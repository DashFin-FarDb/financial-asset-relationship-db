<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.13.2" xml:lang="en-US">
  <compounddef id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec" kind="page">
    <compoundname>md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec</compoundname>
    <title>Technical Specification</title>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para><anchor id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3661"/></para>
<sect1 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3662">
<title>1. Introduction</title><para>This Technical Specification document provides a comprehensive reference for the <bold>Financial Asset Relationship Database</bold>, an enterprise-grade system designed to visualize and analyze complex interconnections between financial assets across multiple asset classes. This introduction establishes the project&apos;s purpose, scope, and context for all stakeholders involved in development, deployment, and utilization of the system.</para>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3663">
<title>1.1 Executive Summary</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3664">
<title>1.1.1 Project Overview</title><para>The Financial Asset Relationship Database is a sophisticated 3D visualization and analytics platform that enables users to explore interconnected financial assets spanning Equities, Fixed Income (Bonds), Commodities, Currencies, and Regulatory Events. The system features a dual-UI architecture that accommodates diverse user preferences and deployment scenarios:</para>
<para><table rows="4" cols="4"><row>
<entry thead="yes"><para>UI Component   </para>
</entry><entry thead="yes"><para>Technology   </para>
</entry><entry thead="yes"><para>Port   </para>
</entry><entry thead="yes"><para>Target Users    </para>
</entry></row>
<row>
<entry thead="no"><para>Legacy Interface   </para>
</entry><entry thead="no"><para>Gradio (Python)   </para>
</entry><entry thead="no"><para>7860   </para>
</entry><entry thead="no"><para>Python developers, rapid prototyping    </para>
</entry></row>
<row>
<entry thead="no"><para>Modern Interface   </para>
</entry><entry thead="no"><para>Next.js + React   </para>
</entry><entry thead="no"><para>3000   </para>
</entry><entry thead="no"><para>Web developers, production deployments    </para>
</entry></row>
<row>
<entry thead="no"><para>REST API   </para>
</entry><entry thead="no"><para>FastAPI   </para>
</entry><entry thead="no"><para>8000   </para>
</entry><entry thead="no"><para>System integrations, external applications   </para>
</entry></row>
</table>
</para>
<para>The platform delivers interactive network visualizations powered by Plotly, enabling intuitive exploration of asset relationships through rotation, zoom, and hover interactions. Both frontend experiences share a common backend logic layer (<computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>) ensuring consistent analytical capabilities regardless of the chosen interface.</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3665">
<title>1.1.2 Core Business Problem</title><para>Financial markets present significant challenges in understanding the complex web of relationships between different asset types. The Financial Asset Relationship Database addresses several critical pain points:</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Challenge   </para>
</entry><entry thead="yes"><para>Solution Provided    </para>
</entry></row>
<row>
<entry thead="no"><para>Cross-Asset Complexity   </para>
</entry><entry thead="no"><para>Automatic discovery of relationships across asset classes including sector affinity, corporate bond-to-equity links, commodity exposure, and currency risk    </para>
</entry></row>
<row>
<entry thead="no"><para>Regulatory Impact Analysis   </para>
</entry><entry thead="no"><para>Integration of regulatory events with scored impact modeling (-1 to +1 scale) affecting multiple assets    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Visualization   </para>
</entry><entry thead="no"><para>Interactive 3D network graphs with deterministic layouts (seed=42) for reproducible analysis    </para>
</entry></row>
<row>
<entry thead="no"><para>Portfolio Risk Assessment   </para>
</entry><entry thead="no"><para>Network metrics calculation including relationship density, average degree, and asset class distributions   </para>
</entry></row>
</table>
</para>
<para>The system transforms raw financial data into actionable intelligence by surfacing hidden connections that traditional asset-by-asset analysis would miss.</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3666">
<title>1.1.3 Key Stakeholders and Users</title><para>The platform serves multiple user constituencies with varying technical backgrounds and analytical needs:</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Stakeholder Group   </para>
</entry><entry thead="yes"><para>Primary Use Cases   </para>
</entry><entry thead="yes"><para>Preferred Interface    </para>
</entry></row>
<row>
<entry thead="no"><para>Financial Analysts   </para>
</entry><entry thead="no"><para>Cross-asset relationship insights, sector analysis   </para>
</entry><entry thead="no"><para>Next.js UI, Gradio UI    </para>
</entry></row>
<row>
<entry thead="no"><para>Portfolio Managers   </para>
</entry><entry thead="no"><para>Diversification analysis, risk exposure visualization   </para>
</entry><entry thead="no"><para>Next.js UI    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Scientists   </para>
</entry><entry thead="no"><para>Network structure exploration, custom analytics   </para>
</entry><entry thead="no"><para>REST API, Gradio UI    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Developers   </para>
</entry><entry thead="no"><para>Programmatic data access, workflow automation   </para>
</entry><entry thead="no"><para>REST API    </para>
</entry></row>
<row>
<entry thead="no"><para>Compliance Officers   </para>
</entry><entry thead="no"><para>Regulatory event impact assessment   </para>
</entry><entry thead="no"><para>Next.js UI   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3667">
<title>1.1.4 Value Proposition and Business Impact</title><para>The Financial Asset Relationship Database delivers measurable business value through:</para>
<para><bold>Analytical Capabilities:</bold></para>
<para><itemizedlist>
<listitem><para>Cross-asset analysis with automatic relationship discovery via <computeroutput>_find_relationships()</computeroutput> and <computeroutput>build_relationships()</computeroutput> methods</para>
</listitem><listitem><para>Real-time network statistics with relationship strength normalization (0.0-1.0 scale)</para>
</listitem><listitem><para>Deterministic 3D layouts ensuring reproducible visualizations across sessions</para>
</listitem><listitem><para>Comprehensive schema and business rules documentation generation</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Advantages:</bold></para>
<para><itemizedlist>
<listitem><para>Modern REST API architecture enabling integration with external systems</para>
</listitem><listitem><para>Dual-UI strategy supporting both rapid prototyping (Gradio) and production deployments (Next.js)</para>
</listitem><listitem><para>Thread-safe graph initialization with double-checked locking for concurrent access</para>
</listitem><listitem><para>JWT-based authentication with configurable token expiration (30-minute default)</para>
</listitem></itemizedlist>
</para>
<para><bold>Operational Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Multiple deployment options: local development, Docker containerization, and Vercel serverless</para>
</listitem><listitem><para>Real market data integration via Yahoo Finance API (yfinance)</para>
</listitem><listitem><para>Offline exploration capability using comprehensive sample dataset</para>
</listitem></itemizedlist>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3668">
<title>1.2 System Overview</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3669">
<title>1.2.1 Project Context</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3670">
<title>Business Context and Market Positioning</title><para>The Financial Asset Relationship Database positions itself as a specialized analytical tool for financial professionals who require visibility into cross-asset relationships. Unlike traditional portfolio management systems that treat assets in isolation, this platform emphasizes the interconnected nature of financial markets.</para>
<para>The system operates within the broader financial technology landscape, providing:</para>
<para><itemizedlist>
<listitem><para>Network-based analysis complementing traditional fundamental and technical analysis</para>
</listitem><listitem><para>Regulatory event integration bridging compliance and investment functions</para>
</listitem><listitem><para>API-first architecture enabling ecosystem integration</para>
</listitem></itemizedlist>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3671">
<title>Current System Architecture</title><para>The platform implements a layered architecture separating concerns across presentation, API, business logic, and data layers:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Presentation[&quot;Presentation<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GradioUI[&quot;Gradio<sp/>UI&lt;br/&gt;(app.py)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextJS[&quot;Next.js<sp/>Frontend&lt;br/&gt;(frontend/)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>APILayer[&quot;API<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI[&quot;FastAPI<sp/>Backend&lt;br/&gt;(api/main.py)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>BusinessLogic[&quot;Business<sp/>Logic<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphLogic[&quot;Asset<sp/>Graph&lt;br/&gt;(src/logic/)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Models[&quot;Domain<sp/>Models&lt;br/&gt;(src/models/)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Visualization[&quot;Visualization&lt;br/&gt;(src/visualizations/)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DataLayer[&quot;Data<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SampleData[&quot;Sample<sp/>Data&lt;br/&gt;(src/data/sample_data.py)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YahooFinance[&quot;Yahoo<sp/>Finance&lt;br/&gt;(yfinance)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GradioUI<sp/>--&gt;<sp/>GraphLogic</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NextJS<sp/>--&gt;<sp/>FastAPI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>GraphLogic</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphLogic<sp/>--&gt;<sp/>Models</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphLogic<sp/>--&gt;<sp/>Visualization</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphLogic<sp/>--&gt;<sp/>SampleData</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphLogic<sp/>--&gt;<sp/>YahooFinance</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3672">
<title>Integration with Enterprise Landscape</title><para>The system is designed for integration flexibility:</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Integration Point   </para>
</entry><entry thead="yes"><para>Mechanism   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>External Data Sources   </para>
</entry><entry thead="no"><para>Yahoo Finance via yfinance library   </para>
</entry><entry thead="no"><para><computeroutput>USE_REAL_DATA_FETCHER</computeroutput> environment variable    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication Systems   </para>
</entry><entry thead="no"><para>JWT token-based auth   </para>
</entry><entry thead="no"><para>Environment variables for secret key and algorithm    </para>
</entry></row>
<row>
<entry thead="no"><para>Frontend Applications   </para>
</entry><entry thead="no"><para>RESTful JSON API   </para>
</entry><entry thead="no"><para>CORS allowlist per environment    </para>
</entry></row>
<row>
<entry thead="no"><para>Container Orchestration   </para>
</entry><entry thead="no"><para>Docker Compose   </para>
</entry><entry thead="no"><para><computeroutput>docker-compose.yml</computeroutput> configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Serverless Platforms   </para>
</entry><entry thead="no"><para>Vercel deployment   </para>
</entry><entry thead="no"><para><computeroutput>vercel.json</computeroutput> configuration   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3673">
<title>1.2.2 High-Level Description</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3674">
<title>Primary System Capabilities</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Capability   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>3D Network Visualization   </para>
</entry><entry thead="no"><para>Interactive Plotly-based graph rendering with rotation, zoom, and hover   </para>
</entry><entry thead="no"><para><computeroutput>src/visualizations/</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Cross-Asset Analysis   </para>
</entry><entry thead="no"><para>Automatic relationship discovery between different asset classes   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Regulatory Integration   </para>
</entry><entry thead="no"><para>Corporate events and SEC filings with scored impact modeling   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Real-time Metrics   </para>
</entry><entry thead="no"><para>Network statistics, relationship density, distribution analysis   </para>
</entry><entry thead="no"><para>API <computeroutput>/api/metrics</computeroutput> endpoint    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset Explorer   </para>
</entry><entry thead="no"><para>Filterable table with asset class and sector filters   </para>
</entry><entry thead="no"><para>Gradio and Next.js UIs    </para>
</entry></row>
<row>
<entry thead="no"><para>Schema Reporting   </para>
</entry><entry thead="no"><para>Auto-generated documentation of data models and business rules   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="schema__report_8py" kindref="compound">src/reports/schema_report.py</ref></computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3675">
<title>Major System Components</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Frontend[&quot;Frontend<sp/>Components&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A1[&quot;Gradio<sp/>UI&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A2[&quot;Next.js<sp/>App&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Backend[&quot;Backend<sp/>Services&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>B1[&quot;FastAPI<sp/>Server&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>B2[&quot;JWT<sp/>Auth&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>B3[&quot;Rate<sp/>Limiter&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Core[&quot;Core<sp/>Logic&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C1[&quot;Asset<sp/>Graph<sp/>Engine&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C2[&quot;Relationship<sp/>Builder&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C3[&quot;Metrics<sp/>Calculator&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Data[&quot;Data<sp/>Sources&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>D1[&quot;Sample<sp/>Database&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>D2[&quot;Yahoo<sp/>Finance&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>A1<sp/>--&gt;<sp/>C1</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>A2<sp/>--&gt;<sp/>B1</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>B1<sp/>--&gt;<sp/>B2</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>B1<sp/>--&gt;<sp/>B3</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>B1<sp/>--&gt;<sp/>C1</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>C1<sp/>--&gt;<sp/>C2</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>C1<sp/>--&gt;<sp/>C3</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>C2<sp/>--&gt;<sp/>D1</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>C2<sp/>--&gt;<sp/>D2</highlight></codeline>
<codeline><highlight class="normal">end</highlight></codeline>
</programlisting></para>
<para>The component architecture follows these responsibilities:</para>
<para><table rows="9" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Location   </para>
</entry><entry thead="yes"><para>Responsibility    </para>
</entry></row>
<row>
<entry thead="no"><para>Gradio UI   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Legacy Python UI with tabbed interface for visualization, metrics, schema, and asset exploration    </para>
</entry></row>
<row>
<entry thead="no"><para>FastAPI Backend   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>REST API with JWT authentication, CORS configuration, and rate limiting    </para>
</entry></row>
<row>
<entry thead="no"><para>Next.js Frontend   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/</computeroutput>   </para>
</entry><entry thead="no"><para>Modern React-based UI with TypeScript and Tailwind CSS    </para>
</entry></row>
<row>
<entry thead="no"><para>Core Logic   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Graph algorithms, relationship discovery, visualization data interface    </para>
</entry></row>
<row>
<entry thead="no"><para>Domain Models   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Asset dataclasses, enums, validation rules    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Layer   </para>
</entry><entry thead="no"><para><computeroutput>src/data/</computeroutput>   </para>
</entry><entry thead="no"><para>Sample data (19 assets, 4 regulatory events) and real Yahoo Finance fetcher    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Layer   </para>
</entry><entry thead="no"><para><computeroutput>src/visualizations/</computeroutput>   </para>
</entry><entry thead="no"><para>Plotly-based chart generation for 3D graphs, metrics, and 2D views    </para>
</entry></row>
<row>
<entry thead="no"><para>Reports   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="schema__report_8py" kindref="compound">src/reports/schema_report.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Schema documentation generator   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3676">
<title>Asset Classes and Domain Model</title><para>The system supports five primary asset classes defined in the <computeroutput>AssetClass</computeroutput> enum:</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Asset Class   </para>
</entry><entry thead="yes"><para>Key Attributes   </para>
</entry><entry thead="yes"><para>Example Use    </para>
</entry></row>
<row>
<entry thead="no"><para>Equity   </para>
</entry><entry thead="no"><para>P/E ratio, dividend yield, EPS, book value   </para>
</entry><entry thead="no"><para>Stock analysis    </para>
</entry></row>
<row>
<entry thead="no"><para>Fixed Income   </para>
</entry><entry thead="no"><para>Yield to maturity, coupon rate, maturity date, credit rating, issuer_id   </para>
</entry><entry thead="no"><para>Bond analysis    </para>
</entry></row>
<row>
<entry thead="no"><para>Commodity   </para>
</entry><entry thead="no"><para>Contract size, delivery date, volatility   </para>
</entry><entry thead="no"><para>Commodity tracking    </para>
</entry></row>
<row>
<entry thead="no"><para>Currency   </para>
</entry><entry thead="no"><para>Exchange rate, country, central bank rate   </para>
</entry><entry thead="no"><para>FX exposure    </para>
</entry></row>
<row>
<entry thead="no"><para>Derivative   </para>
</entry><entry thead="no"><para>Extensible attributes   </para>
</entry><entry thead="no"><para>Future expansion   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3677">
<title>Relationship Types</title><para>The relationship engine discovers and manages six primary relationship types:</para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Relationship Type   </para>
</entry><entry thead="yes"><para>Directionality   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>same_sector</computeroutput>   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Assets operating in the same industry sector    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>corporate_bond_to_equity</computeroutput>   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Bonds issued by companies with traded stock    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>commodity_exposure</computeroutput>   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Equity companies exposed to commodity price movements    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>currency_risk</computeroutput>   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>FX exposure for non-USD denominated assets    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>income_comparison</computeroutput>   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Dividend yields compared to bond yields    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_impact</computeroutput>   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Regulatory events affecting multiple assets   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3678">
<title>1.2.3 Technology Stack</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3679">
<title>Backend Technologies</title><para><table rows="11" cols="3"><row>
<entry thead="yes"><para>Technology   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Python   </para>
</entry><entry thead="no"><para>3.10+   </para>
</entry><entry thead="no"><para>Runtime environment    </para>
</entry></row>
<row>
<entry thead="no"><para>FastAPI   </para>
</entry><entry thead="no"><para>0.127.0   </para>
</entry><entry thead="no"><para>REST API framework    </para>
</entry></row>
<row>
<entry thead="no"><para>Uvicorn   </para>
</entry><entry thead="no"><para>≥0.24.0   </para>
</entry><entry thead="no"><para>ASGI server    </para>
</entry></row>
<row>
<entry thead="no"><para>Pydantic   </para>
</entry><entry thead="no"><para>2.12.5   </para>
</entry><entry thead="no"><para>Data validation and serialization    </para>
</entry></row>
<row>
<entry thead="no"><para>NumPy   </para>
</entry><entry thead="no"><para>2.2.6   </para>
</entry><entry thead="no"><para>Numerical computing    </para>
</entry></row>
<row>
<entry thead="no"><para>Pandas   </para>
</entry><entry thead="no"><para>≥1.5.0   </para>
</entry><entry thead="no"><para>Data analysis and manipulation    </para>
</entry></row>
<row>
<entry thead="no"><para>yfinance   </para>
</entry><entry thead="no"><para>≥0.2.51   </para>
</entry><entry thead="no"><para>Yahoo Finance data acquisition    </para>
</entry></row>
<row>
<entry thead="no"><para>Plotly   </para>
</entry><entry thead="no"><para>≥6.0.0   </para>
</entry><entry thead="no"><para>Visualization generation    </para>
</entry></row>
<row>
<entry thead="no"><para>SQLAlchemy   </para>
</entry><entry thead="no"><para>≥2.0.0   </para>
</entry><entry thead="no"><para>Database ORM    </para>
</entry></row>
<row>
<entry thead="no"><para>Gradio   </para>
</entry><entry thead="no"><para>≥4.0.0   </para>
</entry><entry thead="no"><para>Legacy UI framework   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3680">
<title>Frontend Technologies</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Technology   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>React   </para>
</entry><entry thead="no"><para>18.2.0   </para>
</entry><entry thead="no"><para>UI component framework    </para>
</entry></row>
<row>
<entry thead="no"><para>Next.js   </para>
</entry><entry thead="no"><para>14.2.x   </para>
</entry><entry thead="no"><para>React framework with App Router    </para>
</entry></row>
<row>
<entry thead="no"><para>TypeScript   </para>
</entry><entry thead="no"><para>Latest   </para>
</entry><entry thead="no"><para>Type safety    </para>
</entry></row>
<row>
<entry thead="no"><para>Tailwind CSS   </para>
</entry><entry thead="no"><para>Latest   </para>
</entry><entry thead="no"><para>Utility-first CSS framework    </para>
</entry></row>
<row>
<entry thead="no"><para>Plotly.js   </para>
</entry><entry thead="no"><para>Latest   </para>
</entry><entry thead="no"><para>Client-side 3D visualization    </para>
</entry></row>
<row>
<entry thead="no"><para>Axios   </para>
</entry><entry thead="no"><para>Latest   </para>
</entry><entry thead="no"><para>HTTP client for API communication   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3681">
<title>Infrastructure Technologies</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Technology   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Configuration File    </para>
</entry></row>
<row>
<entry thead="no"><para>Docker   </para>
</entry><entry thead="no"><para>Containerization   </para>
</entry><entry thead="no"><para><computeroutput>Dockerfile</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Docker Compose   </para>
</entry><entry thead="no"><para>Multi-container orchestration   </para>
</entry><entry thead="no"><para><computeroutput>docker-compose.yml</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Vercel   </para>
</entry><entry thead="no"><para>Serverless deployment   </para>
</entry><entry thead="no"><para><computeroutput>vercel.json</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Jest   </para>
</entry><entry thead="no"><para>Frontend testing   </para>
</entry><entry thead="no"><para><computeroutput>frontend/jest.config.js</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Pytest   </para>
</entry><entry thead="no"><para>Backend testing   </para>
</entry><entry thead="no"><para><computeroutput>tests/</computeroutput> directory   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3682">
<title>1.2.4 Success Criteria</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3683">
<title>Measurable Objectives</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Objective   </para>
</entry><entry thead="yes"><para>Metric   </para>
</entry><entry thead="yes"><para>Target    </para>
</entry></row>
<row>
<entry thead="no"><para>API Response Time   </para>
</entry><entry thead="no"><para>95th percentile latency   </para>
</entry><entry thead="no"><para>&lt; 500ms for standard queries    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Rendering   </para>
</entry><entry thead="no"><para>Time to interactive   </para>
</entry><entry thead="no"><para>&lt; 2 seconds for 3D graph    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Discovery   </para>
</entry><entry thead="no"><para>Coverage   </para>
</entry><entry thead="no"><para>100% of defined relationship types    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Accuracy   </para>
</entry><entry thead="no"><para>Validation pass rate   </para>
</entry><entry thead="no"><para>100% for all asset records   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3684">
<title>Critical Success Factors</title><para><orderedlist>
<listitem><para><bold>Accurate Relationship Discovery</bold>: The system must correctly identify and categorize all relationship types between assets based on the defined business rules in <computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput></para>
</listitem><listitem><para><bold>Reproducible Visualizations</bold>: Deterministic 3D layouts using fixed seed (seed=42) must produce identical visual outputs across sessions</para>
</listitem><listitem><para><bold>API Reliability</bold>: Thread-safe graph initialization with double-checked locking must prevent race conditions under concurrent load</para>
</listitem><listitem><para><bold>Security Compliance</bold>: JWT authentication must enforce 30-minute token expiration with configurable rate limiting (5 requests/minute on <computeroutput>/token</computeroutput>)</para>
</listitem></orderedlist>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3685">
<title>Key Performance Indicators</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>KPI   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Measurement Source    </para>
</entry></row>
<row>
<entry thead="no"><para>Network Density   </para>
</entry><entry thead="no"><para>Ratio of actual to possible relationships   </para>
</entry><entry thead="no"><para><computeroutput>/api/metrics</computeroutput> endpoint    </para>
</entry></row>
<row>
<entry thead="no"><para>Average Degree   </para>
</entry><entry thead="no"><para>Mean number of connections per asset   </para>
</entry><entry thead="no"><para><computeroutput>/api/metrics</computeroutput> endpoint    </para>
</entry></row>
<row>
<entry thead="no"><para>Max Degree   </para>
</entry><entry thead="no"><para>Highest connected asset   </para>
</entry><entry thead="no"><para><computeroutput>/api/metrics</computeroutput> endpoint    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset Class Distribution   </para>
</entry><entry thead="no"><para>Balance of asset types in network   </para>
</entry><entry thead="no"><para><computeroutput>/api/metrics</computeroutput> endpoint    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Strength Distribution   </para>
</entry><entry thead="no"><para>Distribution of normalized weights   </para>
</entry><entry thead="no"><para>Visualization layer   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3686">
<title>1.3 Scope</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3687">
<title>1.3.1 In-Scope</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3688">
<title>Core Features and Functionalities</title><para><bold>Must-Have Capabilities:</bold></para>
<para><table rows="9" cols="3"><row>
<entry thead="yes"><para>Feature   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Status    </para>
</entry></row>
<row>
<entry thead="no"><para>3D Network Visualization   </para>
</entry><entry thead="no"><para>Interactive Plotly-based graph with rotation, zoom, hover   </para>
</entry><entry thead="no"><para>Implemented    </para>
</entry></row>
<row>
<entry thead="no"><para>2D Visualization   </para>
</entry><entry thead="no"><para>Alternative flat network view   </para>
</entry><entry thead="no"><para>Implemented    </para>
</entry></row>
<row>
<entry thead="no"><para>Multi-Asset Class Support   </para>
</entry><entry thead="no"><para>Equity, Fixed Income, Commodity, Currency, Derivative   </para>
</entry><entry thead="no"><para>Implemented    </para>
</entry></row>
<row>
<entry thead="no"><para>Automatic Relationship Discovery   </para>
</entry><entry thead="no"><para>Rule-based detection via <computeroutput>_find_relationships()</computeroutput>   </para>
</entry><entry thead="no"><para>Implemented    </para>
</entry></row>
<row>
<entry thead="no"><para>Network Metrics   </para>
</entry><entry thead="no"><para>Density, average/max degree, distributions   </para>
</entry><entry thead="no"><para>Implemented    </para>
</entry></row>
<row>
<entry thead="no"><para>Regulatory Event Modeling   </para>
</entry><entry thead="no"><para>Impact scores (-1 to +1 scale)   </para>
</entry><entry thead="no"><para>Implemented    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Strength Normalization   </para>
</entry><entry thead="no"><para>Weights on 0.0-1.0 scale   </para>
</entry><entry thead="no"><para>Implemented    </para>
</entry></row>
<row>
<entry thead="no"><para>Schema Documentation   </para>
</entry><entry thead="no"><para>Auto-generated business rules reference   </para>
</entry><entry thead="no"><para>Implemented   </para>
</entry></row>
</table>
</para>
<para><bold>Primary User Workflows:</bold></para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TD</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Workflow1[&quot;Visualization<sp/>Workflow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>W1A[&quot;Access<sp/>UI&quot;]<sp/>--&gt;<sp/>W1B[&quot;Select<sp/>3D/2D<sp/>View&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>W1B<sp/>--&gt;<sp/>W1C[&quot;Interact<sp/>with<sp/>Graph&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>W1C<sp/>--&gt;<sp/>W1D[&quot;Hover<sp/>for<sp/>Details&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Workflow2[&quot;Analytics<sp/>Workflow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>W2A[&quot;View<sp/>Metrics<sp/>Dashboard&quot;]<sp/>--&gt;<sp/>W2B[&quot;Analyze<sp/>Network<sp/>Statistics&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>W2B<sp/>--&gt;<sp/>W2C[&quot;Review<sp/>Distributions&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Workflow3[&quot;Exploration<sp/>Workflow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>W3A[&quot;Open<sp/>Asset<sp/>Explorer&quot;]<sp/>--&gt;<sp/>W3B[&quot;Apply<sp/>Filters&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>W3B<sp/>--&gt;<sp/>W3C[&quot;Select<sp/>Asset&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>W3C<sp/>--&gt;<sp/>W3D[&quot;View<sp/>Relationships&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Workflow4[&quot;Integration<sp/>Workflow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>W4A[&quot;Authenticate<sp/>via<sp/>/token&quot;]<sp/>--&gt;<sp/>W4B[&quot;Call<sp/>REST<sp/>Endpoints&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>W4B<sp/>--&gt;<sp/>W4C[&quot;Process<sp/>JSON<sp/>Response&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal">end</highlight></codeline>
</programlisting></para>
<para><bold>Essential Integrations:</bold></para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Integration   </para>
</entry><entry thead="yes"><para>Technology   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Market Data   </para>
</entry><entry thead="no"><para>Yahoo Finance (yfinance)   </para>
</entry><entry thead="no"><para>Real-time and historical asset data    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization   </para>
</entry><entry thead="no"><para>Plotly   </para>
</entry><entry thead="no"><para>Chart and graph rendering    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication   </para>
</entry><entry thead="no"><para>JWT   </para>
</entry><entry thead="no"><para>API security    </para>
</entry></row>
<row>
<entry thead="no"><para>Database   </para>
</entry><entry thead="no"><para>SQLite/PostgreSQL   </para>
</entry><entry thead="no"><para>Optional persistence   </para>
</entry></row>
</table>
</para>
<para><bold>REST API Endpoints:</bold></para>
<para><table rows="11" cols="3"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Method   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/health</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>System health check    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>List assets with optional filters    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets/{id}</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Retrieve single asset details    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets/{id}/relationships</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Get relationships for specific asset    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/relationships</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>List all relationships    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/metrics</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Network metrics and statistics    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/visualization</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>3D visualization data payload    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/asset-classes</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Enumerate available asset classes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/sectors</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>List industry sectors    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/token</computeroutput>   </para>
</entry><entry thead="no"><para>POST   </para>
</entry><entry thead="no"><para>JWT authentication   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3689">
<title>Implementation Boundaries</title><para><bold>System Boundaries:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Boundary   </para>
</entry><entry thead="yes"><para>Scope    </para>
</entry></row>
<row>
<entry thead="no"><para>Deployment Model   </para>
</entry><entry thead="no"><para>Standalone application with optional external data sources    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Persistence   </para>
</entry><entry thead="no"><para>In-memory graph with optional database backing    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication   </para>
</entry><entry thead="no"><para>Single-user JWT; multi-user requires extension    </para>
</entry></row>
<row>
<entry thead="no"><para>Network Protocol   </para>
</entry><entry thead="no"><para>HTTPS (production), HTTP (development)   </para>
</entry></row>
</table>
</para>
<para><bold>User Groups Covered:</bold></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>User Group   </para>
</entry><entry thead="yes"><para>Access Level   </para>
</entry><entry thead="yes"><para>Interface    </para>
</entry></row>
<row>
<entry thead="no"><para>Analysts   </para>
</entry><entry thead="no"><para>Full read access   </para>
</entry><entry thead="no"><para>All UIs    </para>
</entry></row>
<row>
<entry thead="no"><para>Developers   </para>
</entry><entry thead="no"><para>API access with authentication   </para>
</entry><entry thead="no"><para>REST API    </para>
</entry></row>
<row>
<entry thead="no"><para>Administrators   </para>
</entry><entry thead="no"><para>Configuration management   </para>
</entry><entry thead="no"><para>Environment variables   </para>
</entry></row>
</table>
</para>
<para><bold>Data Domains Included:</bold></para>
<para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Domain   </para>
</entry><entry thead="yes"><para>Coverage    </para>
</entry></row>
<row>
<entry thead="no"><para>Equities   </para>
</entry><entry thead="no"><para>US market securities    </para>
</entry></row>
<row>
<entry thead="no"><para>Fixed Income   </para>
</entry><entry thead="no"><para>Corporate and government bonds    </para>
</entry></row>
<row>
<entry thead="no"><para>Commodities   </para>
</entry><entry thead="no"><para>Major commodity contracts    </para>
</entry></row>
<row>
<entry thead="no"><para>Currencies   </para>
</entry><entry thead="no"><para>Major currency pairs    </para>
</entry></row>
<row>
<entry thead="no"><para>Regulatory Events   </para>
</entry><entry thead="no"><para>SEC filings and corporate actions   </para>
</entry></row>
</table>
</para>
<para><bold>Sample Dataset:</bold></para>
<para><itemizedlist>
<listitem><para>19 assets across 4 asset classes</para>
</listitem><listitem><para>4 regulatory events with impact scores</para>
</listitem><listitem><para>Comprehensive relationship coverage for all defined types</para>
</listitem></itemizedlist>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3690">
<title>1.3.2 Out-of-Scope</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3691">
<title>Explicitly Excluded Features</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Feature   </para>
</entry><entry thead="yes"><para>Exclusion Reason   </para>
</entry><entry thead="yes"><para>Future Consideration    </para>
</entry></row>
<row>
<entry thead="no"><para>Real-time Streaming Data   </para>
</entry><entry thead="no"><para>Architectural complexity   </para>
</entry><entry thead="no"><para>Phase 2    </para>
</entry></row>
<row>
<entry thead="no"><para>WebSocket Live Updates   </para>
</entry><entry thead="no"><para>Infrastructure requirements   </para>
</entry><entry thead="no"><para>Phase 2    </para>
</entry></row>
<row>
<entry thead="no"><para>Advanced Portfolio Optimization   </para>
</entry><entry thead="no"><para>Beyond core visualization scope   </para>
</entry><entry thead="no"><para>Not planned    </para>
</entry></row>
<row>
<entry thead="no"><para>Historical Backtesting   </para>
</entry><entry thead="no"><para>Requires time-series infrastructure   </para>
</entry><entry thead="no"><para>Not planned    </para>
</entry></row>
<row>
<entry thead="no"><para>Multi-User Role-Based Access   </para>
</entry><entry thead="no"><para>Basic JWT auth only   </para>
</entry><entry thead="no"><para>Phase 2    </para>
</entry></row>
<row>
<entry thead="no"><para>Mobile Native Applications   </para>
</entry><entry thead="no"><para>Web-responsive only   </para>
</entry><entry thead="no"><para>Not planned   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3692">
<title>Future Phase Considerations</title><para>The following enhancements are identified for future development phases:</para>
<para><bold>Phase 2 Enhancements (from <ref refid="INTEGRATION__SUMMARY_8md" kindref="compound">INTEGRATION_SUMMARY.md</ref>):</bold></para>
<para><table rows="8" cols="2"><row>
<entry thead="yes"><para>Enhancement   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para>Enhanced Authentication   </para>
</entry><entry thead="no"><para>Role-based access control    </para>
</entry></row>
<row>
<entry thead="no"><para>Caching Layer   </para>
</entry><entry thead="no"><para>Redis integration for performance    </para>
</entry></row>
<row>
<entry thead="no"><para>Real-time Updates   </para>
</entry><entry thead="no"><para>WebSocket-based live data    </para>
</entry></row>
<row>
<entry thead="no"><para>Additional Visualizations   </para>
</entry><entry thead="no"><para>Extended chart types    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Export   </para>
</entry><entry thead="no"><para>CSV, JSON, PDF export capabilities    </para>
</entry></row>
<row>
<entry thead="no"><para>CI/CD Pipeline   </para>
</entry><entry thead="no"><para>Automated testing and deployment    </para>
</entry></row>
<row>
<entry thead="no"><para>Monitoring &amp; Analytics   </para>
</entry><entry thead="no"><para>Application performance monitoring   </para>
</entry></row>
</table>
</para>
<para><bold>Feature Parity Roadmap (Next.js catching up to Gradio):</bold></para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Feature   </para>
</entry><entry thead="yes"><para>Gradio Status   </para>
</entry><entry thead="yes"><para>Next.js Status    </para>
</entry></row>
<row>
<entry thead="no"><para>Schema Report   </para>
</entry><entry thead="no"><para>✓ Implemented   </para>
</entry><entry thead="no"><para>Pending    </para>
</entry></row>
<row>
<entry thead="no"><para>Documentation Tab   </para>
</entry><entry thead="no"><para>✓ Implemented   </para>
</entry><entry thead="no"><para>Pending    </para>
</entry></row>
<row>
<entry thead="no"><para>2D Visualization   </para>
</entry><entry thead="no"><para>✓ Implemented   </para>
</entry><entry thead="no"><para>Pending    </para>
</entry></row>
<row>
<entry thead="no"><para>Formulaic Analysis   </para>
</entry><entry thead="no"><para>✓ Implemented   </para>
</entry><entry thead="no"><para>Pending    </para>
</entry></row>
<row>
<entry thead="no"><para>Export Features   </para>
</entry><entry thead="no"><para>✓ Implemented   </para>
</entry><entry thead="no"><para>Pending   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3693">
<title>Integration Points Not Covered</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Integration   </para>
</entry><entry thead="yes"><para>Status   </para>
</entry><entry thead="yes"><para>Notes    </para>
</entry></row>
<row>
<entry thead="no"><para>Bloomberg Terminal   </para>
</entry><entry thead="no"><para>Out of scope   </para>
</entry><entry thead="no"><para>Proprietary API    </para>
</entry></row>
<row>
<entry thead="no"><para>Reuters Eikon   </para>
</entry><entry thead="no"><para>Out of scope   </para>
</entry><entry thead="no"><para>Licensing requirements    </para>
</entry></row>
<row>
<entry thead="no"><para>Alternative data providers   </para>
</entry><entry thead="no"><para>Out of scope   </para>
</entry><entry thead="no"><para>yfinance standardized    </para>
</entry></row>
<row>
<entry thead="no"><para>Third-party authentication (OAuth)   </para>
</entry><entry thead="no"><para>Out of scope   </para>
</entry><entry thead="no"><para>JWT only   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3694">
<title>Unsupported Use Cases</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Use Case   </para>
</entry><entry thead="yes"><para>Reason    </para>
</entry></row>
<row>
<entry thead="no"><para>High-Frequency Trading   </para>
</entry><entry thead="no"><para>Latency requirements exceed design parameters    </para>
</entry></row>
<row>
<entry thead="no"><para>Multi-Tenant SaaS   </para>
</entry><entry thead="no"><para>Single-user architecture    </para>
</entry></row>
<row>
<entry thead="no"><para>Offline Mobile   </para>
</entry><entry thead="no"><para>Web-only responsive design    </para>
</entry></row>
<row>
<entry thead="no"><para>Non-Financial Assets   </para>
</entry><entry thead="no"><para>Domain model specific to financial instruments    </para>
</entry></row>
<row>
<entry thead="no"><para>Real-time Market Making   </para>
</entry><entry thead="no"><para>No order execution capability   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3695">
<title>1.4 References</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3696">
<title>1.4.1 Documentation Files</title><para><table rows="8" cols="2"><row>
<entry thead="yes"><para>File   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>README.md</computeroutput>   </para>
</entry><entry thead="no"><para>Project overview, features, quick start guide, architecture summary    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="ARCHITECTURE_8md" kindref="compound">ARCHITECTURE.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Detailed system architecture, component diagrams, data flow    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="QUICK__START_8md" kindref="compound">QUICK_START.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>User onboarding, development setup, usage examples    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="INTEGRATION__SUMMARY_8md" kindref="compound">INTEGRATION_SUMMARY.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Vercel integration, Next.js + FastAPI architecture, future roadmap    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="DEPLOYMENT_8md" kindref="compound">DEPLOYMENT.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Deployment procedures, API endpoints, environment configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="UI__COMPARISON_8md" kindref="compound">UI_COMPARISON.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Gradio vs Next.js feature comparison    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="SECURITY_8md" kindref="compound">SECURITY.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Security best practices, authentication patterns   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3697">
<title>1.4.2 Source Code Files</title><para><table rows="8" cols="2"><row>
<entry thead="yes"><para>File   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Gradio UI implementation, tabs, visualization handlers    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI implementation, all endpoints, CORS, rate limiting, JWT auth    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Domain models, asset classes, validation rules, enums    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Core graph logic, relationship discovery, visualization data interface    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="sample__data_8py" kindref="compound">src/data/sample_data.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Sample asset data with 19 assets, 4 regulatory events    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="schema__report_8py" kindref="compound">src/reports/schema_report.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Schema documentation generator    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>requirements.txt</computeroutput>   </para>
</entry><entry thead="no"><para>Python dependencies and versions   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3698">
<title>1.4.3 Configuration Files</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>File   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Dockerfile</computeroutput>   </para>
</entry><entry thead="no"><para>Container configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>docker-compose.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Container orchestration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>vercel.json</computeroutput>   </para>
</entry><entry thead="no"><para>Serverless deployment configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/jest.config.js</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend test configuration   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3699">
<title>1.4.4 Source Directories</title><para><table rows="10" cols="2"><row>
<entry thead="yes"><para>Directory   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/</computeroutput>   </para>
</entry><entry thead="no"><para>Core Python library packages    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/models/</computeroutput>   </para>
</entry><entry thead="no"><para>Domain model definitions    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/logic/</computeroutput>   </para>
</entry><entry thead="no"><para>Graph algorithm implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/data/</computeroutput>   </para>
</entry><entry thead="no"><para>Data sources and persistence    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/visualizations/</computeroutput>   </para>
</entry><entry thead="no"><para>Plotly visualization helpers    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>api/</computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI backend package    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/</computeroutput>   </para>
</entry><entry thead="no"><para>Next.js application    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/</computeroutput>   </para>
</entry><entry thead="no"><para>React components, API client, types    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>tests/</computeroutput>   </para>
</entry><entry thead="no"><para>Test harness structure   </para>
</entry></row>
</table>
</para>
</sect3>
</sect2>
</sect1>
<sect1 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3700">
<title>2. Product Requirements</title><para>This section provides a comprehensive catalog of product requirements for the Financial Asset Relationship Database system. Each feature is documented with traceable requirements, acceptance criteria, and implementation considerations derived from the actual system implementation.</para>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3701">
<title>2.1 Feature Catalog</title><para>The feature catalog documents all discrete, testable features implemented in the Financial Asset Relationship Database. Features are categorized by functional domain and include complete metadata, descriptions, and dependency mappings.</para>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3702">
<title>2.1.1 Feature Overview</title><para>The system encompasses 17 primary features organized across five functional domains:</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Domain   </para>
</entry><entry thead="yes"><para>Feature Count   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Model   </para>
</entry><entry thead="no"><para>2   </para>
</entry><entry thead="no"><para>Asset types and regulatory events    </para>
</entry></row>
<row>
<entry thead="no"><para>Core Engine   </para>
</entry><entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>Graph relationship processing    </para>
</entry></row>
<row>
<entry thead="no"><para>API Layer   </para>
</entry><entry thead="no"><para>4   </para>
</entry><entry thead="no"><para>REST endpoints, auth, security    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization   </para>
</entry><entry thead="no"><para>3   </para>
</entry><entry thead="no"><para>3D/2D graphs, metrics display    </para>
</entry></row>
<row>
<entry thead="no"><para>User Interface   </para>
</entry><entry thead="no"><para>4   </para>
</entry><entry thead="no"><para>Gradio and Next.js frontends   </para>
</entry></row>
</table>
</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TD</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DataModel[&quot;Data<sp/>Model<sp/>Domain&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F001[&quot;F-001&lt;br/&gt;Multi-Asset<sp/>Data<sp/>Model&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F002[&quot;F-002&lt;br/&gt;Regulatory<sp/>Events&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>CoreEngine[&quot;Core<sp/>Engine<sp/>Domain&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F003[&quot;F-003&lt;br/&gt;Graph<sp/>Engine&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>APILayer[&quot;API<sp/>Layer<sp/>Domain&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F004[&quot;F-004&lt;br/&gt;REST<sp/>API&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F005[&quot;F-005&lt;br/&gt;JWT<sp/>Auth&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F006[&quot;F-006&lt;br/&gt;CORS<sp/>Config&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F007[&quot;F-007&lt;br/&gt;Rate<sp/>Limiting&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Visualization[&quot;Visualization<sp/>Domain&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F008[&quot;F-008&lt;br/&gt;3D<sp/>Visualization&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F009[&quot;F-009&lt;br/&gt;2D<sp/>Visualization&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F010[&quot;F-010&lt;br/&gt;Metrics<sp/>Dashboard&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>UserInterface[&quot;User<sp/>Interface<sp/>Domain&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F011[&quot;F-011&lt;br/&gt;Asset<sp/>Explorer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F012[&quot;F-012&lt;br/&gt;Schema<sp/>Report&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F016[&quot;F-016&lt;br/&gt;Gradio<sp/>UI&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F017[&quot;F-017&lt;br/&gt;Next.js<sp/>Frontend&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F001<sp/>--&gt;<sp/>F003</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F002<sp/>--&gt;<sp/>F003</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F003<sp/>--&gt;<sp/>F004</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F003<sp/>--&gt;<sp/>F008</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F003<sp/>--&gt;<sp/>F009</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F003<sp/>--&gt;<sp/>F010</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F004<sp/>--&gt;<sp/>F017</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F005<sp/>--&gt;<sp/>F004</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F006<sp/>--&gt;<sp/>F004</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F007<sp/>--&gt;<sp/>F004</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3703">
<title>2.1.2 Data Model Features</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3704">
<title>F-001: Multi-Asset Class Data Model</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-001    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>Multi-Asset Class Data Model    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>Data Model    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>Critical    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>The Multi-Asset Class Data Model provides the foundational domain model supporting five distinct asset classes: Equity, Fixed Income (Bonds), Commodity, Currency, and Derivative. Each asset class extends a base <computeroutput>Asset</computeroutput> dataclass with specialized attributes relevant to that financial instrument type.</para>
<para><bold>Business Value:</bold></para>
<para>This feature enables comprehensive cross-asset analysis by providing a unified data structure that captures the unique characteristics of diverse financial instruments while maintaining a consistent interface for relationship discovery and visualization.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Analysts can explore relationships across heterogeneous asset types</para>
</listitem><listitem><para>Portfolio managers can assess diversification across asset classes</para>
</listitem><listitem><para>Data scientists can perform network analysis on a normalized dataset</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>The domain model is implemented in <computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput> using Python dataclasses. The <computeroutput>AssetClass</computeroutput> enum defines the five supported types, while specialized dataclasses (Equity, Bond, Commodity, Currency) extend the base <computeroutput>Asset</computeroutput> class with type-specific fields. Validation rules enforce data integrity constraints including non-empty identifiers, non-negative prices, and ISO currency code formatting.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>Python 3.10+, dataclasses    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>Compatible with SQLAlchemy ORM mapping   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3706">
<title>F-002: Regulatory Event Integration</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-002    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>Regulatory Event Integration    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>Data Model    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>High    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>Regulatory Event Integration models corporate and regulatory activities that impact multiple financial assets. Events include earnings reports, SEC filings, dividend announcements, bond issuances, acquisitions, and bankruptcy proceedings. Each event carries a scored impact value enabling quantitative assessment of regulatory influence on asset relationships.</para>
<para><bold>Business Value:</bold></para>
<para>This feature bridges compliance and investment functions by surfacing regulatory events that affect asset valuations and inter-asset relationships, enabling proactive risk management.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Compliance officers can track regulatory event propagation</para>
</listitem><listitem><para>Analysts can assess event impact across related assets</para>
</listitem><listitem><para>Portfolio managers can evaluate regulatory risk exposure</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented via the <computeroutput>RegulatoryEvent</computeroutput> dataclass and <computeroutput>RegulatoryActivity</computeroutput> enum in <computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>. The impact_score field uses a normalized scale from -1.0 (highly negative) to +1.0 (highly positive). Events link to affected assets via the <computeroutput>asset_id</computeroutput> field and optionally through <computeroutput>related_assets</computeroutput> for multi-asset impacts.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>F-001 (Multi-Asset Data Model)    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>Python 3.10+, dataclasses    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>Requires valid asset_id references   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3708">
<title>2.1.3 Core Engine Features</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3709">
<title>F-003: Asset Relationship Graph Engine</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-003    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>Asset Relationship Graph Engine    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>Core Logic    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>Critical    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>The Asset Relationship Graph Engine is the central processing component that discovers, stores, and exposes relationships between financial assets. The engine implements rule-based relationship detection across eight relationship types, calculates network metrics, and provides visualization data interfaces.</para>
<para><bold>Business Value:</bold></para>
<para>This feature transforms raw financial data into actionable intelligence by surfacing hidden connections that traditional asset-by-asset analysis would miss, enabling superior risk assessment and portfolio construction.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Automatic discovery of non-obvious asset relationships</para>
</listitem><listitem><para>Reproducible visualizations via deterministic layouts</para>
</listitem><listitem><para>Network-based analysis complementing fundamental analysis</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented in <computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>, the engine maintains a graph structure as <computeroutput>Dict[source_id, List[Tuple[target_id, rel_type, strength]]]</computeroutput>. Key methods include <computeroutput>add_asset()</computeroutput>, <computeroutput>add_regulatory_event()</computeroutput>, <computeroutput>build_relationships()</computeroutput>, <computeroutput>calculate_metrics()</computeroutput>, and <computeroutput>get_3d_visualization_data()</computeroutput>. The engine uses a fixed seed (42) for deterministic 3D layout generation.</para>
<para><bold>Supported Relationship Types:</bold></para>
<para><table rows="9" cols="3"><row>
<entry thead="yes"><para>Relationship Type   </para>
</entry><entry thead="yes"><para>Directionality   </para>
</entry><entry thead="yes"><para>Detection Rule    </para>
</entry></row>
<row>
<entry thead="no"><para>same_sector   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Assets in identical sector    </para>
</entry></row>
<row>
<entry thead="no"><para>corporate_bond_to_equity   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Bond issuer_id matches equity    </para>
</entry></row>
<row>
<entry thead="no"><para>commodity_exposure   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Equity exposed to commodity    </para>
</entry></row>
<row>
<entry thead="no"><para>currency_risk   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Non-USD currency exposure    </para>
</entry></row>
<row>
<entry thead="no"><para>income_comparison   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Dividend vs bond yield    </para>
</entry></row>
<row>
<entry thead="no"><para>regulatory_impact   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Shared regulatory events    </para>
</entry></row>
<row>
<entry thead="no"><para>market_cap_similar   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Similar market capitalization    </para>
</entry></row>
<row>
<entry thead="no"><para>correlation   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Price correlation threshold   </para>
</entry></row>
</table>
</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>F-001, F-002    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>NumPy 2.2.6, Pandas ≥1.5.0    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>Thread-safe initialization   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3711">
<title>2.1.4 API Layer Features</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3712">
<title>F-004: REST API Endpoints</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-004    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>REST API Endpoints    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>API Layer    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>Critical    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>The REST API provides a comprehensive set of HTTP endpoints for programmatic access to asset data, relationships, network metrics, and visualization payloads. Built on FastAPI, the API implements OpenAPI specification compliance with automatic documentation generation.</para>
<para><bold>Business Value:</bold></para>
<para>Enables ecosystem integration, allowing external applications and automated workflows to consume financial relationship data programmatically.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Developers can integrate data into custom applications</para>
</listitem><listitem><para>Automated workflows can consume relationship data</para>
</listitem><listitem><para>Third-party tools can leverage visualization payloads</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented in <computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput> using FastAPI 0.127.0. The API exposes 12 primary endpoints with Pydantic response models for type-safe serialization. Graph initialization occurs at startup via the lifespan context manager with thread-safe singleton access.</para>
<para><bold>API Endpoints:</bold></para>
<para><table rows="13" cols="3"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Method   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>API metadata and endpoint listing    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/health</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>System health check    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/token</computeroutput>   </para>
</entry><entry thead="no"><para>POST   </para>
</entry><entry thead="no"><para>JWT authentication    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/users/me</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Current authenticated user    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>List assets with filters    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets/{id}</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Single asset details    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets/{id}/relationships</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Asset-specific relationships    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/relationships</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>All relationships    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/metrics</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Network metrics    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/visualization</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>3D visualization payload    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/asset-classes</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Available asset classes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/sectors</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Available sectors   </para>
</entry></row>
</table>
</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>F-001, F-002, F-003    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>FastAPI 0.127.0, Pydantic 2.12.5    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>Uvicorn ≥0.24.0    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>F-005 (Authentication), F-006 (CORS)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3714">
<title>F-005: JWT Authentication System</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-005    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>JWT Authentication System    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>API Layer    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>Critical    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>The JWT Authentication System provides token-based security for API endpoints. Users authenticate via username/password credentials to receive a time-limited access token. The system uses HS256 algorithm for token signing with configurable expiration.</para>
<para><bold>Business Value:</bold></para>
<para>Ensures secure access to sensitive financial data by authenticating API consumers and enforcing token-based session management.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Secure programmatic API access</para>
</listitem><listitem><para>Stateless authentication enabling horizontal scaling</para>
</listitem><listitem><para>Configurable session duration</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented in <computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput> using PyJWT ≥2.8.0 and passlib for password hashing. Tokens expire after 30 minutes (ACCESS_TOKEN_EXPIRE_MINUTES). The system requires SECRET_KEY, ADMIN_USERNAME, and ADMIN_PASSWORD environment variables. Failed authentication returns HTTP 401 with &quot;WWW-Authenticate: Bearer&quot; header.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>PyJWT ≥2.8.0, passlib[bcrypt] ≥1.7.4    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>Environment variable configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>F-004 (REST API)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3716">
<title>F-006: CORS Configuration</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-006    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>CORS Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>API Layer    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>High    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>CORS Configuration manages cross-origin resource sharing policies to enable secure frontend-backend communication across different origins. The configuration adapts between development and production modes with support for dynamic origin allowlists and Vercel preview deployments.</para>
<para><bold>Business Value:</bold></para>
<para>Enables secure browser-based API consumption while preventing unauthorized cross-origin requests.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Seamless frontend integration</para>
</listitem><listitem><para>Secure cross-origin communication</para>
</listitem><listitem><para>Support for preview deployments</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented in <computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput> with environment-aware configuration. Development mode permits HTTP localhost:3000 and localhost:7860. Production mode restricts to HTTPS origins. Vercel preview domains are validated via regex pattern <computeroutput>^https://[a-zA-Z0-9\-\.]+\.vercel\.app$</computeroutput>. Custom origins are configurable via ALLOWED_ORIGINS environment variable.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>FastAPI CORSMiddleware    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>Environment configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>F-004 (REST API)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3718">
<title>F-007: Rate Limiting</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-007    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>Rate Limiting    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>API Layer    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>Medium    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>Rate Limiting protects API endpoints from abuse by enforcing request frequency limits per client IP address. The feature uses the slowapi library integrated with FastAPI exception handlers.</para>
<para><bold>Business Value:</bold></para>
<para>Prevents denial-of-service attacks and ensures fair resource allocation among API consumers.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Consistent API availability</para>
</listitem><listitem><para>Protection from credential stuffing attacks</para>
</listitem><listitem><para>Fair usage enforcement</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented using slowapi ≥0.1.4 with <computeroutput>get_remote_address</computeroutput> as the key function. Current rate limits include 5 requests per minute on <computeroutput>/token</computeroutput> and 10 requests per minute on <computeroutput>/api/users/me</computeroutput>.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>slowapi ≥0.1.4    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>F-004 (REST API)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3720">
<title>2.1.5 Visualization Features</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3721">
<title>F-008: 3D Network Visualization</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-008    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>3D Network Visualization    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>Visualization    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>Critical    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>3D Network Visualization renders the asset relationship graph as an interactive three-dimensional network using Plotly. Users can rotate, zoom, and hover over nodes and edges to explore asset relationships in an immersive spatial context.</para>
<para><bold>Business Value:</bold></para>
<para>Provides intuitive visual exploration of complex relationship networks that would be difficult to comprehend in tabular form, accelerating insight discovery.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Intuitive exploration of complex networks</para>
</listitem><listitem><para>Reproducible layouts for consistent analysis</para>
</listitem><listitem><para>Interactive hover details for deep dives</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented in <computeroutput><ref refid="graph__visuals_8py" kindref="compound">src/visualizations/graph_visuals.py</ref></computeroutput> with Plotly ≥6.0.0 (backend) and plotly.js ^2.27.0 (frontend). Nodes are color-coded by asset class: Blue (Equity), Green (Fixed Income), Orange (Commodity), Red (Currency), Purple (Derivative). Edge colors vary by relationship type. Deterministic layouts use seed=42. Frontend guardrails limit rendering to MAX_NODES (default 500) and MAX_EDGES (default 2000).</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>F-003 (Graph Engine)    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>Plotly ≥6.0.0    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>Visualization data from F-003   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3723">
<title>F-009: 2D Network Visualization</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-009    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>2D Network Visualization    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>Visualization    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>High    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>2D Network Visualization provides an alternative flat view of the asset relationship network with selectable layout algorithms. This view is optimized for static analysis and print output.</para>
<para><bold>Business Value:</bold></para>
<para>Offers an alternative visualization format suitable for reports, presentations, and users who prefer traditional 2D analysis.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Multiple layout options (spring, circular, grid)</para>
</listitem><listitem><para>Print-friendly output</para>
</listitem><listitem><para>Simplified interaction model</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented in <computeroutput><ref refid="graph__2d__visuals_8py" kindref="compound">src/visualizations/graph_2d_visuals.py</ref></computeroutput>. Supports the same filtering and relationship visibility toggles as 3D visualization. Layout options include spring (force-directed), circular, and grid arrangements.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>F-003 (Graph Engine)    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>Plotly ≥6.0.0    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>F-008 (shares visualization infrastructure)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3725">
<title>F-010: Metrics Dashboard</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-010    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>Metrics Dashboard    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>Visualization    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>High    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>The Metrics Dashboard displays network statistics and distribution analytics including total assets, total relationships, asset class distribution, average degree, maximum degree, network density, and relationship density.</para>
<para><bold>Business Value:</bold></para>
<para>Provides quantitative insight into network structure, enabling assessment of portfolio diversification and relationship concentration.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>At-a-glance network health indicators</para>
</listitem><listitem><para>Asset class distribution analysis</para>
</listitem><listitem><para>Relationship concentration metrics</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Backend metrics calculation in F-003 exposes data via <computeroutput>/api/metrics</computeroutput> endpoint. The MetricsResponse model includes: total_assets, total_relationships, asset_classes (Dict[str, int]), avg_degree, max_degree, network_density, and relationship_density. Frontend rendering in <computeroutput>frontend/app/components/MetricsDashboard.tsx</computeroutput>.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>F-003 (Graph Engine)    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>Plotly ≥6.0.0    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>F-004 (REST API)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3727">
<title>2.1.6 User Interface Features</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3728">
<title>F-011: Asset Explorer</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-011    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>Asset Explorer    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>User Interface    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>High    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>Asset Explorer provides a filterable, paginated table view of all assets in the system. Users can filter by asset class and sector, view asset details, and navigate to relationship views.</para>
<para><bold>Business Value:</bold></para>
<para>Enables structured data exploration for users who prefer tabular interfaces or need to locate specific assets efficiently.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Efficient asset lookup by class or sector</para>
</listitem><listitem><para>Paginated navigation for large datasets</para>
</listitem><listitem><para>Direct access to asset details</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented in both Gradio (<computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>) and Next.js (<computeroutput>frontend/app/components/AssetList.tsx</computeroutput>). API supports filtering via <computeroutput>asset_class</computeroutput> and <computeroutput>sector</computeroutput> query parameters. Pagination via <computeroutput>page</computeroutput> and <computeroutput>per_page</computeroutput> parameters. Display columns include symbol, name, asset class, sector, price, and market_cap.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>F-003 (Graph Engine)    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>F-004 (REST API) for Next.js   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3730">
<title>F-012: Schema &amp; Rules Report</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-012    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>Schema &amp; Rules Report    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>User Interface    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>Medium    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>The Schema &amp; Rules Report generates human-readable documentation of the data model, relationship types, business rules, and calculated metrics. Output is formatted in Markdown for easy consumption and publication.</para>
<para><bold>Business Value:</bold></para>
<para>Provides self-documenting system capabilities, reducing onboarding time for new users and enabling compliance documentation.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Auto-generated data dictionary</para>
</listitem><listitem><para>Business rules reference</para>
</listitem><listitem><para>Data quality score visibility</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented in <computeroutput><ref refid="schema__report_8py" kindref="compound">src/reports/schema_report.py</ref></computeroutput>. Output includes entity type descriptions, relationship type definitions, business rules documentation, calculated metrics explanations, and data quality scores. Accessible via the Gradio UI&apos;s Schema &amp; Rules tab.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>F-003 (Graph Engine)    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>Gradio UI (F-016)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3732">
<title>F-013: Formulaic Analysis</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-013    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>Formulaic Analysis    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>Analytics    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>Medium    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>Formulaic Analysis provides a library of financial formulas with LaTeX rendering, variable definitions, example calculations, and R-squared values where applicable. Formula categories span fundamental analysis, correlation, valuation, risk/return, portfolio theory, and cross-asset relationships.</para>
<para><bold>Business Value:</bold></para>
<para>Educates users on the quantitative foundations underlying relationship analysis and enables validation of system calculations.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Formula library with mathematical notation</para>
</listitem><listitem><para>Category-organized reference material</para>
</listitem><listitem><para>Example calculations for verification</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented in <computeroutput><ref refid="formulaic__analysis_8py" kindref="compound">src/analysis/formulaic_analysis.py</ref></computeroutput>. The Formula dataclass includes: name, formula, latex, description, variables, example_calculation, category, and r_squared. The Gradio UI exposes this via the Formulaic Analysis tab with empirical relationship data including correlation matrices.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>F-001, F-003    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>Gradio UI (F-016)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3734">
<title>F-014: Real Data Fetching</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-014    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>Real Data Fetching    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>Data Layer    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>Medium    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>Real Data Fetching integrates with Yahoo Finance to retrieve live market data for a predefined set of symbols. When enabled, the system fetches current prices and attributes for equities, bond ETFs, commodities, and currency pairs.</para>
<para><bold>Business Value:</bold></para>
<para>Enables analysis of real-world market relationships rather than static sample data, providing actionable insights for production use.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Live market data analysis</para>
</listitem><listitem><para>Current price integration</para>
</listitem><listitem><para>Production-ready data source</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented in <computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput> using yfinance ≥0.2.51. Supported symbols include: AAPL, MSFT, XOM, JPM (equities); TLT, LQD, HYG (bond ETFs); GC=F, CL=F, SI=F (commodities); EURUSD=X, GBPUSD=X, JPYUSD=X (currencies). Enabled via USE_REAL_DATA_FETCHER environment variable. Implements atomic JSON file caching via NamedTemporaryFile and os.replace.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>F-001    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>yfinance ≥0.2.51    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>Yahoo Finance API    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>Network connectivity   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3736">
<title>F-015: Database Persistence</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-015    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>Database Persistence    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>Data Layer    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>Low    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>Database Persistence provides optional SQLAlchemy-based storage for assets, relationships, and regulatory events. The persistence layer supports both SQLite (development) and PostgreSQL (production) backends.</para>
<para><bold>Business Value:</bold></para>
<para>Enables data persistence across sessions and supports larger datasets than in-memory storage allows.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Data survives application restarts</para>
</listitem><listitem><para>Scalable to larger datasets</para>
</listitem><listitem><para>Standard SQL query access</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented across <computeroutput><ref refid="src_2data_2database_8py" kindref="compound">src/data/database.py</ref></computeroutput>, <computeroutput><ref refid="db__models_8py" kindref="compound">src/data/db_models.py</ref></computeroutput>, and <computeroutput><ref refid="repository_8py" kindref="compound">src/data/repository.py</ref></computeroutput>. Uses SQLAlchemy 2.x with Mapped/mapped_column syntax. Tables include: assets, asset_relationships, regulatory_events, and regulatory_event_assets (junction). Migrations defined in <computeroutput>migrations/001_initial.sql</computeroutput>.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>F-001, F-002    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>SQLAlchemy ≥2.0.0    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>SQLite or PostgreSQL    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>DATABASE_URL configuration   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3738">
<title>F-016: Gradio UI (Legacy Interface)</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-016    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>Gradio UI (Legacy Interface)    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>User Interface    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>High    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>Completed   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>The Gradio UI provides a Python-native web interface with six tabbed sections covering 3D/2D visualization, metrics analytics, schema documentation, asset exploration, general documentation, and formulaic analysis. Designed for rapid prototyping and Python developer workflows.</para>
<para><bold>Business Value:</bold></para>
<para>Provides immediate visual access to system capabilities without frontend development, accelerating prototyping and Python-centric workflows.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Zero frontend setup required</para>
</listitem><listitem><para>Full feature coverage</para>
</listitem><listitem><para>Interactive controls for visualization</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented in <computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput> using Gradio ≥4.0.0,&lt;6.0.0. Exposes six tabs with interactive controls including view mode toggle (2D/3D), layout type selection, eight relationship visibility checkboxes, and direction arrows toggle. Runs on port 7860 by default.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>F-003, F-008, F-009, F-010, F-011, F-012, F-013    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>Gradio ≥4.0.0    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>Direct core library access   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3740">
<title>F-017: Next.js Frontend (Modern Interface)</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature ID   </para>
</entry><entry thead="no"><para>F-017    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Name   </para>
</entry><entry thead="no"><para>Next.js Frontend (Modern Interface)    </para>
</entry></row>
<row>
<entry thead="no"><para>Category   </para>
</entry><entry thead="no"><para>User Interface    </para>
</entry></row>
<row>
<entry thead="no"><para>Priority   </para>
</entry><entry thead="no"><para>High    </para>
</entry></row>
<row>
<entry thead="no"><para>Status   </para>
</entry><entry thead="no"><para>In Development   </para>
</entry></row>
</table>
</para>
<para><bold>Description:</bold></para>
<para>The Next.js Frontend provides a modern React-based interface with TypeScript type safety and Tailwind CSS styling. Currently implements visualization, metrics, and asset exploration tabs with additional features planned for parity with Gradio.</para>
<para><bold>Business Value:</bold></para>
<para>Provides production-ready web interface suitable for enterprise deployment with modern frontend tooling and performance optimization.</para>
<para><bold>User Benefits:</bold></para>
<para><itemizedlist>
<listitem><para>Modern, responsive user experience</para>
</listitem><listitem><para>TypeScript type safety</para>
</listitem><listitem><para>Production deployment readiness</para>
</listitem></itemizedlist>
</para>
<para><bold>Technical Context:</bold></para>
<para>Implemented in <computeroutput>frontend/</computeroutput> using Next.js 14.2.x, React 18.2.0, TypeScript, and Tailwind CSS 3.3.0. API communication via Axios. 3D visualization with react-plotly.js ^2.6.0. Components in <computeroutput>frontend/app/components/</computeroutput> include NetworkVisualization, MetricsDashboard, and AssetList.</para>
<para><bold>Dependencies:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Dependency Type   </para>
</entry><entry thead="yes"><para>Dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>Prerequisite Features   </para>
</entry><entry thead="no"><para>F-004 (REST API)    </para>
</entry></row>
<row>
<entry thead="no"><para>System Dependencies   </para>
</entry><entry thead="no"><para>Node.js ≥18.0.0, Next.js 14.2.x    </para>
</entry></row>
<row>
<entry thead="no"><para>External Dependencies   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Requirements   </para>
</entry><entry thead="no"><para>F-004, F-006 (CORS)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3742">
<title>2.2 Functional Requirements Tables</title><para>This section provides detailed requirements for each feature with acceptance criteria, technical specifications, and validation rules.</para>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3743">
<title>2.2.1 Data Model Requirements</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3744">
<title>F-001 Requirements: Multi-Asset Class Data Model</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Requirement ID   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Priority    </para>
</entry></row>
<row>
<entry thead="no"><para>F-001-RQ-001   </para>
</entry><entry thead="no"><para>Support five asset classes via AssetClass enum   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-001-RQ-002   </para>
</entry><entry thead="no"><para>Validate required fields (id, symbol, name) as non-empty   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-001-RQ-003   </para>
</entry><entry thead="no"><para>Enforce non-negative price values   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-001-RQ-004   </para>
</entry><entry thead="no"><para>Validate currency against ISO 4217 format   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-001-RQ-005   </para>
</entry><entry thead="no"><para>Support optional market_cap with non-negative validation   </para>
</entry><entry thead="no"><para>Should-Have   </para>
</entry></row>
</table>
</para>
<para><bold>F-001-RQ-001: Asset Class Enumeration</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-001-RQ-001    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall support five asset classes: EQUITY, FIXED_INCOME, COMMODITY, CURRENCY, DERIVATIVE    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>AssetClass enum contains all five values; assets can be created with each type    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Low   </para>
</entry></row>
</table>
</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Technical Specification   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Input Parameters   </para>
</entry><entry thead="no"><para>asset_class: AssetClass enum value    </para>
</entry></row>
<row>
<entry thead="no"><para>Output/Response   </para>
</entry><entry thead="no"><para>Asset instance with valid asset_class    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Criteria   </para>
</entry><entry thead="no"><para>Instantiation &lt; 1ms    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Requirements   </para>
</entry><entry thead="no"><para>Valid enum member selection   </para>
</entry></row>
</table>
</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Validation Rules   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Business Rules   </para>
</entry><entry thead="no"><para>Only defined enum values accepted    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Validation   </para>
</entry><entry thead="no"><para><ref refid="classEnum" kindref="compound">Enum</ref> membership check    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Requirements   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Compliance Requirements   </para>
</entry><entry thead="no"><para>None   </para>
</entry></row>
</table>
</para>
<para><bold>F-001-RQ-002: Required Field Validation</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-001-RQ-002    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall validate id, symbol, and name fields as non-empty strings    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>Empty strings rejected with validation error; whitespace-only strings rejected    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Low   </para>
</entry></row>
</table>
</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Technical Specification   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Input Parameters   </para>
</entry><entry thead="no"><para>id: str, symbol: str, name: str    </para>
</entry></row>
<row>
<entry thead="no"><para>Output/Response   </para>
</entry><entry thead="no"><para>ValidationError on empty values    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Criteria   </para>
</entry><entry thead="no"><para>Validation &lt; 1ms    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Requirements   </para>
</entry><entry thead="no"><para>Non-empty string requirement   </para>
</entry></row>
</table>
</para>
<para><bold>F-001-RQ-003: Price Validation</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-001-RQ-003    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall enforce price values ≥ 0    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>Negative prices rejected; zero and positive values accepted    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Low   </para>
</entry></row>
</table>
</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Technical Specification   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Input Parameters   </para>
</entry><entry thead="no"><para>price: float    </para>
</entry></row>
<row>
<entry thead="no"><para>Output/Response   </para>
</entry><entry thead="no"><para>ValidationError if price &lt; 0    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Criteria   </para>
</entry><entry thead="no"><para>Validation &lt; 1ms    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Requirements   </para>
</entry><entry thead="no"><para>Numeric type required   </para>
</entry></row>
</table>
</para>
<para><bold>F-001-RQ-004: Currency Code Validation</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-001-RQ-004    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall validate currency codes match pattern ^[A-Z]{3}$    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>Three uppercase letters accepted; other formats rejected    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Low   </para>
</entry></row>
</table>
</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Technical Specification   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Input Parameters   </para>
</entry><entry thead="no"><para>currency: str (default &quot;USD&quot;)    </para>
</entry></row>
<row>
<entry thead="no"><para>Output/Response   </para>
</entry><entry thead="no"><para>ValidationError on pattern mismatch    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Criteria   </para>
</entry><entry thead="no"><para>Regex validation &lt; 1ms    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Requirements   </para>
</entry><entry thead="no"><para>ISO 4217 format   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3746">
<title>F-002 Requirements: Regulatory Event Integration</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Requirement ID   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Priority    </para>
</entry></row>
<row>
<entry thead="no"><para>F-002-RQ-001   </para>
</entry><entry thead="no"><para>Support six regulatory activity types   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-002-RQ-002   </para>
</entry><entry thead="no"><para>Validate impact_score in range [-1, 1]   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-002-RQ-003   </para>
</entry><entry thead="no"><para>Validate date format as ISO 8601   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-002-RQ-004   </para>
</entry><entry thead="no"><para>Support multi-asset event relationships   </para>
</entry><entry thead="no"><para>Should-Have   </para>
</entry></row>
</table>
</para>
<para><bold>F-002-RQ-001: Regulatory Activity Types</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-002-RQ-001    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall support: EARNINGS_REPORT, SEC_FILING, DIVIDEND_ANNOUNCEMENT, BOND_ISSUANCE, ACQUISITION, BANKRUPTCY    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>RegulatoryActivity enum contains all six values    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Low   </para>
</entry></row>
</table>
</para>
<para><bold>F-002-RQ-002: Impact Score Validation</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-002-RQ-002    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall validate impact_score as float in range [-1.0, 1.0]    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>Values outside range rejected; boundary values accepted    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Low   </para>
</entry></row>
</table>
</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Technical Specification   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Input Parameters   </para>
</entry><entry thead="no"><para>impact_score: float    </para>
</entry></row>
<row>
<entry thead="no"><para>Output/Response   </para>
</entry><entry thead="no"><para>ValidationError if outside [-1, 1]    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Criteria   </para>
</entry><entry thead="no"><para>Validation &lt; 1ms    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Requirements   </para>
</entry><entry thead="no"><para>Normalized impact scale   </para>
</entry></row>
</table>
</para>
<para><bold>F-002-RQ-003: Date Format Validation</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-002-RQ-003    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall validate dates match pattern ^\d{4}-\d{2}-\d{2} (YYYY-MM-DD)    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>ISO 8601 dates accepted; other formats rejected    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Low   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3748">
<title>2.2.2 Core Engine Requirements</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3749">
<title>F-003 Requirements: Asset Relationship Graph Engine</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Requirement ID   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Priority    </para>
</entry></row>
<row>
<entry thead="no"><para>F-003-RQ-001   </para>
</entry><entry thead="no"><para>Discover relationships across 8 defined types   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-003-RQ-002   </para>
</entry><entry thead="no"><para>Generate deterministic 3D layouts with seed=42   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-003-RQ-003   </para>
</entry><entry thead="no"><para>Provide thread-safe initialization   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-003-RQ-004   </para>
</entry><entry thead="no"><para>Calculate network metrics accurately   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-003-RQ-005   </para>
</entry><entry thead="no"><para>Normalize relationship strength to [0, 1]   </para>
</entry><entry thead="no"><para>Should-Have   </para>
</entry></row>
</table>
</para>
<para><bold>F-003-RQ-001: Relationship Discovery</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-003-RQ-001    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall discover relationships: same_sector, corporate_bond_to_equity, commodity_exposure, currency_risk, income_comparison, regulatory_impact, market_cap_similar, correlation    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>All relationship types detected per business rules    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>High   </para>
</entry></row>
</table>
</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Technical Specification   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Input Parameters   </para>
</entry><entry thead="no"><para>Asset collection, RegulatoryEvent collection    </para>
</entry></row>
<row>
<entry thead="no"><para>Output/Response   </para>
</entry><entry thead="no"><para>Graph structure with typed edges    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Criteria   </para>
</entry><entry thead="no"><para>&lt; 500ms for 100 assets    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Requirements   </para>
</entry><entry thead="no"><para>Valid asset instances   </para>
</entry></row>
</table>
</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Validation Rules   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Business Rules   </para>
</entry><entry thead="no"><para>Bidirectional: same_sector, income_comparison, market_cap_similar, correlation; Directional: corporate_bond_to_equity, commodity_exposure, currency_risk, regulatory_impact    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Validation   </para>
</entry><entry thead="no"><para>Valid asset and event IDs    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Requirements   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Compliance Requirements   </para>
</entry><entry thead="no"><para>None   </para>
</entry></row>
</table>
</para>
<para><bold>F-003-RQ-002: Deterministic Layout</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-003-RQ-002    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall generate identical 3D coordinates for same input data using seed=42    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>Repeated calls produce identical node positions    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry></row>
</table>
</para>
<para><bold>F-003-RQ-003: Thread-Safe Initialization</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-003-RQ-003    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall use double-checked locking for graph singleton    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>Concurrent requests receive same instance; no race conditions    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry></row>
</table>
</para>
<para><bold>F-003-RQ-004: Network Metrics Calculation</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-003-RQ-004    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall calculate: total_assets, total_relationships, asset_classes distribution, avg_degree, max_degree, network_density, relationship_density    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>All metrics returned with correct values    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3751">
<title>2.2.3 API Layer Requirements</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3752">
<title>F-004 Requirements: REST API Endpoints</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Requirement ID   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Priority    </para>
</entry></row>
<row>
<entry thead="no"><para>F-004-RQ-001   </para>
</entry><entry thead="no"><para>Expose 12 primary endpoints   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-004-RQ-002   </para>
</entry><entry thead="no"><para>Return valid JSON responses   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-004-RQ-003   </para>
</entry><entry thead="no"><para>Support filtering on /api/assets   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-004-RQ-004   </para>
</entry><entry thead="no"><para>Provide OpenAPI documentation   </para>
</entry><entry thead="no"><para>Should-Have   </para>
</entry></row>
</table>
</para>
<para><bold>F-004-RQ-001: Endpoint Coverage</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-004-RQ-001    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall expose all 12 documented endpoints with correct HTTP methods    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>Each endpoint responds with appropriate status codes    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry></row>
</table>
</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Technical Specification   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Input Parameters   </para>
</entry><entry thead="no"><para>Per-endpoint query/path parameters    </para>
</entry></row>
<row>
<entry thead="no"><para>Output/Response   </para>
</entry><entry thead="no"><para>JSON with Pydantic model serialization    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Criteria   </para>
</entry><entry thead="no"><para>95th percentile &lt; 500ms    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Requirements   </para>
</entry><entry thead="no"><para>Valid request parameters   </para>
</entry></row>
</table>
</para>
<para><bold>F-004-RQ-003: Asset Filtering</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-004-RQ-003    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>/api/assets shall support asset_class and sector query parameters    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>Filtered results match criteria; empty filters return all    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Low   </para>
</entry></row>
</table>
</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Technical Specification   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Input Parameters   </para>
</entry><entry thead="no"><para>asset_class: str (optional), sector: str (optional), page: int, per_page: int    </para>
</entry></row>
<row>
<entry thead="no"><para>Output/Response   </para>
</entry><entry thead="no"><para>Paginated asset list    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Criteria   </para>
</entry><entry thead="no"><para>&lt; 100ms for typical queries    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Requirements   </para>
</entry><entry thead="no"><para>Valid enum values for asset_class   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3754">
<title>F-005 Requirements: JWT Authentication System</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Requirement ID   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Priority    </para>
</entry></row>
<row>
<entry thead="no"><para>F-005-RQ-001   </para>
</entry><entry thead="no"><para>Issue JWT tokens via /token endpoint   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-005-RQ-002   </para>
</entry><entry thead="no"><para>Enforce 30-minute token expiration   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-005-RQ-003   </para>
</entry><entry thead="no"><para>Use HS256 signing algorithm   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-005-RQ-004   </para>
</entry><entry thead="no"><para>Return 401 with WWW-Authenticate on failure   </para>
</entry><entry thead="no"><para>Must-Have   </para>
</entry></row>
</table>
</para>
<para><bold>F-005-RQ-001: Token Issuance</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-005-RQ-001    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall issue JWT tokens upon valid username/password authentication    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>Valid credentials return access_token; invalid credentials return 401    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry></row>
</table>
</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Technical Specification   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Input Parameters   </para>
</entry><entry thead="no"><para>username: str, password: str (form data)    </para>
</entry></row>
<row>
<entry thead="no"><para>Output/Response   </para>
</entry><entry thead="no"><para>{&quot;access_token&quot;: &quot;...&quot;, &quot;token_type&quot;: &quot;bearer&quot;}    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Criteria   </para>
</entry><entry thead="no"><para>&lt; 200ms including password hash verification    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Requirements   </para>
</entry><entry thead="no"><para>Matching credentials in user store   </para>
</entry></row>
</table>
</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Validation Rules   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Business Rules   </para>
</entry><entry thead="no"><para>Passwords verified via pbkdf2_sha256    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Validation   </para>
</entry><entry thead="no"><para>Non-empty username and password    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Requirements   </para>
</entry><entry thead="no"><para>Constant-time password comparison    </para>
</entry></row>
<row>
<entry thead="no"><para>Compliance Requirements   </para>
</entry><entry thead="no"><para>Token-based stateless auth   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3756">
<title>F-006 Requirements: CORS Configuration</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Requirement ID   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Priority    </para>
</entry></row>
<row>
<entry thead="no"><para>F-006-RQ-001   </para>
</entry><entry thead="no"><para>Allow localhost:3000 and localhost:7860 in development   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-006-RQ-002   </para>
</entry><entry thead="no"><para>Restrict to HTTPS origins in production   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-006-RQ-003   </para>
</entry><entry thead="no"><para>Support Vercel preview domain pattern   </para>
</entry><entry thead="no"><para>Should-Have   </para>
</entry></row>
</table>
</para>
<para><bold>F-006-RQ-001: Development Origins</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-006-RQ-001    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>Development mode shall allow HTTP origins: localhost:3000, localhost:7860    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>Cross-origin requests from allowed origins succeed    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Low   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3758">
<title>F-007 Requirements: Rate Limiting</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Requirement ID   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Priority    </para>
</entry></row>
<row>
<entry thead="no"><para>F-007-RQ-001   </para>
</entry><entry thead="no"><para>Limit /token to 5 requests per minute   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-007-RQ-002   </para>
</entry><entry thead="no"><para>Limit /api/users/me to 10 requests per minute   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-007-RQ-003   </para>
</entry><entry thead="no"><para>Return 429 when limit exceeded   </para>
</entry><entry thead="no"><para>Must-Have   </para>
</entry></row>
</table>
</para>
<para><bold>F-007-RQ-001: Token Endpoint Rate Limit</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-007-RQ-001    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>/token endpoint shall reject requests exceeding 5 per minute per IP    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>6th request within minute returns 429    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Low   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3760">
<title>2.2.4 Visualization Requirements</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3761">
<title>F-008 Requirements: 3D Network Visualization</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Requirement ID   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Priority    </para>
</entry></row>
<row>
<entry thead="no"><para>F-008-RQ-001   </para>
</entry><entry thead="no"><para>Render interactive 3D graph with Plotly   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-008-RQ-002   </para>
</entry><entry thead="no"><para>Color-code nodes by asset class   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-008-RQ-003   </para>
</entry><entry thead="no"><para>Support rotation, zoom, and hover   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-008-RQ-004   </para>
</entry><entry thead="no"><para>Limit rendering to MAX_NODES/MAX_EDGES   </para>
</entry><entry thead="no"><para>Should-Have   </para>
</entry></row>
</table>
</para>
<para><bold>F-008-RQ-001: 3D Graph Rendering</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-008-RQ-001    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>System shall render asset network as 3D scatter plot with edges    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>Graph displays with nodes positioned in 3D space    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>High   </para>
</entry></row>
</table>
</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Technical Specification   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Input Parameters   </para>
</entry><entry thead="no"><para>Visualization data from graph engine    </para>
</entry></row>
<row>
<entry thead="no"><para>Output/Response   </para>
</entry><entry thead="no"><para>Plotly Figure object / JSON payload    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Criteria   </para>
</entry><entry thead="no"><para>Time to interactive &lt; 2 seconds    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Requirements   </para>
</entry><entry thead="no"><para>Valid node/edge data   </para>
</entry></row>
</table>
</para>
<para><bold>F-008-RQ-002: Asset Class Color Coding</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-008-RQ-002    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>Nodes colored: Equity (Blue), Fixed Income (Green), Commodity (Orange), Currency (Red), Derivative (Purple)    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>Visual inspection confirms color mapping    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Low   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3763">
<title>2.2.5 User Interface Requirements</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3764">
<title>F-011 Requirements: Asset Explorer</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Requirement ID   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Priority    </para>
</entry></row>
<row>
<entry thead="no"><para>F-011-RQ-001   </para>
</entry><entry thead="no"><para>Display asset table with key attributes   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-011-RQ-002   </para>
</entry><entry thead="no"><para>Support filtering by asset_class and sector   </para>
</entry><entry thead="no"><para>Must-Have    </para>
</entry></row>
<row>
<entry thead="no"><para>F-011-RQ-003   </para>
</entry><entry thead="no"><para>Implement pagination   </para>
</entry><entry thead="no"><para>Should-Have   </para>
</entry></row>
</table>
</para>
<para><bold>F-011-RQ-001: Asset Table Display</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Requirement ID   </para>
</entry><entry thead="no"><para>F-011-RQ-001    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>Display columns: symbol, name, asset_class, sector, price, market_cap    </para>
</entry></row>
<row>
<entry thead="no"><para>Acceptance Criteria   </para>
</entry><entry thead="no"><para>All columns render with correct data    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Low   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3766">
<title>2.3 Feature Relationships</title><para>This section documents the dependencies, integration points, and shared components between features.</para>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3767">
<title>2.3.1 Feature Dependency Map</title><para>The following diagram illustrates the dependency relationships between features:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TD</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Foundation[&quot;Foundation<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F001[&quot;F-001:<sp/>Multi-Asset&lt;br/&gt;Data<sp/>Model&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F002[&quot;F-002:<sp/>Regulatory&lt;br/&gt;Events&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Core[&quot;Core<sp/>Processing&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F003[&quot;F-003:<sp/>Graph&lt;br/&gt;Engine&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DataLayer[&quot;Data<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F014[&quot;F-014:<sp/>Real<sp/>Data&lt;br/&gt;Fetching&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F015[&quot;F-015:<sp/>Database&lt;br/&gt;Persistence&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Security[&quot;Security<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F005[&quot;F-005:<sp/>JWT<sp/>Auth&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F006[&quot;F-006:<sp/>CORS&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F007[&quot;F-007:<sp/>Rate<sp/>Limiting&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>API[&quot;API<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F004[&quot;F-004:<sp/>REST<sp/>API&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Visualization[&quot;Visualization<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F008[&quot;F-008:<sp/>3D<sp/>Visualization&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F009[&quot;F-009:<sp/>2D<sp/>Visualization&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F010[&quot;F-010:<sp/>Metrics<sp/>Dashboard&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Analytics[&quot;Analytics<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F012[&quot;F-012:<sp/>Schema<sp/>Report&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F013[&quot;F-013:<sp/>Formulaic<sp/>Analysis&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Interface[&quot;Interface<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F011[&quot;F-011:<sp/>Asset<sp/>Explorer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F016[&quot;F-016:<sp/>Gradio<sp/>UI&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F017[&quot;F-017:<sp/>Next.js<sp/>Frontend&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F001<sp/>--&gt;<sp/>F003</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F002<sp/>--&gt;<sp/>F003</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F014<sp/>--&gt;<sp/>F001</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F015<sp/>--&gt;<sp/>F001</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F015<sp/>--&gt;<sp/>F002</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F003<sp/>--&gt;<sp/>F004</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F005<sp/>--&gt;<sp/>F004</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F006<sp/>--&gt;<sp/>F004</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F007<sp/>--&gt;<sp/>F004</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F003<sp/>--&gt;<sp/>F008</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F003<sp/>--&gt;<sp/>F009</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F003<sp/>--&gt;<sp/>F010</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F003<sp/>--&gt;<sp/>F012</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F003<sp/>--&gt;<sp/>F013</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F001<sp/>--&gt;<sp/>F013</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F003<sp/>--&gt;<sp/>F011</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F004<sp/>--&gt;<sp/>F017</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F008<sp/>--&gt;<sp/>F016</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F009<sp/>--&gt;<sp/>F016</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F010<sp/>--&gt;<sp/>F016</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F011<sp/>--&gt;<sp/>F016</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F012<sp/>--&gt;<sp/>F016</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>F013<sp/>--&gt;<sp/>F016</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3768">
<title>2.3.2 Dependency Matrix</title><para><table rows="18" cols="3"><row>
<entry thead="yes"><para>Feature   </para>
</entry><entry thead="yes"><para>Depends On   </para>
</entry><entry thead="yes"><para>Required By    </para>
</entry></row>
<row>
<entry thead="no"><para>F-001   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>F-002, F-003, F-013, F-014, F-015    </para>
</entry></row>
<row>
<entry thead="no"><para>F-002   </para>
</entry><entry thead="no"><para>F-001   </para>
</entry><entry thead="no"><para>F-003, F-015    </para>
</entry></row>
<row>
<entry thead="no"><para>F-003   </para>
</entry><entry thead="no"><para>F-001, F-002   </para>
</entry><entry thead="no"><para>F-004, F-008, F-009, F-010, F-011, F-012, F-013    </para>
</entry></row>
<row>
<entry thead="no"><para>F-004   </para>
</entry><entry thead="no"><para>F-001, F-002, F-003, F-005, F-006, F-007   </para>
</entry><entry thead="no"><para>F-017    </para>
</entry></row>
<row>
<entry thead="no"><para>F-005   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>F-004    </para>
</entry></row>
<row>
<entry thead="no"><para>F-006   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>F-004    </para>
</entry></row>
<row>
<entry thead="no"><para>F-007   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>F-004    </para>
</entry></row>
<row>
<entry thead="no"><para>F-008   </para>
</entry><entry thead="no"><para>F-003   </para>
</entry><entry thead="no"><para>F-016    </para>
</entry></row>
<row>
<entry thead="no"><para>F-009   </para>
</entry><entry thead="no"><para>F-003   </para>
</entry><entry thead="no"><para>F-016    </para>
</entry></row>
<row>
<entry thead="no"><para>F-010   </para>
</entry><entry thead="no"><para>F-003   </para>
</entry><entry thead="no"><para>F-016, F-017    </para>
</entry></row>
<row>
<entry thead="no"><para>F-011   </para>
</entry><entry thead="no"><para>F-003   </para>
</entry><entry thead="no"><para>F-016, F-017    </para>
</entry></row>
<row>
<entry thead="no"><para>F-012   </para>
</entry><entry thead="no"><para>F-003   </para>
</entry><entry thead="no"><para>F-016    </para>
</entry></row>
<row>
<entry thead="no"><para>F-013   </para>
</entry><entry thead="no"><para>F-001, F-003   </para>
</entry><entry thead="no"><para>F-016    </para>
</entry></row>
<row>
<entry thead="no"><para>F-014   </para>
</entry><entry thead="no"><para>F-001   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>F-015   </para>
</entry><entry thead="no"><para>F-001, F-002   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>F-016   </para>
</entry><entry thead="no"><para>F-008, F-009, F-010, F-011, F-012, F-013   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>F-017   </para>
</entry><entry thead="no"><para>F-004   </para>
</entry><entry thead="no"><para>None   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3769">
<title>2.3.3 Integration Points</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Integration Point   </para>
</entry><entry thead="yes"><para>Features Involved   </para>
</entry><entry thead="yes"><para>Mechanism    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Data Access   </para>
</entry><entry thead="no"><para>F-003 ↔ F-004   </para>
</entry><entry thead="no"><para>Python method calls    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Data   </para>
</entry><entry thead="no"><para>F-003 → F-008, F-009   </para>
</entry><entry thead="no"><para>get_3d_visualization_data()    </para>
</entry></row>
<row>
<entry thead="no"><para>API Communication   </para>
</entry><entry thead="no"><para>F-004 ↔ F-017   </para>
</entry><entry thead="no"><para>HTTP/JSON via Axios    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication Flow   </para>
</entry><entry thead="no"><para>F-005 → F-004 → F-017   </para>
</entry><entry thead="no"><para>JWT Bearer token    </para>
</entry></row>
<row>
<entry thead="no"><para>Metrics Calculation   </para>
</entry><entry thead="no"><para>F-003 → F-010   </para>
</entry><entry thead="no"><para>calculate_metrics()    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Ingestion   </para>
</entry><entry thead="no"><para>F-014 → F-001 → F-003   </para>
</entry><entry thead="no"><para>Asset instantiation   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3770">
<title>2.3.4 Shared Components</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Used By Features   </para>
</entry><entry thead="yes"><para>Location    </para>
</entry></row>
<row>
<entry thead="no"><para>AssetClass enum   </para>
</entry><entry thead="no"><para>F-001, F-003, F-004, F-008, F-011   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset dataclasses   </para>
</entry><entry thead="no"><para>F-001, F-003, F-014, F-015   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Plotly rendering   </para>
</entry><entry thead="no"><para>F-008, F-009, F-010   </para>
</entry><entry thead="no"><para><computeroutput>src/visualizations/</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Pydantic models   </para>
</entry><entry thead="no"><para>F-004, F-017   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>, <computeroutput>frontend/app/types/</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph singleton   </para>
</entry><entry thead="no"><para>F-003, F-004, F-016   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput> initialization   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3771">
<title>2.3.5 Common Services</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Service   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Consumer Features    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Initialization   </para>
</entry><entry thead="no"><para>Thread-safe singleton creation   </para>
</entry><entry thead="no"><para>F-003, F-004    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Discovery   </para>
</entry><entry thead="no"><para>Rule-based edge detection   </para>
</entry><entry thead="no"><para>F-003, F-008, F-009    </para>
</entry></row>
<row>
<entry thead="no"><para>Validation   </para>
</entry><entry thead="no"><para>Data constraint enforcement   </para>
</entry><entry thead="no"><para>F-001, F-002    </para>
</entry></row>
<row>
<entry thead="no"><para>JSON Serialization   </para>
</entry><entry thead="no"><para>Pydantic model conversion   </para>
</entry><entry thead="no"><para>F-004, F-017    </para>
</entry></row>
<row>
<entry thead="no"><para>Password Hashing   </para>
</entry><entry thead="no"><para>pbkdf2_sha256 via passlib   </para>
</entry><entry thead="no"><para>F-005   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3773">
<title>2.4 Implementation Considerations</title><para>This section documents technical constraints, performance requirements, and operational considerations for each feature domain.</para>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3774">
<title>2.4.1 Data Model Implementation</title><para><bold>F-001, F-002: Domain Model Considerations</bold></para>
<para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Consideration   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Technical Constraints   </para>
</entry><entry thead="no"><para>Python 3.10+ required for dataclass features    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Requirements   </para>
</entry><entry thead="no"><para>Instantiation &lt; 1ms; validation &lt; 1ms    </para>
</entry></row>
<row>
<entry thead="no"><para>Scalability Considerations   </para>
</entry><entry thead="no"><para>Dataclass memory footprint scales linearly    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Implications   </para>
</entry><entry thead="no"><para>Input validation prevents injection    </para>
</entry></row>
<row>
<entry thead="no"><para>Maintenance Requirements   </para>
</entry><entry thead="no"><para>Schema changes require migration   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3775">
<title>2.4.2 Core Engine Implementation</title><para><bold>F-003: Graph Engine Considerations</bold></para>
<para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Consideration   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Technical Constraints   </para>
</entry><entry thead="no"><para>In-memory graph limits dataset size    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Requirements   </para>
</entry><entry thead="no"><para>Relationship discovery &lt; 500ms for 100 assets    </para>
</entry></row>
<row>
<entry thead="no"><para>Scalability Considerations   </para>
</entry><entry thead="no"><para>O(n²) relationship detection; partition for scale    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Implications   </para>
</entry><entry thead="no"><para>No sensitive data in graph structure    </para>
</entry></row>
<row>
<entry thead="no"><para>Maintenance Requirements   </para>
</entry><entry thead="no"><para>New relationship types require rule additions   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3776">
<title>2.4.3 API Layer Implementation</title><para><bold>F-004, F-005, F-006, F-007: API Considerations</bold></para>
<para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Consideration   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Technical Constraints   </para>
</entry><entry thead="no"><para>Single-threaded graph access    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Requirements   </para>
</entry><entry thead="no"><para>95th percentile response &lt; 500ms    </para>
</entry></row>
<row>
<entry thead="no"><para>Scalability Considerations   </para>
</entry><entry thead="no"><para>Horizontal scaling requires shared state    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Implications   </para>
</entry><entry thead="no"><para>JWT expiration enforced; CORS restricted    </para>
</entry></row>
<row>
<entry thead="no"><para>Maintenance Requirements   </para>
</entry><entry thead="no"><para>OpenAPI docs auto-generated   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3777">
<title>2.4.4 Visualization Implementation</title><para><bold>F-008, F-009, F-010: Visualization Considerations</bold></para>
<para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Consideration   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Technical Constraints   </para>
</entry><entry thead="no"><para>Browser memory limits visualization size    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Requirements   </para>
</entry><entry thead="no"><para>Time to interactive &lt; 2 seconds    </para>
</entry></row>
<row>
<entry thead="no"><para>Scalability Considerations   </para>
</entry><entry thead="no"><para>MAX_NODES=500, MAX_EDGES=2000 defaults    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Implications   </para>
</entry><entry thead="no"><para>Client-side rendering; no server load    </para>
</entry></row>
<row>
<entry thead="no"><para>Maintenance Requirements   </para>
</entry><entry thead="no"><para>Plotly version compatibility   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3778">
<title>2.4.5 User Interface Implementation</title><para><bold>F-016, F-017: UI Considerations</bold></para>
<para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Consideration   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Technical Constraints   </para>
</entry><entry thead="no"><para>Gradio: Python only; Next.js: Node.js required    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance Requirements   </para>
</entry><entry thead="no"><para>Initial load &lt; 3 seconds    </para>
</entry></row>
<row>
<entry thead="no"><para>Scalability Considerations   </para>
</entry><entry thead="no"><para>Static assets cacheable; API stateless    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Implications   </para>
</entry><entry thead="no"><para>CORS enforcement; XSS prevention    </para>
</entry></row>
<row>
<entry thead="no"><para>Maintenance Requirements   </para>
</entry><entry thead="no"><para>Dependency updates; feature parity   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3780">
<title>2.5 Traceability Matrix</title><para>This matrix links features to their implementing source files and test coverage.</para>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3781">
<title>2.5.1 Feature-to-Source Traceability</title><para><table rows="18" cols="3"><row>
<entry thead="yes"><para>Feature ID   </para>
</entry><entry thead="yes"><para>Primary Source Files   </para>
</entry><entry thead="yes"><para>Test Files    </para>
</entry></row>
<row>
<entry thead="no"><para>F-001   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>tests/unit/test_models.py</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-002   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>tests/unit/test_models.py</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-003   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>tests/unit/test_graph.py</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-004   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="tests_2unit_2test__api_8py" kindref="compound">tests/unit/test_api.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-005   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>tests/unit/test_auth.py</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-006   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>tests/unit/test_cors.py</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-007   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="tests_2unit_2test__api_8py" kindref="compound">tests/unit/test_api.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-008   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="graph__visuals_8py" kindref="compound">src/visualizations/graph_visuals.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>tests/unit/test_visualizations.py</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-009   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="graph__2d__visuals_8py" kindref="compound">src/visualizations/graph_2d_visuals.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>tests/unit/test_visualizations.py</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-010   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/components/MetricsDashboard.tsx</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/__tests__/</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-011   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/components/AssetList.tsx</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/__tests__/</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-012   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="schema__report_8py" kindref="compound">src/reports/schema_report.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>tests/unit/test_reports.py</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-013   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="formulaic__analysis_8py" kindref="compound">src/analysis/formulaic_analysis.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>tests/unit/test_analysis.py</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-014   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>tests/unit/test_data.py</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-015   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="src_2data_2database_8py" kindref="compound">src/data/database.py</ref></computeroutput>, <computeroutput><ref refid="repository_8py" kindref="compound">src/data/repository.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="test__database_8py" kindref="compound">tests/unit/test_database.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>F-016   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Manual testing    </para>
</entry></row>
<row>
<entry thead="no"><para>F-017   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/page.tsx</computeroutput>, <computeroutput>frontend/app/components/</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/__tests__/</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3782">
<title>2.5.2 Requirement-to-Feature Traceability</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Requirement Category   </para>
</entry><entry thead="yes"><para>Feature IDs   </para>
</entry><entry thead="yes"><para>Count    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Validation   </para>
</entry><entry thead="no"><para>F-001, F-002   </para>
</entry><entry thead="no"><para>9    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Processing   </para>
</entry><entry thead="no"><para>F-003   </para>
</entry><entry thead="no"><para>5    </para>
</entry></row>
<row>
<entry thead="no"><para>API Functionality   </para>
</entry><entry thead="no"><para>F-004, F-005, F-006, F-007   </para>
</entry><entry thead="no"><para>12    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization   </para>
</entry><entry thead="no"><para>F-008, F-009, F-010   </para>
</entry><entry thead="no"><para>7    </para>
</entry></row>
<row>
<entry thead="no"><para>User Interface   </para>
</entry><entry thead="no"><para>F-011, F-012, F-013, F-016, F-017   </para>
</entry><entry thead="no"><para>8   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3784">
<title>2.6 Assumptions and Constraints</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3785">
<title>2.6.1 Assumptions</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>ID   </para>
</entry><entry thead="yes"><para>Assumption   </para>
</entry><entry thead="yes"><para>Impact    </para>
</entry></row>
<row>
<entry thead="no"><para>A-001   </para>
</entry><entry thead="no"><para>Users have modern browser (Chrome, Firefox, Safari, Edge)   </para>
</entry><entry thead="no"><para>Visualization features may not work on legacy browsers    </para>
</entry></row>
<row>
<entry thead="no"><para>A-002   </para>
</entry><entry thead="no"><para>Network connectivity available for real data fetching   </para>
</entry><entry thead="no"><para>System falls back to sample data when offline    </para>
</entry></row>
<row>
<entry thead="no"><para>A-003   </para>
</entry><entry thead="no"><para>Single concurrent admin user sufficient   </para>
</entry><entry thead="no"><para>Multi-user requires authentication extension    </para>
</entry></row>
<row>
<entry thead="no"><para>A-004   </para>
</entry><entry thead="no"><para>Dataset size &lt; 500 nodes for optimal visualization   </para>
</entry><entry thead="no"><para>Larger datasets require pagination or filtering   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3786">
<title>2.6.2 Constraints</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>ID   </para>
</entry><entry thead="yes"><para>Constraint   </para>
</entry><entry thead="yes"><para>Mitigation    </para>
</entry></row>
<row>
<entry thead="no"><para>C-001   </para>
</entry><entry thead="no"><para>In-memory graph limits scalability   </para>
</entry><entry thead="no"><para>Database persistence option (F-015)    </para>
</entry></row>
<row>
<entry thead="no"><para>C-002   </para>
</entry><entry thead="no"><para>Single-user JWT authentication   </para>
</entry><entry thead="no"><para>Role-based access planned for Phase 2    </para>
</entry></row>
<row>
<entry thead="no"><para>C-003   </para>
</entry><entry thead="no"><para>Yahoo Finance API rate limits   </para>
</entry><entry thead="no"><para>Caching with atomic file writes    </para>
</entry></row>
<row>
<entry thead="no"><para>C-004   </para>
</entry><entry thead="no"><para>Browser memory limits visualization   </para>
</entry><entry thead="no"><para>MAX_NODES/MAX_EDGES guardrails   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3788">
<title>2.7 References</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3789">
<title>2.7.1 Source Files Examined</title><para><table rows="21" cols="2"><row>
<entry thead="yes"><para>File Path   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Domain model definitions, validation rules, enums    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Core graph container, relationship discovery    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI implementation, all REST endpoints    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>JWT authentication, password hashing    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Gradio UI implementation, tabbed interface    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="sample__data_8py" kindref="compound">src/data/sample_data.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Sample database with 19 assets, 4 events    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Yahoo Finance integration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="src_2data_2database_8py" kindref="compound">src/data/database.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>SQLAlchemy database configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="repository_8py" kindref="compound">src/data/repository.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Data access layer    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="graph__visuals_8py" kindref="compound">src/visualizations/graph_visuals.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>3D Plotly visualization    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="graph__2d__visuals_8py" kindref="compound">src/visualizations/graph_2d_visuals.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>2D Plotly visualization    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="schema__report_8py" kindref="compound">src/reports/schema_report.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Schema documentation generator    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="formulaic__analysis_8py" kindref="compound">src/analysis/formulaic_analysis.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Financial formula library    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/types/api.ts</computeroutput>   </para>
</entry><entry thead="no"><para>TypeScript API contracts    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/components/NetworkVisualization.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>3D graph React component    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/components/MetricsDashboard.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Metrics display component    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/components/AssetList.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Asset table component    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>requirements.txt</computeroutput>   </para>
</entry><entry thead="no"><para>Python dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>   </para>
</entry><entry thead="no"><para>Node.js dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>migrations/001_initial.sql</computeroutput>   </para>
</entry><entry thead="no"><para>Database schema   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3790">
<title>2.7.2 Source Directories Examined</title><para><table rows="14" cols="2"><row>
<entry thead="yes"><para>Directory Path   </para>
</entry><entry thead="yes"><para>Contents    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/</computeroutput>   </para>
</entry><entry thead="no"><para>Core Python library packages    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/models/</computeroutput>   </para>
</entry><entry thead="no"><para>Domain model layer    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/logic/</computeroutput>   </para>
</entry><entry thead="no"><para>Graph algorithm implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/data/</computeroutput>   </para>
</entry><entry thead="no"><para>Data persistence and ingestion    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/visualizations/</computeroutput>   </para>
</entry><entry thead="no"><para>Plotly visualization layer    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/analysis/</computeroutput>   </para>
</entry><entry thead="no"><para>Formulaic financial analysis    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/reports/</computeroutput>   </para>
</entry><entry thead="no"><para>Schema documentation generation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>api/</computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI backend package    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/</computeroutput>   </para>
</entry><entry thead="no"><para>Next.js application root    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/</computeroutput>   </para>
</entry><entry thead="no"><para>App Router source    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/components/</computeroutput>   </para>
</entry><entry thead="no"><para>React UI components    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/types/</computeroutput>   </para>
</entry><entry thead="no"><para>TypeScript API contracts    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>tests/</computeroutput>   </para>
</entry><entry thead="no"><para>Test harness structure   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3791">
<title>2.7.3 Technical Specification Cross-References</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Section   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para>1.1 Executive Summary   </para>
</entry><entry thead="no"><para>Business context, stakeholders, value proposition    </para>
</entry></row>
<row>
<entry thead="no"><para>1.2 System Overview   </para>
</entry><entry thead="no"><para>Architecture, technology stack, success criteria    </para>
</entry></row>
<row>
<entry thead="no"><para>1.3 Scope   </para>
</entry><entry thead="no"><para>In-scope/out-of-scope features, boundaries    </para>
</entry></row>
<row>
<entry thead="no"><para>1.4 References   </para>
</entry><entry thead="no"><para>Documentation and source file inventory   </para>
</entry></row>
</table>
</para>
</sect3>
</sect2>
</sect1>
<sect1 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3792">
<title>3. Technology Stack</title><para>This section documents the complete technology stack employed by the Financial Asset Relationship Database, including programming languages, frameworks, libraries, external services, data storage solutions, and development infrastructure. Each technology selection is justified based on system requirements, architectural constraints, and integration considerations.</para>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3793">
<title>3.1 Technology Stack Overview</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3794">
<title>3.1.1 Stack Architecture Summary</title><para>The Financial Asset Relationship Database employs a modern, polyglot architecture optimized for financial data visualization and API-driven consumption. The technology choices prioritize type safety, performance, and developer productivity while maintaining deployment flexibility.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Frontend[&quot;Frontend<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextJS[&quot;Next.js<sp/>14.2.35&lt;br/&gt;TypeScript<sp/>^5.3.0&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gradio[&quot;Gradio<sp/>≥4.0.0&lt;br/&gt;Python<sp/>UI&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Backend[&quot;Backend<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI[&quot;FastAPI<sp/>0.127.0&lt;br/&gt;Python<sp/>3.11&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Uvicorn[&quot;Uvicorn<sp/>≥0.24.0&lt;br/&gt;ASGI<sp/>Server&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Visualization[&quot;Visualization<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PlotlyPy[&quot;Plotly<sp/>≥6.0.0&lt;br/&gt;Server-side&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PlotlyJS[&quot;plotly.js<sp/>^2.27.0&lt;br/&gt;Client-side&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Data[&quot;Data<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLAlchemy[&quot;SQLAlchemy<sp/>≥2.0.0&lt;br/&gt;ORM&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yfinance[&quot;yfinance<sp/>≥0.2.51&lt;br/&gt;Market<sp/>Data&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Infrastructure[&quot;Infrastructure&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Docker[&quot;Docker&lt;br/&gt;python:3.11-slim&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Vercel[&quot;Vercel&lt;br/&gt;Serverless&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GHACI[&quot;GitHub<sp/>Actions&lt;br/&gt;CircleCI&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NextJS<sp/>--&gt;<sp/>FastAPI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Gradio<sp/>--&gt;<sp/>PlotlyPy</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>Uvicorn</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>SQLAlchemy</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>yfinance</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NextJS<sp/>--&gt;<sp/>PlotlyJS</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>Docker</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NextJS<sp/>--&gt;<sp/>Vercel</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3795">
<title>3.1.2 Technology Selection Criteria</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Criterion   </para>
</entry><entry thead="yes"><para>Priority   </para>
</entry><entry thead="yes"><para>Rationale    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Type Safety</bold>   </para>
</entry><entry thead="no"><para>Critical   </para>
</entry><entry thead="no"><para>Financial data requires strict validation to prevent calculation errors    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Performance</bold>   </para>
</entry><entry thead="no"><para>High   </para>
</entry><entry thead="no"><para>Sub-500ms API response times for interactive visualizations    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Developer Productivity</bold>   </para>
</entry><entry thead="no"><para>High   </para>
</entry><entry thead="no"><para>Rapid prototyping with Gradio; production-ready with Next.js    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Ecosystem Maturity</bold>   </para>
</entry><entry thead="no"><para>High   </para>
</entry><entry thead="no"><para>Well-maintained libraries with active security patching    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Deployment Flexibility</bold>   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry><entry thead="no"><para>Support for containerized, serverless, and local development    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Integration Capability</bold>   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry><entry thead="no"><para>REST API and MCP protocol support for ecosystem integration   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3796">
<title>3.1.3 Stack Deviations from Default Template</title><para>The following default template technologies are <bold>not used</bold> in this project:</para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Default Technology   </para>
</entry><entry thead="yes"><para>Actual Implementation   </para>
</entry><entry thead="yes"><para>Rationale    </para>
</entry></row>
<row>
<entry thead="no"><para>Flask   </para>
</entry><entry thead="no"><para>FastAPI 0.127.0   </para>
</entry><entry thead="no"><para>FastAPI provides automatic OpenAPI docs, native async support, and Pydantic integration    </para>
</entry></row>
<row>
<entry thead="no"><para>Auth0   </para>
</entry><entry thead="no"><para>Custom JWT (PyJWT)   </para>
</entry><entry thead="no"><para>Simpler single-user authentication without external service dependency    </para>
</entry></row>
<row>
<entry thead="no"><para>MongoDB   </para>
</entry><entry thead="no"><para>SQLite/PostgreSQL (SQLAlchemy)   </para>
</entry><entry thead="no"><para>Relational model better suited for asset relationships and regulatory event linkages    </para>
</entry></row>
<row>
<entry thead="no"><para>LangChain   </para>
</entry><entry thead="no"><para>Not applicable   </para>
</entry><entry thead="no"><para>System is not an AI/LLM application    </para>
</entry></row>
<row>
<entry thead="no"><para>React-Native   </para>
</entry><entry thead="no"><para>Web-responsive only   </para>
</entry><entry thead="no"><para>Mobile native applications explicitly out of scope    </para>
</entry></row>
<row>
<entry thead="no"><para>Terraform   </para>
</entry><entry thead="no"><para>Docker Compose + Vercel   </para>
</entry><entry thead="no"><para>Simplified infrastructure for single-application deployment   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3798">
<title>3.2 Programming Languages</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3799">
<title>3.2.1 Python (Backend &amp; Core Logic)</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification   </para>
</entry><entry thead="yes"><para>Evidence    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Minimum Version</bold>   </para>
</entry><entry thead="no"><para>Python 3.10+   </para>
</entry><entry thead="no"><para><computeroutput>pyproject.toml</computeroutput>: <computeroutput>requires-python = &quot;&gt;=3.10&quot;</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Supported Versions</bold>   </para>
</entry><entry thead="no"><para>3.10, 3.11, 3.12   </para>
</entry><entry thead="no"><para><computeroutput>ci.yml</computeroutput> matrix configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Production Version</bold>   </para>
</entry><entry thead="no"><para>Python 3.11-slim   </para>
</entry><entry thead="no"><para><computeroutput>Dockerfile</computeroutput> base image    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Package Manager</bold>   </para>
</entry><entry thead="no"><para>pip with requirements files   </para>
</entry><entry thead="no"><para><computeroutput>requirements.txt</computeroutput>, <computeroutput>requirements-dev.txt</computeroutput>   </para>
</entry></row>
</table>
</para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3800">
<title>Selection Justification</title><para>Python 3.10+ is required for the following technical reasons:</para>
<para><orderedlist>
<listitem><para><bold>Modern Dataclass Features</bold>: The domain model in <computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput> leverages enhanced dataclass functionality including <computeroutput>slots=True</computeroutput> for memory efficiency and <computeroutput>kw_only=True</computeroutput> for required parameter enforcement.</para>
</listitem><listitem><para><bold>Type Annotation Improvements</bold>: Python 3.10 introduced <computeroutput>ParamSpec</computeroutput> and <computeroutput>TypeAlias</computeroutput> which improve type checking for the FastAPI dependency injection system.</para>
</listitem><listitem><para><bold>Performance Optimizations</bold>: Python 3.11 provides approximately 25% faster execution through specialization improvements, benefiting compute-intensive relationship discovery operations.</para>
</listitem><listitem><para><bold>Ecosystem Compatibility</bold>: The pinned versions of NumPy 2.2.6, Pandas ≥1.5.0, and Plotly ≥6.0.0 all require Python 3.10+ for full feature support.</para>
</listitem></orderedlist>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3801">
<title>Primary Use Cases</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Location   </para>
</entry><entry thead="yes"><para>Python Usage    </para>
</entry></row>
<row>
<entry thead="no"><para>REST API Server   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI application with async handlers    </para>
</entry></row>
<row>
<entry thead="no"><para>Core Graph Engine   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Relationship discovery and metrics calculation    </para>
</entry></row>
<row>
<entry thead="no"><para>Domain Models   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Dataclass definitions with validation    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Generation   </para>
</entry><entry thead="no"><para><computeroutput>src/visualizations/</computeroutput>   </para>
</entry><entry thead="no"><para>Plotly figure construction    </para>
</entry></row>
<row>
<entry thead="no"><para>Legacy UI   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Gradio interface    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Fetching   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Yahoo Finance integration   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3802">
<title>3.2.2 TypeScript/JavaScript (Frontend)</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification   </para>
</entry><entry thead="yes"><para>Evidence    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>TypeScript Version</bold>   </para>
</entry><entry thead="no"><para>^5.3.0   </para>
</entry><entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Node.js Version</bold>   </para>
</entry><entry thead="no"><para>&gt;=18.0.0   </para>
</entry><entry thead="no"><para><computeroutput>frontend/package.json</computeroutput> engines    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>npm Version</bold>   </para>
</entry><entry thead="no"><para>&gt;=8.0.0   </para>
</entry><entry thead="no"><para><computeroutput>frontend/package.json</computeroutput> engines    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Module System</bold>   </para>
</entry><entry thead="no"><para>ES Modules   </para>
</entry><entry thead="no"><para>Next.js App Router conventions    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Strict Mode</bold>   </para>
</entry><entry thead="no"><para>Enabled   </para>
</entry><entry thead="no"><para><computeroutput>frontend/tsconfig.json</computeroutput>: <computeroutput>strict: true</computeroutput>   </para>
</entry></row>
</table>
</para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3803">
<title>Selection Justification</title><para>TypeScript is selected over plain JavaScript for the following reasons:</para>
<para><orderedlist>
<listitem><para><bold>API Contract Enforcement</bold>: The frontend consumes strongly-typed API responses (e.g., <computeroutput>MetricsResponse</computeroutput>, <computeroutput>AssetResponse</computeroutput>). TypeScript ensures compile-time validation of response handling.</para>
</listitem><listitem><para><bold>Plotly Type Safety</bold>: 3D visualization configuration requires precise coordinate arrays and layout objects. TypeScript prevents runtime errors from malformed visualization data.</para>
</listitem><listitem><para><bold>React Component Props</bold>: Complex component interfaces for <computeroutput>NetworkVisualization</computeroutput>, <computeroutput>MetricsDashboard</computeroutput>, and <computeroutput>AssetList</computeroutput> benefit from explicit prop type definitions.</para>
</listitem><listitem><para><bold>IDE Productivity</bold>: TypeScript provides enhanced code completion, refactoring support, and inline documentation in modern IDEs.</para>
</listitem></orderedlist>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3804">
<title>Node.js Version Requirements</title><para>Node.js 18.0.0+ is required for:</para>
<para><itemizedlist>
<listitem><para>Next.js 14.x App Router architecture</para>
</listitem><listitem><para>Native Fetch API support (no polyfill required)</para>
</listitem><listitem><para>ES Module interoperability</para>
</listitem><listitem><para>V8 engine optimizations for Plotly.js rendering</para>
</listitem></itemizedlist>
</para>
<para><hruler/>
</para>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3806">
<title>3.3 Frameworks &amp; Libraries</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3807">
<title>3.3.1 Backend Frameworks</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3808">
<title>FastAPI (REST API Framework)</title><para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Version</bold>   </para>
</entry><entry thead="no"><para>0.127.0 (pinned)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Source</bold>   </para>
</entry><entry thead="no"><para><computeroutput>requirements.txt</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Purpose</bold>   </para>
</entry><entry thead="no"><para>REST API framework with automatic validation and documentation   </para>
</entry></row>
</table>
</para>
<para><bold>Key Features Utilized:</bold></para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Feature   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Location    </para>
</entry></row>
<row>
<entry thead="no"><para>Lifespan Context Manager   </para>
</entry><entry thead="no"><para>Thread-safe graph initialization at startup   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput> lines 159-165    </para>
</entry></row>
<row>
<entry thead="no"><para>Dependency Injection   </para>
</entry><entry thead="no"><para>Authentication via <computeroutput>get_current_user</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>OAuth2PasswordBearer   </para>
</entry><entry thead="no"><para>JWT token extraction from Authorization header   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>OpenAPI Generation   </para>
</entry><entry thead="no"><para>Auto-generated Swagger UI at <computeroutput>/docs</computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI default    </para>
</entry></row>
<row>
<entry thead="no"><para>Pydantic Integration   </para>
</entry><entry thead="no"><para>Request/response validation   </para>
</entry><entry thead="no"><para>All API endpoints   </para>
</entry></row>
</table>
</para>
<para><bold>Version Pinning Rationale:</bold></para>
<para>FastAPI 0.127.0 is explicitly pinned to ensure:</para>
<para><itemizedlist>
<listitem><para>Compatibility with Pydantic 2.12.5</para>
</listitem><listitem><para>Stable behavior for lifespan event handling</para>
</listitem><listitem><para>Consistent OpenAPI schema generation</para>
</listitem></itemizedlist>
</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>FastAPIApp[&quot;FastAPI<sp/>Application&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Lifespan[&quot;Lifespan&lt;br/&gt;Manager&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Router[&quot;API&lt;br/&gt;Router&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Middleware[&quot;Middleware&lt;br/&gt;Stack&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>MiddlewareChain[&quot;Middleware<sp/>Chain&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS[&quot;CORS&lt;br/&gt;Middleware&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimit[&quot;SlowAPI&lt;br/&gt;Rate<sp/>Limiter&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DependencySystem[&quot;Dependency<sp/>Injection&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth[&quot;OAuth2&lt;br/&gt;Bearer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserDep[&quot;get_current_user&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Lifespan<sp/>--&gt;<sp/>Router</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Middleware<sp/>--&gt;<sp/>MiddlewareChain</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CORS<sp/>--&gt;<sp/>RateLimit</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Router<sp/>--&gt;<sp/>DependencySystem</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Auth<sp/>--&gt;<sp/>UserDep</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3809">
<title>Pydantic (Data Validation)</title><para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Version</bold>   </para>
</entry><entry thead="no"><para>2.12.5 (pinned)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Source</bold>   </para>
</entry><entry thead="no"><para><computeroutput>requirements.txt</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Purpose</bold>   </para>
</entry><entry thead="no"><para>API request/response validation and serialization   </para>
</entry></row>
</table>
</para>
<para><bold>Version Pinning Rationale:</bold></para>
<para>Pydantic 2.12.5 is pinned for:</para>
<para><itemizedlist>
<listitem><para>FastAPI 0.127.0 compatibility</para>
</listitem><listitem><para>Consistent JSON schema generation for OpenAPI</para>
</listitem><listitem><para>Stable validation behavior across deployments</para>
</listitem></itemizedlist>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3810">
<title>Uvicorn (ASGI Server)</title><para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Version</bold>   </para>
</entry><entry thead="no"><para>&gt;=0.24.0    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Package</bold>   </para>
</entry><entry thead="no"><para><computeroutput>uvicorn[standard]</computeroutput> (includes full async support)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Default Port</bold>   </para>
</entry><entry thead="no"><para>8000   </para>
</entry></row>
</table>
</para>
<para><bold>Configuration:</bold></para>
<para><itemizedlist>
<listitem><para>Development: <computeroutput>uvicorn <ref refid="namespaceapi_1_1main" kindref="compound">api.main</ref>:app --reload --port 8000</computeroutput></para>
</listitem><listitem><para>Production: Managed via Docker CMD or Vercel serverless functions</para>
</listitem></itemizedlist>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3811">
<title>Gradio (Legacy UI Framework)</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Version</bold>   </para>
</entry><entry thead="no"><para>&gt;=4.0.0,&lt;6.0.0    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Source</bold>   </para>
</entry><entry thead="no"><para><computeroutput>requirements.txt</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Default Port</bold>   </para>
</entry><entry thead="no"><para>7860    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Purpose</bold>   </para>
</entry><entry thead="no"><para>Python-native web interface for rapid prototyping   </para>
</entry></row>
</table>
</para>
<para><bold>Selection Justification:</bold></para>
<para>Gradio provides immediate visual access to system capabilities without frontend development overhead. It serves as:</para>
<para><itemizedlist>
<listitem><para>A rapid prototyping environment for Python developers</para>
</listitem><listitem><para>A reference implementation demonstrating all core features</para>
</listitem><listitem><para>A standalone UI option for Python-centric workflows</para>
</listitem></itemizedlist>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3812">
<title>3.3.2 Frontend Frameworks</title></sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3813">
<title>Next.js (React Meta-Framework)</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Version</bold>   </para>
</entry><entry thead="no"><para>14.2.35    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Source</bold>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Architecture</bold>   </para>
</entry><entry thead="no"><para>App Router (app/ directory)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Configuration</bold>   </para>
</entry><entry thead="no"><para><computeroutput>reactStrictMode: true</computeroutput>   </para>
</entry></row>
</table>
</para>
<para><bold>Selection Justification:</bold></para>
<para>Next.js 14.x is selected over Create React App for:</para>
<para><orderedlist>
<listitem><para><bold>App Router Architecture</bold>: File-system based routing with React Server Components support</para>
</listitem><listitem><para><bold>Build Optimizations</bold>: Automatic code splitting, tree shaking, and bundle analysis</para>
</listitem><listitem><para><bold>Vercel Integration</bold>: First-class support for serverless deployment target</para>
</listitem><listitem><para><bold>TypeScript Native</bold>: Zero-configuration TypeScript support</para>
</listitem></orderedlist>
</para>
<para><bold>Key Configuration:</bold></para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>reactStrictMode</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>true</computeroutput>   </para>
</entry><entry thead="no"><para>Enables additional development checks    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>NEXT_PUBLIC_API_URL</computeroutput>   </para>
</entry><entry thead="no"><para>Environment variable   </para>
</entry><entry thead="no"><para>Backend API endpoint configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>NEXT_PUBLIC_MAX_NODES</computeroutput>   </para>
</entry><entry thead="no"><para>500   </para>
</entry><entry thead="no"><para>Visualization guardrail    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>NEXT_PUBLIC_MAX_EDGES</computeroutput>   </para>
</entry><entry thead="no"><para>2000   </para>
</entry><entry thead="no"><para>Visualization guardrail   </para>
</entry></row>
</table>
</para>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3814_1s3"><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3814">
<title>React</title><para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Version</bold>   </para>
</entry><entry thead="no"><para>^18.2.0    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Source</bold>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Mode</bold>   </para>
</entry><entry thead="no"><para>Client Components with <lsquo/>&apos;use client<rsquo/>` directive   </para>
</entry></row>
</table>
</para>
</sect4></sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3815_1s3"><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3815">
<title>Tailwind CSS</title><para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Version</bold>   </para>
</entry><entry thead="no"><para>^3.3.0    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Source</bold>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/package.json</computeroutput> devDependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Purpose</bold>   </para>
</entry><entry thead="no"><para>Utility-first CSS framework   </para>
</entry></row>
</table>
</para>
<para><bold>Selection Justification:</bold></para>
<para>Tailwind CSS provides:</para>
<para><itemizedlist>
<listitem><para>Consistent design system without custom CSS maintenance</para>
</listitem><listitem><para>Responsive design utilities for visualization containers</para>
</listitem><listitem><para>Integration with Next.js JIT compiler for optimal bundle size</para>
</listitem></itemizedlist>
</para>
</sect4></sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3816">
<title>3.3.3 Visualization Libraries</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3817">
<title>Plotly (Exclusive Visualization Library)</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Context   </para>
</entry><entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Backend (Python)</bold>   </para>
</entry><entry thead="no"><para>plotly   </para>
</entry><entry thead="no"><para>&gt;=6.0.0    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Frontend (React)</bold>   </para>
</entry><entry thead="no"><para>react-plotly.js   </para>
</entry><entry thead="no"><para>^2.6.0    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Frontend (Core)</bold>   </para>
</entry><entry thead="no"><para>plotly.js   </para>
</entry><entry thead="no"><para>^2.27.0   </para>
</entry></row>
</table>
</para>
<para><bold>Library Constraint:</bold></para>
<para>Per project coding standards, Plotly is the <bold>only approved charting and visualization library</bold>. Alternative visualization libraries (e.g., D3, Chart.js, Matplotlib) are explicitly prohibited to maintain consistency across both UI implementations.</para>
<para><bold>Visualization Capabilities:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Visualization Type   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>3D Network Graph   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="graph__visuals_8py" kindref="compound">src/visualizations/graph_visuals.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>2D Network Graph   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="graph__2d__visuals_8py" kindref="compound">src/visualizations/graph_2d_visuals.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Metrics Dashboard   </para>
</entry><entry thead="no"><para><computeroutput>src/visualizations/metrics_visuals.py</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Formulaic Visuals   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="formulaic__visuals_8py" kindref="compound">src/visualizations/formulaic_visuals.py</ref></computeroutput>   </para>
</entry></row>
</table>
</para>
<para><bold>Deterministic Layout:</bold></para>
<para>All visualizations use <computeroutput>seed=42</computeroutput> for reproducible 3D node positioning, ensuring identical visual output across sessions.</para>
<para><hruler/>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3819">
<title>3.4 Open Source Dependencies</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3820">
<title>3.4.1 Python Runtime Dependencies</title><para><bold>Source:</bold> <computeroutput>requirements.txt</computeroutput></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3821">
<title>Core Application Dependencies</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version Constraint   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>fastapi</bold>   </para>
</entry><entry thead="no"><para>0.127.0 (pinned)   </para>
</entry><entry thead="no"><para>REST API framework    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>uvicorn[standard]</bold>   </para>
</entry><entry thead="no"><para>&gt;=0.24.0   </para>
</entry><entry thead="no"><para>ASGI server with async support    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>pydantic</bold>   </para>
</entry><entry thead="no"><para>2.12.5 (pinned)   </para>
</entry><entry thead="no"><para>Data validation and serialization    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>gradio</bold>   </para>
</entry><entry thead="no"><para>&gt;=4.0.0,&lt;6.0.0   </para>
</entry><entry thead="no"><para>Legacy UI framework   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3822">
<title>Data Processing Dependencies</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version Constraint   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>numpy</bold>   </para>
</entry><entry thead="no"><para>2.2.6 (pinned)   </para>
</entry><entry thead="no"><para>Numerical computing for graph coordinates    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>pandas</bold>   </para>
</entry><entry thead="no"><para>&gt;=1.5.0   </para>
</entry><entry thead="no"><para>Tabular data manipulation    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>plotly</bold>   </para>
</entry><entry thead="no"><para>&gt;=6.0.0   </para>
</entry><entry thead="no"><para>Visualization generation    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>dataclasses-json</bold>   </para>
</entry><entry thead="no"><para>&gt;=0.5.7   </para>
</entry><entry thead="no"><para>JSON serialization for domain models   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3823">
<title>External Data Dependencies</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version Constraint   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>yfinance</bold>   </para>
</entry><entry thead="no"><para>&gt;=0.2.51   </para>
</entry><entry thead="no"><para>Yahoo Finance API integration    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>requests</bold>   </para>
</entry><entry thead="no"><para>&gt;=2.32.2   </para>
</entry><entry thead="no"><para>HTTP client for external requests   </para>
</entry></row>
</table>
</para>
<para><bold>Library Constraint:</bold></para>
<para>Per project coding standards, yfinance is the <bold>only approved finance data API</bold>. Alternative providers (e.g., Alpha Vantage, IEX Cloud) require explicit approval.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3824">
<title>Security Dependencies</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version Constraint   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>PyJWT</bold>   </para>
</entry><entry thead="no"><para>&gt;=2.8.0   </para>
</entry><entry thead="no"><para>JWT token signing and verification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>passlib[bcrypt]</bold>   </para>
</entry><entry thead="no"><para>&gt;=1.7.4   </para>
</entry><entry thead="no"><para>Password hashing (pbkdf2_sha256)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>slowapi</bold>   </para>
</entry><entry thead="no"><para>&gt;=0.1.4   </para>
</entry><entry thead="no"><para>Rate limiting middleware   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3825">
<title>Database Dependencies</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version Constraint   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>sqlalchemy</bold>   </para>
</entry><entry thead="no"><para>&gt;=2.0.0   </para>
</entry><entry thead="no"><para>ORM with 2.x Mapped/mapped_column syntax    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>psycopg2-binary</bold>   </para>
</entry><entry thead="no"><para>&gt;=2.9.9   </para>
</entry><entry thead="no"><para>PostgreSQL adapter for production   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3826">
<title>Serverless/Protocol Dependencies</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version Constraint   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>mangum</bold>   </para>
</entry><entry thead="no"><para>&gt;=0.17.0   </para>
</entry><entry thead="no"><para>AWS Lambda ASGI adapter    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>mcp</bold>   </para>
</entry><entry thead="no"><para>&gt;=1.0.0   </para>
</entry><entry thead="no"><para>Model Context Protocol    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>fastmcp</bold>   </para>
</entry><entry thead="no"><para>&gt;=0.1.0   </para>
</entry><entry thead="no"><para>FastMCP server implementation   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3827">
<title>Compatibility Pins</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version Constraint   </para>
</entry><entry thead="yes"><para>Reason    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>h11</bold>   </para>
</entry><entry thead="no"><para>0.16.0 (pinned)   </para>
</entry><entry thead="no"><para>HTTP/1.1 protocol compatibility with uvicorn/httpx    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>httpx</bold>   </para>
</entry><entry thead="no"><para>0.28.1 (pinned)   </para>
</entry><entry thead="no"><para>Test HTTP client compatibility    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>anyio</bold>   </para>
</entry><entry thead="no"><para>4.12.0 (pinned)   </para>
</entry><entry thead="no"><para>Async I/O compatibility with httpx   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3828">
<title>Security-Mandated Pins (Snyk)</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version Constraint   </para>
</entry><entry thead="yes"><para>Vulnerability Mitigation    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>urllib3</bold>   </para>
</entry><entry thead="no"><para>&gt;=2.6.0   </para>
</entry><entry thead="no"><para>Known vulnerability patch    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>zipp</bold>   </para>
</entry><entry thead="no"><para>&gt;=3.19.1   </para>
</entry><entry thead="no"><para>Known vulnerability patch   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3829">
<title>3.4.2 Python Development Dependencies</title><para><bold>Source:</bold> <computeroutput>requirements-dev.txt</computeroutput></para>
<para><table rows="12" cols="4"><row>
<entry thead="yes"><para>Category   </para>
</entry><entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Testing</bold>   </para>
</entry><entry thead="no"><para>pytest   </para>
</entry><entry thead="no"><para>&gt;=7.0.0   </para>
</entry><entry thead="no"><para>Test framework    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Testing</bold>   </para>
</entry><entry thead="no"><para>pytest-cov   </para>
</entry><entry thead="no"><para>&gt;=4.0.0   </para>
</entry><entry thead="no"><para>Coverage reporting    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Testing</bold>   </para>
</entry><entry thead="no"><para>pytest-asyncio   </para>
</entry><entry thead="no"><para>&gt;=0.21.0   </para>
</entry><entry thead="no"><para>Async test support    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Linting</bold>   </para>
</entry><entry thead="no"><para>flake8   </para>
</entry><entry thead="no"><para>&gt;=6.0.0   </para>
</entry><entry thead="no"><para>Style linting    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Linting</bold>   </para>
</entry><entry thead="no"><para>pylint   </para>
</entry><entry thead="no"><para>&gt;=2.17.0   </para>
</entry><entry thead="no"><para>Static analysis    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Type Checking</bold>   </para>
</entry><entry thead="no"><para>mypy   </para>
</entry><entry thead="no"><para>&gt;=1.0.0   </para>
</entry><entry thead="no"><para>Type checking    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Formatting</bold>   </para>
</entry><entry thead="no"><para>black   </para>
</entry><entry thead="no"><para>&gt;=23.0.0   </para>
</entry><entry thead="no"><para>Code formatting    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Formatting</bold>   </para>
</entry><entry thead="no"><para>isort   </para>
</entry><entry thead="no"><para>&gt;=5.12.0   </para>
</entry><entry thead="no"><para>Import sorting    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Git Hooks</bold>   </para>
</entry><entry thead="no"><para>pre-commit   </para>
</entry><entry thead="no"><para>&gt;=3.0.0   </para>
</entry><entry thead="no"><para>Pre-commit hook management    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Configuration</bold>   </para>
</entry><entry thead="no"><para>PyYAML   </para>
</entry><entry thead="no"><para>&gt;=6.0   </para>
</entry><entry thead="no"><para>YAML parsing    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Type Stubs</bold>   </para>
</entry><entry thead="no"><para>types-PyYAML   </para>
</entry><entry thead="no"><para>-   </para>
</entry><entry thead="no"><para>Type annotations for PyYAML   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3830">
<title>3.4.3 Frontend Runtime Dependencies</title><para><bold>Source:</bold> <computeroutput>frontend/package.json</computeroutput></para>
<para><table rows="8" cols="3"><row>
<entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>next</bold>   </para>
</entry><entry thead="no"><para>14.2.35   </para>
</entry><entry thead="no"><para>React framework with App Router    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>react</bold>   </para>
</entry><entry thead="no"><para>^18.2.0   </para>
</entry><entry thead="no"><para>UI component library    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>react-dom</bold>   </para>
</entry><entry thead="no"><para>^18.2.0   </para>
</entry><entry thead="no"><para>React DOM renderer    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>axios</bold>   </para>
</entry><entry thead="no"><para>^1.13.2   </para>
</entry><entry thead="no"><para>HTTP client for API communication    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>plotly.js</bold>   </para>
</entry><entry thead="no"><para>^2.27.0   </para>
</entry><entry thead="no"><para>3D visualization engine    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>react-plotly.js</bold>   </para>
</entry><entry thead="no"><para>^2.6.0   </para>
</entry><entry thead="no"><para>React Plotly wrapper component    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>recharts</bold>   </para>
</entry><entry thead="no"><para>^2.10.0   </para>
</entry><entry thead="no"><para>Additional charting (secondary)   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3831">
<title>3.4.4 Frontend Development Dependencies</title><para><bold>Source:</bold> <computeroutput>frontend/package.json</computeroutput></para>
<para><table rows="12" cols="4"><row>
<entry thead="yes"><para>Category   </para>
</entry><entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>TypeScript</bold>   </para>
</entry><entry thead="no"><para>typescript   </para>
</entry><entry thead="no"><para>^5.3.0   </para>
</entry><entry thead="no"><para>Type safety    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Styling</bold>   </para>
</entry><entry thead="no"><para>tailwindcss   </para>
</entry><entry thead="no"><para>^3.3.0   </para>
</entry><entry thead="no"><para>CSS framework    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Styling</bold>   </para>
</entry><entry thead="no"><para>postcss   </para>
</entry><entry thead="no"><para>^8.4.31   </para>
</entry><entry thead="no"><para>CSS processing    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Styling</bold>   </para>
</entry><entry thead="no"><para>autoprefixer   </para>
</entry><entry thead="no"><para>^10.4.16   </para>
</entry><entry thead="no"><para>Vendor prefixing    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Testing</bold>   </para>
</entry><entry thead="no"><para>jest   </para>
</entry><entry thead="no"><para>^29.7.0   </para>
</entry><entry thead="no"><para>Test framework    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Testing</bold>   </para>
</entry><entry thead="no"><para>jest-environment-jsdom   </para>
</entry><entry thead="no"><para>^29.7.0   </para>
</entry><entry thead="no"><para>DOM testing environment    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Testing</bold>   </para>
</entry><entry thead="no"><para>@testing-library/react   </para>
</entry><entry thead="no"><para>^14.1.2   </para>
</entry><entry thead="no"><para>React component testing    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Testing</bold>   </para>
</entry><entry thead="no"><para>@testing-library/jest-dom   </para>
</entry><entry thead="no"><para>^6.1.5   </para>
</entry><entry thead="no"><para>DOM assertion matchers    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Testing</bold>   </para>
</entry><entry thead="no"><para>@testing-library/user-event   </para>
</entry><entry thead="no"><para>^14.5.1   </para>
</entry><entry thead="no"><para>User interaction simulation    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Linting</bold>   </para>
</entry><entry thead="no"><para>eslint   </para>
</entry><entry thead="no"><para>^8.55.0   </para>
</entry><entry thead="no"><para>Code linting    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Linting</bold>   </para>
</entry><entry thead="no"><para>eslint-config-next   </para>
</entry><entry thead="no"><para>^14.0.0   </para>
</entry><entry thead="no"><para>Next.js ESLint rules   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3832">
<title>3.4.5 Dependency Version Strategy</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TD</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>VersionStrategy[&quot;Version<sp/>Constraint<sp/>Strategy&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pinned[&quot;Pinned<sp/>Versions&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Minimum[&quot;Minimum<sp/>Versions&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Range[&quot;Version<sp/>Ranges&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>PinnedPackages[&quot;Pinned<sp/>(Critical<sp/>Compatibility)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPIPkg[&quot;fastapi<sp/>0.127.0&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PydanticPkg[&quot;pydantic<sp/>2.12.5&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NumpyPkg[&quot;numpy<sp/>2.2.6&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>H11Pkg[&quot;h11<sp/>0.16.0&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>MinimumPackages[&quot;Minimum<sp/>(Security<sp/>+<sp/>Features)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLAlchemyPkg[&quot;sqlalchemy<sp/>&gt;=2.0.0&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PyJWTPkg[&quot;PyJWT<sp/>&gt;=2.8.0&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Urllib3Pkg[&quot;urllib3<sp/>&gt;=2.6.0&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>RangePackages[&quot;Range<sp/>(Compatibility)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GradioPkg[&quot;gradio<sp/>&gt;=4.0.0,&lt;6.0.0&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextPkg[&quot;next<sp/>^14.2.35&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Pinned<sp/>--&gt;<sp/>PinnedPackages</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Minimum<sp/>--&gt;<sp/>MinimumPackages</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Range<sp/>--&gt;<sp/>RangePackages</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3834">
<title>3.5 Third-Party Services</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3835">
<title>3.5.1 External Data APIs</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3836">
<title>Yahoo Finance (via yfinance)</title><para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Library</bold>   </para>
</entry><entry thead="no"><para>yfinance &gt;=0.2.51    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Enable Flag</bold>   </para>
</entry><entry thead="no"><para><computeroutput>USE_REAL_DATA_FETCHER</computeroutput> environment variable    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Implementation</bold>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>   </para>
</entry></row>
</table>
</para>
<para><bold>Supported Symbols:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Category   </para>
</entry><entry thead="yes"><para>Symbols    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Equities</bold>   </para>
</entry><entry thead="no"><para>AAPL, MSFT, XOM, JPM    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Bond ETFs</bold>   </para>
</entry><entry thead="no"><para>TLT, LQD, HYG    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Commodities</bold>   </para>
</entry><entry thead="no"><para>GC=F (Gold), CL=F (Crude Oil), SI=F (Silver)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Currencies</bold>   </para>
</entry><entry thead="no"><para>EURUSD=X, GBPUSD=X, JPYUSD=X   </para>
</entry></row>
</table>
</para>
<para><bold>Rate Limit Mitigation:</bold></para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Strategy   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>File Caching</bold>   </para>
</entry><entry thead="no"><para>JSON cache with atomic writes via <computeroutput>NamedTemporaryFile</computeroutput> + <computeroutput>os.replace</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Cache Path</bold>   </para>
</entry><entry thead="no"><para>Configurable via <computeroutput>REAL_DATA_CACHE_PATH</computeroutput> environment variable    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Fallback</bold>   </para>
</entry><entry thead="no"><para>Sample data when network disabled or unavailable   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3837">
<title>3.5.2 Authentication Services</title><para>The system implements <bold>custom JWT authentication</bold> rather than external identity providers:</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Technology   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Token Signing</bold>   </para>
</entry><entry thead="no"><para>PyJWT &gt;=2.8.0   </para>
</entry><entry thead="no"><para>HS256 algorithm    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Token Expiration</bold>   </para>
</entry><entry thead="no"><para>30 minutes   </para>
</entry><entry thead="no"><para><computeroutput>ACCESS_TOKEN_EXPIRE_MINUTES</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Password Hashing</bold>   </para>
</entry><entry thead="no"><para>passlib (pbkdf2_sha256)   </para>
</entry><entry thead="no"><para><computeroutput>CryptContext</computeroutput> with pbkdf2_sha256 scheme    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Secret Management</bold>   </para>
</entry><entry thead="no"><para>Environment variables   </para>
</entry><entry thead="no"><para><computeroutput>SECRET_KEY</computeroutput> (required)   </para>
</entry></row>
</table>
</para>
<para><bold>Authentication Flow:</bold></para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Client</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>FastAPI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>AuthModule</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Database</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Client-&gt;&gt;FastAPI:<sp/>POST<sp/>/token<sp/>(credentials)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI-&gt;&gt;AuthModule:<sp/>Validate<sp/>credentials</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AuthModule-&gt;&gt;Database:<sp/>Query<sp/>user_credentials</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Database--&gt;&gt;AuthModule:<sp/>User<sp/>record</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AuthModule-&gt;&gt;AuthModule:<sp/>Verify<sp/>password<sp/>hash</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AuthModule-&gt;&gt;AuthModule:<sp/>Create<sp/>JWT<sp/>(HS256)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AuthModule--&gt;&gt;FastAPI:<sp/>Access<sp/>token</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI--&gt;&gt;Client:<sp/>JWT<sp/>token<sp/>(30<sp/>min<sp/>expiry)</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Client-&gt;&gt;FastAPI:<sp/>GET<sp/>/api/assets<sp/>(Bearer<sp/>token)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI-&gt;&gt;AuthModule:<sp/>Validate<sp/>JWT</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AuthModule-&gt;&gt;AuthModule:<sp/>Decode<sp/>and<sp/>verify</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AuthModule--&gt;&gt;FastAPI:<sp/>User<sp/>identity</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI--&gt;&gt;Client:<sp/>Protected<sp/>resource</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3838">
<title>3.5.3 CI/CD &amp; Code Quality Services</title><para><table rows="9" cols="3"><row>
<entry thead="yes"><para>Service   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Integration    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>GitHub Actions</bold>   </para>
</entry><entry thead="no"><para>Primary CI pipeline   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/ci.yml</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>CircleCI</bold>   </para>
</entry><entry thead="no"><para>Secondary CI pipeline   </para>
</entry><entry thead="no"><para><computeroutput>.circleci/config.yml</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Codecov</bold>   </para>
</entry><entry thead="no"><para>Coverage reporting   </para>
</entry><entry thead="no"><para>Uploads <computeroutput>coverage.xml</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>GitHub Advanced Security</bold>   </para>
</entry><entry thead="no"><para>Security analysis   </para>
</entry><entry thead="no"><para>SARIF uploads    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Codacy</bold>   </para>
</entry><entry thead="no"><para>Code quality analysis   </para>
</entry><entry thead="no"><para>Automated reviews    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Snyk</bold>   </para>
</entry><entry thead="no"><para>Dependency vulnerability scanning   </para>
</entry><entry thead="no"><para>Version pins    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Bandit</bold>   </para>
</entry><entry thead="no"><para>Python security analysis   </para>
</entry><entry thead="no"><para>CI security job    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Safety</bold>   </para>
</entry><entry thead="no"><para>Dependency security checks   </para>
</entry><entry thead="no"><para>CI security job   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3839">
<title>3.5.4 Deployment Platforms</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Platform   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Vercel</bold>   </para>
</entry><entry thead="no"><para>Production hosting   </para>
</entry><entry thead="no"><para><computeroutput>vercel.json</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Docker Hub</bold>   </para>
</entry><entry thead="no"><para>Container registry   </para>
</entry><entry thead="no"><para><computeroutput>Dockerfile</computeroutput>, <computeroutput>docker-compose.yml</computeroutput>   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3841">
<title>3.6 Databases &amp; Storage</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3842">
<title>3.6.1 Primary Storage: In-Memory Graph</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Data Structure</bold>   </para>
</entry><entry thead="no"><para><computeroutput>Dict[source_id, List[Tuple[target_id, rel_type, strength]]]</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Implementation</bold>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Thread Safety</bold>   </para>
</entry><entry thead="no"><para>Double-checked locking singleton pattern    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Size Constraint</bold>   </para>
</entry><entry thead="no"><para>Optimal performance for &lt; 500 nodes   </para>
</entry></row>
</table>
</para>
<para><bold>Justification:</bold></para>
<para>In-memory storage is selected for the primary graph due to:</para>
<para><itemizedlist>
<listitem><para>Sub-millisecond relationship traversal for visualization</para>
</listitem><listitem><para>No external database dependency for deployment simplicity</para>
</listitem><listitem><para>Sufficient capacity for the 19-asset sample dataset and moderate production workloads</para>
</listitem></itemizedlist>
</para>
<para><bold>Thread-Safe Initialization:</bold></para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TD</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Initialization[&quot;Graph<sp/>Initialization&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Request[&quot;API<sp/>Request&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckGlobal{&quot;Global&lt;br/&gt;graph<sp/>exists?&quot;}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AcquireLock[&quot;Acquire&lt;br/&gt;Thread<sp/>Lock&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DoubleCheck{&quot;Double-check&lt;br/&gt;inside<sp/>lock?&quot;}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CreateGraph[&quot;Create<sp/>Graph&lt;br/&gt;Instance&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BuildRelationships[&quot;Build&lt;br/&gt;Relationships&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetGlobal[&quot;Set<sp/>Global&lt;br/&gt;Reference&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReleaseLock[&quot;Release&lt;br/&gt;Lock&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReturnGraph[&quot;Return&lt;br/&gt;Graph&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Request<sp/>--&gt;<sp/>CheckGlobal</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CheckGlobal<sp/>--&gt;|No|<sp/>AcquireLock</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CheckGlobal<sp/>--&gt;|Yes|<sp/>ReturnGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AcquireLock<sp/>--&gt;<sp/>DoubleCheck</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DoubleCheck<sp/>--&gt;|No|<sp/>CreateGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DoubleCheck<sp/>--&gt;|Yes|<sp/>ReleaseLock</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CreateGraph<sp/>--&gt;<sp/>BuildRelationships</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>BuildRelationships<sp/>--&gt;<sp/>SetGlobal</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SetGlobal<sp/>--&gt;<sp/>ReleaseLock</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ReleaseLock<sp/>--&gt;<sp/>ReturnGraph</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3843">
<title>3.6.2 SQLite (API Authentication)</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Purpose</bold>   </para>
</entry><entry thead="no"><para>User credentials storage    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Implementation</bold>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2database_8py" kindref="compound">api/database.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Environment Variable</bold>   </para>
</entry><entry thead="no"><para><computeroutput>DATABASE_URL</computeroutput> (required for auth)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Features</bold>   </para>
</entry><entry thead="no"><para>Connection pooling, row factory, in-memory support   </para>
</entry></row>
</table>
</para>
<para><bold>Schema:</bold></para>
<para><programlisting><codeline><highlight class="normal">TABLE<sp/>user_credentials<sp/>(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>username<sp/>TEXT<sp/>PRIMARY<sp/>KEY,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>email<sp/>TEXT,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>full_name<sp/>TEXT,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>hashed_password<sp/>TEXT<sp/>NOT<sp/>NULL,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>disabled<sp/>BOOLEAN<sp/>DEFAULT<sp/>FALSE</highlight></codeline>
<codeline><highlight class="normal">)</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3844">
<title>3.6.3 SQLAlchemy ORM (Optional Persistence)</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Version</bold>   </para>
</entry><entry thead="no"><para>SQLAlchemy &gt;=2.0.0    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Syntax</bold>   </para>
</entry><entry thead="no"><para>2.x with <computeroutput>Mapped</computeroutput>/<computeroutput>mapped_column</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Implementation</bold>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="src_2data_2database_8py" kindref="compound">src/data/database.py</ref></computeroutput>, <computeroutput><ref refid="db__models_8py" kindref="compound">src/data/db_models.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Environment Variable</bold>   </para>
</entry><entry thead="no"><para><computeroutput>ASSET_GRAPH_DATABASE_URL</computeroutput>   </para>
</entry></row>
</table>
</para>
<para><bold>Supported Database Backends:</bold></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Backend   </para>
</entry><entry thead="yes"><para>Use Case   </para>
</entry><entry thead="yes"><para>Connection String    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>SQLite</bold>   </para>
</entry><entry thead="no"><para>Development   </para>
</entry><entry thead="no"><para><computeroutput>sqlite:///path/to/db.sqlite</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>SQLite In-Memory</bold>   </para>
</entry><entry thead="no"><para>Testing   </para>
</entry><entry thead="no"><para><computeroutput>sqlite:///:memory:</computeroutput> with <computeroutput>StaticPool</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>PostgreSQL</bold>   </para>
</entry><entry thead="no"><para>Production   </para>
</entry><entry thead="no"><para><computeroutput>postgresql://user:pass@host/db</computeroutput>   </para>
</entry></row>
</table>
</para>
<para><bold>Database Schema (migrations/001_initial.sql):</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Table   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>assets</bold>   </para>
</entry><entry thead="no"><para>Primary entity table for financial instruments    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>asset_relationships</bold>   </para>
</entry><entry thead="no"><para>Directed edge table with unique constraint    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>regulatory_events</bold>   </para>
</entry><entry thead="no"><para>Event records with impact scoring    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>regulatory_event_assets</bold>   </para>
</entry><entry thead="no"><para>Many-to-many junction table   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3845">
<title>3.6.4 Caching Strategy</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Cache Type   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Real Data Cache</bold>   </para>
</entry><entry thead="no"><para>JSON file with atomic writes   </para>
</entry><entry thead="no"><para><computeroutput>REAL_DATA_CACHE_PATH</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Graph Cache</bold>   </para>
</entry><entry thead="no"><para>Optional JSON serialization   </para>
</entry><entry thead="no"><para><computeroutput>GRAPH_CACHE_PATH</computeroutput>   </para>
</entry></row>
</table>
</para>
<para><bold>Atomic Write Pattern:</bold></para>
<para><programlisting><codeline><highlight class="normal">1.<sp/>Write<sp/>to<sp/>NamedTemporaryFile<sp/>in<sp/>same<sp/>directory</highlight></codeline>
<codeline><highlight class="normal">2.<sp/>Flush<sp/>and<sp/>sync<sp/>to<sp/>disk</highlight></codeline>
<codeline><highlight class="normal">3.<sp/>os.replace()<sp/>atomic<sp/>rename<sp/>to<sp/>target<sp/>path</highlight></codeline>
<codeline><highlight class="normal">4.<sp/>Guarantees<sp/>no<sp/>partial<sp/>writes<sp/>on<sp/>failure</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3847">
<title>3.7 Development &amp; Deployment</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3848">
<title>3.7.1 Development Tools</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3849">
<title>Makefile Commands</title><para><bold>Source:</bold> <computeroutput>Makefile</computeroutput></para>
<para><table rows="9" cols="2"><row>
<entry thead="yes"><para>Command   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make install</computeroutput>   </para>
</entry><entry thead="no"><para>Install production dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make install-dev</computeroutput>   </para>
</entry><entry thead="no"><para>Install development dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make test</computeroutput>   </para>
</entry><entry thead="no"><para>Run pytest with coverage    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make lint</computeroutput>   </para>
</entry><entry thead="no"><para>Run flake8 + pylint    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make format</computeroutput>   </para>
</entry><entry thead="no"><para>Format with black + isort    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make type-check</computeroutput>   </para>
</entry><entry thead="no"><para>Run mypy type checking    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make check</computeroutput>   </para>
</entry><entry thead="no"><para>Full quality check pipeline    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make docker-compose-up</computeroutput>   </para>
</entry><entry thead="no"><para>Build and start containers   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3850">
<title>Pre-commit Hooks</title><para><bold>Source:</bold> <computeroutput>.pre-commit-config.yaml</computeroutput></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Hook   </para>
</entry><entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Formatting</bold>   </para>
</entry><entry thead="no"><para>black   </para>
</entry><entry thead="no"><para><computeroutput>line-length: 120</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Import Sorting</bold>   </para>
</entry><entry thead="no"><para>isort   </para>
</entry><entry thead="no"><para><computeroutput>profile: black</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Linting</bold>   </para>
</entry><entry thead="no"><para>flake8   </para>
</entry><entry thead="no"><para><computeroutput>.flake8</computeroutput> config file   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3851">
<title>Code Quality Tools Configuration</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Config Source   </para>
</entry><entry thead="yes"><para>Key Settings    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>black</bold>   </para>
</entry><entry thead="no"><para><computeroutput>pyproject.toml</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>line-length = 120</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>isort</bold>   </para>
</entry><entry thead="no"><para><computeroutput>pyproject.toml</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>profile = &quot;black&quot;</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>mypy</bold>   </para>
</entry><entry thead="no"><para><computeroutput>pyproject.toml</computeroutput>   </para>
</entry><entry thead="no"><para>Strict type checking    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>flake8</bold>   </para>
</entry><entry thead="no"><para><computeroutput>.flake8</computeroutput>   </para>
</entry><entry thead="no"><para>E501 max-line-length    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>pylint</bold>   </para>
</entry><entry thead="no"><para><computeroutput>.pylintrc</computeroutput>   </para>
</entry><entry thead="no"><para>Customized rules   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3852">
<title>3.7.2 Build System</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3853">
<title>Python Build Configuration</title><para><bold>Source:</bold> <computeroutput>pyproject.toml</computeroutput></para>
<para><programlisting filename=".toml"><codeline><highlight class="normal">[build-system]</highlight></codeline>
<codeline><highlight class="normal">requires<sp/>=<sp/>[&quot;setuptools&gt;=45&quot;,<sp/>&quot;wheel&quot;]</highlight></codeline>
<codeline><highlight class="normal">build-backend<sp/>=<sp/>&quot;setuptools.build_meta&quot;</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3854">
<title>Frontend Build Scripts</title><para><bold>Source:</bold> <computeroutput>frontend/package.json</computeroutput></para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Script   </para>
</entry><entry thead="yes"><para>Command   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm run dev</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>next dev</computeroutput>   </para>
</entry><entry thead="no"><para>Development server with hot reload    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm run build</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>next build</computeroutput>   </para>
</entry><entry thead="no"><para>Production build    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm run start</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>next start</computeroutput>   </para>
</entry><entry thead="no"><para>Production server    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm run lint</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>next lint</computeroutput>   </para>
</entry><entry thead="no"><para>ESLint analysis    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm test</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>jest --silent</computeroutput>   </para>
</entry><entry thead="no"><para>Run test suite    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm test -- --coverage</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>jest --coverage</computeroutput>   </para>
</entry><entry thead="no"><para>Coverage report   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3855">
<title>3.7.3 Containerization</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3856">
<title>Docker Configuration</title><para><bold>Source:</bold> <computeroutput>Dockerfile</computeroutput></para>
<para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold><ref refid="classBase" kindref="compound">Base</ref> Image</bold>   </para>
</entry><entry thead="no"><para><computeroutput>python:3.11-slim</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Working Directory</bold>   </para>
</entry><entry thead="no"><para><computeroutput>/app</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>User</bold>   </para>
</entry><entry thead="no"><para>Non-root <computeroutput>appuser</computeroutput> (UID 1000)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Exposed Port</bold>   </para>
</entry><entry thead="no"><para>7860 (Gradio)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Health Check</bold>   </para>
</entry><entry thead="no"><para>HTTP probe every 30s   </para>
</entry></row>
</table>
</para>
<para><bold>Security Considerations:</bold></para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Practice   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Non-root User</bold>   </para>
</entry><entry thead="no"><para><computeroutput>useradd -m -u 1000 appuser</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Minimal <ref refid="classBase" kindref="compound">Base</ref> Image</bold>   </para>
</entry><entry thead="no"><para><computeroutput>python:3.11-slim</computeroutput> (no dev tools)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Health Monitoring</bold>   </para>
</entry><entry thead="no"><para><computeroutput>HEALTHCHECK</computeroutput> instruction with curl   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3857">
<title>Docker Compose Configuration</title><para><bold>Source:</bold> <computeroutput>docker-compose.yml</computeroutput></para>
<para><programlisting filename=".yaml"><codeline><highlight class="normal">version:<sp/>&quot;3.8&quot;</highlight></codeline>
<codeline><highlight class="normal">services:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>app:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>build:<sp/>.</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ports:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>&quot;7860:7860&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>environment:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>GRADIO_SERVER_NAME=0.0.0.0</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>GRADIO_SERVER_PORT=7860</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>volumes:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>./src:/app/src</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>./data:/app/data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>restart:<sp/>unless-stopped</highlight></codeline>
</programlisting></para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3858">
<title>3.7.4 CI/CD Pipeline</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3859">
<title>GitHub Actions (Primary)</title><para><bold>Source:</bold> <computeroutput>.github/workflows/ci.yml</computeroutput></para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>TestJob[&quot;Test<sp/>Job&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Matrix[&quot;Python<sp/>Matrix&lt;br/&gt;3.10,<sp/>3.11,<sp/>3.12&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Lint[&quot;Linting&lt;br/&gt;flake8,<sp/>black,<sp/>isort&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pylint[&quot;Static<sp/>Analysis&lt;br/&gt;pylint&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Tests[&quot;pytest&lt;br/&gt;+<sp/>coverage&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>SecurityJob[&quot;Security<sp/>Job&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Safety[&quot;safety<sp/>check&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Bandit[&quot;bandit<sp/>scan&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>CoverageJob[&quot;Coverage<sp/>Job&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Codecov[&quot;Upload<sp/>to&lt;br/&gt;Codecov&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Matrix<sp/>--&gt;<sp/>Lint</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Lint<sp/>--&gt;<sp/>Pylint</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Pylint<sp/>--&gt;<sp/>Tests</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Tests<sp/>--&gt;<sp/>SecurityJob</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Tests<sp/>--&gt;<sp/>CoverageJob</highlight></codeline>
</programlisting></para>
<para><bold>Job Configuration:</bold></para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Job   </para>
</entry><entry thead="yes"><para>Actions    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>test</bold>   </para>
</entry><entry thead="no"><para>Matrix Python 3.10/3.11/3.12, linting, pytest with coverage    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>security</bold>   </para>
</entry><entry thead="no"><para>safety check, bandit scan    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>coverage</bold>   </para>
</entry><entry thead="no"><para>Upload to Codecov (Python 3.11 only)   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3860">
<title>CircleCI (Secondary)</title><para><bold>Source:</bold> <computeroutput>.circleci/config.yml</computeroutput></para>
<para><table rows="7" cols="2"><row>
<entry thead="yes"><para>Job   </para>
</entry><entry thead="yes"><para>Actions    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>python-lint</bold>   </para>
</entry><entry thead="no"><para>flake8 with <computeroutput>.flake8</computeroutput> config    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>python-test</bold>   </para>
</entry><entry thead="no"><para>pytest with parallelism=4, JUnit XML output    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>python-security</bold>   </para>
</entry><entry thead="no"><para>safety + bandit    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>frontend-lint</bold>   </para>
</entry><entry thead="no"><para>npm run lint    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>frontend-build</bold>   </para>
</entry><entry thead="no"><para>npm run build    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>docker-build</bold>   </para>
</entry><entry thead="no"><para>Build container + smoke test   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3861">
<title>Scheduled Security Scans</title><para><table rows="2" cols="3"><row>
<entry thead="yes"><para>Schedule   </para>
</entry><entry thead="yes"><para>Workflow   </para>
</entry><entry thead="yes"><para>Target    </para>
</entry></row>
<row>
<entry thead="no"><para>Nightly (02:00 UTC)   </para>
</entry><entry thead="no"><para>Security workflow   </para>
</entry><entry thead="no"><para>main branch   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3862">
<title>3.7.5 Deployment Options</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3863">
<title>Local Development</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Command   </para>
</entry><entry thead="yes"><para>Port    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>FastAPI Backend</bold>   </para>
</entry><entry thead="no"><para><computeroutput>uvicorn <ref refid="namespaceapi_1_1main" kindref="compound">api.main</ref>:app --reload --port 8000</computeroutput>   </para>
</entry><entry thead="no"><para>8000    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Next.js Frontend</bold>   </para>
</entry><entry thead="no"><para><computeroutput>cd frontend &amp;&amp; npm run dev</computeroutput>   </para>
</entry><entry thead="no"><para>3000    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Gradio Legacy UI</bold>   </para>
</entry><entry thead="no"><para><computeroutput>python <ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>7860   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3864">
<title>Vercel Serverless</title><para><bold>Source:</bold> <computeroutput>vercel.json</computeroutput></para>
<para><table rows="3" cols="2"><row>
<entry thead="yes"><para>Build   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Backend</bold>   </para>
</entry><entry thead="no"><para><computeroutput>@vercel/python</computeroutput>, maxLambdaSize: 50mb    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Frontend</bold>   </para>
</entry><entry thead="no"><para><computeroutput>@vercel/next</computeroutput>   </para>
</entry></row>
</table>
</para>
<para><bold>Routes:</bold></para>
<para><table rows="3" cols="2"><row>
<entry thead="yes"><para>Pattern   </para>
</entry><entry thead="yes"><para>Destination    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/(.*)</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/(.*)</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/$1</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3865">
<title>Docker Production</title><para><programlisting filename=".bash"><codeline><highlight class="normal">docker-compose<sp/>up<sp/>--build</highlight></codeline>
<codeline><highlight class="normal">#<sp/>OR</highlight></codeline>
<codeline><highlight class="normal">make<sp/>docker-compose-up</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3867">
<title>3.8 Security Considerations</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3868">
<title>3.8.1 Authentication Security</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Aspect   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Algorithm</bold>   </para>
</entry><entry thead="no"><para>HS256 (HMAC-SHA256)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Secret Key</bold>   </para>
</entry><entry thead="no"><para>Environment variable (<computeroutput>SECRET_KEY</computeroutput>)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Token Expiration</bold>   </para>
</entry><entry thead="no"><para>30 minutes default    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Password Hashing</bold>   </para>
</entry><entry thead="no"><para>pbkdf2_sha256 via passlib   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3869">
<title>3.8.2 API Security</title><para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Protection   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Rate Limiting</bold>   </para>
</entry><entry thead="no"><para>slowapi: 5 req/min on <computeroutput>/token</computeroutput>, 10 req/min on <computeroutput>/api/users/me</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>CORS</bold>   </para>
</entry><entry thead="no"><para>Environment-specific allowlists; no wildcard <computeroutput>*</computeroutput> origins    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Input Validation</bold>   </para>
</entry><entry thead="no"><para>Pydantic models with strict type enforcement   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3870">
<title>3.8.3 Deployment Security</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Practice   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Container User</bold>   </para>
</entry><entry thead="no"><para>Non-root <computeroutput>appuser</computeroutput> (UID 1000)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Secrets Management</bold>   </para>
</entry><entry thead="no"><para>Environment variables only; never committed    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Dependency Scanning</bold>   </para>
</entry><entry thead="no"><para>Snyk, Safety, Bandit in CI pipeline    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>HTTPS</bold>   </para>
</entry><entry thead="no"><para>Required in production; Vercel provides TLS termination   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3871">
<title>3.8.4 CORS Configuration</title><para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Environment   </para>
</entry><entry thead="yes"><para>Allowed Origins    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Development</bold>   </para>
</entry><entry thead="no"><para><computeroutput><ulink url="http://localhost:3000">http://localhost:3000</ulink></computeroutput>, <computeroutput><ulink url="http://localhost:7860">http://localhost:7860</ulink></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Production</bold>   </para>
</entry><entry thead="no"><para>HTTPS origins only; Vercel preview domains via regex validation    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Custom</bold>   </para>
</entry><entry thead="no"><para><computeroutput>ALLOWED_ORIGINS</computeroutput> environment variable (comma-separated)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3873">
<title>3.9 Integration Requirements</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3874">
<title>3.9.1 Frontend-Backend Communication</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Aspect   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Protocol</bold>   </para>
</entry><entry thead="no"><para>REST over HTTPS (production) / HTTP (development)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Data Format</bold>   </para>
</entry><entry thead="no"><para>JSON    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Authentication</bold>   </para>
</entry><entry thead="no"><para>Bearer token in <computeroutput>Authorization</computeroutput> header    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>API <ref refid="classBase" kindref="compound">Base</ref> URL</bold>   </para>
</entry><entry thead="no"><para><computeroutput>NEXT_PUBLIC_API_URL</computeroutput> environment variable   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3875">
<title>3.9.2 Database Connectivity</title><para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Backend   </para>
</entry><entry thead="yes"><para>Connection Handling    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>SQLite</bold>   </para>
</entry><entry thead="no"><para>Single connection for in-memory; file-based for persistence    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>PostgreSQL</bold>   </para>
</entry><entry thead="no"><para>psycopg2-binary with connection pooling    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>In-Memory Testing</bold>   </para>
</entry><entry thead="no"><para>SQLAlchemy <computeroutput>StaticPool</computeroutput> for connection reuse   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3876">
<title>3.9.3 External Data Source Integration</title><para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Source   </para>
</entry><entry thead="yes"><para>Integration Pattern    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Yahoo Finance</bold>   </para>
</entry><entry thead="no"><para>Rate-limited with JSON file caching    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Fallback</bold>   </para>
</entry><entry thead="no"><para>Sample data generator when network unavailable    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Enable Flag</bold>   </para>
</entry><entry thead="no"><para><computeroutput>USE_REAL_DATA_FETCHER</computeroutput> environment variable   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3877">
<title>3.9.4 Component Version Compatibility Matrix</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Component A   </para>
</entry><entry thead="yes"><para>Component B   </para>
</entry><entry thead="yes"><para>Constraint    </para>
</entry></row>
<row>
<entry thead="no"><para>FastAPI 0.127.0   </para>
</entry><entry thead="no"><para>Pydantic 2.12.5   </para>
</entry><entry thead="no"><para>Pinned together    </para>
</entry></row>
<row>
<entry thead="no"><para>NumPy 2.2.6   </para>
</entry><entry thead="no"><para>Pandas &gt;=1.5.0   </para>
</entry><entry thead="no"><para>NumPy 2.x compatibility    </para>
</entry></row>
<row>
<entry thead="no"><para>Next.js 14.2.x   </para>
</entry><entry thead="no"><para>React 18.2.0   </para>
</entry><entry thead="no"><para>React 18 required    </para>
</entry></row>
<row>
<entry thead="no"><para>Uvicorn &gt;=0.24.0   </para>
</entry><entry thead="no"><para>h11 0.16.0   </para>
</entry><entry thead="no"><para>HTTP protocol compatibility   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3879">
<title>3.10 References</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3880">
<title>3.10.1 Configuration Files Examined</title><para><table rows="14" cols="2"><row>
<entry thead="yes"><para>File   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>requirements.txt</computeroutput>   </para>
</entry><entry thead="no"><para>Python runtime dependencies with pinned versions    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>requirements-dev.txt</computeroutput>   </para>
</entry><entry thead="no"><para>Python development/testing dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>pyproject.toml</computeroutput>   </para>
</entry><entry thead="no"><para>Python packaging, build config, tool configurations    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>   </para>
</entry><entry thead="no"><para>Node.js/Next.js dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/tsconfig.json</computeroutput>   </para>
</entry><entry thead="no"><para>TypeScript configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Dockerfile</computeroutput>   </para>
</entry><entry thead="no"><para>Container configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>docker-compose.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Multi-container orchestration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>vercel.json</computeroutput>   </para>
</entry><entry thead="no"><para>Serverless deployment configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/ci.yml</computeroutput>   </para>
</entry><entry thead="no"><para>GitHub Actions CI pipeline    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.circleci/config.yml</computeroutput>   </para>
</entry><entry thead="no"><para>CircleCI CI pipeline    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Makefile</computeroutput>   </para>
</entry><entry thead="no"><para>Build automation commands    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.env.example</computeroutput>   </para>
</entry><entry thead="no"><para>Environment variable templates    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.pre-commit-config.yaml</computeroutput>   </para>
</entry><entry thead="no"><para>Pre-commit hook configuration   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3881">
<title>3.10.2 Source Files Examined</title><para><table rows="10" cols="2"><row>
<entry thead="yes"><para>File   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI application with CORS, auth, rate limiting    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>JWT authentication implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2database_8py" kindref="compound">api/database.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>SQLite database module for API auth    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="src_2data_2database_8py" kindref="compound">src/data/database.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>SQLAlchemy ORM configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Yahoo Finance integration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Core graph engine    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Domain model dataclasses    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Gradio UI entry point    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="mcp__server_8py" kindref="compound">mcp_server.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>FastMCP server for Model Context Protocol   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3882">
<title>3.10.3 Folders Explored</title><para><table rows="10" cols="2"><row>
<entry thead="yes"><para>Folder   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>api/</computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI backend application    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/</computeroutput>   </para>
</entry><entry thead="no"><para>Core Python packages    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/data/</computeroutput>   </para>
</entry><entry thead="no"><para>Data layer and database    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/visualizations/</computeroutput>   </para>
</entry><entry thead="no"><para>Plotly visualization generators    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/</computeroutput>   </para>
</entry><entry thead="no"><para>Next.js application    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/</computeroutput>   </para>
</entry><entry thead="no"><para>App Router pages and components    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/</computeroutput>   </para>
</entry><entry thead="no"><para>GitHub Actions configurations    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.circleci/</computeroutput>   </para>
</entry><entry thead="no"><para>CircleCI configurations    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>migrations/</computeroutput>   </para>
</entry><entry thead="no"><para>Database migration scripts   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3883">
<title>3.10.4 Technical Specification Cross-References</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Section   </para>
</entry><entry thead="yes"><para>Reference Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>1.2 System Overview   </para>
</entry><entry thead="no"><para>Architecture context and technology summary    </para>
</entry></row>
<row>
<entry thead="no"><para>2.1 Feature Catalog   </para>
</entry><entry thead="no"><para>Feature technology dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para>2.4 Implementation Considerations   </para>
</entry><entry thead="no"><para>Technical constraints and requirements    </para>
</entry></row>
<row>
<entry thead="no"><para>2.6 Assumptions and Constraints   </para>
</entry><entry thead="no"><para>Scalability and operational constraints    </para>
</entry></row>
<row>
<entry thead="no"><para>1.3 Scope   </para>
</entry><entry thead="no"><para>System boundaries and excluded technologies   </para>
</entry></row>
</table>
</para>
</sect3>
</sect2>
</sect1>
<sect1 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3884">
<title>4. Process Flowchart</title><para>This section documents the complete process workflows, state transitions, and integration patterns that govern the Financial Asset Relationship Database system. Each workflow is presented with detailed Mermaid.js diagrams illustrating decision points, error handling paths, system boundaries, and timing considerations.</para>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3885">
<title>4.1 High-Level System Workflow</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3886">
<title>4.1.1 End-to-End System Architecture Flow</title><para>The Financial Asset Relationship Database operates through a layered architecture where user interactions flow from presentation layers through API services to core business logic and data sources. The following diagram illustrates the complete end-to-end data flow across all system components.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>UserLayer[&quot;User<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>User([User])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>PresentationLayer[&quot;Presentation<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GradioUI[&quot;Gradio<sp/>UI&lt;br/&gt;(app.py:7860)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextJS[&quot;Next.js<sp/>Frontend&lt;br/&gt;(frontend/:3000)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>APILayer[&quot;API<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI[&quot;FastAPI<sp/>Backend&lt;br/&gt;(api/main.py:8000)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth[&quot;JWT<sp/>Authentication&lt;br/&gt;(api/auth.py)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimit[&quot;Rate<sp/>Limiter&lt;br/&gt;(slowapi)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS[&quot;CORS<sp/>Middleware&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>BusinessLogic[&quot;Business<sp/>Logic<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphEngine[&quot;Asset<sp/>Graph<sp/>Engine&lt;br/&gt;(src/logic/asset_graph.py)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RelBuilder[&quot;Relationship<sp/>Builder&lt;br/&gt;(8<sp/>relationship<sp/>types)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MetricsCalc[&quot;Metrics<sp/>Calculator&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VizData[&quot;Visualization<sp/>Data&lt;br/&gt;Generator&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DataLayer[&quot;Data<sp/>Layer&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SampleData[&quot;Sample<sp/>Data&lt;br/&gt;(src/data/sample_data.py)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RealData[&quot;Real<sp/>Data<sp/>Fetcher&lt;br/&gt;(src/data/real_data_fetcher.py)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YahooFinance[&quot;Yahoo<sp/>Finance&lt;br/&gt;(yfinance)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cache[&quot;JSON<sp/>File<sp/>Cache&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>User<sp/>--&gt;<sp/>GradioUI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>User<sp/>--&gt;<sp/>NextJS</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GradioUI<sp/>--&gt;<sp/>GraphEngine</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NextJS<sp/>--&gt;<sp/>FastAPI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>CORS</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CORS<sp/>--&gt;<sp/>RateLimit</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RateLimit<sp/>--&gt;<sp/>Auth</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Auth<sp/>--&gt;<sp/>GraphEngine</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphEngine<sp/>--&gt;<sp/>RelBuilder</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphEngine<sp/>--&gt;<sp/>MetricsCalc</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphEngine<sp/>--&gt;<sp/>VizData</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RelBuilder<sp/>--&gt;<sp/>SampleData</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RelBuilder<sp/>--&gt;<sp/>RealData</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RealData<sp/>--&gt;<sp/>YahooFinance</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RealData<sp/>--&gt;<sp/>Cache</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3887">
<title>4.1.2 Request Processing Pipeline</title><para>All API requests traverse a standardized pipeline that enforces security policies, rate limits, and proper error handling. The pipeline ensures consistent request processing regardless of the specific endpoint being accessed.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>RequestPipeline[&quot;Request<sp/>Processing<sp/>Pipeline&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A[Incoming&lt;br/&gt;Request]<sp/>--&gt;<sp/>B{CORS&lt;br/&gt;Valid?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>B<sp/>--&gt;|Yes|<sp/>C{Rate<sp/>Limit&lt;br/&gt;OK?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>B<sp/>--&gt;|No|<sp/>D[403<sp/>Forbidden]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C<sp/>--&gt;|Yes|<sp/>E{Auth&lt;br/&gt;Required?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C<sp/>--&gt;|No|<sp/>F[429<sp/>Too<sp/>Many&lt;br/&gt;Requests]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E<sp/>--&gt;|Yes|<sp/>G{Token&lt;br/&gt;Valid?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E<sp/>--&gt;|No|<sp/>H[Process&lt;br/&gt;Request]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>G<sp/>--&gt;|Yes|<sp/>H</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>G<sp/>--&gt;|No|<sp/>I[401&lt;br/&gt;Unauthorized]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>H<sp/>--&gt;<sp/>J{Success?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>--&gt;|Yes|<sp/>K[200<sp/>Response]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>--&gt;|No|<sp/>L[Error<sp/>Response&lt;br/&gt;4xx/5xx]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3888">
<title>4.1.3 System Startup Sequence</title><para>The system startup sequence orchestrates the initialization of all components in the correct order, ensuring dependencies are satisfied before dependent components activate.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Uvicorn<sp/>as<sp/>Uvicorn<sp/>Server</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>FastAPI<sp/>as<sp/>FastAPI<sp/>App</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Lifespan<sp/>as<sp/>Lifespan<sp/>Manager</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Graph<sp/>as<sp/>Graph<sp/>Singleton</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Factory<sp/>as<sp/>Graph<sp/>Factory</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Data<sp/>as<sp/>Data<sp/>Source</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Cache<sp/>as<sp/>Cache<sp/>Layer</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Uvicorn-&gt;&gt;FastAPI:<sp/>Start<sp/>Application</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI-&gt;&gt;Lifespan:<sp/>Enter<sp/>Lifespan<sp/>Context</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Lifespan-&gt;&gt;Graph:<sp/>get_graph()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph-&gt;&gt;Graph:<sp/>Acquire<sp/>Thread<sp/>Lock</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>alt<sp/>Graph<sp/>Not<sp/>Initialized</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph-&gt;&gt;Factory:<sp/>Check<sp/>Custom<sp/>Factory</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alt<sp/>Custom<sp/>Factory<sp/>Set</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Factory--&gt;&gt;Graph:<sp/>Create<sp/>Test<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>GRAPH_CACHE_PATH<sp/>Set</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph-&gt;&gt;Cache:<sp/>Load<sp/>Cached<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cache--&gt;&gt;Graph:<sp/>Return<sp/>Cached<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>USE_REAL_DATA_FETCHER</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph-&gt;&gt;Data:<sp/>RealDataFetcher.create_real_database()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Data--&gt;&gt;Graph:<sp/>Return<sp/>Live<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>Default<sp/>Mode</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph-&gt;&gt;Data:<sp/>SampleDatabase.create_sample_database()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Data--&gt;&gt;Graph:<sp/>Return<sp/>Sample<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph-&gt;&gt;Graph:<sp/>Release<sp/>Thread<sp/>Lock</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph--&gt;&gt;Lifespan:<sp/>Graph<sp/>Ready</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Lifespan--&gt;&gt;FastAPI:<sp/>Startup<sp/>Complete</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI--&gt;&gt;Uvicorn:<sp/>Accepting<sp/>Requests</highlight></codeline>
</programlisting></para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3889">
<title>4.2 Core Business Process Flows</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3890">
<title>4.2.1 Authentication Workflow</title><para>The JWT-based authentication system implements a complete credential validation and token management workflow with security controls including rate limiting, constant-time password comparison, and token expiration enforcement.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>AuthFlow[&quot;Authentication<sp/>Flow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Start([User<sp/>Submits&lt;br/&gt;Credentials])<sp/>--&gt;<sp/>RateCheck{Rate<sp/>Limit&lt;br/&gt;5/min<sp/>OK?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateCheck<sp/>--&gt;|No|<sp/>RateError[429<sp/>Too<sp/>Many&lt;br/&gt;Requests]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateCheck<sp/>--&gt;|Yes|<sp/>ParseForm[Parse<sp/>OAuth2&lt;br/&gt;Form<sp/>Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParseForm<sp/>--&gt;<sp/>LookupUser[Lookup<sp/>User&lt;br/&gt;in<sp/>Repository]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LookupUser<sp/>--&gt;<sp/>UserExists{User&lt;br/&gt;Found?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserExists<sp/>--&gt;|No|<sp/>AuthFail[401<sp/>Incorrect&lt;br/&gt;Username/Password]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserExists<sp/>--&gt;|Yes|<sp/>VerifyPwd[Verify<sp/>Password&lt;br/&gt;pbkdf2_sha256]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VerifyPwd<sp/>--&gt;<sp/>PwdValid{Password&lt;br/&gt;Valid?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PwdValid<sp/>--&gt;|No|<sp/>AuthFail</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PwdValid<sp/>--&gt;|Yes|<sp/>CheckActive{User&lt;br/&gt;Active?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckActive<sp/>--&gt;|No|<sp/>InactiveError[400<sp/>Inactive&lt;br/&gt;User]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckActive<sp/>--&gt;|Yes|<sp/>CreateToken[Create<sp/>JWT<sp/>Token&lt;br/&gt;30min<sp/>Expiry]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CreateToken<sp/>--&gt;<sp/>ReturnToken[Return&lt;br/&gt;access_token&lt;br/&gt;token_type:<sp/>bearer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReturnToken<sp/>--&gt;<sp/>EndSuccess([Success])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3891">
<title>Token Validation Subprocess</title><para>Protected endpoints validate tokens through a standardized subprocess that checks token integrity, expiration, and user status.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>TokenValidation[&quot;Token<sp/>Validation<sp/>Subprocess&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TokenStart([Protected&lt;br/&gt;Endpoint<sp/>Called])<sp/>--&gt;<sp/>ExtractToken[Extract<sp/>Bearer&lt;br/&gt;Token<sp/>from<sp/>Header]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ExtractToken<sp/>--&gt;<sp/>HasToken{Token&lt;br/&gt;Present?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HasToken<sp/>--&gt;|No|<sp/>NoToken[401<sp/>Not&lt;br/&gt;Authenticated]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HasToken<sp/>--&gt;|Yes|<sp/>DecodeJWT[Decode<sp/>JWT&lt;br/&gt;with<sp/>SECRET_KEY]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DecodeJWT<sp/>--&gt;<sp/>DecodeOK{Decode&lt;br/&gt;Successful?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DecodeOK<sp/>--&gt;|No|<sp/>InvalidToken[401<sp/>Could<sp/>Not&lt;br/&gt;Validate<sp/>Credentials]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DecodeOK<sp/>--&gt;|Yes|<sp/>CheckExpiry{Token&lt;br/&gt;Expired?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckExpiry<sp/>--&gt;|Yes|<sp/>ExpiredToken[401<sp/>Token&lt;br/&gt;Has<sp/>Expired]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckExpiry<sp/>--&gt;|No|<sp/>ExtractUsername[Extract<sp/>Username&lt;br/&gt;from<sp/>Payload]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ExtractUsername<sp/>--&gt;<sp/>LookupUser2[Lookup<sp/>User&lt;br/&gt;in<sp/>Repository]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LookupUser2<sp/>--&gt;<sp/>UserFound{User&lt;br/&gt;Found?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserFound<sp/>--&gt;|No|<sp/>InvalidToken</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserFound<sp/>--&gt;|Yes|<sp/>CheckActive2{User&lt;br/&gt;Active?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckActive2<sp/>--&gt;|No|<sp/>InactiveUser[400<sp/>Inactive&lt;br/&gt;User]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckActive2<sp/>--&gt;|Yes|<sp/>ReturnUser[Return&lt;br/&gt;Authenticated<sp/>User]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReturnUser<sp/>--&gt;<sp/>TokenEnd([Proceed<sp/>to&lt;br/&gt;Endpoint<sp/>Logic])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3892">
<title>4.2.2 Data Ingestion Workflow</title><para>The data ingestion workflow manages the creation and population of the asset graph from various data sources, implementing caching, fallback mechanisms, and atomic write operations for data integrity.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DataIngestion[&quot;Data<sp/>Ingestion<sp/>Workflow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IngestStart([Start<sp/>Data&lt;br/&gt;Ingestion])<sp/>--&gt;<sp/>CheckCache{Cache<sp/>File&lt;br/&gt;Exists?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckCache<sp/>--&gt;|Yes|<sp/>LoadCache[Load<sp/>Cached&lt;br/&gt;Graph<sp/>JSON]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadCache<sp/>--&gt;<sp/>CacheValid{Cache&lt;br/&gt;Valid?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CacheValid<sp/>--&gt;|Yes|<sp/>UseCache[Use<sp/>Cached&lt;br/&gt;Graph<sp/>Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CacheValid<sp/>--&gt;|No|<sp/>FreshFetch[Proceed<sp/>to&lt;br/&gt;Fresh<sp/>Fetch]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckCache<sp/>--&gt;|No|<sp/>FreshFetch</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FreshFetch<sp/>--&gt;<sp/>CheckNetwork{Network&lt;br/&gt;Enabled?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckNetwork<sp/>--&gt;|No|<sp/>UseFallback[Use<sp/>Fallback&lt;br/&gt;Sample<sp/>Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckNetwork<sp/>--&gt;|Yes|<sp/>FetchEquities[Fetch<sp/>Equities&lt;br/&gt;AAPL,<sp/>MSFT,<sp/>XOM,<sp/>JPM]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FetchEquities<sp/>--&gt;<sp/>FetchBonds[Fetch<sp/>Bond<sp/>ETFs&lt;br/&gt;TLT,<sp/>LQD,<sp/>HYG]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FetchBonds<sp/>--&gt;<sp/>FetchCommodities[Fetch<sp/>Commodities&lt;br/&gt;GC=F,<sp/>CL=F,<sp/>SI=F]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FetchCommodities<sp/>--&gt;<sp/>FetchCurrencies[Fetch<sp/>Currencies&lt;br/&gt;EURUSD,<sp/>GBPUSD,<sp/>JPYUSD]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FetchCurrencies<sp/>--&gt;<sp/>CreateEvents[Create<sp/>Regulatory&lt;br/&gt;Events]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CreateEvents<sp/>--&gt;<sp/>PopulateGraph[Populate<sp/>Graph&lt;br/&gt;with<sp/>Assets]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PopulateGraph<sp/>--&gt;<sp/>BuildRelations[Build&lt;br/&gt;Relationships]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BuildRelations<sp/>--&gt;<sp/>SaveCache[Save<sp/>to<sp/>Cache&lt;br/&gt;Atomic<sp/>Write]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UseCache<sp/>--&gt;<sp/>IngestEnd([Graph&lt;br/&gt;Ready])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UseFallback<sp/>--&gt;<sp/>PopulateSample[Populate<sp/>Sample&lt;br/&gt;Database]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PopulateSample<sp/>--&gt;<sp/>BuildRelations</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SaveCache<sp/>--&gt;<sp/>IngestEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3893">
<title>Atomic Cache Write Subprocess</title><para>The atomic cache write operation ensures data integrity by using temporary files and atomic rename operations.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>AtomicWrite[&quot;Atomic<sp/>Cache<sp/>Write&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WriteStart([Start&lt;br/&gt;Cache<sp/>Write])<sp/>--&gt;<sp/>CreateTemp[Create&lt;br/&gt;NamedTemporaryFile]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CreateTemp<sp/>--&gt;<sp/>WriteJSON[Write<sp/>JSON&lt;br/&gt;to<sp/>Temp<sp/>File]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WriteJSON<sp/>--&gt;<sp/>CloseTemp[Close&lt;br/&gt;Temp<sp/>File]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CloseTemp<sp/>--&gt;<sp/>AtomicReplace[os.replace()&lt;br/&gt;Atomic<sp/>Rename]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AtomicReplace<sp/>--&gt;<sp/>WriteEnd([Cache<sp/>Write&lt;br/&gt;Complete])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3894">
<title>4.2.3 Relationship Discovery Workflow</title><para>The relationship discovery engine processes all assets to identify eight distinct relationship types using rule-based detection algorithms.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>RelDiscovery[&quot;Relationship<sp/>Discovery<sp/>Workflow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RelStart([Start<sp/>Relationship&lt;br/&gt;Discovery])<sp/>--&gt;<sp/>GetAssets[Get<sp/>All&lt;br/&gt;Assets]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GetAssets<sp/>--&gt;<sp/>InitRels[Initialize<sp/>Empty&lt;br/&gt;Relationships<sp/>Dict]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InitRels<sp/>--&gt;<sp/>SameSector[Detect&lt;br/&gt;same_sector&lt;br/&gt;Bidirectional]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SameSector<sp/>--&gt;<sp/>CorpBond[Detect&lt;br/&gt;corporate_bond_to_equity&lt;br/&gt;Directional]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CorpBond<sp/>--&gt;<sp/>CommodExp[Detect&lt;br/&gt;commodity_exposure&lt;br/&gt;Directional]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CommodExp<sp/>--&gt;<sp/>CurrRisk[Detect&lt;br/&gt;currency_risk&lt;br/&gt;Directional]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CurrRisk<sp/>--&gt;<sp/>IncomeComp[Detect&lt;br/&gt;income_comparison&lt;br/&gt;Bidirectional]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IncomeComp<sp/>--&gt;<sp/>RegImpact[Detect&lt;br/&gt;regulatory_impact&lt;br/&gt;Directional]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RegImpact<sp/>--&gt;<sp/>MarketCap[Detect&lt;br/&gt;market_cap_similar&lt;br/&gt;Bidirectional]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MarketCap<sp/>--&gt;<sp/>Correlation[Detect&lt;br/&gt;correlation&lt;br/&gt;Bidirectional]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Correlation<sp/>--&gt;<sp/>StoreRels[Store<sp/>Relationships&lt;br/&gt;in<sp/>Graph]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>StoreRels<sp/>--&gt;<sp/>RelEnd([Relationships&lt;br/&gt;Built])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3895">
<title>Relationship Detection Rules</title><para><table rows="9" cols="4"><row>
<entry thead="yes"><para>Relationship Type   </para>
</entry><entry thead="yes"><para>Detection Rule   </para>
</entry><entry thead="yes"><para>Directionality   </para>
</entry><entry thead="yes"><para>Strength Calculation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>same_sector</computeroutput>   </para>
</entry><entry thead="no"><para>Assets share identical sector value   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Fixed: 0.8    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>corporate_bond_to_equity</computeroutput>   </para>
</entry><entry thead="no"><para>Bond.issuer_id matches Equity.id   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Based on credit rating    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>commodity_exposure</computeroutput>   </para>
</entry><entry thead="no"><para>Equity sector linked to commodity type   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Sector correlation coefficient    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>currency_risk</computeroutput>   </para>
</entry><entry thead="no"><para>Asset currency ≠ USD   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Exchange rate volatility    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>income_comparison</computeroutput>   </para>
</entry><entry thead="no"><para>Dividend yield vs bond yield comparison   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Yield differential    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_impact</computeroutput>   </para>
</entry><entry thead="no"><para>Shared regulatory event with impact_score   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Event impact_score    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>market_cap_similar</computeroutput>   </para>
</entry><entry thead="no"><para>Market cap within 50% range   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Similarity ratio    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>correlation</computeroutput>   </para>
</entry><entry thead="no"><para>Price correlation &gt; threshold   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Correlation coefficient   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3896">
<title>4.3 API Request Workflows</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3897">
<title>4.3.1 Asset Listing Flow</title><para>The asset listing endpoint (<computeroutput>GET /api/assets</computeroutput>) supports optional filtering by asset class and sector with efficient iteration over the in-memory graph.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>AssetListing[&quot;GET<sp/>/api/assets<sp/>Workflow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ListStart([GET<sp/>/api/assets&lt;br/&gt;Request])<sp/>--&gt;<sp/>ParseParams[Parse<sp/>Query&lt;br/&gt;Parameters]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParseParams<sp/>--&gt;<sp/>GetGraph[get_graph()&lt;br/&gt;Thread-Safe]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GetGraph<sp/>--&gt;<sp/>InitResults[Initialize&lt;br/&gt;Results<sp/>List]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InitResults<sp/>--&gt;<sp/>IterAssets[Iterate&lt;br/&gt;graph.assets]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IterAssets<sp/>--&gt;<sp/>NextAsset{More&lt;br/&gt;Assets?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextAsset<sp/>--&gt;|Yes|<sp/>CheckClassFilter{asset_class&lt;br/&gt;Filter<sp/>Set?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckClassFilter<sp/>--&gt;|Yes|<sp/>MatchClass{Asset<sp/>Matches&lt;br/&gt;Class?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MatchClass<sp/>--&gt;|No|<sp/>IterAssets</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MatchClass<sp/>--&gt;|Yes|<sp/>CheckSectorFilter</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckClassFilter<sp/>--&gt;|No|<sp/>CheckSectorFilter{sector&lt;br/&gt;Filter<sp/>Set?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckSectorFilter<sp/>--&gt;|Yes|<sp/>MatchSector{Asset<sp/>Matches&lt;br/&gt;Sector?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MatchSector<sp/>--&gt;|No|<sp/>IterAssets</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MatchSector<sp/>--&gt;|Yes|<sp/>Serialize[serialize_asset()]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckSectorFilter<sp/>--&gt;|No|<sp/>Serialize</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Serialize<sp/>--&gt;<sp/>AddResult[Add<sp/>to&lt;br/&gt;Results]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AddResult<sp/>--&gt;<sp/>IterAssets</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextAsset<sp/>--&gt;|No|<sp/>ReturnList[Return&lt;br/&gt;List<sp/>of<sp/>Assets]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReturnList<sp/>--&gt;<sp/>ListEnd([200<sp/>OK&lt;br/&gt;JSON<sp/>Response])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3898">
<title>4.3.2 Visualization Data Flow</title><para>The visualization endpoint (<computeroutput>GET /api/visualization</computeroutput>) generates complete 3D graph data including node positions, colors, and edge connections.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>VizFlow[&quot;GET<sp/>/api/visualization<sp/>Workflow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VizStart([GET<sp/>/api/visualization&lt;br/&gt;Request])<sp/>--&gt;<sp/>GetGraph2[get_graph()&lt;br/&gt;Thread-Safe]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GetGraph2<sp/>--&gt;<sp/>CallViz[Call<sp/>get_3d_visualization_data_enhanced()]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CallViz<sp/>--&gt;<sp/>GenPositions[Generate<sp/>3D&lt;br/&gt;Positions]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GenPositions<sp/>--&gt;<sp/>SetSeed[Set<sp/>Random<sp/>Seed=42&lt;br/&gt;Deterministic]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetSeed<sp/>--&gt;<sp/>CalcPositions[Calculate<sp/>Node&lt;br/&gt;Coordinates]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CalcPositions<sp/>--&gt;<sp/>GenColors[Generate<sp/>Colors&lt;br/&gt;by<sp/>Asset<sp/>Class]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GenColors<sp/>--&gt;<sp/>GenHover[Generate&lt;br/&gt;Hover<sp/>Text]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GenHover<sp/>--&gt;<sp/>BuildNodes[Build<sp/>Nodes&lt;br/&gt;Array]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BuildNodes<sp/>--&gt;<sp/>BuildEdges[Build<sp/>Edges&lt;br/&gt;from<sp/>Relationships]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BuildEdges<sp/>--&gt;<sp/>SerializeViz[Serialize<sp/>to&lt;br/&gt;VisualizationDataResponse]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SerializeViz<sp/>--&gt;<sp/>VizEnd([200<sp/>OK&lt;br/&gt;JSON<sp/>Response])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3899">
<title>Color Mapping for Asset Classes</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Asset Class   </para>
</entry><entry thead="yes"><para>Color Code   </para>
</entry><entry thead="yes"><para>Visual    </para>
</entry></row>
<row>
<entry thead="no"><para>Equity   </para>
</entry><entry thead="no"><para>Blue (#1f77b4)   </para>
</entry><entry thead="no"><para>Standard equities    </para>
</entry></row>
<row>
<entry thead="no"><para>Fixed Income   </para>
</entry><entry thead="no"><para>Green (#2ca02c)   </para>
</entry><entry thead="no"><para>Bonds and bond ETFs    </para>
</entry></row>
<row>
<entry thead="no"><para>Commodity   </para>
</entry><entry thead="no"><para>Orange (#ff7f0e)   </para>
</entry><entry thead="no"><para>Commodity futures    </para>
</entry></row>
<row>
<entry thead="no"><para>Currency   </para>
</entry><entry thead="no"><para>Red (#d62728)   </para>
</entry><entry thead="no"><para>Currency pairs    </para>
</entry></row>
<row>
<entry thead="no"><para>Derivative   </para>
</entry><entry thead="no"><para>Purple (#9467bd)   </para>
</entry><entry thead="no"><para>Derivatives   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3900">
<title>4.3.3 Metrics Calculation Flow</title><para>The metrics endpoint (<computeroutput>GET /api/metrics</computeroutput>) calculates and returns network statistics including density, degree distribution, and asset class breakdowns.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>MetricsFlow[&quot;GET<sp/>/api/metrics<sp/>Workflow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MetStart([GET<sp/>/api/metrics&lt;br/&gt;Request])<sp/>--&gt;<sp/>GetGraph3[get_graph()&lt;br/&gt;Thread-Safe]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GetGraph3<sp/>--&gt;<sp/>CallMetrics[Call<sp/>calculate_metrics()]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CallMetrics<sp/>--&gt;<sp/>CountAssets[Count<sp/>Total&lt;br/&gt;Assets]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CountAssets<sp/>--&gt;<sp/>CountRels[Count<sp/>Total&lt;br/&gt;Relationships]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CountRels<sp/>--&gt;<sp/>CalcByClass[Calculate<sp/>Assets&lt;br/&gt;by<sp/>Class]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CalcByClass<sp/>--&gt;<sp/>CalcDegree[Calculate&lt;br/&gt;Avg/Max<sp/>Degree]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CalcDegree<sp/>--&gt;<sp/>CalcDensity[Calculate<sp/>Network&lt;br/&gt;Density]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CalcDensity<sp/>--&gt;<sp/>BuildResponse[Build&lt;br/&gt;MetricsResponse]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BuildResponse<sp/>--&gt;<sp/>MetEnd([200<sp/>OK&lt;br/&gt;JSON<sp/>Response])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3901">
<title>Metrics Calculation Formulas</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Metric   </para>
</entry><entry thead="yes"><para>Formula   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para>Total Assets   </para>
</entry><entry thead="no"><para><computeroutput>len(graph.assets)</computeroutput>   </para>
</entry><entry thead="no"><para>Count of all asset nodes    </para>
</entry></row>
<row>
<entry thead="no"><para>Total Relationships   </para>
</entry><entry thead="no"><para><computeroutput>sum(len(edges) for edges in graph.relationships.values())</computeroutput>   </para>
</entry><entry thead="no"><para>Count of all edges    </para>
</entry></row>
<row>
<entry thead="no"><para>Average Degree   </para>
</entry><entry thead="no"><para><computeroutput>(2 × total_relationships) / total_assets</computeroutput>   </para>
</entry><entry thead="no"><para>Mean connections per node    </para>
</entry></row>
<row>
<entry thead="no"><para>Max Degree   </para>
</entry><entry thead="no"><para><computeroutput>max(len(edges) for edges in graph.relationships.values())</computeroutput>   </para>
</entry><entry thead="no"><para>Highest connected node    </para>
</entry></row>
<row>
<entry thead="no"><para>Network Density   </para>
</entry><entry thead="no"><para><computeroutput>total_relationships / (total_assets × (total_assets - 1) / 2)</computeroutput>   </para>
</entry><entry thead="no"><para>Ratio of actual to possible edges   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3902">
<title>4.4 Frontend Workflows</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3903">
<title>4.4.1 Next.js Page Load Flow</title><para>The Next.js frontend implements a client-side data loading pattern with error handling and retry capabilities.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>NextJSFlow[&quot;Next.js<sp/>Page<sp/>Load<sp/>Workflow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PageStart([Page<sp/>Mount&lt;br/&gt;useEffect])<sp/>--&gt;<sp/>SetLoading[Set<sp/>Loading&lt;br/&gt;State<sp/>=<sp/>true]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetLoading<sp/>--&gt;<sp/>FetchData[Promise.all:&lt;br/&gt;getMetrics()&lt;br/&gt;getVisualizationData()]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FetchData<sp/>--&gt;<sp/>FetchResult{Fetch&lt;br/&gt;Successful?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FetchResult<sp/>--&gt;|Yes|<sp/>StoreData[Store<sp/>Data&lt;br/&gt;in<sp/>State]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>StoreData<sp/>--&gt;<sp/>ClearLoading[Clear<sp/>Loading&lt;br/&gt;State]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClearLoading<sp/>--&gt;<sp/>RenderUI[Render<sp/>UI&lt;br/&gt;Components]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RenderUI<sp/>--&gt;<sp/>PageEnd([Page&lt;br/&gt;Ready])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FetchResult<sp/>--&gt;|No|<sp/>SetError[Set<sp/>Error&lt;br/&gt;State]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetError<sp/>--&gt;<sp/>ShowRetry[Show<sp/>Retry&lt;br/&gt;Button]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ShowRetry<sp/>--&gt;<sp/>UserRetry{User<sp/>Clicks&lt;br/&gt;Retry?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserRetry<sp/>--&gt;|Yes|<sp/>SetLoading</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserRetry<sp/>--&gt;|No|<sp/>WaitAction([Wait<sp/>for&lt;br/&gt;User<sp/>Action])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3904">
<title>4.4.2 Gradio UI Event Flow</title><para>The Gradio interface manages state and user interactions through an event-driven architecture with real-time visualization updates.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>GradioFlow[&quot;Gradio<sp/>UI<sp/>Event<sp/>Flow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GradioStart([Gradio<sp/>App&lt;br/&gt;Starts])<sp/>--&gt;<sp/>InitGraph[Initialize&lt;br/&gt;Graph<sp/>State]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InitGraph<sp/>--&gt;<sp/>CreateInterface[Create<sp/>Blocks&lt;br/&gt;Interface]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CreateInterface<sp/>--&gt;<sp/>SetupTabs[Setup<sp/>6&lt;br/&gt;Tabs]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetupTabs<sp/>--&gt;<sp/>WireEvents[Wire<sp/>Event&lt;br/&gt;Handlers]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WireEvents<sp/>--&gt;<sp/>LaunchServer[Launch<sp/>Server&lt;br/&gt;Port<sp/>7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LaunchServer<sp/>--&gt;<sp/>WaitEvent([Wait<sp/>for&lt;br/&gt;User<sp/>Event])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WaitEvent<sp/>--&gt;<sp/>UserAction{User&lt;br/&gt;Action<sp/>Type}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserAction<sp/>--&gt;|Refresh|<sp/>RefreshAll[refresh_all_outputs()]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserAction<sp/>--&gt;|Filter<sp/>Change|<sp/>UpdateViz[refresh_visualization()]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserAction<sp/>--&gt;|Tab<sp/>Change|<sp/>LoadTab[Load<sp/>Tab&lt;br/&gt;Content]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserAction<sp/>--&gt;|Asset<sp/>Select|<sp/>UpdateAsset[update_asset_info()]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RefreshAll<sp/>--&gt;<sp/>WaitEvent</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UpdateViz<sp/>--&gt;<sp/>WaitEvent</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadTab<sp/>--&gt;<sp/>WaitEvent</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UpdateAsset<sp/>--&gt;<sp/>WaitEvent</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3905">
<title>4.4.3 Tab Navigation State Machine</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">stateDiagram-v2</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>[*]<sp/>--&gt;<sp/>Visualization:<sp/>Default<sp/>Tab</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Visualization<sp/>--&gt;<sp/>Metrics:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Visualization<sp/>--&gt;<sp/>SchemaRules:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Visualization<sp/>--&gt;<sp/>AssetExplorer:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Visualization<sp/>--&gt;<sp/>Documentation:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Visualization<sp/>--&gt;<sp/>FormulaicAnalysis:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Metrics<sp/>--&gt;<sp/>Visualization:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Metrics<sp/>--&gt;<sp/>SchemaRules:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Metrics<sp/>--&gt;<sp/>AssetExplorer:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Metrics<sp/>--&gt;<sp/>Documentation:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Metrics<sp/>--&gt;<sp/>FormulaicAnalysis:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SchemaRules<sp/>--&gt;<sp/>Visualization:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SchemaRules<sp/>--&gt;<sp/>Metrics:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SchemaRules<sp/>--&gt;<sp/>AssetExplorer:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SchemaRules<sp/>--&gt;<sp/>Documentation:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SchemaRules<sp/>--&gt;<sp/>FormulaicAnalysis:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AssetExplorer<sp/>--&gt;<sp/>Visualization:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AssetExplorer<sp/>--&gt;<sp/>Metrics:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AssetExplorer<sp/>--&gt;<sp/>SchemaRules:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AssetExplorer<sp/>--&gt;<sp/>Documentation:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AssetExplorer<sp/>--&gt;<sp/>FormulaicAnalysis:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Documentation<sp/>--&gt;<sp/>Visualization:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Documentation<sp/>--&gt;<sp/>Metrics:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Documentation<sp/>--&gt;<sp/>SchemaRules:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Documentation<sp/>--&gt;<sp/>AssetExplorer:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Documentation<sp/>--&gt;<sp/>FormulaicAnalysis:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FormulaicAnalysis<sp/>--&gt;<sp/>Visualization:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FormulaicAnalysis<sp/>--&gt;<sp/>Metrics:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FormulaicAnalysis<sp/>--&gt;<sp/>SchemaRules:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FormulaicAnalysis<sp/>--&gt;<sp/>AssetExplorer:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FormulaicAnalysis<sp/>--&gt;<sp/>Documentation:<sp/>Tab<sp/>Click</highlight></codeline>
</programlisting></para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3906">
<title>4.5 Error Handling Workflows</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3907">
<title>4.5.1 API Error Handling Flow</title><para>The API implements comprehensive error handling with proper HTTP status codes and informative error messages.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>APIErrors[&quot;API<sp/>Error<sp/>Handling<sp/>Flow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrStart([Error&lt;br/&gt;Occurs])<sp/>--&gt;<sp/>ErrType{Error&lt;br/&gt;Type?}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrType<sp/>--&gt;|HTTPException|<sp/>HTTPErr[Return<sp/>HTTP&lt;br/&gt;Error<sp/>Code]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HTTPErr<sp/>--&gt;<sp/>HTTP401{401?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HTTP401<sp/>--&gt;|Yes|<sp/>AddAuth[Add<sp/>WWW-Authenticate&lt;br/&gt;Bearer<sp/>Header]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HTTP401<sp/>--&gt;|No|<sp/>HTTP404{404?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HTTP404<sp/>--&gt;|Yes|<sp/>NotFound[Return&lt;br/&gt;Not<sp/>Found<sp/>Detail]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HTTP404<sp/>--&gt;|No|<sp/>HTTP400{400?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HTTP400<sp/>--&gt;|Yes|<sp/>BadRequest[Return&lt;br/&gt;Bad<sp/>Request<sp/>Detail]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HTTP400<sp/>--&gt;|No|<sp/>OtherHTTP[Return&lt;br/&gt;Error<sp/>Detail]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrType<sp/>--&gt;|Rate<sp/>Limit|<sp/>RateErr[429<sp/>Too<sp/>Many&lt;br/&gt;Requests]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateErr<sp/>--&gt;<sp/>AddRetry[Add<sp/>Retry-After&lt;br/&gt;Header]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrType<sp/>--&gt;|Validation|<sp/>ValErr[422<sp/>Validation&lt;br/&gt;Error]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ValErr<sp/>--&gt;<sp/>PydanticDetail[Return<sp/>Pydantic&lt;br/&gt;Error<sp/>Details]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrType<sp/>--&gt;|Unexpected|<sp/>UnexpErr[Log<sp/>Exception]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UnexpErr<sp/>--&gt;<sp/>Return500[500<sp/>Internal&lt;br/&gt;Server<sp/>Error]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AddAuth<sp/>--&gt;<sp/>ErrEnd([Error<sp/>Response&lt;br/&gt;Sent])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NotFound<sp/>--&gt;<sp/>ErrEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BadRequest<sp/>--&gt;<sp/>ErrEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OtherHTTP<sp/>--&gt;<sp/>ErrEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AddRetry<sp/>--&gt;<sp/>ErrEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PydanticDetail<sp/>--&gt;<sp/>ErrEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return500<sp/>--&gt;<sp/>ErrEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3908">
<title>4.5.2 Authentication Error Scenarios</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>AuthErrors[&quot;Authentication<sp/>Error<sp/>Scenarios&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AuthErrStart([Auth<sp/>Error&lt;br/&gt;Detected])<sp/>--&gt;<sp/>AuthErrType{Error&lt;br/&gt;Scenario}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AuthErrType<sp/>--&gt;|Invalid<sp/>Credentials|<sp/>InvalidCred[&quot;401:<sp/>Incorrect&lt;br/&gt;username<sp/>or<sp/>password&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AuthErrType<sp/>--&gt;|Expired<sp/>Token|<sp/>ExpiredTok[&quot;401:<sp/>Token&lt;br/&gt;has<sp/>expired&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AuthErrType<sp/>--&gt;|Malformed<sp/>Token|<sp/>MalformedTok[&quot;401:<sp/>Could<sp/>not&lt;br/&gt;validate<sp/>credentials&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AuthErrType<sp/>--&gt;|Missing<sp/>Token|<sp/>MissingTok[&quot;401:<sp/>Not&lt;br/&gt;authenticated&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AuthErrType<sp/>--&gt;|Disabled<sp/>Account|<sp/>DisabledAcc[&quot;400:<sp/>Inactive&lt;br/&gt;user&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AuthErrType<sp/>--&gt;|Rate<sp/>Limited|<sp/>RateLimited[&quot;429:<sp/>Too<sp/>many&lt;br/&gt;requests&quot;]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InvalidCred<sp/>--&gt;<sp/>RetryPrompt[Prompt<sp/>User&lt;br/&gt;to<sp/>Retry]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ExpiredTok<sp/>--&gt;<sp/>ReAuth[Redirect<sp/>to&lt;br/&gt;Re-authenticate]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MalformedTok<sp/>--&gt;<sp/>ReAuth</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MissingTok<sp/>--&gt;<sp/>LoginPrompt[Show<sp/>Login&lt;br/&gt;Form]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DisabledAcc<sp/>--&gt;<sp/>ContactAdmin[Contact&lt;br/&gt;Administrator]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimited<sp/>--&gt;<sp/>WaitRetry[Wait<sp/>and&lt;br/&gt;Retry]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RetryPrompt<sp/>--&gt;<sp/>AuthErrEnd([Error&lt;br/&gt;Handled])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReAuth<sp/>--&gt;<sp/>AuthErrEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoginPrompt<sp/>--&gt;<sp/>AuthErrEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ContactAdmin<sp/>--&gt;<sp/>AuthErrEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WaitRetry<sp/>--&gt;<sp/>AuthErrEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3909">
<title>4.5.3 Graph Initialization Error Handling</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>GraphErrors[&quot;Graph<sp/>Initialization<sp/>Error<sp/>Handling&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphErrStart([Graph<sp/>Init&lt;br/&gt;Error])<sp/>--&gt;<sp/>ErrSource{Error&lt;br/&gt;Source}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrSource<sp/>--&gt;|Cache<sp/>Load<sp/>Failed|<sp/>CacheErr[Log<sp/>Cache&lt;br/&gt;Error]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CacheErr<sp/>--&gt;<sp/>FallbackFetch[Proceed<sp/>to&lt;br/&gt;Standard<sp/>Fetch]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrSource<sp/>--&gt;|Network<sp/>Disabled|<sp/>NetErr[Network&lt;br/&gt;Unavailable]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NetErr<sp/>--&gt;<sp/>UseSample[Use<sp/>Sample&lt;br/&gt;Data<sp/>Fallback]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrSource<sp/>--&gt;|Yahoo<sp/>Finance<sp/>Error|<sp/>YFErr[Log<sp/>Yahoo&lt;br/&gt;Finance<sp/>Error]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YFErr<sp/>--&gt;<sp/>CheckPartial{Partial<sp/>Data&lt;br/&gt;Retrieved?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckPartial<sp/>--&gt;|Yes|<sp/>UsePartial[Use<sp/>Available&lt;br/&gt;Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckPartial<sp/>--&gt;|No|<sp/>UseSample</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrSource<sp/>--&gt;|Critical<sp/>Failure|<sp/>CritErr[Log<sp/>Critical&lt;br/&gt;Error]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CritErr<sp/>--&gt;<sp/>AbortStartup[Abort&lt;br/&gt;Application<sp/>Startup]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FallbackFetch<sp/>--&gt;<sp/>GraphReady([Graph&lt;br/&gt;Initialized])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UseSample<sp/>--&gt;<sp/>GraphReady</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UsePartial<sp/>--&gt;<sp/>GraphReady</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AbortStartup<sp/>--&gt;<sp/>StartupFailed([Startup&lt;br/&gt;Failed])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3910">
<title>4.5.4 Frontend Error Recovery Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>FrontendErrors[&quot;Frontend<sp/>Error<sp/>Recovery&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FEStart([Frontend<sp/>Error&lt;br/&gt;Detected])<sp/>--&gt;<sp/>ErrCategory{Error&lt;br/&gt;Category}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrCategory<sp/>--&gt;|Network<sp/>Error|<sp/>NetError[Set<sp/>Error:&lt;br/&gt;Network<sp/>Unavailable]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrCategory<sp/>--&gt;|API<sp/>Error|<sp/>APIError[Set<sp/>Error:&lt;br/&gt;API<sp/>Error<sp/>Message]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrCategory<sp/>--&gt;|Render<sp/>Error|<sp/>RenderError[Set<sp/>Error:&lt;br/&gt;Display<sp/>Error]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NetError<sp/>--&gt;<sp/>ShowRetryUI[Show<sp/>Retry&lt;br/&gt;Button]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>APIError<sp/>--&gt;<sp/>ShowRetryUI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RenderError<sp/>--&gt;<sp/>ShowRefresh[Show<sp/>Refresh&lt;br/&gt;Page<sp/>Option]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ShowRetryUI<sp/>--&gt;<sp/>UserRetries{User&lt;br/&gt;Retries?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserRetries<sp/>--&gt;|Yes|<sp/>ClearError[Clear<sp/>Error&lt;br/&gt;State]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClearError<sp/>--&gt;<sp/>ReloadData[Reload&lt;br/&gt;Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReloadData<sp/>--&gt;<sp/>Success{Success?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Success<sp/>--&gt;|Yes|<sp/>Normal([Normal&lt;br/&gt;Operation])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Success<sp/>--&gt;|No|<sp/>NetError</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserRetries<sp/>--&gt;|No|<sp/>WaitUser([Wait<sp/>for&lt;br/&gt;User])</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ShowRefresh<sp/>--&gt;<sp/>UserRefresh{User&lt;br/&gt;Refreshes?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserRefresh<sp/>--&gt;|Yes|<sp/>PageReload[Full<sp/>Page&lt;br/&gt;Reload]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PageReload<sp/>--&gt;<sp/>Normal</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserRefresh<sp/>--&gt;|No|<sp/>WaitUser</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3911">
<title>4.6 Integration Sequence Diagrams</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3912">
<title>4.6.1 Frontend-Backend API Integration</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>User<sp/>as<sp/>User<sp/>Browser</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>NextJS<sp/>as<sp/>Next.js<sp/>Frontend</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Axios<sp/>as<sp/>Axios<sp/>Client</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>CORS<sp/>as<sp/>CORS<sp/>Middleware</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>FastAPI<sp/>as<sp/>FastAPI<sp/>Backend</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Graph<sp/>as<sp/>Graph<sp/>Engine</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>User-&gt;&gt;NextJS:<sp/>Navigate<sp/>to<sp/>Page</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NextJS-&gt;&gt;Axios:<sp/>api.getMetrics()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Axios-&gt;&gt;CORS:<sp/>GET<sp/>/api/metrics</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CORS-&gt;&gt;CORS:<sp/>Validate<sp/>Origin</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>alt<sp/>Origin<sp/>Valid</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS-&gt;&gt;FastAPI:<sp/>Forward<sp/>Request</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI-&gt;&gt;Graph:<sp/>get_graph()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph--&gt;&gt;FastAPI:<sp/>Graph<sp/>Instance</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI-&gt;&gt;Graph:<sp/>calculate_metrics()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph--&gt;&gt;FastAPI:<sp/>Metrics<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI--&gt;&gt;CORS:<sp/>MetricsResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS--&gt;&gt;Axios:<sp/>200<sp/>OK<sp/>+<sp/>CORS<sp/>Headers</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Axios--&gt;&gt;NextJS:<sp/>Response<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextJS--&gt;&gt;User:<sp/>Render<sp/>Metrics</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else<sp/>Origin<sp/>Invalid</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS--&gt;&gt;Axios:<sp/>403<sp/>Forbidden</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Axios--&gt;&gt;NextJS:<sp/>Error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextJS--&gt;&gt;User:<sp/>Show<sp/>Error<sp/>Message</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3913">
<title>4.6.2 Authentication Token Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Client<sp/>as<sp/>API<sp/>Client</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>RateLimiter<sp/>as<sp/>Rate<sp/>Limiter</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Auth<sp/>as<sp/>Auth<sp/>Module</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>UserRepo<sp/>as<sp/>User<sp/>Repository</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>JWT<sp/>as<sp/>JWT<sp/>Library</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Client-&gt;&gt;RateLimiter:<sp/>POST<sp/>/token</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RateLimiter-&gt;&gt;RateLimiter:<sp/>Check<sp/>5/min<sp/>limit</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>alt<sp/>Rate<sp/>Limit<sp/>OK</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimiter-&gt;&gt;Auth:<sp/>Process<sp/>Login</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;UserRepo:<sp/>get_user(username)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserRepo--&gt;&gt;Auth:<sp/>User<sp/>or<sp/>None</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alt<sp/>User<sp/>Found</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;Auth:<sp/>verify_password(plain,<sp/>hashed)</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alt<sp/>Password<sp/>Valid</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;JWT:<sp/>encode(payload,<sp/>SECRET_KEY,<sp/>HS256)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JWT--&gt;&gt;Auth:<sp/>Access<sp/>Token</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth--&gt;&gt;Client:<sp/>{&quot;access_token&quot;:<sp/>&quot;...&quot;,<sp/>&quot;token_type&quot;:<sp/>&quot;bearer&quot;}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>Password<sp/>Invalid</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth--&gt;&gt;Client:<sp/>401<sp/>Incorrect<sp/>username<sp/>or<sp/>password</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>User<sp/>Not<sp/>Found</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth--&gt;&gt;Client:<sp/>401<sp/>Incorrect<sp/>username<sp/>or<sp/>password</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else<sp/>Rate<sp/>Limit<sp/>Exceeded</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimiter--&gt;&gt;Client:<sp/>429<sp/>Too<sp/>Many<sp/>Requests</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3914">
<title>4.6.3 Real Data Fetching Integration</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>App<sp/>as<sp/>Application</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Fetcher<sp/>as<sp/>RealDataFetcher</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Cache<sp/>as<sp/>File<sp/>Cache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>YF<sp/>as<sp/>Yahoo<sp/>Finance</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Graph<sp/>as<sp/>Graph<sp/>Engine</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>App-&gt;&gt;Fetcher:<sp/>create_real_database()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;Cache:<sp/>Check<sp/>cache<sp/>file</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>alt<sp/>Cache<sp/>Exists</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cache--&gt;&gt;Fetcher:<sp/>Cached<sp/>JSON</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;Graph:<sp/>Load<sp/>from<sp/>cache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph--&gt;&gt;App:<sp/>Cached<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else<sp/>No<sp/>Cache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;YF:<sp/>Download<sp/>AAPL,<sp/>MSFT,<sp/>XOM,<sp/>JPM</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YF--&gt;&gt;Fetcher:<sp/>Equity<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;YF:<sp/>Download<sp/>TLT,<sp/>LQD,<sp/>HYG</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YF--&gt;&gt;Fetcher:<sp/>Bond<sp/>ETF<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;YF:<sp/>Download<sp/>GC=F,<sp/>CL=F,<sp/>SI=F</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YF--&gt;&gt;Fetcher:<sp/>Commodity<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;YF:<sp/>Download<sp/>EURUSD=X,<sp/>GBPUSD=X,<sp/>JPYUSD=X</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YF--&gt;&gt;Fetcher:<sp/>Currency<sp/>Data</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;Graph:<sp/>add_asset()<sp/>×<sp/>N</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;Graph:<sp/>add_regulatory_event()<sp/>×<sp/>N</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;Graph:<sp/>build_relationships()</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;Cache:<sp/>Write<sp/>temp<sp/>file</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cache-&gt;&gt;Cache:<sp/>Atomic<sp/>rename</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cache--&gt;&gt;Fetcher:<sp/>Cache<sp/>saved</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph--&gt;&gt;App:<sp/>Fresh<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3915">
<title>4.6.4 Visualization Rendering Pipeline</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>User<sp/>as<sp/>User</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>UI<sp/>as<sp/>UI<sp/>Component</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>API<sp/>as<sp/>API<sp/>Layer</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Graph<sp/>as<sp/>Graph<sp/>Engine</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Viz<sp/>as<sp/>Visualization<sp/>Module</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Plotly<sp/>as<sp/>Plotly<sp/>Renderer</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>User-&gt;&gt;UI:<sp/>Request<sp/>3D<sp/>Visualization</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>UI-&gt;&gt;API:<sp/>GET<sp/>/api/visualization</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API-&gt;&gt;Graph:<sp/>get_graph()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph--&gt;&gt;API:<sp/>Graph<sp/>Instance</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API-&gt;&gt;Viz:<sp/>get_3d_visualization_data_enhanced()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Viz-&gt;&gt;Viz:<sp/>Set<sp/>seed(42)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Viz-&gt;&gt;Viz:<sp/>Calculate<sp/>3D<sp/>positions</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Viz-&gt;&gt;Viz:<sp/>Assign<sp/>colors<sp/>by<sp/>asset<sp/>class</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Viz-&gt;&gt;Viz:<sp/>Generate<sp/>hover<sp/>text</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Viz--&gt;&gt;API:<sp/>(positions,<sp/>ids,<sp/>colors,<sp/>hovers)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API-&gt;&gt;API:<sp/>Build<sp/>nodes<sp/>array</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API-&gt;&gt;API:<sp/>Build<sp/>edges<sp/>array</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API--&gt;&gt;UI:<sp/>VisualizationDataResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>UI-&gt;&gt;Plotly:<sp/>Render<sp/>3D<sp/>scatter</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Plotly--&gt;&gt;User:<sp/>Interactive<sp/>3D<sp/>Graph</highlight></codeline>
</programlisting></para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3916">
<title>4.7 State Transition Diagrams</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3917">
<title>4.7.1 Graph Lifecycle State Machine</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">stateDiagram-v2</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>[*]<sp/>--&gt;<sp/>Uninitialized:<sp/>Application<sp/>Start</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Uninitialized<sp/>--&gt;<sp/>Initializing:<sp/>get_graph()<sp/>called</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Initializing<sp/>--&gt;<sp/>Loading:<sp/>Acquire<sp/>Lock</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Loading<sp/>--&gt;<sp/>LoadingFromCache:<sp/>Cache<sp/>path<sp/>set</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Loading<sp/>--&gt;<sp/>LoadingFromNetwork:<sp/>Real<sp/>data<sp/>enabled</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Loading<sp/>--&gt;<sp/>LoadingFromSample:<sp/>Default<sp/>mode</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LoadingFromCache<sp/>--&gt;<sp/>Initialized:<sp/>Cache<sp/>loaded</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LoadingFromCache<sp/>--&gt;<sp/>LoadingFromNetwork:<sp/>Cache<sp/>invalid</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LoadingFromNetwork<sp/>--&gt;<sp/>Initialized:<sp/>Data<sp/>fetched</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LoadingFromNetwork<sp/>--&gt;<sp/>LoadingFromSample:<sp/>Network<sp/>error</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LoadingFromSample<sp/>--&gt;<sp/>Initialized:<sp/>Sample<sp/>created</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Initialized<sp/>--&gt;<sp/>Ready:<sp/>Release<sp/>Lock</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Ready<sp/>--&gt;<sp/>Ready:<sp/>Serving<sp/>requests</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Ready<sp/>--&gt;<sp/>Resetting:<sp/>reset_graph()<sp/>called</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Resetting<sp/>--&gt;<sp/>Uninitialized:<sp/>Graph<sp/>cleared</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Ready<sp/>--&gt;<sp/>FactoryOverride:<sp/>set_graph_factory()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FactoryOverride<sp/>--&gt;<sp/>Resetting:<sp/>Factory<sp/>set</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3918">
<title>4.7.2 Request State Machine</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">stateDiagram-v2</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>[*]<sp/>--&gt;<sp/>Received:<sp/>HTTP<sp/>Request</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Received<sp/>--&gt;<sp/>ValidatingCORS:<sp/>Check<sp/>origin</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ValidatingCORS<sp/>--&gt;<sp/>CORSRejected:<sp/>Invalid<sp/>origin</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ValidatingCORS<sp/>--&gt;<sp/>CheckingRateLimit:<sp/>Valid<sp/>origin</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CORSRejected<sp/>--&gt;<sp/>[*]:<sp/>403<sp/>Forbidden</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CheckingRateLimit<sp/>--&gt;<sp/>RateLimited:<sp/>Limit<sp/>exceeded</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CheckingRateLimit<sp/>--&gt;<sp/>CheckingAuth:<sp/>Within<sp/>limit</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RateLimited<sp/>--&gt;<sp/>[*]:<sp/>429<sp/>Too<sp/>Many<sp/>Requests</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CheckingAuth<sp/>--&gt;<sp/>Authenticated:<sp/>Valid<sp/>token</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CheckingAuth<sp/>--&gt;<sp/>AuthRequired:<sp/>Missing/invalid<sp/>token</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CheckingAuth<sp/>--&gt;<sp/>Processing:<sp/>No<sp/>auth<sp/>required</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AuthRequired<sp/>--&gt;<sp/>[*]:<sp/>401<sp/>Unauthorized</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Authenticated<sp/>--&gt;<sp/>Processing:<sp/>User<sp/>validated</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Processing<sp/>--&gt;<sp/>Completed:<sp/>Success</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Processing<sp/>--&gt;<sp/>Failed:<sp/>Exception</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Completed<sp/>--&gt;<sp/>[*]:<sp/>2xx<sp/>Response</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Failed<sp/>--&gt;<sp/>[*]:<sp/>4xx/5xx<sp/>Response</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3919">
<title>4.7.3 User Session State Machine</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">stateDiagram-v2</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>[*]<sp/>--&gt;<sp/>Anonymous:<sp/>Visit<sp/>application</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Anonymous<sp/>--&gt;<sp/>Authenticating:<sp/>Submit<sp/>credentials</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Authenticating<sp/>--&gt;<sp/>Authenticated:<sp/>Valid<sp/>credentials</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Authenticating<sp/>--&gt;<sp/>Anonymous:<sp/>Invalid<sp/>credentials</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Authenticated<sp/>--&gt;<sp/>TokenExpired:<sp/>30<sp/>min<sp/>elapsed</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>TokenExpired<sp/>--&gt;<sp/>Authenticating:<sp/>Re-authenticate</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>TokenExpired<sp/>--&gt;<sp/>Anonymous:<sp/>Session<sp/>ended</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Authenticated<sp/>--&gt;<sp/>Anonymous:<sp/>Logout</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Authenticated<sp/>--&gt;<sp/>Accessing:<sp/>Request<sp/>protected<sp/>resource</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Accessing<sp/>--&gt;<sp/>Authenticated:<sp/>Request<sp/>complete</highlight></codeline>
</programlisting></para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3920">
<title>4.8 Timing and SLA Considerations</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3921">
<title>4.8.1 Performance Targets by Operation</title><para><table rows="9" cols="3"><row>
<entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Target SLA   </para>
</entry><entry thead="yes"><para>Measurement Point    </para>
</entry></row>
<row>
<entry thead="no"><para>API Response (95th percentile)   </para>
</entry><entry thead="no"><para>&lt; 500ms   </para>
</entry><entry thead="no"><para>Request to response    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Rendering   </para>
</entry><entry thead="no"><para>&lt; 2 seconds   </para>
</entry><entry thead="no"><para>Data load to interactive    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Discovery   </para>
</entry><entry thead="no"><para>&lt; 500ms   </para>
</entry><entry thead="no"><para>For 100 assets    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Generation   </para>
</entry><entry thead="no"><para>&lt; 100ms   </para>
</entry><entry thead="no"><para>Credential submission to token    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Initialization   </para>
</entry><entry thead="no"><para>&lt; 3 seconds   </para>
</entry><entry thead="no"><para>Application startup    </para>
</entry></row>
<row>
<entry thead="no"><para>Dataclass Instantiation   </para>
</entry><entry thead="no"><para>&lt; 1ms   </para>
</entry><entry thead="no"><para>Per object    </para>
</entry></row>
<row>
<entry thead="no"><para>Validation   </para>
</entry><entry thead="no"><para>&lt; 1ms   </para>
</entry><entry thead="no"><para>Per object    </para>
</entry></row>
<row>
<entry thead="no"><para>Initial Page Load   </para>
</entry><entry thead="no"><para>&lt; 3 seconds   </para>
</entry><entry thead="no"><para>Navigation to interactive   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3922">
<title>4.8.2 Timeout Configuration</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Timeouts[&quot;Timeout<sp/>Configuration&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JWT[&quot;JWT<sp/>Token&lt;br/&gt;30<sp/>min<sp/>expiry&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimit[&quot;Rate<sp/>Limit<sp/>Window&lt;br/&gt;1<sp/>minute&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HTTPTimeout[&quot;HTTP<sp/>Client&lt;br/&gt;30<sp/>sec<sp/>default&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YahooFinance[&quot;Yahoo<sp/>Finance&lt;br/&gt;Request<sp/>timeout&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3923">
<title>4.8.3 Rate Limiting Constraints</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Limit   </para>
</entry><entry thead="yes"><para>Window   </para>
</entry><entry thead="yes"><para>Key Function    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>POST /token</computeroutput>   </para>
</entry><entry thead="no"><para>5 requests   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Client IP    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GET /api/users/me</computeroutput>   </para>
</entry><entry thead="no"><para>10 requests   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Client IP    </para>
</entry></row>
<row>
<entry thead="no"><para>Other endpoints   </para>
</entry><entry thead="no"><para>Unlimited   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry></row>
</table>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3924">
<title>4.9 Validation Rules and Checkpoints</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3925">
<title>4.9.1 Business Rules Validation Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ValidationFlow[&quot;Validation<sp/>Flow&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ValStart([Data&lt;br/&gt;Input])<sp/>--&gt;<sp/>DomainVal{Domain&lt;br/&gt;Validation}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DomainVal<sp/>--&gt;|Asset|<sp/>AssetRules[&quot;Asset<sp/>Rules:&lt;br/&gt;•<sp/>id<sp/>non-empty&lt;br/&gt;•<sp/>symbol<sp/>non-empty&lt;br/&gt;•<sp/>name<sp/>non-empty&lt;br/&gt;•<sp/>price<sp/>≥<sp/>0&lt;br/&gt;•<sp/>currency<sp/>3-letter<sp/>ISO&quot;]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DomainVal<sp/>--&gt;|RegulatoryEvent|<sp/>EventRules[&quot;Event<sp/>Rules:&lt;br/&gt;•<sp/>impact_score<sp/>in<sp/>[-1,<sp/>1]&lt;br/&gt;•<sp/>date<sp/>ISO<sp/>8601&lt;br/&gt;•<sp/>id<sp/>non-empty&quot;]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AssetRules<sp/>--&gt;<sp/>ClassSpecific{Asset&lt;br/&gt;Class?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClassSpecific<sp/>--&gt;|Equity|<sp/>EquityRules[&quot;Equity<sp/>Rules:&lt;br/&gt;•<sp/>P/E<sp/>ratio<sp/>numeric&lt;br/&gt;•<sp/>dividend_yield<sp/>numeric&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClassSpecific<sp/>--&gt;|FixedIncome|<sp/>BondRules[&quot;Bond<sp/>Rules:&lt;br/&gt;•<sp/>maturity_date<sp/>valid&lt;br/&gt;•<sp/>coupon_rate<sp/>numeric&lt;br/&gt;•<sp/>credit_rating<sp/>valid&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClassSpecific<sp/>--&gt;|Commodity|<sp/>CommodityRules[&quot;Commodity<sp/>Rules:&lt;br/&gt;•<sp/>contract_size<sp/>positive&lt;br/&gt;•<sp/>delivery_date<sp/>valid&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClassSpecific<sp/>--&gt;|Currency|<sp/>CurrencyRules[&quot;Currency<sp/>Rules:&lt;br/&gt;•<sp/>exchange_rate<sp/>positive&lt;br/&gt;•<sp/>country<sp/>non-empty&quot;]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>EventRules<sp/>--&gt;<sp/>ValEnd([Validation&lt;br/&gt;Complete])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>EquityRules<sp/>--&gt;<sp/>ValEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BondRules<sp/>--&gt;<sp/>ValEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CommodityRules<sp/>--&gt;<sp/>ValEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CurrencyRules<sp/>--&gt;<sp/>ValEnd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3926">
<title>4.9.2 API Input Validation Checkpoints</title><para><table rows="8" cols="3"><row>
<entry thead="yes"><para>Checkpoint   </para>
</entry><entry thead="yes"><para>Validation   </para>
</entry><entry thead="yes"><para>Response on Failure    </para>
</entry></row>
<row>
<entry thead="no"><para>Request Body   </para>
</entry><entry thead="no"><para>Pydantic model parsing   </para>
</entry><entry thead="no"><para>422 Validation Error    </para>
</entry></row>
<row>
<entry thead="no"><para>Query Parameters   </para>
</entry><entry thead="no"><para>Type coercion and constraints   </para>
</entry><entry thead="no"><para>422 Validation Error    </para>
</entry></row>
<row>
<entry thead="no"><para>Path Parameters   </para>
</entry><entry thead="no"><para>Type validation   </para>
</entry><entry thead="no"><para>422 Validation Error    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication   </para>
</entry><entry thead="no"><para>Token format and signature   </para>
</entry><entry thead="no"><para>401 Unauthorized    </para>
</entry></row>
<row>
<entry thead="no"><para>Authorization   </para>
</entry><entry thead="no"><para>User active status   </para>
</entry><entry thead="no"><para>400 Inactive User    </para>
</entry></row>
<row>
<entry thead="no"><para>CORS Origin   </para>
</entry><entry thead="no"><para>Allowlist and pattern matching   </para>
</entry><entry thead="no"><para>403 Forbidden    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limit   </para>
</entry><entry thead="no"><para>Request count per window   </para>
</entry><entry thead="no"><para>429 Too Many Requests   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3927">
<title>4.9.3 Data Quality Validation</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DataQuality[&quot;Data<sp/>Quality<sp/>Validation&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DQStart([Data&lt;br/&gt;Received])<sp/>--&gt;<sp/>Completeness[&quot;Completeness<sp/>Check:&lt;br/&gt;Required<sp/>fields<sp/>present&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Completeness<sp/>--&gt;<sp/>Consistency[&quot;Consistency<sp/>Check:&lt;br/&gt;Cross-field<sp/>logic&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Consistency<sp/>--&gt;<sp/>Accuracy[&quot;Accuracy<sp/>Check:&lt;br/&gt;Value<sp/>ranges<sp/>valid&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Accuracy<sp/>--&gt;<sp/>Uniqueness[&quot;Uniqueness<sp/>Check:&lt;br/&gt;ID<sp/>uniqueness&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Uniqueness<sp/>--&gt;<sp/>DQEnd([Quality&lt;br/&gt;Verified])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3928">
<title>4.10 Transaction Boundaries and Persistence</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3929">
<title>4.10.1 Data Persistence Points</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Persistence Method   </para>
</entry><entry thead="yes"><para>Durability    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph State   </para>
</entry><entry thead="no"><para>In-memory singleton   </para>
</entry><entry thead="no"><para>Process lifetime    </para>
</entry></row>
<row>
<entry thead="no"><para>User Credentials   </para>
</entry><entry thead="no"><para>SQLite database   </para>
</entry><entry thead="no"><para>Persistent    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache Files   </para>
</entry><entry thead="no"><para>JSON file system   </para>
</entry><entry thead="no"><para>Persistent    </para>
</entry></row>
<row>
<entry thead="no"><para>JWT Tokens   </para>
</entry><entry thead="no"><para>Stateless (client-held)   </para>
</entry><entry thead="no"><para>Token lifetime    </para>
</entry></row>
<row>
<entry thead="no"><para>Session State   </para>
</entry><entry thead="no"><para>React/Gradio state   </para>
</entry><entry thead="no"><para>Tab lifetime   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3930">
<title>4.10.2 Transaction Flow for Cache Updates</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>CacheTransaction[&quot;Cache<sp/>Update<sp/>Transaction&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TxStart([Start<sp/>Cache&lt;br/&gt;Update])<sp/>--&gt;<sp/>CreateTemp[Create&lt;br/&gt;Temp<sp/>File]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CreateTemp<sp/>--&gt;<sp/>WriteData[Write<sp/>JSON&lt;br/&gt;Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WriteData<sp/>--&gt;<sp/>FlushSync[Flush<sp/>and&lt;br/&gt;Sync<sp/>to<sp/>Disk]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FlushSync<sp/>--&gt;<sp/>CloseFile[Close&lt;br/&gt;File<sp/>Handle]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CloseFile<sp/>--&gt;<sp/>AtomicRename[os.replace()&lt;br/&gt;Atomic<sp/>Rename]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AtomicRename<sp/>--&gt;<sp/>TxEnd([Transaction&lt;br/&gt;Complete])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3931">
<title>4.10.3 Thread Safety Boundaries</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ThreadSafety[&quot;Thread<sp/>Safety<sp/>Boundaries&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Request1[&quot;Request<sp/>1&quot;]<sp/>--&gt;<sp/>Lock[&quot;graph_lock&lt;br/&gt;Threading<sp/>Lock&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Request2[&quot;Request<sp/>2&quot;]<sp/>--&gt;<sp/>Lock</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Request3[&quot;Request<sp/>3&quot;]<sp/>--&gt;<sp/>Lock</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Lock<sp/>--&gt;<sp/>GraphAccess[&quot;Graph<sp/>Singleton&lt;br/&gt;Access&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphAccess<sp/>--&gt;<sp/>ReadOps[&quot;Read<sp/>Operations&lt;br/&gt;(Concurrent<sp/>OK)&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphAccess<sp/>--&gt;<sp/>WriteOps[&quot;Write<sp/>Operations&lt;br/&gt;(Serialized)&quot;]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReadOps<sp/>--&gt;<sp/>Response1[&quot;Response<sp/>1&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReadOps<sp/>--&gt;<sp/>Response2[&quot;Response<sp/>2&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WriteOps<sp/>--&gt;<sp/>Response3[&quot;Response<sp/>3&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3932">
<title>4.11 References</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3933_1s3"><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3933">
<title>Files Examined</title><para><itemizedlist>
<listitem><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput> - FastAPI backend with graph lifecycle, authentication flow, CORS, rate limiting, all REST endpoints, and error handling patterns</para>
</listitem><listitem><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput> - JWT authentication flow, password hashing, token creation/validation, and user repository</para>
</listitem><listitem><para><computeroutput><ref refid="api_2database_8py" kindref="compound">api/database.py</ref></computeroutput> - SQLite database helpers and memory connection management</para>
</listitem><listitem><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput> - Core graph class with relationships data structure and 3D visualization data</para>
</listitem><listitem><para><computeroutput><ref refid="sample__data_8py" kindref="compound">src/data/sample_data.py</ref></computeroutput> - Sample data creation workflow, asset/event registration, and relationship building</para>
</listitem><listitem><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput> - Yahoo Finance data fetching, caching mechanism, and fallback patterns</para>
</listitem><listitem><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput> - Domain models with validation rules</para>
</listitem><listitem><para><computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput> - Gradio UI controller with visualization workflows and event handlers</para>
</listitem><listitem><para><computeroutput>frontend/app/page.tsx</computeroutput> - Next.js home page with data loading, tab navigation, and error handling</para>
</listitem><listitem><para><computeroutput>frontend/app/lib/api.ts</computeroutput> - Frontend API client with all endpoint calls</para>
</listitem></itemizedlist>
</para>
</sect4></sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3934_1s3"><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3934">
<title>Technical Specification Sections Referenced</title><para><itemizedlist>
<listitem><para>1.2 System Overview - System architecture and component interactions</para>
</listitem><listitem><para>2.1 Feature Catalog - Feature definitions and dependencies</para>
</listitem><listitem><para>2.4 Implementation Considerations - Performance requirements and constraints</para>
</listitem><listitem><para>3.8 Security Considerations - Authentication and API security</para>
</listitem><listitem><para>3.9 Integration Requirements - Frontend-backend communication patterns</para>
</listitem></itemizedlist>
</para>
</sect4></sect3>
</sect2>
</sect1>
<sect1 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3935">
<title>5. System Architecture</title><para>This section provides a comprehensive technical reference for the Financial Asset Relationship Database system architecture, documenting the architectural patterns, component interactions, technical decisions, and cross-cutting concerns that define the system&apos;s structure and behavior.</para>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3936">
<title>5.1 HIGH-LEVEL ARCHITECTURE</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3937">
<title>5.1.1 System Overview</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3938">
<title>Architectural Style and Rationale</title><para>The Financial Asset Relationship Database implements a <bold>layered architecture</bold> with clear separation of concerns, optimizing for deployment flexibility, maintainability, and appropriate scalability for financial analysis workloads. The system follows an <bold>API-first design</bold> philosophy, enabling multiple presentation layers to consume the same business logic through standardized interfaces.</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Architectural Characteristic   </para>
</entry><entry thead="yes"><para>Design Decision   </para>
</entry><entry thead="yes"><para>Rationale    </para>
</entry></row>
<row>
<entry thead="no"><para>Layer Separation   </para>
</entry><entry thead="no"><para>Four distinct layers (Presentation, API, Business Logic, Data)   </para>
</entry><entry thead="no"><para>Enables independent evolution and testing of each concern    </para>
</entry></row>
<row>
<entry thead="no"><para>Monolithic Core   </para>
</entry><entry thead="no"><para>Single deployable Python process with modular packages   </para>
</entry><entry thead="no"><para>Simplifies deployment for current scale (&lt;500 assets) while maintaining clear module boundaries    </para>
</entry></row>
<row>
<entry thead="no"><para>API-First Design   </para>
</entry><entry thead="no"><para>REST/JSON endpoints via FastAPI with automatic OpenAPI documentation   </para>
</entry><entry thead="no"><para>Universal client compatibility and self-documenting interfaces    </para>
</entry></row>
<row>
<entry thead="no"><para>Dual UI Strategy   </para>
</entry><entry thead="no"><para>Legacy Gradio + Modern Next.js frontends   </para>
</entry><entry thead="no"><para>Supports rapid prototyping and production-ready experiences   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3939">
<title>Key Architectural Principles</title><para>The system adheres to the following architectural principles that guide all design decisions:</para>
<para><itemizedlist>
<listitem><para><bold>Thread-Safe Singleton Pattern</bold>: The graph engine uses double-checked locking to ensure safe concurrent access during initialization, preventing race conditions under multi-threaded workloads</para>
</listitem><listitem><para><bold>Deterministic Visualization</bold>: Fixed random seed (seed=42) ensures reproducible 3D layouts across sessions, critical for consistent user experience and debugging</para>
</listitem><listitem><para><bold>Type Safety</bold>: Python dataclasses with validation and Pydantic models enforce strict type contracts throughout the stack</para>
</listitem><listitem><para><bold>Graceful Degradation</bold>: Fallback mechanisms ensure the system remains operational when external data sources are unavailable</para>
</listitem><listitem><para><bold>Atomic Operations</bold>: Cache writes use temporary files with atomic rename operations to prevent data corruption</para>
</listitem></itemizedlist>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3940">
<title>System Boundaries and Interfaces</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>External[External<sp/>Systems]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YF[Yahoo<sp/>Finance<sp/>API]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Users[End<sp/>Users]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Vercel[Vercel<sp/>Platform]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>SystemBoundary[Financial<sp/>Asset<sp/>Relationship<sp/>Database]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Presentation[Presentation<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextJS[Next.js<sp/>Frontend&lt;br/&gt;Port<sp/>3000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gradio[Gradio<sp/>UI&lt;br/&gt;Port<sp/>7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>API[API<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI[FastAPI<sp/>Backend&lt;br/&gt;Port<sp/>8000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth[JWT<sp/>Auth<sp/>Module]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimit[Rate<sp/>Limiter]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS[CORS<sp/>Middleware]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Core[Business<sp/>Logic<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph[Asset<sp/>Graph<sp/>Engine]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Models[Domain<sp/>Models]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Viz[Visualization<sp/>Module]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Metrics[Metrics<sp/>Calculator]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Data[Data<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Sample[Sample<sp/>Data<sp/>Generator]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher[Real<sp/>Data<sp/>Fetcher]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cache[JSON<sp/>File<sp/>Cache]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLite[SQLite<sp/>Auth<sp/>DB]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users<sp/>--&gt;<sp/>NextJS</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users<sp/>--&gt;<sp/>Gradio</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NextJS<sp/>--&gt;<sp/>FastAPI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>CORS</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CORS<sp/>--&gt;<sp/>RateLimit</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RateLimit<sp/>--&gt;<sp/>Auth</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Auth<sp/>--&gt;<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Gradio<sp/>--&gt;<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>Models</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>Viz</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>Metrics</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>Sample</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>Fetcher</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Fetcher<sp/>--&gt;<sp/>YF</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Fetcher<sp/>--&gt;<sp/>Cache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Auth<sp/>--&gt;<sp/>SQLite</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>Vercel</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NextJS<sp/>--&gt;<sp/>Vercel</highlight></codeline>
</programlisting></para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3941">
<title>5.1.2 Core Components</title><para>The system comprises eight major components, each with distinct responsibilities and well-defined integration boundaries.</para>
<para><table rows="9" cols="4"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Primary Responsibility   </para>
</entry><entry thead="yes"><para>Key Dependencies   </para>
</entry><entry thead="yes"><para>Integration Points    </para>
</entry></row>
<row>
<entry thead="no"><para>FastAPI Backend   </para>
</entry><entry thead="no"><para>REST API server, request routing, middleware orchestration   </para>
</entry><entry thead="no"><para>FastAPI 0.127.0, Uvicorn, slowapi, PyJWT   </para>
</entry><entry thead="no"><para>Frontend via HTTP/JSON, Graph via Python calls    </para>
</entry></row>
<row>
<entry thead="no"><para>Next.js Frontend   </para>
</entry><entry thead="no"><para>Modern React-based UI with TypeScript   </para>
</entry><entry thead="no"><para>Next.js 14.2.35, React 18.2.0, Axios, Plotly.js   </para>
</entry><entry thead="no"><para>FastAPI via REST, Users via browser    </para>
</entry></row>
<row>
<entry thead="no"><para>Gradio UI   </para>
</entry><entry thead="no"><para>Legacy Python-native dashboard   </para>
</entry><entry thead="no"><para>Gradio ≥4.0.0, Plotly ≥6.0.0   </para>
</entry><entry thead="no"><para>Graph Engine via direct Python calls    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Engine   </para>
</entry><entry thead="no"><para>In-memory relationship storage, 3D layout calculation   </para>
</entry><entry thead="no"><para>NumPy 2.2.6   </para>
</entry><entry thead="no"><para>All layers via singleton accessor    </para>
</entry></row>
<row>
<entry thead="no"><para>Domain Models   </para>
</entry><entry thead="no"><para>Asset/Event dataclasses, validation rules   </para>
</entry><entry thead="no"><para>Python standard library   </para>
</entry><entry thead="no"><para>All components via imports    </para>
</entry></row>
<row>
<entry thead="no"><para>Real Data Fetcher   </para>
</entry><entry thead="no"><para>Yahoo Finance integration, caching   </para>
</entry><entry thead="no"><para>yfinance ≥0.2.51   </para>
</entry><entry thead="no"><para>Graph initialization pipeline    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Module   </para>
</entry><entry thead="no"><para>Plotly chart generation, color mapping   </para>
</entry><entry thead="no"><para>Plotly ≥6.0.0   </para>
</entry><entry thead="no"><para>API endpoints, Gradio UI    </para>
</entry></row>
<row>
<entry thead="no"><para>Auth Module   </para>
</entry><entry thead="no"><para>JWT token management, user authentication   </para>
</entry><entry thead="no"><para>PyJWT ≥2.8.0, passlib   </para>
</entry><entry thead="no"><para>FastAPI protected endpoints   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3942">
<title>5.1.3 Data Flow Description</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3943">
<title>Primary Data Flow: API to Visualization</title><para>The primary data flow begins with user interaction and culminates in rendered visualizations:</para>
<para><orderedlist>
<listitem><para><bold>Request Initiation</bold>: User navigates to a page in Next.js frontend or Gradio UI</para>
</listitem><listitem><para><bold>API Communication</bold>: Next.js client sends HTTP request via Axios to FastAPI backend</para>
</listitem><listitem><para><bold>Security Pipeline</bold>: Request traverses CORS validation → Rate limit check → JWT authentication (if protected)</para>
</listitem><listitem><para><bold>Graph Access</bold>: API endpoint calls <computeroutput>get_graph()</computeroutput> to retrieve thread-safe singleton instance</para>
</listitem><listitem><para><bold>Data Processing</bold>: Graph engine provides assets, relationships, and calculated positions</para>
</listitem><listitem><para><bold>Serialization</bold>: Pydantic models serialize Python objects to JSON response</para>
</listitem><listitem><para><bold>Client Rendering</bold>: Frontend receives data and renders Plotly.js 3D visualization</para>
</listitem></orderedlist>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3944">
<title>Data Ingestion Flow</title><para>The data ingestion flow populates the graph from external or internal sources:</para>
<para><orderedlist>
<listitem><para><bold>Cache Check</bold>: On startup, <computeroutput>_initialize_graph()</computeroutput> checks for existing cache at <computeroutput>GRAPH_CACHE_PATH</computeroutput></para>
</listitem><listitem><para><bold>Cache Loading</bold>: If valid cache exists, JSON-serialized graph is loaded directly</para>
</listitem><listitem><para><bold>Fresh Fetch</bold>: Otherwise, <computeroutput>RealDataFetcher</computeroutput> retrieves data from Yahoo Finance (if enabled)</para>
</listitem><listitem><para><bold>Fallback Mode</bold>: If network unavailable, sample data generator creates representative dataset</para>
</listitem><listitem><para><bold>Graph Population</bold>: Assets added via <computeroutput>graph.add_asset()</computeroutput>, events via <computeroutput>graph.add_regulatory_event()</computeroutput></para>
</listitem><listitem><para><bold>Relationship Building</bold>: <computeroutput>graph.build_relationships()</computeroutput> discovers all eight relationship types</para>
</listitem><listitem><para><bold>Cache Persistence</bold>: Graph serialized to JSON using atomic write pattern</para>
</listitem></orderedlist>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3945">
<title>Relationship Discovery Data Flow</title><para>The relationship discovery engine processes assets through rule-based algorithms:</para>
<para><table rows="9" cols="4"><row>
<entry thead="yes"><para>Relationship Type   </para>
</entry><entry thead="yes"><para>Detection Rule   </para>
</entry><entry thead="yes"><para>Directionality   </para>
</entry><entry thead="yes"><para>Data Source    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>same_sector</computeroutput>   </para>
</entry><entry thead="no"><para>Assets share identical sector   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Asset.sector field    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>corporate_bond_to_equity</computeroutput>   </para>
</entry><entry thead="no"><para>Bond.issuer_id matches Equity.id   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Cross-asset linkage    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>commodity_exposure</computeroutput>   </para>
</entry><entry thead="no"><para>Equity sector linked to commodity   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Sector-commodity mapping    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>currency_risk</computeroutput>   </para>
</entry><entry thead="no"><para>Asset currency ≠ USD   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Asset.currency field    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>income_comparison</computeroutput>   </para>
</entry><entry thead="no"><para>Dividend yield vs bond yield   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Yield calculations    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_impact</computeroutput>   </para>
</entry><entry thead="no"><para>Shared regulatory event   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Event.impact_score    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>market_cap_similar</computeroutput>   </para>
</entry><entry thead="no"><para>Market cap within 50% range   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Asset.market_cap    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>correlation</computeroutput>   </para>
</entry><entry thead="no"><para>Price correlation &gt; threshold   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Historical prices   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3946">
<title>5.1.4 External Integration Points</title><para>The system integrates with external services through well-defined interfaces:</para>
<para><table rows="5" cols="4"><row>
<entry thead="yes"><para>System Name   </para>
</entry><entry thead="yes"><para>Integration Type   </para>
</entry><entry thead="yes"><para>Data Exchange Pattern   </para>
</entry><entry thead="yes"><para>Protocol/Format    </para>
</entry></row>
<row>
<entry thead="no"><para>Yahoo Finance   </para>
</entry><entry thead="no"><para>External data source   </para>
</entry><entry thead="no"><para>HTTP pull with JSON caching   </para>
</entry><entry thead="no"><para>yfinance Python library    </para>
</entry></row>
<row>
<entry thead="no"><para>SQLite   </para>
</entry><entry thead="no"><para>Local authentication store   </para>
</entry><entry thead="no"><para>File-based SQL persistence   </para>
</entry><entry thead="no"><para>sqlite3 driver    </para>
</entry></row>
<row>
<entry thead="no"><para>PostgreSQL   </para>
</entry><entry thead="no"><para>Optional production persistence   </para>
</entry><entry thead="no"><para>Connection-pooled SQL   </para>
</entry><entry thead="no"><para>SQLAlchemy ORM    </para>
</entry></row>
<row>
<entry thead="no"><para>Vercel   </para>
</entry><entry thead="no"><para>Serverless hosting platform   </para>
</entry><entry thead="no"><para>HTTPS deployment   </para>
</entry><entry thead="no"><para>Vercel CLI/JSON config   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3948">
<title>5.2 COMPONENT DETAILS</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3949">
<title>5.2.1 FastAPI Backend</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3950">
<title>Purpose and Responsibilities</title><para>The FastAPI backend serves as the primary API gateway, exposing graph data through RESTful endpoints while enforcing security policies, rate limiting, and data validation.</para>
<para><bold>Location</bold>: <computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput></para>
<para><table rows="7" cols="2"><row>
<entry thead="yes"><para>Responsibility   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>REST API Routing   </para>
</entry><entry thead="no"><para>FastAPI router with typed endpoint definitions    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication   </para>
</entry><entry thead="no"><para>JWT token issuance and validation via <computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limiting   </para>
</entry><entry thead="no"><para>slowapi integration with per-endpoint limits    </para>
</entry></row>
<row>
<entry thead="no"><para>CORS Management   </para>
</entry><entry thead="no"><para>Environment-specific origin allowlists    </para>
</entry></row>
<row>
<entry thead="no"><para>Request Validation   </para>
</entry><entry thead="no"><para>Pydantic models for automatic validation    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Lifecycle   </para>
</entry><entry thead="no"><para>Thread-safe singleton management   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3951">
<title>Technologies and Frameworks</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Technology   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>FastAPI   </para>
</entry><entry thead="no"><para>0.127.0   </para>
</entry><entry thead="no"><para>REST framework with automatic OpenAPI    </para>
</entry></row>
<row>
<entry thead="no"><para>Uvicorn   </para>
</entry><entry thead="no"><para>≥0.24.0   </para>
</entry><entry thead="no"><para>ASGI server with async support    </para>
</entry></row>
<row>
<entry thead="no"><para>Pydantic   </para>
</entry><entry thead="no"><para>2.12.5   </para>
</entry><entry thead="no"><para>Request/response validation    </para>
</entry></row>
<row>
<entry thead="no"><para>slowapi   </para>
</entry><entry thead="no"><para>Latest   </para>
</entry><entry thead="no"><para>Rate limiting middleware    </para>
</entry></row>
<row>
<entry thead="no"><para>PyJWT   </para>
</entry><entry thead="no"><para>≥2.8.0   </para>
</entry><entry thead="no"><para>JWT token encoding/decoding    </para>
</entry></row>
<row>
<entry thead="no"><para>passlib   </para>
</entry><entry thead="no"><para>Latest   </para>
</entry><entry thead="no"><para>Password hashing (pbkdf2_sha256)   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3952">
<title>Key Interfaces and APIs</title><para><table rows="12" cols="4"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Method   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Auth Required    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/token</computeroutput>   </para>
</entry><entry thead="no"><para>POST   </para>
</entry><entry thead="no"><para>JWT token issuance   </para>
</entry><entry thead="no"><para>No (rate limited: 5/min)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>List assets with optional filters   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets/{id}</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Single asset details   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets/{id}/relationships</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Asset relationships   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/relationships</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>All relationships   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/metrics</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Network statistics   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/visualization</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>3D visualization data   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/asset-classes</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Available asset class enum   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/sectors</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Available sectors   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/users/me</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Current user info   </para>
</entry><entry thead="no"><para>Yes (rate limited: 10/min)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/health</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Health check   </para>
</entry><entry thead="no"><para>No   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3953">
<title>Thread-Safe Graph Access Pattern</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ThreadSafe[Thread-Safe<sp/>Graph<sp/>Initialization]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Request([API<sp/>Request])<sp/>--&gt;<sp/>CheckGlobal{Global<sp/>graph&lt;br/&gt;exists?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckGlobal<sp/>--&gt;|Yes|<sp/>ReturnGraph([Return<sp/>Graph])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckGlobal<sp/>--&gt;|No|<sp/>AcquireLock[Acquire<sp/>Thread<sp/>Lock]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AcquireLock<sp/>--&gt;<sp/>DoubleCheck{Double-check&lt;br/&gt;inside<sp/>lock?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DoubleCheck<sp/>--&gt;|Yes|<sp/>ReleaseLock1[Release<sp/>Lock]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReleaseLock1<sp/>--&gt;<sp/>ReturnGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DoubleCheck<sp/>--&gt;|No|<sp/>Initialize[Initialize<sp/>Graph]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Initialize<sp/>--&gt;<sp/>SetGlobal[Set<sp/>Global<sp/>Reference]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetGlobal<sp/>--&gt;<sp/>ReleaseLock2[Release<sp/>Lock]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReleaseLock2<sp/>--&gt;<sp/>ReturnGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3954">
<title>Scaling Considerations</title><para><itemizedlist>
<listitem><para><bold>Node Limit</bold>: Optimal performance for &lt;500 nodes due to in-memory storage</para>
</listitem><listitem><para>**Rate Limiting**: Protects against abuse and ensures fair resource allocation</para>
</listitem><listitem><para>**Serverless Ready**: Mangum adapter enables Vercel Lambda deployment (50MB limit)</para>
</listitem><listitem><para>**Stateless Requests**: Each request is independent; session state managed via JWT</para>
</listitem></itemizedlist>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3955">
<title>5.2.2 Next.js Frontend</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3956">
<title>Purpose and Responsibilities</title><para>The Next.js frontend provides a modern, responsive user interface for exploring asset relationships and visualizing network data.</para>
<para>**Location**: `frontend/`</para>
<para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Responsibility   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>3D Visualization   </para>
</entry><entry thead="no"><para>Plotly.js integration with SSR safety    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset Exploration   </para>
</entry><entry thead="no"><para>Filterable tables with URL-synced state    </para>
</entry></row>
<row>
<entry thead="no"><para>Metrics Dashboard   </para>
</entry><entry thead="no"><para>Grid-based metrics display    </para>
</entry></row>
<row>
<entry thead="no"><para>API Communication   </para>
</entry><entry thead="no"><para>Axios HTTP client with error handling    </para>
</entry></row>
<row>
<entry thead="no"><para>Responsive Design   </para>
</entry><entry thead="no"><para>Tailwind CSS utility classes   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3957">
<title>Technologies and Frameworks</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Technology   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Next.js   </para>
</entry><entry thead="no"><para>14.2.35   </para>
</entry><entry thead="no"><para>React meta-framework with App Router    </para>
</entry></row>
<row>
<entry thead="no"><para>React   </para>
</entry><entry thead="no"><para>18.2.0   </para>
</entry><entry thead="no"><para>UI component library    </para>
</entry></row>
<row>
<entry thead="no"><para>TypeScript   </para>
</entry><entry thead="no"><para>^5.3.0   </para>
</entry><entry thead="no"><para>Type safety    </para>
</entry></row>
<row>
<entry thead="no"><para>Tailwind CSS   </para>
</entry><entry thead="no"><para>Latest   </para>
</entry><entry thead="no"><para>Utility-first styling    </para>
</entry></row>
<row>
<entry thead="no"><para>Plotly.js   </para>
</entry><entry thead="no"><para>^2.27.0   </para>
</entry><entry thead="no"><para>Client-side 3D rendering    </para>
</entry></row>
<row>
<entry thead="no"><para>Axios   </para>
</entry><entry thead="no"><para>Latest   </para>
</entry><entry thead="no"><para>HTTP client   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3958">
<title>Key Components</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Location   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>NetworkVisualization</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/components/NetworkVisualization.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>3D Plotly graph with dynamic import for SSR    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>MetricsDashboard</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/components/MetricsDashboard.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Metrics display grid    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>AssetList</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/components/AssetList.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Filterable asset table with pagination   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3959">
<title>Frontend Data Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>User<sp/>as<sp/>User<sp/>Browser</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Page<sp/>as<sp/>Next.js<sp/>Page</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>API<sp/>as<sp/>API<sp/>Client</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Backend<sp/>as<sp/>FastAPI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Plotly<sp/>as<sp/>Plotly.js</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>User-&gt;&gt;Page:<sp/>Navigate<sp/>to<sp/>Page</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Page-&gt;&gt;Page:<sp/>useEffect<sp/>on<sp/>mount</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Page-&gt;&gt;API:<sp/>getMetrics()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Page-&gt;&gt;API:<sp/>getVisualizationData()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API-&gt;&gt;Backend:<sp/>GET<sp/>/api/metrics</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API-&gt;&gt;Backend:<sp/>GET<sp/>/api/visualization</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Backend--&gt;&gt;API:<sp/>JSON<sp/>Response</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API--&gt;&gt;Page:<sp/>Data<sp/>Objects</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Page-&gt;&gt;Plotly:<sp/>Render<sp/>3D<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Plotly--&gt;&gt;User:<sp/>Interactive<sp/>Visualization</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3960">
<title>Scaling Considerations</title><para><itemizedlist>
<listitem><para><bold>MAX_NODES/MAX_EDGES</bold>: Environment-configurable limits (<computeroutput>NEXT_PUBLIC_MAX_NODES</computeroutput>, <computeroutput>NEXT_PUBLIC_MAX_EDGES</computeroutput>)</para>
</listitem><listitem><para><bold>Default Limits</bold>: 500 nodes, 2000 edges for client-side performance</para>
</listitem><listitem><para><bold>SSR Safety</bold>: Dynamic imports prevent server-side Plotly rendering errors</para>
</listitem><listitem><para><bold>Client Hydration</bold>: Data fetched client-side to avoid SSR data mismatches</para>
</listitem></itemizedlist>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3961">
<title>5.2.3 Gradio UI</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3962">
<title>Purpose and Responsibilities</title><para>The Gradio UI provides a legacy Python-native dashboard for rapid exploration and development, with direct integration to core Python modules.</para>
<para><bold>Location</bold>: <computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Responsibility   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>Tabbed Interface   </para>
</entry><entry thead="no"><para>Gradio Blocks with six tabs    </para>
</entry></row>
<row>
<entry thead="no"><para>Real-time Updates   </para>
</entry><entry thead="no"><para>Event handlers for refresh actions    </para>
</entry></row>
<row>
<entry thead="no"><para>Direct Python Access   </para>
</entry><entry thead="no"><para>No API intermediary for visualization    </para>
</entry></row>
<row>
<entry thead="no"><para>Development Tool   </para>
</entry><entry thead="no"><para>Rapid prototyping environment   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3963">
<title>Technologies and Frameworks</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Technology   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Gradio   </para>
</entry><entry thead="no"><para>≥4.0.0   </para>
</entry><entry thead="no"><para>Python UI framework    </para>
</entry></row>
<row>
<entry thead="no"><para>Plotly   </para>
</entry><entry thead="no"><para>≥6.0.0   </para>
</entry><entry thead="no"><para>Server-side visualization   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3964">
<title>Interface Structure</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Tab   </para>
</entry><entry thead="yes"><para>Content   </para>
</entry><entry thead="yes"><para>Data Source    </para>
</entry></row>
<row>
<entry thead="no"><para>3D Visualization   </para>
</entry><entry thead="no"><para>Interactive network graph   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="graph__visuals_8py" kindref="compound">src/visualizations/graph_visuals.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Metrics   </para>
</entry><entry thead="no"><para>Network statistics   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="metric__visuals_8py" kindref="compound">src/visualizations/metric_visuals.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Schema &amp; Rules   </para>
</entry><entry thead="no"><para>Data model documentation   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="schema__report_8py" kindref="compound">src/reports/schema_report.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset Explorer   </para>
</entry><entry thead="no"><para>Filterable asset table   </para>
</entry><entry thead="no"><para>Graph engine assets    </para>
</entry></row>
<row>
<entry thead="no"><para>Documentation   </para>
</entry><entry thead="no"><para>System documentation   </para>
</entry><entry thead="no"><para>Static content    </para>
</entry></row>
<row>
<entry thead="no"><para>Formulaic Analysis   </para>
</entry><entry thead="no"><para>Analysis dashboard   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="formulaic__visuals_8py" kindref="compound">src/visualizations/formulaic_visuals.py</ref></computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3965">
<title>5.2.4 Graph Engine</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3966">
<title>Purpose and Responsibilities</title><para>The Graph Engine serves as the central data structure, managing asset storage, relationship discovery, and 3D layout calculations.</para>
<para><bold>Location</bold>: <computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput></para>
<para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Responsibility   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset Storage   </para>
</entry><entry thead="no"><para>Dictionary-based in-memory storage    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Management   </para>
</entry><entry thead="no"><para>Adjacency list with typed edges    </para>
</entry></row>
<row>
<entry thead="no"><para>3D Layout Calculation   </para>
</entry><entry thead="no"><para>NumPy-based coordinate generation    </para>
</entry></row>
<row>
<entry thead="no"><para>Metrics Computation   </para>
</entry><entry thead="no"><para>Network statistics calculation    </para>
</entry></row>
<row>
<entry thead="no"><para>Singleton Access   </para>
</entry><entry thead="no"><para>Thread-safe global instance   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3967">
<title>Data Structures</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Structure   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>assets</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Dict[str, Asset]</computeroutput>   </para>
</entry><entry thead="no"><para>Asset ID to object mapping    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>relationships</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Dict[str, List[Tuple[str, str, float]]]</computeroutput>   </para>
</entry><entry thead="no"><para>Source ID to (target, type, strength) edges    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_events</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Dict[str, RegulatoryEvent]</computeroutput>   </para>
</entry><entry thead="no"><para>Event ID to object mapping   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3968">
<title>Key Methods</title><para><table rows="7" cols="4"><row>
<entry thead="yes"><para>Method   </para>
</entry><entry thead="yes"><para>Parameters   </para>
</entry><entry thead="yes"><para>Returns   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>add_asset()</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Asset</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>None</computeroutput>   </para>
</entry><entry thead="no"><para>Register asset in graph    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>add_regulatory_event()</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>RegulatoryEvent</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>None</computeroutput>   </para>
</entry><entry thead="no"><para>Register event    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>build_relationships()</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>None</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>None</computeroutput>   </para>
</entry><entry thead="no"><para>Discover all relationship types    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>get_relationships()</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>asset_id</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>List[Tuple]</computeroutput>   </para>
</entry><entry thead="no"><para>Get edges for asset    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>calculate_metrics()</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>None</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Dict</computeroutput>   </para>
</entry><entry thead="no"><para>Compute network statistics    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>get_3d_visualization_data_enhanced()</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>filters</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Tuple</computeroutput>   </para>
</entry><entry thead="no"><para>Generate visualization data   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3969">
<title>5.2.5 Domain Models</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3970">
<title>Purpose and Responsibilities</title><para>Domain models define the type-safe data structures and validation rules that govern all financial entities in the system.</para>
<para><bold>Location</bold>: <computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3971">
<title>Asset Class Enumeration</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Display Name   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>EQUITY</computeroutput>   </para>
</entry><entry thead="no"><para>Equity   </para>
</entry><entry thead="no"><para>Stocks and equity instruments    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>FIXED_INCOME</computeroutput>   </para>
</entry><entry thead="no"><para>Fixed Income   </para>
</entry><entry thead="no"><para>Bonds and debt instruments    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>COMMODITY</computeroutput>   </para>
</entry><entry thead="no"><para>Commodity   </para>
</entry><entry thead="no"><para>Physical commodity futures    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>CURRENCY</computeroutput>   </para>
</entry><entry thead="no"><para>Currency   </para>
</entry><entry thead="no"><para>Foreign exchange pairs    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>DERIVATIVE</computeroutput>   </para>
</entry><entry thead="no"><para>Derivative   </para>
</entry><entry thead="no"><para>Derivative instruments   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3972">
<title>Asset Type Hierarchy</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">classDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>class<sp/>Asset<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+str<sp/>id</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+str<sp/>symbol</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+str<sp/>name</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+AssetClass<sp/>asset_class</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+str<sp/>sector</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+float<sp/>price</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[float]<sp/>market_cap</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+str<sp/>currency</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+__post_init__()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>class<sp/>Equity<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[float]<sp/>pe_ratio</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[float]<sp/>dividend_yield</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[float]<sp/>earnings_per_share</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[float]<sp/>book_value</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>class<sp/>Bond<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[float]<sp/>yield_to_maturity</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[float]<sp/>coupon_rate</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[str]<sp/>maturity_date</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[str]<sp/>credit_rating</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[str]<sp/>issuer_id</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>class<sp/>Commodity<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[float]<sp/>contract_size</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[str]<sp/>delivery_date</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[float]<sp/>volatility</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>class<sp/>Currency<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[float]<sp/>exchange_rate</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[str]<sp/>country</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Optional[float]<sp/>central_bank_rate</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Asset<sp/>&lt;|--<sp/>Equity</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Asset<sp/>&lt;|--<sp/>Bond</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Asset<sp/>&lt;|--<sp/>Commodity</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Asset<sp/>&lt;|--<sp/>Currency</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3973">
<title>Validation Rules</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Field   </para>
</entry><entry thead="yes"><para>Rule   </para>
</entry><entry thead="yes"><para>Error Handling    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>id</computeroutput>, <computeroutput>symbol</computeroutput>, <computeroutput>name</computeroutput>   </para>
</entry><entry thead="no"><para>Non-empty string   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput> on empty    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>price</computeroutput>, <computeroutput>market_cap</computeroutput>   </para>
</entry><entry thead="no"><para>Non-negative float   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput> on negative    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>currency</computeroutput>   </para>
</entry><entry thead="no"><para>3-character ISO code   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput> on invalid    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>impact_score</computeroutput> (events)   </para>
</entry><entry thead="no"><para>Range [-1, 1]   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput> on out of bounds    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>date</computeroutput> (events)   </para>
</entry><entry thead="no"><para>ISO 8601 format   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput> on invalid format   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3974">
<title>5.2.6 Visualization Layer</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3975">
<title>Purpose and Responsibilities</title><para>The Visualization Layer generates Plotly-compatible chart specifications for both server-side (Gradio) and client-side (Next.js) rendering.</para>
<para><bold>Location</bold>: <computeroutput>src/visualizations/</computeroutput></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Module   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="graph__visuals_8py" kindref="compound">graph_visuals.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>3D network visualization with filtering    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="graph__2d__visuals_8py" kindref="compound">graph_2d_visuals.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>2D network layouts    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="metric__visuals_8py" kindref="compound">metric_visuals.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Metrics bar charts and dashboards    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="formulaic__visuals_8py" kindref="compound">formulaic_visuals.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Formulaic analysis dashboard   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3976">
<title>Color Scheme Mapping</title><para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Asset Class   </para>
</entry><entry thead="yes"><para>Node Color   </para>
</entry><entry thead="yes"><para>Relationship Type   </para>
</entry><entry thead="yes"><para>Edge Color    </para>
</entry></row>
<row>
<entry thead="no"><para>Equity   </para>
</entry><entry thead="no"><para>Blue (#1f77b4)   </para>
</entry><entry thead="no"><para>same_sector   </para>
</entry><entry thead="no"><para>Orange    </para>
</entry></row>
<row>
<entry thead="no"><para>Fixed Income   </para>
</entry><entry thead="no"><para>Green (#2ca02c)   </para>
</entry><entry thead="no"><para>corporate_bond_to_equity   </para>
</entry><entry thead="no"><para>Blue    </para>
</entry></row>
<row>
<entry thead="no"><para>Commodity   </para>
</entry><entry thead="no"><para>Orange (#ff7f0e)   </para>
</entry><entry thead="no"><para>commodity_exposure   </para>
</entry><entry thead="no"><para>Green    </para>
</entry></row>
<row>
<entry thead="no"><para>Currency   </para>
</entry><entry thead="no"><para>Red (#d62728)   </para>
</entry><entry thead="no"><para>regulatory_impact   </para>
</entry><entry thead="no"><para>Red    </para>
</entry></row>
<row>
<entry thead="no"><para>Derivative   </para>
</entry><entry thead="no"><para>Purple (#9467bd)   </para>
</entry><entry thead="no"><para>market_cap_similar   </para>
</entry><entry thead="no"><para>Gray   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3977">
<title>5.2.7 Component Interaction Diagram</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Frontend[Frontend<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextJS[Next.js]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gradio[Gradio]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>API[API<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI[FastAPI]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth[Auth]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Rate[Rate<sp/>Limiter]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Business[Business<sp/>Logic]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph[Graph<sp/>Engine]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Viz[Visualization]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Models[Domain<sp/>Models]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Data[Data<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Sample[Sample<sp/>Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Yahoo[Yahoo<sp/>Finance]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cache[Cache]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLite[SQLite]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NextJS<sp/>--&gt;|HTTP/JSON|<sp/>FastAPI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Gradio<sp/>--&gt;|Direct<sp/>Call|<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>Rate</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Rate<sp/>--&gt;<sp/>Auth</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Auth<sp/>--&gt;<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Auth<sp/>--&gt;<sp/>SQLite</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>Viz</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>Models</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>Sample</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>Yahoo</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Yahoo<sp/>--&gt;<sp/>Cache</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3979">
<title>5.3 TECHNICAL DECISIONS</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3980">
<title>5.3.1 Architecture Style Decisions</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3981">
<title>Decision: Monolithic with API-First Design</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Aspect   </para>
</entry><entry thead="yes"><para>Choice   </para>
</entry><entry thead="yes"><para>Alternatives Considered    </para>
</entry></row>
<row>
<entry thead="no"><para>Deployment Model   </para>
</entry><entry thead="no"><para>Monolithic   </para>
</entry><entry thead="no"><para>Microservices, Serverless-only    </para>
</entry></row>
<row>
<entry thead="no"><para>API Design   </para>
</entry><entry thead="no"><para>REST/JSON   </para>
</entry><entry thead="no"><para>GraphQL, gRPC    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Storage   </para>
</entry><entry thead="no"><para>In-memory with optional persistence   </para>
</entry><entry thead="no"><para>Database-first, Event-sourced   </para>
</entry></row>
</table>
</para>
<para><bold>Rationale</bold>:</para>
<para><itemizedlist>
<listitem><para><bold>Simplified Deployment</bold>: Single Python process reduces operational complexity for current scale</para>
</listitem><listitem><para><bold>Module Boundaries</bold>: Clear package structure (<computeroutput>src/logic/</computeroutput>, <computeroutput>src/data/</computeroutput>, <computeroutput>src/visualizations/</computeroutput>) enables future microservices migration</para>
</listitem><listitem><para><bold>Adequate Scale</bold>: &lt;500 assets fits comfortably in memory with sub-millisecond access</para>
</listitem><listitem><para>**Deployment Flexibility**: Same codebase deploys to Docker, Vercel, and local development</para>
</listitem></itemizedlist>
</para>
<para>**Tradeoffs**:</para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Benefit   </para>
</entry><entry thead="yes"><para>Cost    </para>
</entry></row>
<row>
<entry thead="no"><para>Simpler operations   </para>
</entry><entry thead="no"><para>Limited horizontal scaling of graph    </para>
</entry></row>
<row>
<entry thead="no"><para>Faster development   </para>
</entry><entry thead="no"><para>All components share runtime    </para>
</entry></row>
<row>
<entry thead="no"><para>Lower latency   </para>
</entry><entry thead="no"><para>Memory-bound capacity   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3982">
<title>5.3.2 Communication Pattern Decisions</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3983">
<title>Decision: REST/JSON over HTTP</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Criterion   </para>
</entry><entry thead="yes"><para>REST/JSON   </para>
</entry><entry thead="yes"><para>GraphQL   </para>
</entry><entry thead="yes"><para>gRPC    </para>
</entry></row>
<row>
<entry thead="no"><para>Client Compatibility   </para>
</entry><entry thead="no"><para>Universal   </para>
</entry><entry thead="no"><para>Requires client   </para>
</entry><entry thead="no"><para>Limited browser support    </para>
</entry></row>
<row>
<entry thead="no"><para>Documentation   </para>
</entry><entry thead="no"><para>Auto-generated OpenAPI   </para>
</entry><entry thead="no"><para>Schema introspection   </para>
</entry><entry thead="no"><para>Protobuf definitions    </para>
</entry></row>
<row>
<entry thead="no"><para>Caching   </para>
</entry><entry thead="no"><para>HTTP caching natural   </para>
</entry><entry thead="no"><para>Complex caching   </para>
</entry><entry thead="no"><para>Not applicable    </para>
</entry></row>
<row>
<entry thead="no"><para>Complexity   </para>
</entry><entry thead="no"><para>Low   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry><entry thead="no"><para>High   </para>
</entry></row>
</table>
</para>
<para><bold>Rationale</bold>:</para>
<para><itemizedlist>
<listitem><para>FastAPI provides automatic OpenAPI documentation generation</para>
</listitem><listitem><para>JSON serialization handles complex types (dates as ISO strings)</para>
</listitem><listitem><para>Pydantic models enforce type safety at API boundaries</para>
</listitem><listitem><para>Stateless request handling simplifies scaling</para>
</listitem></itemizedlist>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3984">
<title>5.3.3 Data Storage Decisions</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3985">
<title>Decision: In-Memory Graph with Optional Persistence</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>StorageOptions[Storage<sp/>Decision<sp/>Tree]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Start([Storage&lt;br/&gt;Requirement])<sp/>--&gt;<sp/>Scale{Expected&lt;br/&gt;Scale?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Scale<sp/>--&gt;|&quot;&lt;<sp/>500<sp/>nodes&quot;|<sp/>InMemory[In-Memory<sp/>Graph]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Scale<sp/>--&gt;|&quot;&gt;<sp/>500<sp/>nodes&quot;|<sp/>Persistence{Persistence&lt;br/&gt;Required?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Persistence<sp/>--&gt;|No|<sp/>InMemory</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Persistence<sp/>--&gt;|Yes|<sp/>Database[SQLAlchemy<sp/>+<sp/>PostgreSQL]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InMemory<sp/>--&gt;<sp/>CacheNeeded{Cache&lt;br/&gt;Needed?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CacheNeeded<sp/>--&gt;|Yes|<sp/>JSONCache[JSON<sp/>File<sp/>Cache]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CacheNeeded<sp/>--&gt;|No|<sp/>DirectUse[Direct<sp/>Use]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
<para><bold>Rationale</bold>:</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Storage Option   </para>
</entry><entry thead="yes"><para>Use Case   </para>
</entry><entry thead="yes"><para>Trade-off    </para>
</entry></row>
<row>
<entry thead="no"><para>In-Memory   </para>
</entry><entry thead="no"><para>Development, Small Datasets   </para>
</entry><entry thead="no"><para>Fast access, no persistence    </para>
</entry></row>
<row>
<entry thead="no"><para>JSON Cache   </para>
</entry><entry thead="no"><para>Startup optimization   </para>
</entry><entry thead="no"><para>Atomic writes, file I/O    </para>
</entry></row>
<row>
<entry thead="no"><para>SQLite   </para>
</entry><entry thead="no"><para>Authentication, Testing   </para>
</entry><entry thead="no"><para>Simple setup, single-writer    </para>
</entry></row>
<row>
<entry thead="no"><para>PostgreSQL   </para>
</entry><entry thead="no"><para>Production persistence   </para>
</entry><entry thead="no"><para>Scalable, connection pooling   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3986">
<title>5.3.4 Caching Strategy Decisions</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3987">
<title>Decision: Atomic JSON File Cache</title><para>The caching strategy uses atomic write operations to prevent data corruption:</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Phase   </para>
</entry><entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>Write to <computeroutput>NamedTemporaryFile</computeroutput>   </para>
</entry><entry thead="no"><para>Isolate incomplete writes    </para>
</entry></row>
<row>
<entry thead="no"><para>2   </para>
</entry><entry thead="no"><para>Flush and sync to disk   </para>
</entry><entry thead="no"><para>Ensure durability    </para>
</entry></row>
<row>
<entry thead="no"><para>3   </para>
</entry><entry thead="no"><para><computeroutput>os.replace()</computeroutput> atomic rename   </para>
</entry><entry thead="no"><para>Single atomic operation    </para>
</entry></row>
<row>
<entry thead="no"><para>4   </para>
</entry><entry thead="no"><para>Delete temp on failure   </para>
</entry><entry thead="no"><para>Clean up partial state   </para>
</entry></row>
</table>
</para>
<para><bold>Configuration Variables</bold>:</para>
<para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Variable   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Default    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>REAL_DATA_CACHE_PATH</computeroutput>   </para>
</entry><entry thead="no"><para>Yahoo Finance data cache   </para>
</entry><entry thead="no"><para>None (disabled)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GRAPH_CACHE_PATH</computeroutput>   </para>
</entry><entry thead="no"><para>Serialized graph cache   </para>
</entry><entry thead="no"><para>None (disabled)   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3988">
<title>5.3.5 Security Mechanism Decisions</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3989">
<title>Decision: JWT with HS256 and pbkdf2_sha256</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Security Layer   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Rationale    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Algorithm   </para>
</entry><entry thead="no"><para>HS256 (HMAC-SHA256)   </para>
</entry><entry thead="no"><para>Symmetric, fast, adequate for single-issuer    </para>
</entry></row>
<row>
<entry thead="no"><para>Password Hashing   </para>
</entry><entry thead="no"><para>pbkdf2_sha256   </para>
</entry><entry thead="no"><para>OWASP recommended, passlib integration    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Expiration   </para>
</entry><entry thead="no"><para>30 minutes   </para>
</entry><entry thead="no"><para>Balance security and usability    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limiting   </para>
</entry><entry thead="no"><para>slowapi per-endpoint   </para>
</entry><entry thead="no"><para>Prevent brute force attacks   </para>
</entry></row>
</table>
</para>
<para><bold>Security Configuration</bold>:</para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Source   </para>
</entry><entry thead="yes"><para>Default    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SECRET_KEY</computeroutput>   </para>
</entry><entry thead="no"><para>Environment variable   </para>
</entry><entry thead="no"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ALGORITHM</computeroutput>   </para>
</entry><entry thead="no"><para>Environment variable   </para>
</entry><entry thead="no"><para>HS256    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ACCESS_TOKEN_EXPIRE_MINUTES</computeroutput>   </para>
</entry><entry thead="no"><para>Code constant   </para>
</entry><entry thead="no"><para>30   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3991">
<title>5.4 CROSS-CUTTING CONCERNS</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3992">
<title>5.4.1 Monitoring and Observability</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3993">
<title>Logging Strategy</title><para><bold>Implementation</bold>: Python standard logging with INFO level default</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Log Point   </para>
</entry><entry thead="yes"><para>Level   </para>
</entry><entry thead="yes"><para>Content    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph initialization   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Success/failure status    </para>
</entry></row>
<row>
<entry thead="no"><para>Application startup   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Server binding, port    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache operations   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Load/save success    </para>
</entry></row>
<row>
<entry thead="no"><para>Request errors   </para>
</entry><entry thead="no"><para>ERROR   </para>
</entry><entry thead="no"><para>Exception details    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication failures   </para>
</entry><entry thead="no"><para>WARNING   </para>
</entry><entry thead="no"><para>Failed login attempts   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3994">
<title>Metrics Endpoints</title><para>The system exposes operational metrics through the <computeroutput>/api/metrics</computeroutput> endpoint:</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Metric   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Source    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>total_assets</computeroutput>   </para>
</entry><entry thead="no"><para>Count of nodes in graph   </para>
</entry><entry thead="no"><para><computeroutput>len(graph.assets)</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>total_relationships</computeroutput>   </para>
</entry><entry thead="no"><para>Count of edges   </para>
</entry><entry thead="no"><para>Sum of adjacency lists    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>average_degree</computeroutput>   </para>
</entry><entry thead="no"><para>Mean connections per node   </para>
</entry><entry thead="no"><para>Calculated statistic    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>max_degree</computeroutput>   </para>
</entry><entry thead="no"><para>Highest connected node   </para>
</entry><entry thead="no"><para>Maximum adjacency count    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>network_density</computeroutput>   </para>
</entry><entry thead="no"><para>Edge ratio   </para>
</entry><entry thead="no"><para>Actual/possible edges   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3995">
<title>Health Check</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Response   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/health</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>{&quot;status&quot;: &quot;healthy&quot;}</computeroutput>   </para>
</entry><entry thead="no"><para>Load balancer probe    </para>
</entry></row>
<row>
<entry thead="no"><para>Docker HEALTHCHECK   </para>
</entry><entry thead="no"><para>HTTP probe every 30s   </para>
</entry><entry thead="no"><para>Container orchestration   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3996">
<title>5.4.2 Error Handling Patterns</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3997">
<title>API Error Categories</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Status Code   </para>
</entry><entry thead="yes"><para>Scenario   </para>
</entry><entry thead="yes"><para>Response Detail    </para>
</entry></row>
<row>
<entry thead="no"><para>400   </para>
</entry><entry thead="no"><para>Bad Request   </para>
</entry><entry thead="no"><para>Inactive user, invalid input    </para>
</entry></row>
<row>
<entry thead="no"><para>401   </para>
</entry><entry thead="no"><para>Unauthorized   </para>
</entry><entry thead="no"><para>Invalid/expired token, missing credentials    </para>
</entry></row>
<row>
<entry thead="no"><para>404   </para>
</entry><entry thead="no"><para>Not Found   </para>
</entry><entry thead="no"><para>Asset/resource not found    </para>
</entry></row>
<row>
<entry thead="no"><para>422   </para>
</entry><entry thead="no"><para>Validation Error   </para>
</entry><entry thead="no"><para>Pydantic validation failure    </para>
</entry></row>
<row>
<entry thead="no"><para>429   </para>
</entry><entry thead="no"><para>Too Many Requests   </para>
</entry><entry thead="no"><para>Rate limit exceeded    </para>
</entry></row>
<row>
<entry thead="no"><para>500   </para>
</entry><entry thead="no"><para>Internal Error   </para>
</entry><entry thead="no"><para>Unexpected exception   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3998">
<title>Error Handling Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ErrorHandling[Error<sp/>Handling<sp/>Flow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error([Error<sp/>Occurs])<sp/>--&gt;<sp/>ErrorType{Error<sp/>Type}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorType<sp/>--&gt;|HTTPException|<sp/>HTTPHandle[Return<sp/>HTTP<sp/>Status]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HTTPHandle<sp/>--&gt;<sp/>Status401{401?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Status401<sp/>--&gt;|Yes|<sp/>AddWWW[Add<sp/>WWW-Authenticate<sp/>Header]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Status401<sp/>--&gt;|No|<sp/>ReturnDetail[Return<sp/>Error<sp/>Detail]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AddWWW<sp/>--&gt;<sp/>ReturnDetail</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorType<sp/>--&gt;|Rate<sp/>Limit|<sp/>RateHandle[429<sp/>+<sp/>Retry-After]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorType<sp/>--&gt;|Validation|<sp/>ValHandle[422<sp/>+<sp/>Pydantic<sp/>Details]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorType<sp/>--&gt;|Unexpected|<sp/>UnexpHandle[Log<sp/>Exception]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UnexpHandle<sp/>--&gt;<sp/>Return500[500<sp/>Internal<sp/>Error]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReturnDetail<sp/>--&gt;<sp/>Done([Response<sp/>Sent])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateHandle<sp/>--&gt;<sp/>Done</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ValHandle<sp/>--&gt;<sp/>Done</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return500<sp/>--&gt;<sp/>Done</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md3999">
<title>Graph Initialization Error Handling</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Error Source   </para>
</entry><entry thead="yes"><para>Recovery Action   </para>
</entry><entry thead="yes"><para>Fallback    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache load failed   </para>
</entry><entry thead="no"><para>Proceed to fresh fetch   </para>
</entry><entry thead="no"><para>Standard initialization    </para>
</entry></row>
<row>
<entry thead="no"><para>Network disabled   </para>
</entry><entry thead="no"><para>Use sample data   </para>
</entry><entry thead="no"><para>Offline mode    </para>
</entry></row>
<row>
<entry thead="no"><para>Yahoo Finance error   </para>
</entry><entry thead="no"><para>Check partial data   </para>
</entry><entry thead="no"><para>Sample data fallback    </para>
</entry></row>
<row>
<entry thead="no"><para>Critical failure   </para>
</entry><entry thead="no"><para>Abort startup   </para>
</entry><entry thead="no"><para>Application exit   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4000">
<title>Frontend Error Recovery</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Error Category   </para>
</entry><entry thead="yes"><para>User Feedback   </para>
</entry><entry thead="yes"><para>Recovery Option    </para>
</entry></row>
<row>
<entry thead="no"><para>Network Error   </para>
</entry><entry thead="no"><para>&quot;Unable to connect&quot;   </para>
</entry><entry thead="no"><para>Retry button    </para>
</entry></row>
<row>
<entry thead="no"><para>API Error   </para>
</entry><entry thead="no"><para>Error message display   </para>
</entry><entry thead="no"><para>Retry button    </para>
</entry></row>
<row>
<entry thead="no"><para>Render Error   </para>
</entry><entry thead="no"><para>Display error state   </para>
</entry><entry thead="no"><para>Refresh page   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4001">
<title>5.4.3 Authentication and Authorization Framework</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4002">
<title>Token Flow Sequence</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Client<sp/>as<sp/>API<sp/>Client</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Rate<sp/>as<sp/>Rate<sp/>Limiter</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Auth<sp/>as<sp/>Auth<sp/>Module</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Repo<sp/>as<sp/>User<sp/>Repository</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>JWT<sp/>as<sp/>JWT<sp/>Library</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Client-&gt;&gt;Rate:<sp/>POST<sp/>/token<sp/>(credentials)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Rate-&gt;&gt;Rate:<sp/>Check<sp/>5/min<sp/>limit</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>alt<sp/>Within<sp/>Limit</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Rate-&gt;&gt;Auth:<sp/>Process<sp/>Login</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;Repo:<sp/>get_user(username)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Repo--&gt;&gt;Auth:<sp/>User<sp/>or<sp/>None</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alt<sp/>User<sp/>Found</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;Auth:<sp/>verify_password()</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alt<sp/>Password<sp/>Valid</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;Auth:<sp/>Check<sp/>user<sp/>active</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;JWT:<sp/>encode(payload,<sp/>SECRET_KEY)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JWT--&gt;&gt;Auth:<sp/>Access<sp/>Token</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth--&gt;&gt;Client:<sp/>{access_token,<sp/>token_type:<sp/>bearer}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>Invalid</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth--&gt;&gt;Client:<sp/>401<sp/>Unauthorized</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>Not<sp/>Found</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth--&gt;&gt;Client:<sp/>401<sp/>Unauthorized</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else<sp/>Exceeded</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Rate--&gt;&gt;Client:<sp/>429<sp/>Too<sp/>Many<sp/>Requests</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4003">
<title>Protected Endpoint Validation</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Step   </para>
</entry><entry thead="yes"><para>Action   </para>
</entry><entry thead="yes"><para>Failure Response    </para>
</entry></row>
<row>
<entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>Extract Bearer token from header   </para>
</entry><entry thead="no"><para>401 Not authenticated    </para>
</entry></row>
<row>
<entry thead="no"><para>2   </para>
</entry><entry thead="no"><para>Decode JWT with SECRET_KEY   </para>
</entry><entry thead="no"><para>401 Could not validate    </para>
</entry></row>
<row>
<entry thead="no"><para>3   </para>
</entry><entry thead="no"><para>Check token expiration   </para>
</entry><entry thead="no"><para>401 Token expired    </para>
</entry></row>
<row>
<entry thead="no"><para>4   </para>
</entry><entry thead="no"><para>Lookup user in repository   </para>
</entry><entry thead="no"><para>401 Invalid credentials    </para>
</entry></row>
<row>
<entry thead="no"><para>5   </para>
</entry><entry thead="no"><para>Verify user is active   </para>
</entry><entry thead="no"><para>400 Inactive user   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4004">
<title>5.4.4 Performance Requirements and SLAs</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4005">
<title>Performance Targets</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Target SLA   </para>
</entry><entry thead="yes"><para>Measurement    </para>
</entry></row>
<row>
<entry thead="no"><para>API Response (p95)   </para>
</entry><entry thead="no"><para>&lt; 500ms   </para>
</entry><entry thead="no"><para>Request to response    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Rendering   </para>
</entry><entry thead="no"><para>&lt; 2 seconds   </para>
</entry><entry thead="no"><para>Data load to interactive    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Generation   </para>
</entry><entry thead="no"><para>&lt; 100ms   </para>
</entry><entry thead="no"><para>Credential to token    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Initialization   </para>
</entry><entry thead="no"><para>&lt; 3 seconds   </para>
</entry><entry thead="no"><para>Application startup    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Discovery   </para>
</entry><entry thead="no"><para>&lt; 500ms   </para>
</entry><entry thead="no"><para>For 100 assets    </para>
</entry></row>
<row>
<entry thead="no"><para>Initial Page Load   </para>
</entry><entry thead="no"><para>&lt; 3 seconds   </para>
</entry><entry thead="no"><para>Navigation to interactive   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4006">
<title>Rate Limiting Configuration</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Limit   </para>
</entry><entry thead="yes"><para>Window   </para>
</entry><entry thead="yes"><para>Key Function    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>POST /token</computeroutput>   </para>
</entry><entry thead="no"><para>5 requests   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Client IP    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GET /api/users/me</computeroutput>   </para>
</entry><entry thead="no"><para>10 requests   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Client IP    </para>
</entry></row>
<row>
<entry thead="no"><para>Other endpoints   </para>
</entry><entry thead="no"><para>Unlimited   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4007">
<title>Timeout Configuration</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Timeout   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>JWT Token   </para>
</entry><entry thead="no"><para>30 minutes   </para>
</entry><entry thead="no"><para>Session expiration    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limit Window   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Request counting period    </para>
</entry></row>
<row>
<entry thead="no"><para>HTTP Client   </para>
</entry><entry thead="no"><para>30 seconds   </para>
</entry><entry thead="no"><para>API request timeout    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Check   </para>
</entry><entry thead="no"><para>30 seconds   </para>
</entry><entry thead="no"><para>Container probe interval   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4008">
<title>5.4.5 CORS Configuration</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Environment   </para>
</entry><entry thead="yes"><para>Allowed Origins   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Development   </para>
</entry><entry thead="no"><para><computeroutput><ulink url="http://localhost:3000">http://localhost:3000</ulink></computeroutput>, <computeroutput><ulink url="http://localhost:7860">http://localhost:7860</ulink></computeroutput>   </para>
</entry><entry thead="no"><para>Hardcoded    </para>
</entry></row>
<row>
<entry thead="no"><para>Production   </para>
</entry><entry thead="no"><para>HTTPS origins only   </para>
</entry><entry thead="no"><para>Environment variable    </para>
</entry></row>
<row>
<entry thead="no"><para>Custom   </para>
</entry><entry thead="no"><para>Comma-separated list   </para>
</entry><entry thead="no"><para><computeroutput>ALLOWED_ORIGINS</computeroutput>   </para>
</entry></row>
</table>
</para>
<para><bold>Security Notes</bold>:</para>
<para><itemizedlist>
<listitem><para>Wildcard (<computeroutput>*</computeroutput>) origins are prohibited when authentication headers are used</para>
</listitem><listitem><para>Vercel preview domains validated via regex pattern matching</para>
</listitem><listitem><para>CORS configuration should be reviewed when promoting to production</para>
</listitem></itemizedlist>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4009">
<title>5.4.6 Disaster Recovery Procedures</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4010">
<title>Recovery Scenarios</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Scenario   </para>
</entry><entry thead="yes"><para>Detection   </para>
</entry><entry thead="yes"><para>Recovery Action    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph corruption   </para>
</entry><entry thead="no"><para>Validation failure   </para>
</entry><entry thead="no"><para>Clear cache, reinitialize    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache file corruption   </para>
</entry><entry thead="no"><para>JSON parse error   </para>
</entry><entry thead="no"><para>Delete cache, fresh fetch    </para>
</entry></row>
<row>
<entry thead="no"><para>Database unavailable   </para>
</entry><entry thead="no"><para>Connection timeout   </para>
</entry><entry thead="no"><para>Retry with exponential backoff    </para>
</entry></row>
<row>
<entry thead="no"><para>Yahoo Finance outage   </para>
</entry><entry thead="no"><para>Request timeout   </para>
</entry><entry thead="no"><para>Fall back to sample data    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication failure   </para>
</entry><entry thead="no"><para>JWT decode error   </para>
</entry><entry thead="no"><para>Re-authenticate user   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4011">
<title>Data Recovery Priority</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Priority   </para>
</entry><entry thead="yes"><para>Data   </para>
</entry><entry thead="yes"><para>Recovery Source    </para>
</entry></row>
<row>
<entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>User credentials   </para>
</entry><entry thead="no"><para>SQLite backup    </para>
</entry></row>
<row>
<entry thead="no"><para>2   </para>
</entry><entry thead="no"><para>Graph state   </para>
</entry><entry thead="no"><para>Cache file or Yahoo Finance    </para>
</entry></row>
<row>
<entry thead="no"><para>3   </para>
</entry><entry thead="no"><para>Session state   </para>
</entry><entry thead="no"><para>Stateless (no recovery needed)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4013">
<title>5.5 DEPLOYMENT ARCHITECTURE</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4014">
<title>5.5.1 Local Development</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Command   </para>
</entry><entry thead="yes"><para>Port   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>FastAPI Backend   </para>
</entry><entry thead="no"><para><computeroutput>uvicorn <ref refid="namespaceapi_1_1main" kindref="compound">api.main</ref>:app --reload --port 8000</computeroutput>   </para>
</entry><entry thead="no"><para>8000   </para>
</entry><entry thead="no"><para>API development    </para>
</entry></row>
<row>
<entry thead="no"><para>Next.js Frontend   </para>
</entry><entry thead="no"><para><computeroutput>cd frontend &amp;&amp; npm run dev</computeroutput>   </para>
</entry><entry thead="no"><para>3000   </para>
</entry><entry thead="no"><para>UI development    </para>
</entry></row>
<row>
<entry thead="no"><para>Gradio UI   </para>
</entry><entry thead="no"><para><computeroutput>python <ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>7860   </para>
</entry><entry thead="no"><para>Legacy interface   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4015">
<title>5.5.2 Docker Deployment</title><para><bold><ref refid="classBase" kindref="compound">Base</ref> Configuration</bold> (from <computeroutput>Dockerfile</computeroutput>):</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><ref refid="classBase" kindref="compound">Base</ref> Image   </para>
</entry><entry thead="no"><para><computeroutput>python:3.11-slim</computeroutput>   </para>
</entry><entry thead="no"><para>Minimal Python runtime    </para>
</entry></row>
<row>
<entry thead="no"><para>Working Directory   </para>
</entry><entry thead="no"><para><computeroutput>/app</computeroutput>   </para>
</entry><entry thead="no"><para>Application root    </para>
</entry></row>
<row>
<entry thead="no"><para>User   </para>
</entry><entry thead="no"><para><computeroutput>appuser</computeroutput> (UID 1000)   </para>
</entry><entry thead="no"><para>Non-root security    </para>
</entry></row>
<row>
<entry thead="no"><para>Exposed Port   </para>
</entry><entry thead="no"><para>7860   </para>
</entry><entry thead="no"><para>Gradio default    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Check   </para>
</entry><entry thead="no"><para>HTTP probe every 30s   </para>
</entry><entry thead="no"><para>Container health   </para>
</entry></row>
</table>
</para>
<para><bold>Docker Compose</bold> (from <computeroutput>docker-compose.yml</computeroutput>):</para>
<para><table rows="2" cols="4"><row>
<entry thead="yes"><para>Service   </para>
</entry><entry thead="yes"><para>Ports   </para>
</entry><entry thead="yes"><para>Volumes   </para>
</entry><entry thead="yes"><para>Restart Policy    </para>
</entry></row>
<row>
<entry thead="no"><para>app   </para>
</entry><entry thead="no"><para>7860:7860   </para>
</entry><entry thead="no"><para><computeroutput>./src:/app/src</computeroutput>, <computeroutput>./data:/app/data</computeroutput>   </para>
</entry><entry thead="no"><para>unless-stopped   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4016">
<title>5.5.3 Vercel Serverless</title><para><bold>Build Configuration</bold> (from <computeroutput>vercel.json</computeroutput>):</para>
<para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Builder   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Backend   </para>
</entry><entry thead="no"><para><computeroutput>@vercel/python</computeroutput>   </para>
</entry><entry thead="no"><para>maxLambdaSize: 50mb    </para>
</entry></row>
<row>
<entry thead="no"><para>Frontend   </para>
</entry><entry thead="no"><para><computeroutput>@vercel/next</computeroutput>   </para>
</entry><entry thead="no"><para>Default Next.js settings   </para>
</entry></row>
</table>
</para>
<para><bold>Route Configuration</bold>:</para>
<para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Pattern   </para>
</entry><entry thead="yes"><para>Destination   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/(.*)</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Backend API routes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/(.*)</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/$1</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend static/SSR   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4017">
<title>5.5.4 Deployment Architecture Diagram</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Local[Local<sp/>Development]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFE[Next.js&lt;br/&gt;:3000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalAPI[FastAPI&lt;br/&gt;:8000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalGradio[Gradio&lt;br/&gt;:7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Docker[Docker<sp/>Deployment]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerApp[app<sp/>container&lt;br/&gt;:7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerVol[(Volumes)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerApp<sp/>--&gt;<sp/>DockerVol</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Vercel[Vercel<sp/>Serverless]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelEdge[Edge<sp/>Network]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelLambda[Python<sp/>Lambda]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelNext[Next.js<sp/>SSR]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelEdge<sp/>--&gt;<sp/>VercelLambda</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelEdge<sp/>--&gt;<sp/>VercelNext</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users([Users])<sp/>--&gt;<sp/>Local</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users<sp/>--&gt;<sp/>Docker</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users<sp/>--&gt;<sp/>Vercel</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4019">
<title>5.6 DATABASE SCHEMA</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4020">
<title>5.6.1 Schema Overview</title><para>The database schema (from <computeroutput>migrations/001_initial.sql</computeroutput>) defines four tables for optional persistence:</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Table   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Primary Key    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>assets</computeroutput>   </para>
</entry><entry thead="no"><para>Financial instrument storage   </para>
</entry><entry thead="no"><para><computeroutput>id</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_relationships</computeroutput>   </para>
</entry><entry thead="no"><para>Relationship edges   </para>
</entry><entry thead="no"><para><computeroutput>source_id, target_id, relationship_type</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_events</computeroutput>   </para>
</entry><entry thead="no"><para>Event records   </para>
</entry><entry thead="no"><para><computeroutput>id</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_event_assets</computeroutput>   </para>
</entry><entry thead="no"><para>Event-asset junction   </para>
</entry><entry thead="no"><para><computeroutput>event_id, asset_id</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4021">
<title>5.6.2 Entity Relationships</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">erDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>assets<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>id<sp/>PK</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>symbol</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>name</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>asset_class</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>sector</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float<sp/>price</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float<sp/>market_cap</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>currency</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>asset_relationships<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>source_id<sp/>FK</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>target_id<sp/>FK</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>relationship_type</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float<sp/>strength</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>regulatory_events<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>id<sp/>PK</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>event_type</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>date<sp/>date</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>description</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float<sp/>impact_score</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>regulatory_event_assets<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>event_id<sp/>FK</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>asset_id<sp/>FK</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>assets<sp/>||--o{<sp/>asset_relationships<sp/>:<sp/>&quot;source&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>assets<sp/>||--o{<sp/>asset_relationships<sp/>:<sp/>&quot;target&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>assets<sp/>||--o{<sp/>regulatory_event_assets<sp/>:<sp/>&quot;affected_by&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>regulatory_events<sp/>||--o{<sp/>regulatory_event_assets<sp/>:<sp/>&quot;affects&quot;</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4022">
<title>5.6.3 Cascade Behavior</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Parent Deletion   </para>
</entry><entry thead="yes"><para>Cascade Target   </para>
</entry><entry thead="yes"><para>Behavior    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset   </para>
</entry><entry thead="no"><para>asset_relationships   </para>
</entry><entry thead="no"><para>Delete related edges    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset   </para>
</entry><entry thead="no"><para>regulatory_event_assets   </para>
</entry><entry thead="no"><para>Remove junction entries    </para>
</entry></row>
<row>
<entry thead="no"><para>Regulatory Event   </para>
</entry><entry thead="no"><para>regulatory_event_assets   </para>
</entry><entry thead="no"><para>Remove junction entries   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4024">
<title>5.7 References</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4025_1s3"><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4025">
<title>Files Examined</title><para><itemizedlist>
<listitem><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput> - FastAPI application, routing, CORS, rate limiting, graph lifecycle</para>
</listitem><listitem><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput> - JWT authentication, password verification, user repository</para>
</listitem><listitem><para><computeroutput><ref refid="api_2database_8py" kindref="compound">api/database.py</ref></computeroutput> - SQLite connection management for authentication</para>
</listitem><listitem><para><computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput> - Gradio UI entry point with tabbed interface</para>
</listitem><listitem><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput> - Core graph container class, relationship storage</para>
</listitem><listitem><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput> - Domain model dataclasses, enums, validation</para>
</listitem><listitem><para><computeroutput><ref refid="sample__data_8py" kindref="compound">src/data/sample_data.py</ref></computeroutput> - Sample database generator</para>
</listitem><listitem><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput> - Yahoo Finance integration, caching</para>
</listitem><listitem><para><computeroutput><ref refid="repository_8py" kindref="compound">src/data/repository.py</ref></computeroutput> - SQLAlchemy repository pattern</para>
</listitem><listitem><para><computeroutput><ref refid="db__models_8py" kindref="compound">src/data/db_models.py</ref></computeroutput> - ORM model definitions</para>
</listitem><listitem><para><computeroutput><ref refid="graph__visuals_8py" kindref="compound">src/visualizations/graph_visuals.py</ref></computeroutput> - 3D Plotly visualization</para>
</listitem><listitem><para><computeroutput><ref refid="graph__2d__visuals_8py" kindref="compound">src/visualizations/graph_2d_visuals.py</ref></computeroutput> - 2D Plotly visualization</para>
</listitem><listitem><para><computeroutput><ref refid="metric__visuals_8py" kindref="compound">src/visualizations/metric_visuals.py</ref></computeroutput> - Metrics dashboard charts</para>
</listitem><listitem><para><computeroutput><ref refid="schema__report_8py" kindref="compound">src/reports/schema_report.py</ref></computeroutput> - Schema documentation generator</para>
</listitem><listitem><para><computeroutput>frontend/app/page.tsx</computeroutput> - Next.js home page component</para>
</listitem><listitem><para><computeroutput>frontend/app/lib/api.ts</computeroutput> - API client with Axios</para>
</listitem><listitem><para><computeroutput>frontend/app/components/NetworkVisualization.tsx</computeroutput> - 3D visualization component</para>
</listitem><listitem><para><computeroutput>frontend/app/components/MetricsDashboard.tsx</computeroutput> - Metrics display component</para>
</listitem><listitem><para><computeroutput>frontend/app/components/AssetList.tsx</computeroutput> - Asset table component</para>
</listitem><listitem><para><computeroutput>vercel.json</computeroutput> - Vercel deployment configuration</para>
</listitem><listitem><para><computeroutput>Dockerfile</computeroutput> - Container definition</para>
</listitem><listitem><para><computeroutput>docker-compose.yml</computeroutput> - Container orchestration</para>
</listitem><listitem><para><computeroutput>migrations/001_initial.sql</computeroutput> - Database schema definition</para>
</listitem><listitem><para><computeroutput>requirements.txt</computeroutput> - Python dependencies</para>
</listitem></itemizedlist>
</para>
</sect4></sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4026_1s3"><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4026">
<title>Folders Explored</title><para><itemizedlist>
<listitem><para><computeroutput>api/</computeroutput> - Backend API layer</para>
</listitem><listitem><para><computeroutput>src/logic/</computeroutput> - Core graph logic</para>
</listitem><listitem><para><computeroutput>src/models/</computeroutput> - Domain model definitions</para>
</listitem><listitem><para><computeroutput>src/data/</computeroutput> - Data layer components</para>
</listitem><listitem><para><computeroutput>src/visualizations/</computeroutput> - Visualization utilities</para>
</listitem><listitem><para><computeroutput>src/reports/</computeroutput> - Report generation</para>
</listitem><listitem><para><computeroutput>frontend/</computeroutput> - Next.js application</para>
</listitem><listitem><para><computeroutput>frontend/app/</computeroutput> - App Router source</para>
</listitem><listitem><para><computeroutput>frontend/app/components/</computeroutput> - React components</para>
</listitem><listitem><para><computeroutput>tests/</computeroutput> - Test harness</para>
</listitem></itemizedlist>
</para>
</sect4></sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4027_1s3"><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4027">
<title>Technical Specification Sections Referenced</title><para><itemizedlist>
<listitem><para>1.2 System Overview</para>
</listitem><listitem><para>3.1 Technology Stack Overview</para>
</listitem><listitem><para>3.6 Databases &amp; Storage</para>
</listitem><listitem><para>3.7 Development &amp; Deployment</para>
</listitem><listitem><para>3.8 Security Considerations</para>
</listitem><listitem><para>3.9 Integration Requirements</para>
</listitem><listitem><para>4.1 High-Level System Workflow</para>
</listitem><listitem><para>4.2 Core Business Process Flows</para>
</listitem><listitem><para>4.3 API Request Workflows</para>
</listitem><listitem><para>4.4 Frontend Workflows</para>
</listitem><listitem><para>4.5 Error Handling Workflows</para>
</listitem><listitem><para>4.6 Integration Sequence Diagrams</para>
</listitem><listitem><para>4.7 State Transition Diagrams</para>
</listitem><listitem><para>4.8 Timing and SLA Considerations</para>
</listitem></itemizedlist>
</para>
</sect4></sect3>
</sect2>
</sect1>
<sect1 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4028">
<title>6. SYSTEM COMPONENTS DESIGN</title><sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4029">
<title>6.1 Core Services Architecture</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4030_1s3"><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4030">
<title>SERVICES ARCHITECTURE</title></sect4></sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4031">
<title>6.1 Core Services Architecture</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4032">
<title>6.1.1 Architecture Classification Statement</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4033">
<title>Applicability Determination</title><para><bold>Core Services Architecture is not applicable for this system in the traditional microservices sense.</bold> The Financial Asset Relationship Database is explicitly designed as a <bold>monolithic layered architecture</bold> with a single deployable Python process, not as a distributed microservices system.</para>
<para>This architectural decision is documented and intentional, based on the following rationale:</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Evaluation Criteria   </para>
</entry><entry thead="yes"><para>System Characteristic   </para>
</entry><entry thead="yes"><para>Microservices Applicability    </para>
</entry></row>
<row>
<entry thead="no"><para>Deployment Model   </para>
</entry><entry thead="no"><para>Single Python process   </para>
</entry><entry thead="no"><para>Not Applicable    </para>
</entry></row>
<row>
<entry thead="no"><para>Service Decomposition   </para>
</entry><entry thead="no"><para>Modular packages within monolith   </para>
</entry><entry thead="no"><para>Not Applicable    </para>
</entry></row>
<row>
<entry thead="no"><para>Inter-Service Communication   </para>
</entry><entry thead="no"><para>Direct Python function calls   </para>
</entry><entry thead="no"><para>Not Applicable    </para>
</entry></row>
<row>
<entry thead="no"><para>Service Discovery   </para>
</entry><entry thead="no"><para>No distributed services to discover   </para>
</entry><entry thead="no"><para>Not Applicable    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Management   </para>
</entry><entry thead="no"><para>Shared in-memory graph singleton   </para>
</entry><entry thead="no"><para>Not Applicable   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4034">
<title>Explicit Architectural Decision</title><para>The technical specification documents this as a deliberate design choice:</para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Aspect   </para>
</entry><entry thead="yes"><para>Choice   </para>
</entry><entry thead="yes"><para>Alternatives Considered    </para>
</entry></row>
<row>
<entry thead="no"><para>Deployment Model   </para>
</entry><entry thead="no"><para><bold>Monolithic</bold>   </para>
</entry><entry thead="no"><para>Microservices, Serverless-only    </para>
</entry></row>
<row>
<entry thead="no"><para>API Design   </para>
</entry><entry thead="no"><para>REST/JSON   </para>
</entry><entry thead="no"><para>GraphQL, gRPC    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Storage   </para>
</entry><entry thead="no"><para>In-memory with optional persistence   </para>
</entry><entry thead="no"><para>Database-first, Event-sourced   </para>
</entry></row>
</table>
</para>
<para><bold>Documented Rationale from Architecture Decision Records:</bold></para>
<para><itemizedlist>
<listitem><para>Single Python process reduces operational complexity for current scale</para>
</listitem><listitem><para>Module boundaries enable future microservices migration if needed</para>
</listitem><listitem><para>Dataset size (&lt;500 assets) fits comfortably in memory with sub-millisecond access</para>
</listitem><listitem><para>Same codebase deploys to Docker, Vercel, and local development environments</para>
</listitem></itemizedlist>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4035">
<title>6.1.2 Monolithic Architecture Overview</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4036">
<title>Layered Architecture Design</title><para>Instead of service decomposition, the system implements a **four-layer architecture** with clear separation of concerns within a single process:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>MonolithicArchitecture[Monolithic<sp/>Layered<sp/>Architecture]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>PresentationLayer[Presentation<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextJS[Next.js<sp/>Frontend&lt;br/&gt;Port<sp/>3000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GradioUI[Gradio<sp/>UI&lt;br/&gt;Port<sp/>7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>APILayer[API<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPIApp[FastAPI<sp/>Backend&lt;br/&gt;Port<sp/>8000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AuthModule[Auth<sp/>Module]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimiter[Rate<sp/>Limiter]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORSMiddleware[CORS<sp/>Middleware]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>BusinessLayer[Business<sp/>Logic<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphEngine[Asset<sp/>Graph<sp/>Engine]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DomainModels[Domain<sp/>Models]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VizModule[Visualization<sp/>Module]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MetricsCalc[Metrics<sp/>Calculator]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>DataLayer[Data<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SampleGen[Sample<sp/>Data<sp/>Generator]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RealFetcher[Real<sp/>Data<sp/>Fetcher]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JSONCache[JSON<sp/>File<sp/>Cache]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLiteDB[SQLite<sp/>Auth<sp/>DB]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NextJS<sp/>--&gt;<sp/>FastAPIApp</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GradioUI<sp/>--&gt;<sp/>GraphEngine</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPIApp<sp/>--&gt;<sp/>CORSMiddleware</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CORSMiddleware<sp/>--&gt;<sp/>RateLimiter</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RateLimiter<sp/>--&gt;<sp/>AuthModule</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AuthModule<sp/>--&gt;<sp/>GraphEngine</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphEngine<sp/>--&gt;<sp/>DomainModels</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphEngine<sp/>--&gt;<sp/>VizModule</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphEngine<sp/>--&gt;<sp/>MetricsCalc</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphEngine<sp/>--&gt;<sp/>SampleGen</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphEngine<sp/>--&gt;<sp/>RealFetcher</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RealFetcher<sp/>--&gt;<sp/>JSONCache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AuthModule<sp/>--&gt;<sp/>SQLiteDB</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4037">
<title>Layer Responsibilities</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Layer   </para>
</entry><entry thead="yes"><para>Components   </para>
</entry><entry thead="yes"><para>Responsibility   </para>
</entry><entry thead="yes"><para>Communication Pattern    </para>
</entry></row>
<row>
<entry thead="no"><para>Presentation   </para>
</entry><entry thead="no"><para>Next.js, Gradio   </para>
</entry><entry thead="no"><para>User interface rendering   </para>
</entry><entry thead="no"><para>HTTP to API, Direct Python calls    </para>
</entry></row>
<row>
<entry thead="no"><para>API   </para>
</entry><entry thead="no"><para>FastAPI, Auth, Rate Limiter   </para>
</entry><entry thead="no"><para>Request routing, security enforcement   </para>
</entry><entry thead="no"><para>Direct Python imports    </para>
</entry></row>
<row>
<entry thead="no"><para>Business Logic   </para>
</entry><entry thead="no"><para>Graph Engine, Models, Visualization   </para>
</entry><entry thead="no"><para>Core domain logic, calculations   </para>
</entry><entry thead="no"><para>Direct Python function calls    </para>
</entry></row>
<row>
<entry thead="no"><para>Data   </para>
</entry><entry thead="no"><para>Fetcher, Cache, SQLite   </para>
</entry><entry thead="no"><para>Data persistence and retrieval   </para>
</entry><entry thead="no"><para>File I/O, SQL queries   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4038">
<title>6.1.3 Modular Package Structure</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4039">
<title>Package Organization (Alternative to Services)</title><para>While the system does not use microservices, it maintains clean modular boundaries through Python packages that could theoretically be extracted into services in the future:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>PackageStructure[Modular<sp/>Package<sp/>Organization]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>APIPackage[api/<sp/>Package]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MainPy[main.py&lt;br/&gt;FastAPI<sp/>App]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AuthPy[auth.py&lt;br/&gt;JWT<sp/>Handler]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DatabasePy[database.py&lt;br/&gt;User<sp/>Store]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>SrcPackage[src/<sp/>Package]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>LogicPkg[logic/]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AssetGraph[asset_graph.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>ModelsPkg[models/]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FinModels[financial_models.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>DataPkg[data/]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RealFetch[real_data_fetcher.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SampleData[sample_database.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>VizPkg[visualizations/]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph3D[graph_visuals.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Metrics[metric_visuals.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>ReportsPkg[reports/]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SchemaRpt[schema_report.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>FrontendPkg[frontend/<sp/>Package]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextApp[Next.js<sp/>Application]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Components[React<sp/>Components]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>APIClient[Axios<sp/>API<sp/>Client]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>APIPackage<sp/>--&gt;<sp/>SrcPackage</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FrontendPkg<sp/>--&gt;<sp/>APIPackage</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4040">
<title>Module Boundary Definitions</title><para><table rows="7" cols="4"><row>
<entry thead="yes"><para>Module   </para>
</entry><entry thead="yes"><para>Location   </para>
</entry><entry thead="yes"><para>Future Service Potential   </para>
</entry><entry thead="yes"><para>Dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Engine   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Graph Service   </para>
</entry><entry thead="no"><para>Domain Models only    </para>
</entry></row>
<row>
<entry thead="no"><para>Domain Models   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Shared Library   </para>
</entry><entry thead="no"><para>Python stdlib    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Fetcher   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Data Ingestion Service   </para>
</entry><entry thead="no"><para>yfinance, cache    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization   </para>
</entry><entry thead="no"><para><computeroutput>src/visualizations/</computeroutput>   </para>
</entry><entry thead="no"><para>Rendering Service   </para>
</entry><entry thead="no"><para>Plotly, Graph Engine    </para>
</entry></row>
<row>
<entry thead="no"><para>Auth Module   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Auth Service   </para>
</entry><entry thead="no"><para>PyJWT, passlib    </para>
</entry></row>
<row>
<entry thead="no"><para>API Gateway   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>API Gateway   </para>
</entry><entry thead="no"><para>All modules   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4041">
<title>6.1.4 Communication Patterns Within Monolith</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4042">
<title>Internal Communication</title><para>Since all components run within a single Python process, communication uses direct function calls rather than network protocols:</para>
<para>| Source | Target | Pattern | Example | | ------------<mdash/> | -----------------<mdash/> | --------------------------------------------<mdash/> | ----<mdash/> | | FastAPI → Graph | Direct import | <computeroutput>from src.logic.asset_graph import get_graph()</computeroutput> | | Gradio → Graph | Direct import | <computeroutput>graph.get_assets()</computeroutput> | | Graph → Models | Direct instantiation | <computeroutput>Asset(id=..., symbol=...)</computeroutput> | | Graph → Fetcher | Direct call | <computeroutput>fetcher.fetch_real_data()</computeroutput> | | API → Auth | Direct call | <computeroutput>authenticate_user(username, password)</computeroutput> |</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4043">
<title>External Communication</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Interface   </para>
</entry><entry thead="yes"><para>Protocol   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Frontend → API   </para>
</entry><entry thead="no"><para>REST/JSON over HTTP   </para>
</entry><entry thead="no"><para>Client-server communication   </para>
</entry><entry thead="no"><para><computeroutput>NEXT_PUBLIC_API_URL</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>API → Yahoo Finance   </para>
</entry><entry thead="no"><para>HTTP via yfinance   </para>
</entry><entry thead="no"><para>External data fetching   </para>
</entry><entry thead="no"><para><computeroutput>USE_REAL_DATA_FETCHER</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>API → SQLite   </para>
</entry><entry thead="no"><para>SQL via sqlite3   </para>
</entry><entry thead="no"><para>Authentication persistence   </para>
</entry><entry thead="no"><para><computeroutput>DATABASE_URL</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4044">
<title>6.1.5 Thread-Safe Singleton Pattern</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4045">
<title>Graph Instance Management</title><para>The system uses a thread-safe singleton pattern for the graph engine instead of distributed state management:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>SingletonPattern[Thread-Safe<sp/>Singleton<sp/>Graph<sp/>Access]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>APIRequest([API<sp/>Request&lt;br/&gt;Arrives])<sp/>--&gt;<sp/>CheckGlobal{Global<sp/>graph&lt;br/&gt;instance<sp/>exists?}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckGlobal<sp/>--&gt;|Yes|<sp/>ReturnExisting[Return<sp/>Existing&lt;br/&gt;Graph<sp/>Instance]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckGlobal<sp/>--&gt;|No|<sp/>AcquireLock[Acquire&lt;br/&gt;threading.Lock]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AcquireLock<sp/>--&gt;<sp/>DoubleCheck{Double-check&lt;br/&gt;inside<sp/>lock}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DoubleCheck<sp/>--&gt;|Created<sp/>by&lt;br/&gt;another<sp/>thread|<sp/>ReleaseReturn[Release<sp/>Lock&lt;br/&gt;Return<sp/>Graph]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DoubleCheck<sp/>--&gt;|Still<sp/>None|<sp/>InitGraph[Initialize&lt;br/&gt;New<sp/>Graph]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InitGraph<sp/>--&gt;<sp/>LoadCache{Cache&lt;br/&gt;available?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadCache<sp/>--&gt;|Yes|<sp/>LoadFromCache[Load<sp/>from&lt;br/&gt;JSON<sp/>Cache]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadCache<sp/>--&gt;|No|<sp/>FetchData[Fetch<sp/>from&lt;br/&gt;Data<sp/>Source]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FetchData<sp/>--&gt;<sp/>BuildRelations[Build&lt;br/&gt;Relationships]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadFromCache<sp/>--&gt;<sp/>SetGlobal[Set<sp/>Global&lt;br/&gt;Reference]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BuildRelations<sp/>--&gt;<sp/>SetGlobal</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetGlobal<sp/>--&gt;<sp/>ReleaseLock[Release<sp/>Lock]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReleaseLock<sp/>--&gt;<sp/>ReturnNew[Return<sp/>New&lt;br/&gt;Graph<sp/>Instance]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReturnExisting<sp/>--&gt;<sp/>GraphReady([Graph<sp/>Ready&lt;br/&gt;for<sp/>Use])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReleaseReturn<sp/>--&gt;<sp/>GraphReady</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReturnNew<sp/>--&gt;<sp/>GraphReady</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4046">
<title>Implementation Details</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Aspect   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Lock Type   </para>
</entry><entry thead="no"><para><computeroutput>threading.Lock()</computeroutput>   </para>
</entry><entry thead="no"><para>Prevent race conditions    </para>
</entry></row>
<row>
<entry thead="no"><para>Pattern   </para>
</entry><entry thead="no"><para>Double-checked locking   </para>
</entry><entry thead="no"><para>Minimize lock contention    </para>
</entry></row>
<row>
<entry thead="no"><para>Scope   </para>
</entry><entry thead="no"><para>Module-level global   </para>
</entry><entry thead="no"><para>Single instance per process    </para>
</entry></row>
<row>
<entry thead="no"><para>Factory Override   </para>
</entry><entry thead="no"><para><computeroutput>set_graph_factory()</computeroutput>   </para>
</entry><entry thead="no"><para>Test isolation support   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4047">
<title>6.1.6 Resilience Patterns (Monolithic Context)</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4048">
<title>Graceful Degradation</title><para>Although not a distributed system, the monolith implements resilience patterns for external dependencies:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>GracefulDegradation[Graceful<sp/>Degradation<sp/>Flow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>StartInit([Initialize&lt;br/&gt;Graph])<sp/>--&gt;<sp/>TryCache{Try<sp/>Load&lt;br/&gt;from<sp/>Cache}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryCache<sp/>--&gt;|Success|<sp/>CacheLoaded[Use<sp/>Cached&lt;br/&gt;Graph<sp/>Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryCache<sp/>--&gt;|Failure|<sp/>LogCacheErr[Log<sp/>Cache&lt;br/&gt;Error]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LogCacheErr<sp/>--&gt;<sp/>TryNetwork{Network&lt;br/&gt;Available?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryNetwork<sp/>--&gt;|Yes|<sp/>TryYahoo{Fetch<sp/>from&lt;br/&gt;Yahoo<sp/>Finance}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryNetwork<sp/>--&gt;|No|<sp/>UseSample1[Fall<sp/>Back<sp/>to&lt;br/&gt;Sample<sp/>Data]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryYahoo<sp/>--&gt;|Success|<sp/>UseRealData[Use<sp/>Real&lt;br/&gt;Market<sp/>Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryYahoo<sp/>--&gt;|Partial|<sp/>UsePartial[Use<sp/>Available&lt;br/&gt;Partial<sp/>Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryYahoo<sp/>--&gt;|Failure|<sp/>UseSample2[Fall<sp/>Back<sp/>to&lt;br/&gt;Sample<sp/>Data]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CacheLoaded<sp/>--&gt;<sp/>GraphReady([Graph&lt;br/&gt;Initialized])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UseRealData<sp/>--&gt;<sp/>SaveCache[Save<sp/>to&lt;br/&gt;Cache]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UsePartial<sp/>--&gt;<sp/>SaveCache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SaveCache<sp/>--&gt;<sp/>GraphReady</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UseSample1<sp/>--&gt;<sp/>GraphReady</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UseSample2<sp/>--&gt;<sp/>GraphReady</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4049">
<title>Resilience Pattern Summary</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Pattern   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Trigger Condition    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache Fallback   </para>
</entry><entry thead="no"><para>JSON file cache   </para>
</entry><entry thead="no"><para>Cache load failure    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Source Fallback   </para>
</entry><entry thead="no"><para>Sample data generator   </para>
</entry><entry thead="no"><para>Network unavailable    </para>
</entry></row>
<row>
<entry thead="no"><para>Partial Data Recovery   </para>
</entry><entry thead="no"><para>Use available data   </para>
</entry><entry thead="no"><para>Partial Yahoo Finance fetch    </para>
</entry></row>
<row>
<entry thead="no"><para>Atomic Cache Writes   </para>
</entry><entry thead="no"><para><computeroutput>NamedTemporaryFile</computeroutput> + <computeroutput>os.replace()</computeroutput>   </para>
</entry><entry thead="no"><para>All cache operations    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limiting   </para>
</entry><entry thead="no"><para>slowapi per-endpoint limits   </para>
</entry><entry thead="no"><para>Request threshold exceeded    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Checks   </para>
</entry><entry thead="no"><para><computeroutput>/api/health</computeroutput> endpoint   </para>
</entry><entry thead="no"><para>Container orchestration   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4050">
<title>Atomic Cache Write Pattern</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Phase   </para>
</entry><entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>Write to <computeroutput>NamedTemporaryFile</computeroutput>   </para>
</entry><entry thead="no"><para>Isolate incomplete writes    </para>
</entry></row>
<row>
<entry thead="no"><para>2   </para>
</entry><entry thead="no"><para>Flush and sync to disk   </para>
</entry><entry thead="no"><para>Ensure durability    </para>
</entry></row>
<row>
<entry thead="no"><para>3   </para>
</entry><entry thead="no"><para><computeroutput>os.replace()</computeroutput> atomic rename   </para>
</entry><entry thead="no"><para>Prevent corruption    </para>
</entry></row>
<row>
<entry thead="no"><para>4   </para>
</entry><entry thead="no"><para>Delete temp on failure   </para>
</entry><entry thead="no"><para>Clean up partial state   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4051">
<title>6.1.7 Error Handling Architecture</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4052">
<title>Error Categories and Responses</title><para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Error Type   </para>
</entry><entry thead="yes"><para>HTTP Status   </para>
</entry><entry thead="yes"><para>Recovery Action   </para>
</entry><entry thead="yes"><para>User Feedback    </para>
</entry></row>
<row>
<entry thead="no"><para>Validation Error   </para>
</entry><entry thead="no"><para>422   </para>
</entry><entry thead="no"><para>Return Pydantic details   </para>
</entry><entry thead="no"><para>Field-level errors    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication Error   </para>
</entry><entry thead="no"><para>401   </para>
</entry><entry thead="no"><para>Prompt re-authentication   </para>
</entry><entry thead="no"><para>Login redirect    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limit Exceeded   </para>
</entry><entry thead="no"><para>429   </para>
</entry><entry thead="no"><para>Add Retry-After header   </para>
</entry><entry thead="no"><para>Wait message    </para>
</entry></row>
<row>
<entry thead="no"><para>Resource Not Found   </para>
</entry><entry thead="no"><para>404   </para>
</entry><entry thead="no"><para>Return error detail   </para>
</entry><entry thead="no"><para>Item not found    </para>
</entry></row>
<row>
<entry thead="no"><para>Internal Error   </para>
</entry><entry thead="no"><para>500   </para>
</entry><entry thead="no"><para>Log exception   </para>
</entry><entry thead="no"><para>Generic error   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4053">
<title>Graph Initialization Error Recovery</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Error Source   </para>
</entry><entry thead="yes"><para>Detection   </para>
</entry><entry thead="yes"><para>Recovery Action   </para>
</entry><entry thead="yes"><para>Fallback    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache load failed   </para>
</entry><entry thead="no"><para>JSON parse error   </para>
</entry><entry thead="no"><para>Proceed to fresh fetch   </para>
</entry><entry thead="no"><para>Standard initialization    </para>
</entry></row>
<row>
<entry thead="no"><para>Network disabled   </para>
</entry><entry thead="no"><para>Connection timeout   </para>
</entry><entry thead="no"><para>Use sample data   </para>
</entry><entry thead="no"><para>Offline mode    </para>
</entry></row>
<row>
<entry thead="no"><para>Yahoo Finance error   </para>
</entry><entry thead="no"><para>Request exception   </para>
</entry><entry thead="no"><para>Check partial data   </para>
</entry><entry thead="no"><para>Sample data fallback    </para>
</entry></row>
<row>
<entry thead="no"><para>Critical failure   </para>
</entry><entry thead="no"><para>Unrecoverable exception   </para>
</entry><entry thead="no"><para>Abort startup   </para>
</entry><entry thead="no"><para>Application exit   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4054">
<title>6.1.8 Scalability Approach (Monolithic Context)</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4055">
<title>Current Scale Characteristics</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Metric   </para>
</entry><entry thead="yes"><para>Current Capacity   </para>
</entry><entry thead="yes"><para>Limiting Factor    </para>
</entry></row>
<row>
<entry thead="no"><para>Node Count   </para>
</entry><entry thead="no"><para>&lt;500 assets optimal   </para>
</entry><entry thead="no"><para>In-memory storage    </para>
</entry></row>
<row>
<entry thead="no"><para>Concurrent Users   </para>
</entry><entry thead="no"><para>Single-threaded graph   </para>
</entry><entry thead="no"><para>Python GIL    </para>
</entry></row>
<row>
<entry thead="no"><para>Response Time (p95)   </para>
</entry><entry thead="no"><para>&lt;500ms   </para>
</entry><entry thead="no"><para>API processing    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Nodes   </para>
</entry><entry thead="no"><para>500 nodes, 2000 edges   </para>
</entry><entry thead="no"><para>Browser memory   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4056">
<title>Scaling Tradeoffs</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Benefit of Monolithic   </para>
</entry><entry thead="yes"><para>Associated Cost    </para>
</entry></row>
<row>
<entry thead="no"><para>Simpler operations   </para>
</entry><entry thead="no"><para>Limited horizontal scaling of graph    </para>
</entry></row>
<row>
<entry thead="no"><para>Faster development   </para>
</entry><entry thead="no"><para>All components share runtime    </para>
</entry></row>
<row>
<entry thead="no"><para>Lower latency   </para>
</entry><entry thead="no"><para>Memory-bound capacity    </para>
</entry></row>
<row>
<entry thead="no"><para>Single deployment   </para>
</entry><entry thead="no"><para>Single point of failure   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4057">
<title>Future Scaling Path</title><para>If the system grows beyond current scale constraints, the modular package structure enables migration to microservices:</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Growth Trigger   </para>
</entry><entry thead="yes"><para>Recommended Action   </para>
</entry><entry thead="yes"><para>Module to Extract    </para>
</entry></row>
<row>
<entry thead="no"><para>&gt;500 assets   </para>
</entry><entry thead="no"><para>Database persistence   </para>
</entry><entry thead="no"><para>Graph Engine → Graph Service    </para>
</entry></row>
<row>
<entry thead="no"><para>Multi-tenant requirements   </para>
</entry><entry thead="no"><para>Dedicated auth service   </para>
</entry><entry thead="no"><para>Auth Module → Auth Service    </para>
</entry></row>
<row>
<entry thead="no"><para>High visualization load   </para>
</entry><entry thead="no"><para>Separate rendering   </para>
</entry><entry thead="no"><para>Visualization → Render Service    </para>
</entry></row>
<row>
<entry thead="no"><para>Data ingestion volume   </para>
</entry><entry thead="no"><para>Async processing   </para>
</entry><entry thead="no"><para>Data Fetcher → Ingestion Service   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4058">
<title>6.1.9 Performance Optimization</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4059">
<title>Performance Targets (SLAs)</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Target   </para>
</entry><entry thead="yes"><para>Measurement    </para>
</entry></row>
<row>
<entry thead="no"><para>API Response (p95)   </para>
</entry><entry thead="no"><para>&lt;500ms   </para>
</entry><entry thead="no"><para>Request to response    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Rendering   </para>
</entry><entry thead="no"><para>&lt;2 seconds   </para>
</entry><entry thead="no"><para>Data load to interactive    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Generation   </para>
</entry><entry thead="no"><para>&lt;100ms   </para>
</entry><entry thead="no"><para>Credential to token    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Initialization   </para>
</entry><entry thead="no"><para>&lt;3 seconds   </para>
</entry><entry thead="no"><para>Application startup    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Discovery   </para>
</entry><entry thead="no"><para>&lt;500ms   </para>
</entry><entry thead="no"><para>For 100 assets    </para>
</entry></row>
<row>
<entry thead="no"><para>Initial Page Load   </para>
</entry><entry thead="no"><para>&lt;3 seconds   </para>
</entry><entry thead="no"><para>Navigation to interactive   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4060">
<title>Optimization Techniques</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Technique   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Impact    </para>
</entry></row>
<row>
<entry thead="no"><para>Deterministic Layout   </para>
</entry><entry thead="no"><para>Fixed seed (seed=42)   </para>
</entry><entry thead="no"><para>Reproducible 3D positions    </para>
</entry></row>
<row>
<entry thead="no"><para>Lazy Initialization   </para>
</entry><entry thead="no"><para>Double-checked locking   </para>
</entry><entry thead="no"><para>Fast startup    </para>
</entry></row>
<row>
<entry thead="no"><para>JSON Caching   </para>
</entry><entry thead="no"><para>Atomic file cache   </para>
</entry><entry thead="no"><para>Reduced API calls    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limiting   </para>
</entry><entry thead="no"><para>Per-endpoint limits   </para>
</entry><entry thead="no"><para>Fair resource allocation    </para>
</entry></row>
<row>
<entry thead="no"><para>Client-Side Limits   </para>
</entry><entry thead="no"><para>MAX_NODES/MAX_EDGES   </para>
</entry><entry thead="no"><para>Browser stability   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4061">
<title>6.1.10 Deployment Architecture Comparison</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4062">
<title>Deployment Options</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DeploymentOptions[Deployment<sp/>Architecture<sp/>Options]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>LocalDev[Local<sp/>Development]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFE[Next.js&lt;br/&gt;:3000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalAPI[FastAPI&lt;br/&gt;:8000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalGradio[Gradio&lt;br/&gt;:7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>DockerDeploy[Docker<sp/>Deployment]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerContainer[Single<sp/>Container&lt;br/&gt;:7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerVolumes[(Mounted&lt;br/&gt;Volumes)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerContainer<sp/>--&gt;<sp/>DockerVolumes</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>VercelDeploy[Vercel<sp/>Serverless]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelEdge[Edge&lt;br/&gt;Network]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelLambda[Python&lt;br/&gt;Lambda]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelSSR[Next.js&lt;br/&gt;SSR]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelEdge<sp/>--&gt;<sp/>VercelLambda</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelEdge<sp/>--&gt;<sp/>VercelSSR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users([End<sp/>Users])<sp/>--&gt;<sp/>LocalDev</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users<sp/>--&gt;<sp/>DockerDeploy</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users<sp/>--&gt;<sp/>VercelDeploy</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4063">
<title>Deployment Configuration Summary</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Environment   </para>
</entry><entry thead="yes"><para>Components   </para>
</entry><entry thead="yes"><para>Command   </para>
</entry><entry thead="yes"><para>Notes    </para>
</entry></row>
<row>
<entry thead="no"><para>Local Dev   </para>
</entry><entry thead="no"><para>FastAPI + Next.js + Gradio   </para>
</entry><entry thead="no"><para>Multiple processes   </para>
</entry><entry thead="no"><para>Full development environment    </para>
</entry></row>
<row>
<entry thead="no"><para>Docker   </para>
</entry><entry thead="no"><para>Single container   </para>
</entry><entry thead="no"><para><computeroutput>docker-compose up</computeroutput>   </para>
</entry><entry thead="no"><para>Simplified deployment    </para>
</entry></row>
<row>
<entry thead="no"><para>Vercel   </para>
</entry><entry thead="no"><para>Lambda + SSR   </para>
</entry><entry thead="no"><para><computeroutput>vercel deploy</computeroutput>   </para>
</entry><entry thead="no"><para>Serverless production   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4064">
<title>6.1.11 Constraints and Limitations</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4065">
<title>Documented System Constraints</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>ID   </para>
</entry><entry thead="yes"><para>Constraint   </para>
</entry><entry thead="yes"><para>Mitigation Strategy    </para>
</entry></row>
<row>
<entry thead="no"><para>C-001   </para>
</entry><entry thead="no"><para>In-memory graph limits scalability   </para>
</entry><entry thead="no"><para>Database persistence option planned    </para>
</entry></row>
<row>
<entry thead="no"><para>C-002   </para>
</entry><entry thead="no"><para>Single-user JWT authentication   </para>
</entry><entry thead="no"><para>Role-based access planned for Phase 2    </para>
</entry></row>
<row>
<entry thead="no"><para>C-003   </para>
</entry><entry thead="no"><para>Yahoo Finance API rate limits   </para>
</entry><entry thead="no"><para>Caching with atomic file writes    </para>
</entry></row>
<row>
<entry thead="no"><para>C-004   </para>
</entry><entry thead="no"><para>Browser memory limits visualization   </para>
</entry><entry thead="no"><para>MAX_NODES/MAX_EDGES guardrails   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4066">
<title>Architectural Assumptions</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>ID   </para>
</entry><entry thead="yes"><para>Assumption   </para>
</entry><entry thead="yes"><para>Impact if Invalid    </para>
</entry></row>
<row>
<entry thead="no"><para>A-001   </para>
</entry><entry thead="no"><para>Modern browser support   </para>
</entry><entry thead="no"><para>Visualization features may fail    </para>
</entry></row>
<row>
<entry thead="no"><para>A-002   </para>
</entry><entry thead="no"><para>Network connectivity available   </para>
</entry><entry thead="no"><para>Falls back to sample data    </para>
</entry></row>
<row>
<entry thead="no"><para>A-003   </para>
</entry><entry thead="no"><para>Single concurrent admin sufficient   </para>
</entry><entry thead="no"><para>Multi-user requires extension    </para>
</entry></row>
<row>
<entry thead="no"><para>A-004   </para>
</entry><entry thead="no"><para>Dataset size &lt;500 nodes   </para>
</entry><entry thead="no"><para>Larger datasets need pagination   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4067">
<title>6.1.12 Microservices Migration Readiness</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4068">
<title>Module Extraction Feasibility</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Module   </para>
</entry><entry thead="yes"><para>Extraction Complexity   </para>
</entry><entry thead="yes"><para>Dependencies to Resolve   </para>
</entry><entry thead="yes"><para>Estimated Effort    </para>
</entry></row>
<row>
<entry thead="no"><para>Auth Module   </para>
</entry><entry thead="no"><para>Low   </para>
</entry><entry thead="no"><para>JWT secret management   </para>
</entry><entry thead="no"><para>1-2 weeks    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Fetcher   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry><entry thead="no"><para>Cache sharing strategy   </para>
</entry><entry thead="no"><para>2-4 weeks    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry><entry thead="no"><para>Graph data access pattern   </para>
</entry><entry thead="no"><para>2-4 weeks    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Engine   </para>
</entry><entry thead="no"><para>High   </para>
</entry><entry thead="no"><para>State management overhaul   </para>
</entry><entry thead="no"><para>4-8 weeks   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4069">
<title>Prerequisites for Migration</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Prerequisite   </para>
</entry><entry thead="yes"><para>Current State   </para>
</entry><entry thead="yes"><para>Required for Migration    </para>
</entry></row>
<row>
<entry thead="no"><para>Database Persistence   </para>
</entry><entry thead="no"><para>Optional (F-015)   </para>
</entry><entry thead="no"><para>Required for shared state    </para>
</entry></row>
<row>
<entry thead="no"><para>Message Queue   </para>
</entry><entry thead="no"><para>Not implemented   </para>
</entry><entry thead="no"><para>Required for async communication    </para>
</entry></row>
<row>
<entry thead="no"><para>Service Mesh   </para>
</entry><entry thead="no"><para>Not applicable   </para>
</entry><entry thead="no"><para>Required for service discovery    </para>
</entry></row>
<row>
<entry thead="no"><para>Distributed Tracing   </para>
</entry><entry thead="no"><para>Not implemented   </para>
</entry><entry thead="no"><para>Required for observability   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4070">
<title>6.1.13 References</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4071">
<title>Technical Specification Sections Referenced</title><para><itemizedlist>
<listitem><para><bold>5.1 HIGH-LEVEL ARCHITECTURE</bold> - Layered architecture design and system boundaries</para>
</listitem><listitem><para><bold>5.2 COMPONENT DETAILS</bold> - Component responsibilities and interaction patterns</para>
</listitem><listitem><para><bold>5.3 TECHNICAL DECISIONS</bold> - Monolithic architecture choice rationale</para>
</listitem><listitem><para><bold>5.4 CROSS-CUTTING CONCERNS</bold> - Error handling, monitoring, authentication</para>
</listitem><listitem><para><bold>5.5 DEPLOYMENT ARCHITECTURE</bold> - Deployment options and configurations</para>
</listitem><listitem><para><bold>2.4 Implementation Considerations</bold> - Performance and scalability constraints</para>
</listitem><listitem><para><bold>2.6 Assumptions and Constraints</bold> - System limitations and mitigations</para>
</listitem><listitem><para><bold>3.9 Integration Requirements</bold> - Frontend-backend communication patterns</para>
</listitem><listitem><para><bold>4.5 Error Handling Workflows</bold> - Error recovery flows and patterns</para>
</listitem></itemizedlist>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4072">
<title>Files and Folders Examined</title><para><table rows="11" cols="2"><row>
<entry thead="yes"><para>Path   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI application with thread-safe singleton graph pattern    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>JWT authentication module implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Graph engine with in-memory storage    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Fallback mechanism and atomic caching    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Domain model definitions    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/visualizations/</computeroutput>   </para>
</entry><entry thead="no"><para>Plotly visualization modules    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Gradio UI with direct Python function calls    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>docker-compose.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Single container deployment configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>vercel.json</computeroutput>   </para>
</entry><entry thead="no"><para>Serverless deployment configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/</computeroutput>   </para>
</entry><entry thead="no"><para>Next.js client application   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4073">
<title>Architectural Decision Records</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Decision   </para>
</entry><entry thead="yes"><para>Choice   </para>
</entry><entry thead="yes"><para>Rationale    </para>
</entry></row>
<row>
<entry thead="no"><para>ADR-001   </para>
</entry><entry thead="no"><para>Monolithic over Microservices   </para>
</entry><entry thead="no"><para>Operational simplicity at current scale    </para>
</entry></row>
<row>
<entry thead="no"><para>ADR-002   </para>
</entry><entry thead="no"><para>REST/JSON over GraphQL/gRPC   </para>
</entry><entry thead="no"><para>Universal client compatibility    </para>
</entry></row>
<row>
<entry thead="no"><para>ADR-003   </para>
</entry><entry thead="no"><para>In-memory over Database-first   </para>
</entry><entry thead="no"><para>Sub-millisecond access for &lt;500 assets    </para>
</entry></row>
<row>
<entry thead="no"><para>ADR-004   </para>
</entry><entry thead="no"><para>Thread-safe Singleton   </para>
</entry><entry thead="no"><para>Prevent race conditions, enable testing   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4074">
<title>6.2 Database Design</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4075">
<title>6.2.1 Database Architecture Overview</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4076">
<title>6.2.1.1 Hybrid Storage Architecture</title><para>The Financial Asset Relationship Database employs a <bold>hybrid data architecture</bold> that combines multiple complementary storage mechanisms optimized for different use cases. This design prioritizes in-memory performance for real-time graph operations while providing optional persistence for durability and scalability.</para>
<para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Storage Layer   </para>
</entry><entry thead="yes"><para>Technology   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Durability    </para>
</entry></row>
<row>
<entry thead="no"><para>Primary Runtime   </para>
</entry><entry thead="no"><para>In-Memory Graph   </para>
</entry><entry thead="no"><para>Relationship traversal   </para>
</entry><entry thead="no"><para>Process lifetime    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication   </para>
</entry><entry thead="no"><para>SQLite   </para>
</entry><entry thead="no"><para>User credentials   </para>
</entry><entry thead="no"><para>Persistent    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset Persistence   </para>
</entry><entry thead="no"><para>SQLAlchemy ORM   </para>
</entry><entry thead="no"><para>Optional durable storage   </para>
</entry><entry thead="no"><para>Persistent    </para>
</entry></row>
<row>
<entry thead="no"><para>External Data Cache   </para>
</entry><entry thead="no"><para>JSON Files   </para>
</entry><entry thead="no"><para>Yahoo Finance data   </para>
</entry><entry thead="no"><para>Persistent   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4077">
<title>6.2.1.2 Storage Layer Architecture Diagram</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>StorageArchitecture[Hybrid<sp/>Storage<sp/>Architecture]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>RuntimeLayer[Runtime<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InMemoryGraph[In-Memory<sp/>Graph&lt;br/&gt;Dict-based<sp/>Adjacency<sp/>Lists]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphSingleton[Thread-Safe&lt;br/&gt;Singleton<sp/>Pattern]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InMemoryGraph<sp/>--&gt;<sp/>GraphSingleton</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>PersistenceLayer[Persistence<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>AuthDB[Authentication<sp/>Database]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLiteAuth[(SQLite&lt;br/&gt;user_credentials)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>AssetDB[Asset<sp/>Persistence]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLAORM[SQLAlchemy<sp/>ORM]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PostgreSQL[(PostgreSQL&lt;br/&gt;Production)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLiteDev[(SQLite&lt;br/&gt;Development)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLAORM<sp/>--&gt;<sp/>PostgreSQL</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLAORM<sp/>--&gt;<sp/>SQLiteDev</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>CacheLayer[Cache<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JSONCache[(JSON<sp/>Files&lt;br/&gt;Atomic<sp/>Writes)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphSingleton<sp/>--&gt;<sp/>SQLAORM</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphSingleton<sp/>--&gt;<sp/>JSONCache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AuthModule[Auth<sp/>Module]<sp/>--&gt;<sp/>SQLiteAuth</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4078">
<title>6.2.1.3 Design Rationale</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Design Choice   </para>
</entry><entry thead="yes"><para>Rationale   </para>
</entry><entry thead="yes"><para>Trade-off    </para>
</entry></row>
<row>
<entry thead="no"><para>In-memory primary storage   </para>
</entry><entry thead="no"><para>Sub-millisecond relationship traversal   </para>
</entry><entry thead="no"><para>Memory-bound capacity    </para>
</entry></row>
<row>
<entry thead="no"><para>Optional database persistence   </para>
</entry><entry thead="no"><para>Flexibility for different deployment scales   </para>
</entry><entry thead="no"><para>Additional complexity    </para>
</entry></row>
<row>
<entry thead="no"><para>Wide table design   </para>
</entry><entry thead="no"><para>Single-table queries for asset retrieval   </para>
</entry><entry thead="no"><para>Nullable columns for type-specific fields    </para>
</entry></row>
<row>
<entry thead="no"><para>Cascade deletes on all FKs   </para>
</entry><entry thead="no"><para>Referential integrity without orphans   </para>
</entry><entry thead="no"><para>Potential for bulk deletes   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4080">
<title>6.2.2 Schema Design</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4081">
<title>6.2.2.1 Core Entity Model</title><para>The database schema is defined in <computeroutput>migrations/001_initial.sql</computeroutput> and implements a graph-oriented relational design supporting financial asset relationships.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4082">
<title>Entity Tables Summary</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Table   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Primary Key   </para>
</entry><entry thead="yes"><para>Record Count Expectation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>assets</computeroutput>   </para>
</entry><entry thead="no"><para>Financial instrument storage   </para>
</entry><entry thead="no"><para><computeroutput>id</computeroutput> (TEXT)   </para>
</entry><entry thead="no"><para>&lt;500 for optimal performance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_relationships</computeroutput>   </para>
</entry><entry thead="no"><para>Directed relationship edges   </para>
</entry><entry thead="no"><para><computeroutput>id</computeroutput> (INTEGER)   </para>
</entry><entry thead="no"><para>N × average_degree    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_events</computeroutput>   </para>
</entry><entry thead="no"><para>Regulatory event records   </para>
</entry><entry thead="no"><para><computeroutput>id</computeroutput> (TEXT)   </para>
</entry><entry thead="no"><para>Events per asset    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_event_assets</computeroutput>   </para>
</entry><entry thead="no"><para>Many-to-many junction   </para>
</entry><entry thead="no"><para><computeroutput>id</computeroutput> (INTEGER)   </para>
</entry><entry thead="no"><para>Events × affected assets   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4083">
<title>6.2.2.2 Assets Table Schema</title><para>The <computeroutput>assets</computeroutput> table uses a <bold>wide table design</bold> with nullable type-specific columns rather than separate tables per asset class, enabling simpler queries at the cost of schema sparsity.</para>
<para><table rows="9" cols="4"><row>
<entry thead="yes"><para>Column   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Constraints   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>PRIMARY KEY   </para>
</entry><entry thead="no"><para>Unique asset identifier    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>symbol</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL   </para>
</entry><entry thead="no"><para>Trading symbol    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>name</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL   </para>
</entry><entry thead="no"><para>Display name    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_class</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL   </para>
</entry><entry thead="no"><para><ref refid="classEnum" kindref="compound">Enum</ref>: equity, fixed_income, commodity, currency, derivative    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>sector</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL   </para>
</entry><entry thead="no"><para>Industry sector classification    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>price</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NOT NULL   </para>
</entry><entry thead="no"><para>Current market price    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>market_cap</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Market capitalization (equities)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>currency</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL   </para>
</entry><entry thead="no"><para>ISO 4217 currency code   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4084">
<title>Equity-Specific Columns</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Column   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Constraints   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>pe_ratio</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Price-to-earnings ratio    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>dividend_yield</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Annual dividend yield    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>earnings_per_share</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>EPS value    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>book_value</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Book value per share   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4085">
<title>Fixed Income Columns</title><para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Column   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Constraints   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>yield_to_maturity</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>YTM percentage    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>coupon_rate</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Annual coupon rate    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>maturity_date</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>ISO 8601 date    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>credit_rating</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Credit rating code    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>issuer_id</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>FK to issuing entity   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4086">
<title>Commodity/Currency Columns</title><para><table rows="7" cols="4"><row>
<entry thead="yes"><para>Column   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Constraints   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>contract_size</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Commodity contract size    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>delivery_date</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Commodity delivery date    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>volatility</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Price volatility    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>exchange_rate</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Currency exchange rate    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>country</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Currency country    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>central_bank_rate</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Central bank interest rate   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4087">
<title>6.2.2.3 Asset Relationships Table Schema</title><para><table rows="7" cols="4"><row>
<entry thead="yes"><para>Column   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Constraints   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para>INTEGER   </para>
</entry><entry thead="no"><para>PRIMARY KEY AUTOINCREMENT   </para>
</entry><entry thead="no"><para>Unique edge identifier    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>source_asset_id</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL, FK → assets(id) ON DELETE CASCADE   </para>
</entry><entry thead="no"><para>Origin node    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>target_asset_id</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL, FK → assets(id) ON DELETE CASCADE   </para>
</entry><entry thead="no"><para>Destination node    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>relationship_type</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL   </para>
</entry><entry thead="no"><para>Relationship classification    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>strength</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NOT NULL   </para>
</entry><entry thead="no"><para>Edge weight [0.0, 1.0]    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>bidirectional</computeroutput>   </para>
</entry><entry thead="no"><para>INTEGER   </para>
</entry><entry thead="no"><para>NOT NULL DEFAULT 0   </para>
</entry><entry thead="no"><para>Boolean flag (0/1)   </para>
</entry></row>
</table>
</para>
<para><bold>Unique Constraint</bold>: <computeroutput>(source_asset_id, target_asset_id, relationship_type)</computeroutput> prevents duplicate edges.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4088">
<title>6.2.2.4 Regulatory Events Tables</title></sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4089">
<title>Regulatory Events Table</title><para><table rows="7" cols="4"><row>
<entry thead="yes"><para>Column   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Constraints   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>PRIMARY KEY   </para>
</entry><entry thead="no"><para>Unique event identifier    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_id</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL, FK → assets(id) ON DELETE CASCADE   </para>
</entry><entry thead="no"><para>Primary affected asset    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>event_type</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL   </para>
</entry><entry thead="no"><para>Event classification    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>date</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL   </para>
</entry><entry thead="no"><para>ISO 8601 date    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>description</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL   </para>
</entry><entry thead="no"><para>Event description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>impact_score</computeroutput>   </para>
</entry><entry thead="no"><para>REAL   </para>
</entry><entry thead="no"><para>NOT NULL   </para>
</entry><entry thead="no"><para>Impact range [-1.0, 1.0]   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4090">
<title>Regulatory Event Assets Junction Table</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Column   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Constraints   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para>INTEGER   </para>
</entry><entry thead="no"><para>PRIMARY KEY AUTOINCREMENT   </para>
</entry><entry thead="no"><para>Junction record ID    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>event_id</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL, FK → regulatory_events(id) ON DELETE CASCADE   </para>
</entry><entry thead="no"><para>Event reference    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_id</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL, FK → assets(id) ON DELETE CASCADE   </para>
</entry><entry thead="no"><para>Affected asset   </para>
</entry></row>
</table>
</para>
<para><bold>Unique Constraint</bold>: <computeroutput>(event_id, asset_id)</computeroutput> prevents duplicate associations.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4091">
<title>6.2.2.5 Authentication Schema</title><para>Defined in <computeroutput><ref refid="api_2database_8py" kindref="compound">api/database.py</ref></computeroutput>, the authentication schema provides user credential storage separate from the asset database.</para>
<para><table rows="7" cols="4"><row>
<entry thead="yes"><para>Column   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Constraints   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para>INTEGER   </para>
</entry><entry thead="no"><para>PRIMARY KEY AUTOINCREMENT   </para>
</entry><entry thead="no"><para>User record ID    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>username</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>UNIQUE NOT NULL   </para>
</entry><entry thead="no"><para>Login identifier    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>email</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Email address    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>full_name</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NULLABLE   </para>
</entry><entry thead="no"><para>Display name    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>hashed_password</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>NOT NULL   </para>
</entry><entry thead="no"><para>pbkdf2_sha256 hash    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>disabled</computeroutput>   </para>
</entry><entry thead="no"><para>INTEGER   </para>
</entry><entry thead="no"><para>NOT NULL DEFAULT 0   </para>
</entry><entry thead="no"><para>Active flag (0=active, 1=disabled)   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4092">
<title>6.2.2.6 Entity Relationship Diagram</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">erDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>assets<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>id<sp/>PK<sp/>&quot;Unique<sp/>identifier&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>symbol<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>name<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>asset_class<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>sector<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REAL<sp/>price<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REAL<sp/>market_cap<sp/>&quot;NULLABLE&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>currency<sp/>&quot;NOT<sp/>NULL<sp/>(3-char<sp/>ISO)&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REAL<sp/>pe_ratio<sp/>&quot;NULLABLE<sp/>-<sp/>Equity&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REAL<sp/>dividend_yield<sp/>&quot;NULLABLE<sp/>-<sp/>Equity&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REAL<sp/>yield_to_maturity<sp/>&quot;NULLABLE<sp/>-<sp/>Bond&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>credit_rating<sp/>&quot;NULLABLE<sp/>-<sp/>Bond&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>issuer_id<sp/>&quot;NULLABLE<sp/>-<sp/>Bond<sp/>FK&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>asset_relationships<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>INTEGER<sp/>id<sp/>PK<sp/>&quot;AUTOINCREMENT&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>source_asset_id<sp/>FK<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>target_asset_id<sp/>FK<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>relationship_type<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REAL<sp/>strength<sp/>&quot;NOT<sp/>NULL<sp/>[0-1]&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>INTEGER<sp/>bidirectional<sp/>&quot;DEFAULT<sp/>0&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>regulatory_events<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>id<sp/>PK<sp/>&quot;Unique<sp/>identifier&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>asset_id<sp/>FK<sp/>&quot;Primary<sp/>affected&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>event_type<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>date<sp/>&quot;ISO<sp/>8601&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>description<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REAL<sp/>impact_score<sp/>&quot;[-1,<sp/>1]&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>regulatory_event_assets<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>INTEGER<sp/>id<sp/>PK<sp/>&quot;AUTOINCREMENT&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>event_id<sp/>FK<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>asset_id<sp/>FK<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>user_credentials<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>INTEGER<sp/>id<sp/>PK<sp/>&quot;AUTOINCREMENT&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>username<sp/>UK<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>email<sp/>&quot;NULLABLE&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>full_name<sp/>&quot;NULLABLE&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TEXT<sp/>hashed_password<sp/>&quot;NOT<sp/>NULL&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>INTEGER<sp/>disabled<sp/>&quot;DEFAULT<sp/>0&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>assets<sp/>||--o{<sp/>asset_relationships<sp/>:<sp/>&quot;source_asset_id&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>assets<sp/>||--o{<sp/>asset_relationships<sp/>:<sp/>&quot;target_asset_id&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>assets<sp/>||--o{<sp/>regulatory_events<sp/>:<sp/>&quot;primary_asset&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>assets<sp/>||--o{<sp/>regulatory_event_assets<sp/>:<sp/>&quot;affected_asset&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>regulatory_events<sp/>||--o{<sp/>regulatory_event_assets<sp/>:<sp/>&quot;affects&quot;</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4094">
<title>6.2.3 Indexing Strategy</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4095">
<title>6.2.3.1 Primary Key Indexes</title><para>All primary keys are automatically indexed by the database engine:</para>
<para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Table   </para>
</entry><entry thead="yes"><para>Index   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>assets</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para>B-tree   </para>
</entry><entry thead="no"><para>Direct asset lookup    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_relationships</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para>B-tree   </para>
</entry><entry thead="no"><para>Edge identification    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_events</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para>B-tree   </para>
</entry><entry thead="no"><para>Event lookup    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_event_assets</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para>B-tree   </para>
</entry><entry thead="no"><para>Junction lookup    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>user_credentials</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para>B-tree   </para>
</entry><entry thead="no"><para>User record access   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4096">
<title>6.2.3.2 Unique Constraint Indexes</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Table   </para>
</entry><entry thead="yes"><para>Constraint   </para>
</entry><entry thead="yes"><para>Columns   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_relationships</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>uq_relationship</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>(source_asset_id, target_asset_id, relationship_type)</computeroutput>   </para>
</entry><entry thead="no"><para>Prevent duplicate edges    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_event_assets</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>uq_event_asset</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>(event_id, asset_id)</computeroutput>   </para>
</entry><entry thead="no"><para>Prevent duplicate associations    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>user_credentials</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>username</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>username</computeroutput>   </para>
</entry><entry thead="no"><para>Unique login enforcement   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4097">
<title>6.2.3.3 Foreign Key Indexes</title><para>Foreign key columns are indexed to support cascade delete operations and join queries:</para>
<para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Table   </para>
</entry><entry thead="yes"><para>Column   </para>
</entry><entry thead="yes"><para>References   </para>
</entry><entry thead="yes"><para>Index Type    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_relationships</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>source_asset_id</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>assets(id)</computeroutput>   </para>
</entry><entry thead="no"><para>Implicit FK index    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_relationships</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>target_asset_id</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>assets(id)</computeroutput>   </para>
</entry><entry thead="no"><para>Implicit FK index    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_events</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>asset_id</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>assets(id)</computeroutput>   </para>
</entry><entry thead="no"><para>Implicit FK index    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_event_assets</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>event_id</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>regulatory_events(id)</computeroutput>   </para>
</entry><entry thead="no"><para>Implicit FK index    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_event_assets</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>asset_id</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>assets(id)</computeroutput>   </para>
</entry><entry thead="no"><para>Implicit FK index   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4098">
<title>6.2.3.4 Recommended Production Indexes</title><para>For PostgreSQL production deployments handling larger datasets:</para>
<para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Table   </para>
</entry><entry thead="yes"><para>Proposed Index   </para>
</entry><entry thead="yes"><para>Columns   </para>
</entry><entry thead="yes"><para>Rationale    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>assets</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>idx_assets_sector</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>sector</computeroutput>   </para>
</entry><entry thead="no"><para>Sector-based filtering    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>assets</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>idx_assets_class</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>asset_class</computeroutput>   </para>
</entry><entry thead="no"><para>Asset class filtering    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_relationships</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>idx_rel_type</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>relationship_type</computeroutput>   </para>
</entry><entry thead="no"><para>Relationship type queries    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_events</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>idx_events_date</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>date</computeroutput>   </para>
</entry><entry thead="no"><para>Date range queries   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4100">
<title>6.2.4 Data Flow Architecture</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4101">
<title>6.2.4.1 Data Flow Diagram</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ExternalSources[External<sp/>Data<sp/>Sources]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YahooFinance[Yahoo<sp/>Finance<sp/>API]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SampleData[Sample<sp/>Data<sp/>Generator]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DataIngestion[Data<sp/>Ingestion<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RealFetcher[RealDataFetcher&lt;br/&gt;src/data/real_data_fetcher.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SampleGen[Sample<sp/>Database&lt;br/&gt;src/data/sample_data.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>CacheLayer[Cache<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JSONCache[(JSON<sp/>File<sp/>Cache&lt;br/&gt;Atomic<sp/>Writes)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>GraphLayer[Graph<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InMemoryGraph[AssetRelationshipGraph&lt;br/&gt;src/logic/asset_graph.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RelationshipBuilder[Relationship<sp/>Builder&lt;br/&gt;Sector/Bond/Currency<sp/>Links]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>PersistenceLayer[Persistence<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Repository[AssetGraphRepository&lt;br/&gt;src/data/repository.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLAlchemyDB[(SQLAlchemy<sp/>ORM&lt;br/&gt;PostgreSQL/SQLite)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLiteAuth[(SQLite<sp/>Auth&lt;br/&gt;user_credentials)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>APILayer[API<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI[FastAPI<sp/>Endpoints&lt;br/&gt;api/main.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AuthModule[Auth<sp/>Module&lt;br/&gt;api/auth.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>YahooFinance<sp/>--&gt;<sp/>RealFetcher</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SampleData<sp/>--&gt;<sp/>SampleGen</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RealFetcher<sp/>--&gt;<sp/>JSONCache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RealFetcher<sp/>--&gt;<sp/>InMemoryGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SampleGen<sp/>--&gt;<sp/>InMemoryGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>JSONCache<sp/>--&gt;<sp/>RealFetcher</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>InMemoryGraph<sp/>--&gt;<sp/>RelationshipBuilder</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RelationshipBuilder<sp/>--&gt;<sp/>InMemoryGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>InMemoryGraph<sp/>--&gt;<sp/>Repository</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Repository<sp/>--&gt;<sp/>SQLAlchemyDB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AuthModule<sp/>--&gt;<sp/>SQLiteAuth</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>InMemoryGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>AuthModule</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4102">
<title>6.2.4.2 Data Flow Sequence</title><para><table rows="7" cols="4"><row>
<entry thead="yes"><para>Phase   </para>
</entry><entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Source   </para>
</entry><entry thead="yes"><para>Destination    </para>
</entry></row>
<row>
<entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>Data Fetch   </para>
</entry><entry thead="no"><para>Yahoo Finance / Sample Generator   </para>
</entry><entry thead="no"><para>Data Fetcher    </para>
</entry></row>
<row>
<entry thead="no"><para>2   </para>
</entry><entry thead="no"><para>Cache Check   </para>
</entry><entry thead="no"><para>JSON Cache   </para>
</entry><entry thead="no"><para>Data Fetcher    </para>
</entry></row>
<row>
<entry thead="no"><para>3   </para>
</entry><entry thead="no"><para>Graph Build   </para>
</entry><entry thead="no"><para>Asset Data   </para>
</entry><entry thead="no"><para>In-Memory Graph    </para>
</entry></row>
<row>
<entry thead="no"><para>4   </para>
</entry><entry thead="no"><para>Relationship Discovery   </para>
</entry><entry thead="no"><para>Graph Nodes   </para>
</entry><entry thead="no"><para>Edge Creation    </para>
</entry></row>
<row>
<entry thead="no"><para>5   </para>
</entry><entry thead="no"><para>Optional Persistence   </para>
</entry><entry thead="no"><para>In-Memory Graph   </para>
</entry><entry thead="no"><para>SQLAlchemy ORM    </para>
</entry></row>
<row>
<entry thead="no"><para>6   </para>
</entry><entry thead="no"><para>API Serving   </para>
</entry><entry thead="no"><para>In-Memory Graph   </para>
</entry><entry thead="no"><para>FastAPI Responses   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4104">
<title>6.2.5 ORM Layer Design</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4105">
<title>6.2.5.1 SQLAlchemy Configuration</title><para>Implemented in <computeroutput><ref refid="src_2data_2database_8py" kindref="compound">src/data/database.py</ref></computeroutput>, the ORM layer supports multiple database backends:</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>SQLAlchemy Version   </para>
</entry><entry thead="no"><para>&gt;=2.0.0   </para>
</entry><entry thead="no"><para>Modern ORM syntax    </para>
</entry></row>
<row>
<entry thead="no"><para>Syntax Style   </para>
</entry><entry thead="no"><para>2.x with <computeroutput>Mapped</computeroutput>/<computeroutput>mapped_column</computeroutput>   </para>
</entry><entry thead="no"><para>Type-safe mappings    </para>
</entry></row>
<row>
<entry thead="no"><para>Environment Variable   </para>
</entry><entry thead="no"><para><computeroutput>ASSET_GRAPH_DATABASE_URL</computeroutput>   </para>
</entry><entry thead="no"><para>Connection string    </para>
</entry></row>
<row>
<entry thead="no"><para>Default Backend   </para>
</entry><entry thead="no"><para>SQLite   </para>
</entry><entry thead="no"><para>Development simplicity   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4106">
<title>6.2.5.2 Connection Configuration by Backend</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Backend   </para>
</entry><entry thead="yes"><para>Use Case   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>SQLite (file)   </para>
</entry><entry thead="no"><para>Development   </para>
</entry><entry thead="no"><para><computeroutput>sqlite:///path/to/db.sqlite</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>SQLite (in-memory)   </para>
</entry><entry thead="no"><para>Testing   </para>
</entry><entry thead="no"><para><computeroutput>sqlite:///:memory:</computeroutput> with <computeroutput>StaticPool</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>PostgreSQL   </para>
</entry><entry thead="no"><para>Production   </para>
</entry><entry thead="no"><para><computeroutput>postgresql://user:pass@host/db</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4107">
<title>6.2.5.3 ORM Model Classes</title><para>Defined in <computeroutput><ref refid="db__models_8py" kindref="compound">src/data/db_models.py</ref></computeroutput>:</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4108">
<title>AssetORM Model</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>SQLAlchemy Type   </para>
</entry><entry thead="yes"><para>Relationship    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Mapped[str]</computeroutput>   </para>
</entry><entry thead="no"><para>Primary Key    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>outgoing_relationships</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Mapped[List[&quot;AssetRelationshipORM&quot;]]</computeroutput>   </para>
</entry><entry thead="no"><para>One-to-Many (cascade: all, delete-orphan)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>incoming_relationships</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Mapped[List[&quot;AssetRelationshipORM&quot;]]</computeroutput>   </para>
</entry><entry thead="no"><para>One-to-Many (cascade: all, delete-orphan)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_events</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Mapped[List[&quot;RegulatoryEventORM&quot;]]</computeroutput>   </para>
</entry><entry thead="no"><para>One-to-Many (cascade: all, delete-orphan)   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4109">
<title>AssetRelationshipORM Model</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>SQLAlchemy Type   </para>
</entry><entry thead="yes"><para>Relationship    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Mapped[int]</computeroutput>   </para>
</entry><entry thead="no"><para>Primary Key (autoincrement)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>source_asset</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Mapped[&quot;AssetORM&quot;]</computeroutput>   </para>
</entry><entry thead="no"><para>Many-to-One    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>target_asset</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Mapped[&quot;AssetORM&quot;]</computeroutput>   </para>
</entry><entry thead="no"><para>Many-to-One   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4110">
<title>RegulatoryEventORM Model</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>SQLAlchemy Type   </para>
</entry><entry thead="yes"><para>Relationship    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Mapped[str]</computeroutput>   </para>
</entry><entry thead="no"><para>Primary Key    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Mapped[&quot;AssetORM&quot;]</computeroutput>   </para>
</entry><entry thead="no"><para>Many-to-One    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>related_assets</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Mapped[List[&quot;RegulatoryEventAssetORM&quot;]]</computeroutput>   </para>
</entry><entry thead="no"><para>One-to-Many (cascade: all, delete-orphan)   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4111">
<title>6.2.5.4 Repository Pattern Implementation</title><para>The <computeroutput>AssetGraphRepository</computeroutput> class in <computeroutput><ref refid="repository_8py" kindref="compound">src/data/repository.py</ref></computeroutput> provides the data access layer:</para>
<para><table rows="12" cols="3"><row>
<entry thead="yes"><para>Method   </para>
</entry><entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Transaction Scope    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>upsert_asset()</computeroutput>   </para>
</entry><entry thead="no"><para>Insert or update asset   </para>
</entry><entry thead="no"><para>Caller manages    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>list_assets()</computeroutput>   </para>
</entry><entry thead="no"><para>Retrieve all assets   </para>
</entry><entry thead="no"><para>Read-only    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>get_assets_map()</computeroutput>   </para>
</entry><entry thead="no"><para>Dict by asset ID   </para>
</entry><entry thead="no"><para>Read-only    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>delete_asset()</computeroutput>   </para>
</entry><entry thead="no"><para>Remove asset (cascades)   </para>
</entry><entry thead="no"><para>Caller manages    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>add_or_update_relationship()</computeroutput>   </para>
</entry><entry thead="no"><para>Upsert edge   </para>
</entry><entry thead="no"><para>Caller manages    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>list_relationships()</computeroutput>   </para>
</entry><entry thead="no"><para>Retrieve all edges   </para>
</entry><entry thead="no"><para>Read-only    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>get_relationship()</computeroutput>   </para>
</entry><entry thead="no"><para>Single edge lookup   </para>
</entry><entry thead="no"><para>Read-only    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>delete_relationship()</computeroutput>   </para>
</entry><entry thead="no"><para>Remove edge   </para>
</entry><entry thead="no"><para>Caller manages    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>upsert_regulatory_event()</computeroutput>   </para>
</entry><entry thead="no"><para>Insert/update event   </para>
</entry><entry thead="no"><para>Caller manages    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>list_regulatory_events()</computeroutput>   </para>
</entry><entry thead="no"><para>Retrieve all events   </para>
</entry><entry thead="no"><para>Read-only    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>delete_regulatory_event()</computeroutput>   </para>
</entry><entry thead="no"><para>Remove event   </para>
</entry><entry thead="no"><para>Caller manages   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4113">
<title>6.2.6 Caching Architecture</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4114">
<title>6.2.6.1 JSON File Cache Design</title><para>Implemented in <computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>, the cache layer provides persistent storage for external API data:</para>
<para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Environment Variable   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Real Data Cache   </para>
</entry><entry thead="no"><para><computeroutput>REAL_DATA_CACHE_PATH</computeroutput>   </para>
</entry><entry thead="no"><para>Yahoo Finance data    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Cache   </para>
</entry><entry thead="no"><para><computeroutput>GRAPH_CACHE_PATH</computeroutput>   </para>
</entry><entry thead="no"><para>Serialized graph state   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4115">
<title>6.2.6.2 Atomic Write Pattern</title><para>The cache uses an atomic write pattern to prevent data corruption:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>AtomicWrite[Atomic<sp/>Write<sp/>Sequence]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Start([Start<sp/>Write])<sp/>--&gt;<sp/>CreateTemp[Create<sp/>NamedTemporaryFile&lt;br/&gt;in<sp/>same<sp/>directory]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CreateTemp<sp/>--&gt;<sp/>WriteJSON[Write<sp/>JSON<sp/>Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WriteJSON<sp/>--&gt;<sp/>FlushSync[Flush<sp/>+<sp/>Sync&lt;br/&gt;to<sp/>Disk]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FlushSync<sp/>--&gt;<sp/>CloseHandle[Close<sp/>File<sp/>Handle]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CloseHandle<sp/>--&gt;<sp/>AtomicRename[os.replace()&lt;br/&gt;Atomic<sp/>Rename]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AtomicRename<sp/>--&gt;<sp/>Complete([Write<sp/>Complete])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>FailurePath[Failure<sp/>Recovery]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WriteJSON<sp/>-.-&gt;|Exception|<sp/>CleanupTemp[Delete<sp/>Temp<sp/>File]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FlushSync<sp/>-.-&gt;|Exception|<sp/>CleanupTemp</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CleanupTemp<sp/>--&gt;<sp/>Failed([Write<sp/>Failed&lt;br/&gt;Original<sp/>Preserved])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4116">
<title>6.2.6.3 Atomic Write Guarantees</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Phase   </para>
</entry><entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Failure Behavior    </para>
</entry></row>
<row>
<entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>Create temporary file   </para>
</entry><entry thead="no"><para>No change to target    </para>
</entry></row>
<row>
<entry thead="no"><para>2   </para>
</entry><entry thead="no"><para>Write JSON content   </para>
</entry><entry thead="no"><para>Temp file only    </para>
</entry></row>
<row>
<entry thead="no"><para>3   </para>
</entry><entry thead="no"><para>Flush and sync   </para>
</entry><entry thead="no"><para>Data on disk in temp    </para>
</entry></row>
<row>
<entry thead="no"><para>4   </para>
</entry><entry thead="no"><para><computeroutput>os.replace()</computeroutput>   </para>
</entry><entry thead="no"><para>Atomic swap or rollback   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4117">
<title>6.2.6.4 Cache Content Structure</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Element   </para>
</entry><entry thead="yes"><para>Serialization   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Assets   </para>
</entry><entry thead="no"><para>JSON with <computeroutput>__type__</computeroutput> discriminator   </para>
</entry><entry thead="no"><para>Type reconstruction    </para>
</entry></row>
<row>
<entry thead="no"><para>Regulatory Events   </para>
</entry><entry thead="no"><para><ref refid="classEnum" kindref="compound">Enum</ref> values as strings   </para>
</entry><entry thead="no"><para>Serialization compatibility    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationships   </para>
</entry><entry thead="no"><para>Adjacency list format   </para>
</entry><entry thead="no"><para>Graph reconstruction    </para>
</entry></row>
<row>
<entry thead="no"><para>Metadata   </para>
</entry><entry thead="no"><para>Timestamps, version info   </para>
</entry><entry thead="no"><para>Cache validation   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4119">
<title>6.2.7 Replication and High Availability</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4120">
<title>6.2.7.1 Current Architecture Limitations</title><para>As documented in the system constraints, the current architecture prioritizes simplicity over high availability:</para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Constraint ID   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Impact    </para>
</entry></row>
<row>
<entry thead="no"><para>C-001   </para>
</entry><entry thead="no"><para>In-memory graph limits scalability   </para>
</entry><entry thead="no"><para>No built-in replication    </para>
</entry></row>
<row>
<entry thead="no"><para>A-003   </para>
</entry><entry thead="no"><para>Single concurrent admin sufficient   </para>
</entry><entry thead="no"><para>Single-user authentication    </para>
</entry></row>
<row>
<entry thead="no"><para>A-004   </para>
</entry><entry thead="no"><para>Dataset size &lt;500 nodes   </para>
</entry><entry thead="no"><para>Memory-based storage viable   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4121">
<title>6.2.7.2 Replication Architecture Diagram</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>CurrentArchitecture[Current<sp/>Single-Instance<sp/>Architecture]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SingleProcess[Python<sp/>Process]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InMemoryGraph[In-Memory<sp/>Graph]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLiteAuth[(SQLite<sp/>Auth)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JSONCache[(JSON<sp/>Cache)]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SingleProcess<sp/>--&gt;<sp/>InMemoryGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SingleProcess<sp/>--&gt;<sp/>SQLiteAuth</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SingleProcess<sp/>--&gt;<sp/>JSONCache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>FutureScaling[Future<sp/>Scaling<sp/>Path]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadBalancer[Load<sp/>Balancer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Instance1[Instance<sp/>1]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Instance2[Instance<sp/>2]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SharedDB[(PostgreSQL&lt;br/&gt;Shared<sp/>Database)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DistCache[(Redis<sp/>Cache)]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadBalancer<sp/>--&gt;<sp/>Instance1</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadBalancer<sp/>--&gt;<sp/>Instance2</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Instance1<sp/>--&gt;<sp/>SharedDB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Instance2<sp/>--&gt;<sp/>SharedDB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Instance1<sp/>--&gt;<sp/>DistCache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Instance2<sp/>--&gt;<sp/>DistCache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CurrentArchitecture<sp/>-.-&gt;|Migration<sp/>Path|<sp/>FutureScaling</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4122">
<title>6.2.7.3 Production Scaling Recommendations</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Growth Trigger   </para>
</entry><entry thead="yes"><para>Recommended Action   </para>
</entry><entry thead="yes"><para>Module Impact    </para>
</entry></row>
<row>
<entry thead="no"><para>&gt;500 assets   </para>
</entry><entry thead="no"><para>Enable PostgreSQL persistence   </para>
</entry><entry thead="no"><para>Graph Engine    </para>
</entry></row>
<row>
<entry thead="no"><para>Multi-user requirements   </para>
</entry><entry thead="no"><para>Implement connection pooling   </para>
</entry><entry thead="no"><para>Auth Module    </para>
</entry></row>
<row>
<entry thead="no"><para>High availability needs   </para>
</entry><entry thead="no"><para>Deploy multiple instances   </para>
</entry><entry thead="no"><para>All modules    </para>
</entry></row>
<row>
<entry thead="no"><para>Session management   </para>
</entry><entry thead="no"><para>Add Redis for shared state   </para>
</entry><entry thead="no"><para>API Layer   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4124">
<title>6.2.8 Backup and Recovery Architecture</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4125">
<title>6.2.8.1 Data Durability by Component</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Durability Level   </para>
</entry><entry thead="yes"><para>Backup Method    </para>
</entry></row>
<row>
<entry thead="no"><para>In-Memory Graph   </para>
</entry><entry thead="no"><para>Process lifetime   </para>
</entry><entry thead="no"><para>JSON cache serialization    </para>
</entry></row>
<row>
<entry thead="no"><para>SQLite Auth   </para>
</entry><entry thead="no"><para>File-based persistence   </para>
</entry><entry thead="no"><para>File system backup    </para>
</entry></row>
<row>
<entry thead="no"><para>PostgreSQL (if used)   </para>
</entry><entry thead="no"><para>Database-level   </para>
</entry><entry thead="no"><para>pg_dump, WAL archiving    </para>
</entry></row>
<row>
<entry thead="no"><para>JSON Cache   </para>
</entry><entry thead="no"><para>File-based   </para>
</entry><entry thead="no"><para>File system backup   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4126">
<title>6.2.8.2 Recovery Scenarios</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Scenario   </para>
</entry><entry thead="yes"><para>Detection Method   </para>
</entry><entry thead="yes"><para>Recovery Action   </para>
</entry><entry thead="yes"><para>Data Loss    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph corruption   </para>
</entry><entry thead="no"><para>Validation failure   </para>
</entry><entry thead="no"><para>Reload from cache or fetch   </para>
</entry><entry thead="no"><para>None (if cached)    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache file corruption   </para>
</entry><entry thead="no"><para>JSON parse error   </para>
</entry><entry thead="no"><para>Fresh fetch from source   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Auth database loss   </para>
</entry><entry thead="no"><para>Connection failure   </para>
</entry><entry thead="no"><para>Restore from backup   </para>
</entry><entry thead="no"><para>Potential    </para>
</entry></row>
<row>
<entry thead="no"><para>Process restart   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry><entry thead="no"><para>Graph reinitialization   </para>
</entry><entry thead="no"><para>Session state   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4127">
<title>6.2.8.3 Disaster Recovery Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DisasterRecovery[Disaster<sp/>Recovery<sp/>Flow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Failure([System<sp/>Failure])<sp/>--&gt;<sp/>DetectType{Failure<sp/>Type}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DetectType<sp/>--&gt;|Graph<sp/>Corruption|<sp/>ClearGraph[Clear<sp/>In-Memory&lt;br/&gt;Graph]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DetectType<sp/>--&gt;|Cache<sp/>Corruption|<sp/>DeleteCache[Delete<sp/>Cache&lt;br/&gt;File]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DetectType<sp/>--&gt;|Database<sp/>Loss|<sp/>RestoreBackup[Restore<sp/>from&lt;br/&gt;Backup]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DetectType<sp/>--&gt;|Full<sp/>System|<sp/>FullRestore[Full<sp/>System&lt;br/&gt;Recovery]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClearGraph<sp/>--&gt;<sp/>ReinitGraph[Reinitialize&lt;br/&gt;Graph]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DeleteCache<sp/>--&gt;<sp/>FreshFetch[Fresh<sp/>Data&lt;br/&gt;Fetch]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RestoreBackup<sp/>--&gt;<sp/>VerifyData[Verify<sp/>Data&lt;br/&gt;Integrity]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FullRestore<sp/>--&gt;<sp/>DeployNew[Deploy<sp/>New&lt;br/&gt;Instance]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReinitGraph<sp/>--&gt;<sp/>CheckCache{Cache&lt;br/&gt;Available?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckCache<sp/>--&gt;|Yes|<sp/>LoadCache[Load<sp/>from&lt;br/&gt;Cache]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckCache<sp/>--&gt;|No|<sp/>FreshFetch</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FreshFetch<sp/>--&gt;<sp/>BuildGraph[Build<sp/>Graph&lt;br/&gt;from<sp/>Source]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadCache<sp/>--&gt;<sp/>Operational([System&lt;br/&gt;Operational])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BuildGraph<sp/>--&gt;<sp/>Operational</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VerifyData<sp/>--&gt;<sp/>Operational</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DeployNew<sp/>--&gt;<sp/>Operational</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4128">
<title>6.2.8.4 Data Recovery Priority</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Priority   </para>
</entry><entry thead="yes"><para>Data Type   </para>
</entry><entry thead="yes"><para>Recovery Source   </para>
</entry><entry thead="yes"><para>Maximum Acceptable Loss    </para>
</entry></row>
<row>
<entry thead="no"><para>1 (Critical)   </para>
</entry><entry thead="no"><para>User credentials   </para>
</entry><entry thead="no"><para>SQLite backup   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>2 (High)   </para>
</entry><entry thead="no"><para>Graph state   </para>
</entry><entry thead="no"><para>Cache or Yahoo Finance   </para>
</entry><entry thead="no"><para>Minutes of updates    </para>
</entry></row>
<row>
<entry thead="no"><para>3 (Medium)   </para>
</entry><entry thead="no"><para>Cached data   </para>
</entry><entry thead="no"><para>Fresh external fetch   </para>
</entry><entry thead="no"><para>Cache refresh time    </para>
</entry></row>
<row>
<entry thead="no"><para>4 (Low)   </para>
</entry><entry thead="no"><para>Session state   </para>
</entry><entry thead="no"><para>Stateless (no recovery)   </para>
</entry><entry thead="no"><para>Full session   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4130">
<title>6.2.9 Compliance Considerations</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4131">
<title>6.2.9.1 Data Retention Policies</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Data Type   </para>
</entry><entry thead="yes"><para>Retention Period   </para>
</entry><entry thead="yes"><para>Disposal Method    </para>
</entry></row>
<row>
<entry thead="no"><para>User credentials   </para>
</entry><entry thead="no"><para>Until explicitly deleted   </para>
</entry><entry thead="no"><para>Secure database deletion    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication logs   </para>
</entry><entry thead="no"><para>Application runtime   </para>
</entry><entry thead="no"><para>In-memory only    </para>
</entry></row>
<row>
<entry thead="no"><para>Cached market data   </para>
</entry><entry thead="no"><para>Configurable cache TTL   </para>
</entry><entry thead="no"><para>File overwrite    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph state   </para>
</entry><entry thead="no"><para>Process lifetime   </para>
</entry><entry thead="no"><para>Memory deallocation   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4132">
<title>6.2.9.2 Access Control Matrix</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Role   </para>
</entry><entry thead="yes"><para>Authentication   </para>
</entry><entry thead="yes"><para>Asset Data   </para>
</entry><entry thead="yes"><para>User Management    </para>
</entry></row>
<row>
<entry thead="no"><para>Anonymous   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>Read-only API access   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Authenticated User   </para>
</entry><entry thead="no"><para>JWT token   </para>
</entry><entry thead="no"><para>Full API access   </para>
</entry><entry thead="no"><para>Self-profile only    </para>
</entry></row>
<row>
<entry thead="no"><para>Admin   </para>
</entry><entry thead="no"><para>JWT + admin flag   </para>
</entry><entry thead="no"><para>Full access   </para>
</entry><entry thead="no"><para>User CRUD   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4133">
<title>6.2.9.3 Privacy Controls</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Control   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Location    </para>
</entry></row>
<row>
<entry thead="no"><para>Password hashing   </para>
</entry><entry thead="no"><para>pbkdf2_sha256   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Token expiration   </para>
</entry><entry thead="no"><para>30-minute JWT lifetime   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Secure transport   </para>
</entry><entry thead="no"><para>HTTPS required in production   </para>
</entry><entry thead="no"><para>Deployment config    </para>
</entry></row>
<row>
<entry thead="no"><para>Secret management   </para>
</entry><entry thead="no"><para>Environment variables only   </para>
</entry><entry thead="no"><para>Never committed   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4134">
<title>6.2.9.4 Audit Mechanisms</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Audit Point   </para>
</entry><entry thead="yes"><para>Log Level   </para>
</entry><entry thead="yes"><para>Content    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph initialization   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Success/failure status    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication attempts   </para>
</entry><entry thead="no"><para>WARNING   </para>
</entry><entry thead="no"><para>Failed login attempts    </para>
</entry></row>
<row>
<entry thead="no"><para>Request errors   </para>
</entry><entry thead="no"><para>ERROR   </para>
</entry><entry thead="no"><para>Exception details    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache operations   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Load/save success   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4136">
<title>6.2.10 Performance Optimization</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4137">
<title>6.2.10.1 Query Optimization Patterns</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Pattern   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Benefit    </para>
</entry></row>
<row>
<entry thead="no"><para>In-memory primary storage   </para>
</entry><entry thead="no"><para><computeroutput>Dict[source_id, List[Tuple]]</computeroutput>   </para>
</entry><entry thead="no"><para>Sub-millisecond traversal    </para>
</entry></row>
<row>
<entry thead="no"><para>Thread-safe singleton   </para>
</entry><entry thead="no"><para>Double-checked locking   </para>
</entry><entry thead="no"><para>Minimal lock contention    </para>
</entry></row>
<row>
<entry thead="no"><para>Lazy initialization   </para>
</entry><entry thead="no"><para>On-demand graph creation   </para>
</entry><entry thead="no"><para>Fast application startup    </para>
</entry></row>
<row>
<entry thead="no"><para>Unique constraint indexes   </para>
</entry><entry thead="no"><para>Composite unique keys   </para>
</entry><entry thead="no"><para>O(1) duplicate detection   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4138">
<title>6.2.10.2 Performance Targets</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Target SLA   </para>
</entry><entry thead="yes"><para>Measurement    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship traversal   </para>
</entry><entry thead="no"><para>&lt;1ms   </para>
</entry><entry thead="no"><para>In-memory graph access    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset lookup   </para>
</entry><entry thead="no"><para>&lt;10ms   </para>
</entry><entry thead="no"><para>Indexed primary key    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph initialization   </para>
</entry><entry thead="no"><para>&lt;3 seconds   </para>
</entry><entry thead="no"><para>Application startup    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship discovery   </para>
</entry><entry thead="no"><para>&lt;500ms   </para>
</entry><entry thead="no"><para>For 100 assets   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4139">
<title>6.2.10.3 Connection Management</title></sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4140">
<title>SQLite Authentication Database</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>check_same_thread</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>False</computeroutput>   </para>
</entry><entry thead="no"><para>Multi-threaded access    </para>
</entry></row>
<row>
<entry thead="no"><para>Connection sharing   </para>
</entry><entry thead="no"><para>Locked shared connection   </para>
</entry><entry thead="no"><para>In-memory database support    </para>
</entry></row>
<row>
<entry thead="no"><para>Row factory   </para>
</entry><entry thead="no"><para>Dict-style access   </para>
</entry><entry thead="no"><para>Convenient result handling   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4141">
<title>SQLAlchemy ORM Connection</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Backend   </para>
</entry><entry thead="yes"><para>Pool Configuration   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>SQLite in-memory   </para>
</entry><entry thead="no"><para><computeroutput>StaticPool</computeroutput>   </para>
</entry><entry thead="no"><para>Single shared connection    </para>
</entry></row>
<row>
<entry thead="no"><para>SQLite file   </para>
</entry><entry thead="no"><para>Default pool   </para>
</entry><entry thead="no"><para>Connection reuse    </para>
</entry></row>
<row>
<entry thead="no"><para>PostgreSQL   </para>
</entry><entry thead="no"><para>Default pool   </para>
</entry><entry thead="no"><para>Connection pooling   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4142">
<title>6.2.10.4 Batch Processing Approach</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Batch Strategy   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph initialization   </para>
</entry><entry thead="no"><para>Bulk asset loading   </para>
</entry><entry thead="no"><para>Single transaction    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship building   </para>
</entry><entry thead="no"><para>Iterate all assets once   </para>
</entry><entry thead="no"><para>O(n) complexity    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache serialization   </para>
</entry><entry thead="no"><para>Single JSON write   </para>
</entry><entry thead="no"><para>Atomic file operation    </para>
</entry></row>
<row>
<entry thead="no"><para>Repository upserts   </para>
</entry><entry thead="no"><para>Caller-managed batching   </para>
</entry><entry thead="no"><para>Session scope pattern   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4144">
<title>6.2.11 Transaction Management</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4145">
<title>6.2.11.1 Transaction Boundaries</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>TransactionScope[Transaction<sp/>Scope<sp/>Management]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>StartOp([Start<sp/>Operation])<sp/>--&gt;<sp/>AcquireSession[Acquire&lt;br/&gt;Session]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AcquireSession<sp/>--&gt;<sp/>BeginTx[Begin&lt;br/&gt;Transaction]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BeginTx<sp/>--&gt;<sp/>ExecuteOps[Execute&lt;br/&gt;Operations]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ExecuteOps<sp/>--&gt;<sp/>CheckSuccess{Success?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckSuccess<sp/>--&gt;|Yes|<sp/>CommitTx[Commit&lt;br/&gt;Transaction]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckSuccess<sp/>--&gt;|No|<sp/>RollbackTx[Rollback&lt;br/&gt;Transaction]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CommitTx<sp/>--&gt;<sp/>CloseSession[Close&lt;br/&gt;Session]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RollbackTx<sp/>--&gt;<sp/>CloseSession</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CloseSession<sp/>--&gt;<sp/>EndOp([End<sp/>Operation])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4146">
<title>6.2.11.2 Session Scope Context Manager</title><para>The <computeroutput>session_scope</computeroutput> context manager in <computeroutput><ref refid="repository_8py" kindref="compound">src/data/repository.py</ref></computeroutput> provides transaction management:</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Phase   </para>
</entry><entry thead="yes"><para>Action   </para>
</entry><entry thead="yes"><para>On Exception    </para>
</entry></row>
<row>
<entry thead="no"><para>Entry   </para>
</entry><entry thead="no"><para>Create session from factory   </para>
</entry><entry thead="no"><para>N/A    </para>
</entry></row>
<row>
<entry thead="no"><para>Yield   </para>
</entry><entry thead="no"><para>Expose session for operations   </para>
</entry><entry thead="no"><para>N/A    </para>
</entry></row>
<row>
<entry thead="no"><para>Exit (success)   </para>
</entry><entry thead="no"><para>Commit transaction   </para>
</entry><entry thead="no"><para>N/A    </para>
</entry></row>
<row>
<entry thead="no"><para>Exit (error)   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry><entry thead="no"><para>Rollback transaction    </para>
</entry></row>
<row>
<entry thead="no"><para>Finally   </para>
</entry><entry thead="no"><para>Close session   </para>
</entry><entry thead="no"><para>Close session   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4147">
<title>6.2.11.3 Cascade Delete Behavior</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Parent Entity   </para>
</entry><entry thead="yes"><para>Child Entities   </para>
</entry><entry thead="yes"><para>Cascade Type    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset   </para>
</entry><entry thead="no"><para>asset_relationships (outgoing)   </para>
</entry><entry thead="no"><para>all, delete-orphan    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset   </para>
</entry><entry thead="no"><para>asset_relationships (incoming)   </para>
</entry><entry thead="no"><para>all, delete-orphan    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset   </para>
</entry><entry thead="no"><para>regulatory_events   </para>
</entry><entry thead="no"><para>all, delete-orphan    </para>
</entry></row>
<row>
<entry thead="no"><para>Regulatory Event   </para>
</entry><entry thead="no"><para>regulatory_event_assets   </para>
</entry><entry thead="no"><para>all, delete-orphan   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4149">
<title>6.2.12 Domain Model Validation</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4150">
<title>6.2.12.1 Validation Rules</title><para>Implemented in <computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>:</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Field   </para>
</entry><entry thead="yes"><para>Validation Rule   </para>
</entry><entry thead="yes"><para>Error Type    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>id</computeroutput>, <computeroutput>symbol</computeroutput>, <computeroutput>name</computeroutput>   </para>
</entry><entry thead="no"><para>Non-empty string   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>price</computeroutput>, <computeroutput>market_cap</computeroutput>   </para>
</entry><entry thead="no"><para>Non-negative float   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>currency</computeroutput>   </para>
</entry><entry thead="no"><para>3-character ISO code   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>impact_score</computeroutput>   </para>
</entry><entry thead="no"><para>Range [-1.0, 1.0]   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>date</computeroutput> (events)   </para>
</entry><entry thead="no"><para>ISO 8601 format   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4151">
<title>6.2.12.2 Validation Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ValidationFlow[Domain<sp/>Model<sp/>Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Input([Input<sp/>Data])<sp/>--&gt;<sp/>TypeCheck{Type&lt;br/&gt;Valid?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TypeCheck<sp/>--&gt;|No|<sp/>TypeError([TypeError])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TypeCheck<sp/>--&gt;|Yes|<sp/>RangeCheck{Range&lt;br/&gt;Valid?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RangeCheck<sp/>--&gt;|No|<sp/>ValueError([ValueError])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RangeCheck<sp/>--&gt;|Yes|<sp/>FormatCheck{Format&lt;br/&gt;Valid?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FormatCheck<sp/>--&gt;|No|<sp/>FormatError([ValueError])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FormatCheck<sp/>--&gt;|Yes|<sp/>CreateModel([Create&lt;br/&gt;Domain<sp/>Object])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4153">
<title>6.2.13 Environment Configuration</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4154">
<title>6.2.13.1 Database Environment Variables</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Variable   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Example Value    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>DATABASE_URL</computeroutput>   </para>
</entry><entry thead="no"><para>SQLite authentication database   </para>
</entry><entry thead="no"><para><computeroutput>sqlite:///auth.db</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ASSET_GRAPH_DATABASE_URL</computeroutput>   </para>
</entry><entry thead="no"><para>SQLAlchemy ORM connection   </para>
</entry><entry thead="no"><para><computeroutput>postgresql://user:pass@host/db</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GRAPH_CACHE_PATH</computeroutput>   </para>
</entry><entry thead="no"><para>Graph cache file location   </para>
</entry><entry thead="no"><para><computeroutput>/data/graph_cache.json</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>REAL_DATA_CACHE_PATH</computeroutput>   </para>
</entry><entry thead="no"><para>Yahoo Finance cache location   </para>
</entry><entry thead="no"><para><computeroutput>/data/real_data.json</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>USE_REAL_DATA_FETCHER</computeroutput>   </para>
</entry><entry thead="no"><para>Enable live data fetching   </para>
</entry><entry thead="no"><para><computeroutput>true</computeroutput> or <computeroutput>false</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4155">
<title>6.2.13.2 Security Environment Variables</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Variable   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Sensitivity    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SECRET_KEY</computeroutput>   </para>
</entry><entry thead="no"><para>JWT signing key   </para>
</entry><entry thead="no"><para>Critical - never commit    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_USERNAME</computeroutput>   </para>
</entry><entry thead="no"><para>Default admin user   </para>
</entry><entry thead="no"><para>Sensitive    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_PASSWORD</computeroutput>   </para>
</entry><entry thead="no"><para>Default admin password   </para>
</entry><entry thead="no"><para>Critical - never commit    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_EMAIL</computeroutput>   </para>
</entry><entry thead="no"><para>Admin email address   </para>
</entry><entry thead="no"><para>Low    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_FULL_NAME</computeroutput>   </para>
</entry><entry thead="no"><para>Admin display name   </para>
</entry><entry thead="no"><para>Low    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_DISABLED</computeroutput>   </para>
</entry><entry thead="no"><para>Admin disabled flag   </para>
</entry><entry thead="no"><para>Low   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4157">
<title>6.2.14 Future Database Enhancements</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4158">
<title>6.2.14.1 Planned Improvements</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Enhancement   </para>
</entry><entry thead="yes"><para>Priority   </para>
</entry><entry thead="yes"><para>Complexity   </para>
</entry><entry thead="yes"><para>Impact    </para>
</entry></row>
<row>
<entry thead="no"><para>PostgreSQL full support   </para>
</entry><entry thead="no"><para>High   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry><entry thead="no"><para>Production readiness    </para>
</entry></row>
<row>
<entry thead="no"><para>Connection pooling   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry><entry thead="no"><para>Low   </para>
</entry><entry thead="no"><para>Improved concurrency    </para>
</entry></row>
<row>
<entry thead="no"><para>Read replicas   </para>
</entry><entry thead="no"><para>Low   </para>
</entry><entry thead="no"><para>High   </para>
</entry><entry thead="no"><para>Horizontal scaling    </para>
</entry></row>
<row>
<entry thead="no"><para>Partitioning by asset class   </para>
</entry><entry thead="no"><para>Low   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry><entry thead="no"><para>Query performance   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4159">
<title>6.2.14.2 Migration Path to Microservices</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Current Component   </para>
</entry><entry thead="yes"><para>Future Service   </para>
</entry><entry thead="yes"><para>Database Change    </para>
</entry></row>
<row>
<entry thead="no"><para>In-memory graph   </para>
</entry><entry thead="no"><para>Graph Service   </para>
</entry><entry thead="no"><para>PostgreSQL + Redis cache    </para>
</entry></row>
<row>
<entry thead="no"><para>SQLite auth   </para>
</entry><entry thead="no"><para>Auth Service   </para>
</entry><entry thead="no"><para>Dedicated auth database    </para>
</entry></row>
<row>
<entry thead="no"><para>JSON cache   </para>
</entry><entry thead="no"><para>Cache Service   </para>
</entry><entry thead="no"><para>Redis/Memcached    </para>
</entry></row>
<row>
<entry thead="no"><para>Repository layer   </para>
</entry><entry thead="no"><para>Data Service   </para>
</entry><entry thead="no"><para>Dedicated asset database   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4161">
<title>6.2.15 References</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4162">
<title>6.2.15.1 Source Files</title><para><table rows="13" cols="2"><row>
<entry thead="yes"><para>Path   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>migrations/001_initial.sql</computeroutput>   </para>
</entry><entry thead="no"><para>DDL schema definitions    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2database_8py" kindref="compound">api/database.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>SQLite authentication helpers    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>JWT authentication and user management    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI application with graph lifecycle    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="src_2data_2database_8py" kindref="compound">src/data/database.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>SQLAlchemy engine configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="db__models_8py" kindref="compound">src/data/db_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>ORM model definitions    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="repository_8py" kindref="compound">src/data/repository.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Repository pattern implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Yahoo Finance caching with atomic writes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="sample__data_8py" kindref="compound">src/data/sample_data.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Sample database creation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>In-memory graph structure    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Domain model validation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>requirements.txt</computeroutput>   </para>
</entry><entry thead="no"><para>Database dependency declarations   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4163">
<title>6.2.15.2 Technical Specification Sections</title><para><table rows="9" cols="2"><row>
<entry thead="yes"><para>Section   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para>5.6 DATABASE SCHEMA   </para>
</entry><entry thead="no"><para>Core schema definitions    </para>
</entry></row>
<row>
<entry thead="no"><para>3.6 Databases &amp; Storage   </para>
</entry><entry thead="no"><para>Technology stack details    </para>
</entry></row>
<row>
<entry thead="no"><para>4.10 Transaction Boundaries and Persistence   </para>
</entry><entry thead="no"><para>Transaction patterns    </para>
</entry></row>
<row>
<entry thead="no"><para>3.8 Security Considerations   </para>
</entry><entry thead="no"><para>Authentication security    </para>
</entry></row>
<row>
<entry thead="no"><para>5.4 CROSS-CUTTING CONCERNS   </para>
</entry><entry thead="no"><para>Error handling and monitoring    </para>
</entry></row>
<row>
<entry thead="no"><para>5.5 DEPLOYMENT ARCHITECTURE   </para>
</entry><entry thead="no"><para>Deployment configurations    </para>
</entry></row>
<row>
<entry thead="no"><para>6.1 Core Services Architecture   </para>
</entry><entry thead="no"><para>Monolithic architecture context    </para>
</entry></row>
<row>
<entry thead="no"><para>2.6 Assumptions and Constraints   </para>
</entry><entry thead="no"><para>System limitations   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4164">
<title>6.2.15.3 Dependencies</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>SQLAlchemy   </para>
</entry><entry thead="no"><para>&gt;=2.0.0   </para>
</entry><entry thead="no"><para>ORM framework    </para>
</entry></row>
<row>
<entry thead="no"><para>passlib   </para>
</entry><entry thead="no"><para>(bundled)   </para>
</entry><entry thead="no"><para>Password hashing    </para>
</entry></row>
<row>
<entry thead="no"><para>PyJWT   </para>
</entry><entry thead="no"><para>(bundled)   </para>
</entry><entry thead="no"><para>JWT token handling    </para>
</entry></row>
<row>
<entry thead="no"><para>sqlite3   </para>
</entry><entry thead="no"><para>(stdlib)   </para>
</entry><entry thead="no"><para>Authentication database   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4165">
<title>6.3 Integration Architecture</title><para>The Financial Asset Relationship Database implements a <bold>REST/JSON API integration architecture</bold> designed for seamless communication between frontend clients, backend services, and external data sources. While the system follows a monolithic layered design (as documented in Section 6.1), it exposes well-defined integration points that enable frontend applications, external data providers, and AI tool integrations to interact with the core graph engine.</para>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4166">
<title>6.3.1 API DESIGN</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4167">
<title>6.3.1.1 Protocol Specifications</title><para>The system implements RESTful API communication using modern web standards and type-safe serialization patterns.</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Aspect   </para>
</entry><entry thead="yes"><para>Specification   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>Protocol   </para>
</entry><entry thead="no"><para>REST over HTTP/HTTPS   </para>
</entry><entry thead="no"><para>HTTP for development, HTTPS for production    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Format   </para>
</entry><entry thead="no"><para>JSON   </para>
</entry><entry thead="no"><para>Content-Type: application/json    </para>
</entry></row>
<row>
<entry thead="no"><para>API Framework   </para>
</entry><entry thead="no"><para>FastAPI 0.127.0   </para>
</entry><entry thead="no"><para>Automatic OpenAPI documentation    </para>
</entry></row>
<row>
<entry thead="no"><para>ASGI Server   </para>
</entry><entry thead="no"><para>Uvicorn ≥0.24.0   </para>
</entry><entry thead="no"><para>Async request handling    </para>
</entry></row>
<row>
<entry thead="no"><para>Serialization   </para>
</entry><entry thead="no"><para>Pydantic 2.12.5   </para>
</entry><entry thead="no"><para>Strict type validation   </para>
</entry></row>
</table>
</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ProtocolStack[Protocol<sp/>Stack<sp/>Architecture]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Client([API<sp/>Client])<sp/>--&gt;<sp/>HTTPS[HTTPS/TLS<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HTTPS<sp/>--&gt;<sp/>ASGI[Uvicorn<sp/>ASGI<sp/>Server]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ASGI<sp/>--&gt;<sp/>Middleware[FastAPI<sp/>Middleware<sp/>Stack]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>MiddlewareChain[Middleware<sp/>Processing]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS[CORS<sp/>Middleware]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimit[Rate<sp/>Limiter]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth[Auth<sp/>Middleware]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS<sp/>--&gt;<sp/>RateLimit</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimit<sp/>--&gt;<sp/>Auth</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Middleware<sp/>--&gt;<sp/>MiddlewareChain</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth<sp/>--&gt;<sp/>Router[FastAPI<sp/>Router]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Router<sp/>--&gt;<sp/>Pydantic[Pydantic<sp/>Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pydantic<sp/>--&gt;<sp/>Handler[Endpoint<sp/>Handler]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Handler<sp/>--&gt;<sp/>Graph[Graph<sp/>Engine]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4168">
<title>API Endpoint Catalog</title><para><table rows="13" cols="5"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Method   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Auth   </para>
</entry><entry thead="yes"><para>Rate Limit    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>API metadata   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/token</computeroutput>   </para>
</entry><entry thead="no"><para>POST   </para>
</entry><entry thead="no"><para>JWT issuance   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>5/min    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/health</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Health check   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>List assets   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets/{id}</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Asset details   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets/{id}/relationships</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Asset relationships   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/relationships</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>All relationships   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/metrics</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Network stats   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/visualization</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>3D visualization   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/asset-classes</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Asset classes   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/sectors</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Sectors   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/users/me</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Current user   </para>
</entry><entry thead="no"><para>Yes   </para>
</entry><entry thead="no"><para>10/min   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4169">
<title>6.3.1.2 Authentication Methods</title><para>The system implements JWT-based authentication with secure password hashing for credential validation.</para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Type   </para>
</entry><entry thead="no"><para>JWT (JSON Web Token)   </para>
</entry><entry thead="no"><para>OAuth2 Bearer scheme    </para>
</entry></row>
<row>
<entry thead="no"><para>Algorithm   </para>
</entry><entry thead="no"><para>HS256 (HMAC-SHA256)   </para>
</entry><entry thead="no"><para>PyJWT ≥2.8.0    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Expiration   </para>
</entry><entry thead="no"><para>30 minutes   </para>
</entry><entry thead="no"><para><computeroutput>ACCESS_TOKEN_EXPIRE_MINUTES</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Secret Key   </para>
</entry><entry thead="no"><para>Environment variable   </para>
</entry><entry thead="no"><para><computeroutput>SECRET_KEY</computeroutput> (required)    </para>
</entry></row>
<row>
<entry thead="no"><para>Password Hashing   </para>
</entry><entry thead="no"><para>pbkdf2_sha256   </para>
</entry><entry thead="no"><para>passlib CryptContext    </para>
</entry></row>
<row>
<entry thead="no"><para>Credential Storage   </para>
</entry><entry thead="no"><para>SQLite database   </para>
</entry><entry thead="no"><para><computeroutput>user_credentials</computeroutput> table   </para>
</entry></row>
</table>
</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Client<sp/>as<sp/>API<sp/>Client</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>RateLimiter<sp/>as<sp/>Rate<sp/>Limiter</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Auth<sp/>as<sp/>Auth<sp/>Module</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>UserRepo<sp/>as<sp/>User<sp/>Repository</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>JWT<sp/>as<sp/>JWT<sp/>Library</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Client-&gt;&gt;RateLimiter:<sp/>POST<sp/>/token<sp/>(credentials)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RateLimiter-&gt;&gt;RateLimiter:<sp/>Check<sp/>5/min<sp/>limit</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>alt<sp/>Rate<sp/>Limit<sp/>OK</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimiter-&gt;&gt;Auth:<sp/>Process<sp/>Login</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;UserRepo:<sp/>get_user(username)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserRepo--&gt;&gt;Auth:<sp/>User<sp/>or<sp/>None</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alt<sp/>User<sp/>Found</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;Auth:<sp/>verify_password(plain,<sp/>hashed)</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alt<sp/>Password<sp/>Valid</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;JWT:<sp/>encode(payload,<sp/>SECRET_KEY,<sp/>HS256)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JWT--&gt;&gt;Auth:<sp/>Access<sp/>Token</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth--&gt;&gt;Client:<sp/>{&quot;access_token&quot;:<sp/>&quot;...&quot;,<sp/>&quot;token_type&quot;:<sp/>&quot;bearer&quot;}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>Password<sp/>Invalid</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth--&gt;&gt;Client:<sp/>401<sp/>Incorrect<sp/>username<sp/>or<sp/>password</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>User<sp/>Not<sp/>Found</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth--&gt;&gt;Client:<sp/>401<sp/>Incorrect<sp/>username<sp/>or<sp/>password</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else<sp/>Rate<sp/>Limit<sp/>Exceeded</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimiter--&gt;&gt;Client:<sp/>429<sp/>Too<sp/>Many<sp/>Requests</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4170">
<title>6.3.1.3 Authorization Framework</title><para>Protected endpoint validation follows a five-step verification process ensuring token integrity and user status.</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Step   </para>
</entry><entry thead="yes"><para>Action   </para>
</entry><entry thead="yes"><para>Failure Response    </para>
</entry></row>
<row>
<entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>Extract Bearer token from header   </para>
</entry><entry thead="no"><para>401 Not authenticated    </para>
</entry></row>
<row>
<entry thead="no"><para>2   </para>
</entry><entry thead="no"><para>Decode JWT with SECRET_KEY   </para>
</entry><entry thead="no"><para>401 Could not validate    </para>
</entry></row>
<row>
<entry thead="no"><para>3   </para>
</entry><entry thead="no"><para>Check token expiration   </para>
</entry><entry thead="no"><para>401 Token has expired    </para>
</entry></row>
<row>
<entry thead="no"><para>4   </para>
</entry><entry thead="no"><para>Lookup user in repository   </para>
</entry><entry thead="no"><para>401 Invalid credentials    </para>
</entry></row>
<row>
<entry thead="no"><para>5   </para>
</entry><entry thead="no"><para>Verify user is active   </para>
</entry><entry thead="no"><para>400 Inactive user   </para>
</entry></row>
</table>
</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Authorization[Authorization<sp/>Validation<sp/>Flow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Request([Protected<sp/>Request])<sp/>--&gt;<sp/>ExtractToken{Bearer<sp/>Token&lt;br/&gt;Present?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ExtractToken<sp/>--&gt;|No|<sp/>Return401A[401<sp/>Not<sp/>Authenticated]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ExtractToken<sp/>--&gt;|Yes|<sp/>DecodeJWT{Decode<sp/>JWT&lt;br/&gt;Valid?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DecodeJWT<sp/>--&gt;|No|<sp/>Return401B[401<sp/>Could<sp/>Not<sp/>Validate]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DecodeJWT<sp/>--&gt;|Yes|<sp/>CheckExpiry{Token&lt;br/&gt;Expired?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckExpiry<sp/>--&gt;|Yes|<sp/>Return401C[401<sp/>Token<sp/>Expired]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckExpiry<sp/>--&gt;|No|<sp/>LookupUser{User&lt;br/&gt;Exists?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LookupUser<sp/>--&gt;|No|<sp/>Return401D[401<sp/>Invalid<sp/>Credentials]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LookupUser<sp/>--&gt;|Yes|<sp/>CheckActive{User&lt;br/&gt;Active?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckActive<sp/>--&gt;|No|<sp/>Return400[400<sp/>Inactive<sp/>User]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckActive<sp/>--&gt;|Yes|<sp/>Authorized([Access<sp/>Granted])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4171">
<title>6.3.1.4 Rate Limiting Strategy</title><para>The system implements endpoint-specific rate limiting using slowapi with client IP-based tracking.</para>
<para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Limit   </para>
</entry><entry thead="yes"><para>Window   </para>
</entry><entry thead="yes"><para>Key Function    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>POST /token</computeroutput>   </para>
</entry><entry thead="no"><para>5 requests   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Client IP    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GET /api/users/me</computeroutput>   </para>
</entry><entry thead="no"><para>10 requests   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Client IP    </para>
</entry></row>
<row>
<entry thead="no"><para>Other endpoints   </para>
</entry><entry thead="no"><para>Unlimited   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry></row>
</table>
</para>
<para><bold>Implementation Details:</bold></para>
<para><itemizedlist>
<listitem><para><bold>Library</bold>: slowapi with <computeroutput>get_remote_address</computeroutput> key function</para>
</listitem><listitem><para><bold>Exception Handling</bold>: <computeroutput>RateLimitExceeded</computeroutput> → custom handler returning HTTP 429</para>
</listitem><listitem><para><bold>Response Headers</bold>: Includes <computeroutput>Retry-After</computeroutput> header indicating wait time</para>
</listitem></itemizedlist>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4172">
<title>6.3.1.5 CORS Configuration</title><para>Cross-Origin Resource Sharing is configured based on deployment environment with strict origin validation.</para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Environment   </para>
</entry><entry thead="yes"><para>Allowed Origins   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Development   </para>
</entry><entry thead="no"><para><computeroutput><ulink url="http://localhost:3000">http://localhost:3000</ulink></computeroutput>, <computeroutput><ulink url="http://localhost:7860">http://localhost:7860</ulink></computeroutput>   </para>
</entry><entry thead="no"><para>Hardcoded    </para>
</entry></row>
<row>
<entry thead="no"><para>Production   </para>
</entry><entry thead="no"><para>HTTPS origins only   </para>
</entry><entry thead="no"><para>Environment variable    </para>
</entry></row>
<row>
<entry thead="no"><para>Custom   </para>
</entry><entry thead="no"><para>Comma-separated list   </para>
</entry><entry thead="no"><para><computeroutput>ALLOWED_ORIGINS</computeroutput>   </para>
</entry></row>
</table>
</para>
<para><bold>CORS Validation Rules:</bold></para>
<para><itemizedlist>
<listitem><para>HTTP localhost allowed only in development mode</para>
</listitem><listitem><para>HTTPS localhost allowed in any environment</para>
</listitem><listitem><para>Vercel preview URLs validated via regex: <computeroutput>^https://[a-zA-Z0-9\-\.]+\.vercel\.app$</computeroutput></para>
</listitem><listitem><para>Wildcard (<computeroutput>*</computeroutput>) origins prohibited when authentication headers are used</para>
</listitem></itemizedlist>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4173">
<title>6.3.1.6 Versioning Approach</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Aspect   </para>
</entry><entry thead="yes"><para>Current Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>API Version   </para>
</entry><entry thead="no"><para>1.0.0    </para>
</entry></row>
<row>
<entry thead="no"><para>Version Exposure   </para>
</entry><entry thead="no"><para>Root endpoint metadata    </para>
</entry></row>
<row>
<entry thead="no"><para>URL Versioning   </para>
</entry><entry thead="no"><para>Not implemented (single version)    </para>
</entry></row>
<row>
<entry thead="no"><para>Future Path   </para>
</entry><entry thead="no"><para>URL-based versioning (e.g., <computeroutput>/v2/</computeroutput>) when needed   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4174">
<title>6.3.1.7 Documentation Standards</title><para>The API implements comprehensive documentation through multiple mechanisms:</para>
<para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Standard   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>OpenAPI/Swagger   </para>
</entry><entry thead="no"><para>Auto-generated by FastAPI from type annotations    </para>
</entry></row>
<row>
<entry thead="no"><para>Interactive Docs   </para>
</entry><entry thead="no"><para>Available at <computeroutput>/docs</computeroutput> (Swagger UI) and <computeroutput>/redoc</computeroutput> (ReDoc)    </para>
</entry></row>
<row>
<entry thead="no"><para>Docstrings   </para>
</entry><entry thead="no"><para>Comprehensive Python docstrings on all endpoints    </para>
</entry></row>
<row>
<entry thead="no"><para>Type Annotations   </para>
</entry><entry thead="no"><para>Pydantic models for request/response schemas    </para>
</entry></row>
<row>
<entry thead="no"><para>Response Examples   </para>
</entry><entry thead="no"><para>Included in OpenAPI specification   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4176">
<title>6.3.2 MESSAGE PROCESSING</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4177">
<title>6.3.2.1 Event Processing Patterns</title><para>The system implements lifecycle event handling through FastAPI&apos;s lifespan context manager pattern.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4178">
<title>Application Lifecycle Events</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>LifecycleEvents[Application<sp/>Lifecycle<sp/>Events]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Startup([Application<sp/>Start])<sp/>--&gt;<sp/>InitGraph[Initialize<sp/>Graph<sp/>Engine]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InitGraph<sp/>--&gt;<sp/>LoadCache{Cache&lt;br/&gt;Available?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadCache<sp/>--&gt;|Yes|<sp/>UseCache[Load<sp/>from<sp/>JSON<sp/>Cache]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadCache<sp/>--&gt;|No|<sp/>FetchData[Fetch<sp/>from<sp/>Data<sp/>Source]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UseCache<sp/>--&gt;<sp/>GraphReady[Graph<sp/>Ready]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FetchData<sp/>--&gt;<sp/>BuildRelations[Build<sp/>Relationships]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BuildRelations<sp/>--&gt;<sp/>GraphReady</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphReady<sp/>--&gt;<sp/>LogStartup[Log<sp/>Startup<sp/>Complete]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LogStartup<sp/>--&gt;<sp/>Ready([Accept<sp/>Requests])</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Ready<sp/>--&gt;<sp/>Shutdown([Shutdown<sp/>Signal])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Shutdown<sp/>--&gt;<sp/>LogShutdown[Log<sp/>Shutdown]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LogShutdown<sp/>--&gt;<sp/>Exit([Application<sp/>Exit])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
<para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Event   </para>
</entry><entry thead="yes"><para>Trigger   </para>
</entry><entry thead="yes"><para>Action   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Startup   </para>
</entry><entry thead="no"><para>Application launch   </para>
</entry><entry thead="no"><para>Initialize graph singleton   </para>
</entry><entry thead="no"><para>Pre-warm graph data    </para>
</entry></row>
<row>
<entry thead="no"><para>Request   </para>
</entry><entry thead="no"><para>HTTP request   </para>
</entry><entry thead="no"><para>Thread-safe graph access   </para>
</entry><entry thead="no"><para>Serve API requests    </para>
</entry></row>
<row>
<entry thead="no"><para>Shutdown   </para>
</entry><entry thead="no"><para>SIGTERM/SIGINT   </para>
</entry><entry thead="no"><para>Log shutdown event   </para>
</entry><entry thead="no"><para>Graceful termination   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4179">
<title>6.3.2.2 Batch Processing Flows</title><para>The real data fetching system implements batch processing for market data acquisition from Yahoo Finance.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>App<sp/>as<sp/>Application</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Fetcher<sp/>as<sp/>RealDataFetcher</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Cache<sp/>as<sp/>File<sp/>Cache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>YF<sp/>as<sp/>Yahoo<sp/>Finance</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Graph<sp/>as<sp/>Graph<sp/>Engine</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>App-&gt;&gt;Fetcher:<sp/>create_real_database()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;Cache:<sp/>Check<sp/>cache<sp/>file</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>alt<sp/>Cache<sp/>Exists</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cache--&gt;&gt;Fetcher:<sp/>Cached<sp/>JSON</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;Graph:<sp/>Load<sp/>from<sp/>cache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph--&gt;&gt;App:<sp/>Cached<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else<sp/>No<sp/>Cache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;YF:<sp/>Download<sp/>AAPL,<sp/>MSFT,<sp/>XOM,<sp/>JPM</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YF--&gt;&gt;Fetcher:<sp/>Equity<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;YF:<sp/>Download<sp/>TLT,<sp/>LQD,<sp/>HYG</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YF--&gt;&gt;Fetcher:<sp/>Bond<sp/>ETF<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;YF:<sp/>Download<sp/>GC=F,<sp/>CL=F,<sp/>SI=F</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YF--&gt;&gt;Fetcher:<sp/>Commodity<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;YF:<sp/>Download<sp/>EURUSD=X,<sp/>GBPUSD=X,<sp/>JPYUSD=X</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YF--&gt;&gt;Fetcher:<sp/>Currency<sp/>Data</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;Graph:<sp/>add_asset()<sp/>×<sp/>N</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;Graph:<sp/>add_regulatory_event()<sp/>×<sp/>N</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;Graph:<sp/>build_relationships()</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fetcher-&gt;&gt;Cache:<sp/>Write<sp/>temp<sp/>file</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cache-&gt;&gt;Cache:<sp/>Atomic<sp/>rename</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cache--&gt;&gt;Fetcher:<sp/>Cache<sp/>saved</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph--&gt;&gt;App:<sp/>Fresh<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4180">
<title>Batch Processing Sequence</title><para><table rows="8" cols="3"><row>
<entry thead="yes"><para>Step   </para>
</entry><entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Fallback Behavior    </para>
</entry></row>
<row>
<entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>Check cache file   </para>
</entry><entry thead="no"><para>Proceed if missing    </para>
</entry></row>
<row>
<entry thead="no"><para>2   </para>
</entry><entry thead="no"><para>Fetch equities (AAPL, MSFT, XOM, JPM)   </para>
</entry><entry thead="no"><para>Skip on error    </para>
</entry></row>
<row>
<entry thead="no"><para>3   </para>
</entry><entry thead="no"><para>Fetch bond ETFs (TLT, LQD, HYG)   </para>
</entry><entry thead="no"><para>Skip on error    </para>
</entry></row>
<row>
<entry thead="no"><para>4   </para>
</entry><entry thead="no"><para>Fetch commodities (GC=F, CL=F, SI=F)   </para>
</entry><entry thead="no"><para>Skip on error    </para>
</entry></row>
<row>
<entry thead="no"><para>5   </para>
</entry><entry thead="no"><para>Fetch currencies (EURUSD=X, etc.)   </para>
</entry><entry thead="no"><para>Skip on error    </para>
</entry></row>
<row>
<entry thead="no"><para>6   </para>
</entry><entry thead="no"><para>Build relationships   </para>
</entry><entry thead="no"><para>Process available data    </para>
</entry></row>
<row>
<entry thead="no"><para>7   </para>
</entry><entry thead="no"><para>Atomic cache write   </para>
</entry><entry thead="no"><para>Log error, continue   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4181">
<title>6.3.2.3 Error Handling Strategy</title><para>The API implements comprehensive error categorization with appropriate HTTP status codes and recovery guidance.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4182">
<title>API Error Categories</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Status Code   </para>
</entry><entry thead="yes"><para>Scenario   </para>
</entry><entry thead="yes"><para>Response Detail    </para>
</entry></row>
<row>
<entry thead="no"><para>400   </para>
</entry><entry thead="no"><para>Bad Request   </para>
</entry><entry thead="no"><para>Inactive user, invalid input    </para>
</entry></row>
<row>
<entry thead="no"><para>401   </para>
</entry><entry thead="no"><para>Unauthorized   </para>
</entry><entry thead="no"><para>Invalid/expired token, missing credentials    </para>
</entry></row>
<row>
<entry thead="no"><para>404   </para>
</entry><entry thead="no"><para>Not Found   </para>
</entry><entry thead="no"><para>Asset/resource not found    </para>
</entry></row>
<row>
<entry thead="no"><para>422   </para>
</entry><entry thead="no"><para>Validation Error   </para>
</entry><entry thead="no"><para>Pydantic validation failure with field details    </para>
</entry></row>
<row>
<entry thead="no"><para>429   </para>
</entry><entry thead="no"><para>Too Many Requests   </para>
</entry><entry thead="no"><para>Rate limit exceeded with Retry-After header    </para>
</entry></row>
<row>
<entry thead="no"><para>500   </para>
</entry><entry thead="no"><para>Internal Error   </para>
</entry><entry thead="no"><para>Unexpected exception (logged server-side)   </para>
</entry></row>
</table>
</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ErrorHandling[Error<sp/>Handling<sp/>Architecture]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error([Error<sp/>Occurs])<sp/>--&gt;<sp/>ErrorType{Error<sp/>Type}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorType<sp/>--&gt;|HTTPException|<sp/>HTTPHandle[Return<sp/>HTTP<sp/>Status]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HTTPHandle<sp/>--&gt;<sp/>Status401{401?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Status401<sp/>--&gt;|Yes|<sp/>AddWWW[Add<sp/>WWW-Authenticate<sp/>Header]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Status401<sp/>--&gt;|No|<sp/>ReturnDetail[Return<sp/>Error<sp/>Detail]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AddWWW<sp/>--&gt;<sp/>ReturnDetail</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorType<sp/>--&gt;|Rate<sp/>Limit|<sp/>RateHandle[429<sp/>+<sp/>Retry-After]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorType<sp/>--&gt;|Validation|<sp/>ValHandle[422<sp/>+<sp/>Pydantic<sp/>Details]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorType<sp/>--&gt;|Unexpected|<sp/>UnexpHandle[Log<sp/>Exception]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UnexpHandle<sp/>--&gt;<sp/>Return500[500<sp/>Internal<sp/>Error]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReturnDetail<sp/>--&gt;<sp/>Done([Response<sp/>Sent])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateHandle<sp/>--&gt;<sp/>Done</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ValHandle<sp/>--&gt;<sp/>Done</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return500<sp/>--&gt;<sp/>Done</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4183">
<title>Graph Initialization Error Recovery</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Error Source   </para>
</entry><entry thead="yes"><para>Detection   </para>
</entry><entry thead="yes"><para>Recovery Action   </para>
</entry><entry thead="yes"><para>Fallback    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache load failed   </para>
</entry><entry thead="no"><para>JSON parse error   </para>
</entry><entry thead="no"><para>Proceed to fresh fetch   </para>
</entry><entry thead="no"><para>Standard init    </para>
</entry></row>
<row>
<entry thead="no"><para>Network disabled   </para>
</entry><entry thead="no"><para>Configuration flag   </para>
</entry><entry thead="no"><para>Use sample data   </para>
</entry><entry thead="no"><para>Offline mode    </para>
</entry></row>
<row>
<entry thead="no"><para>Yahoo Finance error   </para>
</entry><entry thead="no"><para>Request exception   </para>
</entry><entry thead="no"><para>Check partial data   </para>
</entry><entry thead="no"><para>Sample fallback    </para>
</entry></row>
<row>
<entry thead="no"><para>Critical failure   </para>
</entry><entry thead="no"><para>Unrecoverable exception   </para>
</entry><entry thead="no"><para>Abort startup   </para>
</entry><entry thead="no"><para>Application exit   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4185">
<title>6.3.3 EXTERNAL SYSTEMS</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4186">
<title>6.3.3.1 Third-Party Integration Patterns</title></sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4187">
<title>Yahoo Finance Integration</title><para>The system integrates with Yahoo Finance via the yfinance library for real-time market data.</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Library   </para>
</entry><entry thead="no"><para>yfinance ≥0.2.51    </para>
</entry></row>
<row>
<entry thead="no"><para>Enable Flag   </para>
</entry><entry thead="no"><para><computeroutput>USE_REAL_DATA_FETCHER</computeroutput> environment variable    </para>
</entry></row>
<row>
<entry thead="no"><para>Implementation   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Source   </para>
</entry><entry thead="no"><para>Yahoo Finance API (via yfinance)   </para>
</entry></row>
</table>
</para>
<para><bold>Supported Financial Instruments:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Category   </para>
</entry><entry thead="yes"><para>Symbols    </para>
</entry></row>
<row>
<entry thead="no"><para>Equities   </para>
</entry><entry thead="no"><para>AAPL, MSFT, XOM, JPM    </para>
</entry></row>
<row>
<entry thead="no"><para>Bond ETFs   </para>
</entry><entry thead="no"><para>TLT, LQD, HYG    </para>
</entry></row>
<row>
<entry thead="no"><para>Commodities   </para>
</entry><entry thead="no"><para>GC=F (Gold), CL=F (Crude Oil), SI=F (Silver)    </para>
</entry></row>
<row>
<entry thead="no"><para>Currencies   </para>
</entry><entry thead="no"><para>EURUSD=X, GBPUSD=X, JPYUSD=X   </para>
</entry></row>
</table>
</para>
<para><bold>Rate Limit Mitigation:</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Strategy   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>File Caching   </para>
</entry><entry thead="no"><para>JSON cache with atomic writes via <computeroutput>NamedTemporaryFile</computeroutput> + <computeroutput>os.replace</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache Path   </para>
</entry><entry thead="no"><para>Configurable via <computeroutput>REAL_DATA_CACHE_PATH</computeroutput> environment variable    </para>
</entry></row>
<row>
<entry thead="no"><para>Fallback   </para>
</entry><entry thead="no"><para>Sample data when network disabled or unavailable    </para>
</entry></row>
<row>
<entry thead="no"><para>Atomic Writes   </para>
</entry><entry thead="no"><para>Prevents cache corruption on write failures   </para>
</entry></row>
</table>
</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>YahooFinanceIntegration[Yahoo<sp/>Finance<sp/>Integration<sp/>Pattern]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Request([Data<sp/>Request])<sp/>--&gt;<sp/>CheckEnabled{Real<sp/>Data&lt;br/&gt;Enabled?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckEnabled<sp/>--&gt;|No|<sp/>UseSample[Use<sp/>Sample<sp/>Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckEnabled<sp/>--&gt;|Yes|<sp/>CheckCache{Cache&lt;br/&gt;Valid?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckCache<sp/>--&gt;|Yes|<sp/>LoadCache[Load<sp/>from<sp/>Cache]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckCache<sp/>--&gt;|No|<sp/>FetchAPI[Fetch<sp/>from<sp/>Yahoo<sp/>Finance]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FetchAPI<sp/>--&gt;<sp/>HandleResponse{Response&lt;br/&gt;OK?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HandleResponse<sp/>--&gt;|Yes|<sp/>ProcessData[Process<sp/>Market<sp/>Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HandleResponse<sp/>--&gt;|Partial|<sp/>PartialData[Use<sp/>Available<sp/>Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HandleResponse<sp/>--&gt;|No|<sp/>FallbackSample[Fallback<sp/>to<sp/>Sample]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ProcessData<sp/>--&gt;<sp/>WriteCache[Write<sp/>to<sp/>Cache]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WriteCache<sp/>--&gt;<sp/>AtomicRename[Atomic<sp/>File<sp/>Rename]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadCache<sp/>--&gt;<sp/>ReturnData([Return<sp/>Data])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AtomicRename<sp/>--&gt;<sp/>ReturnData</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PartialData<sp/>--&gt;<sp/>ReturnData</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FallbackSample<sp/>--&gt;<sp/>ReturnData</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UseSample<sp/>--&gt;<sp/>ReturnData</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4188">
<title>6.3.3.2 MCP (Model Context Protocol) Integration</title><para>The system includes support for the Model Context Protocol, enabling AI tool integrations.</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>Framework   </para>
</entry><entry thead="no"><para>FastMCP (<computeroutput>mcp&gt;=1.0.0</computeroutput>, <computeroutput>fastmcp&gt;=0.1.0</computeroutput>)    </para>
</entry></row>
<row>
<entry thead="no"><para>Server Name   </para>
</entry><entry thead="no"><para>&quot;DashFin-Relationship-Manager&quot;    </para>
</entry></row>
<row>
<entry thead="no"><para>Thread Safety   </para>
</entry><entry thead="no"><para><computeroutput>_ThreadSafeGraph</computeroutput> proxy with <computeroutput>threading.Lock</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Entry Point   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="mcp__server_8py" kindref="compound">mcp_server.py</ref></computeroutput>   </para>
</entry></row>
</table>
</para>
<para><bold>Exposed MCP Tools/Resources:</bold></para>
<para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Tool/Resource   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>add_equity_node()</computeroutput>   </para>
</entry><entry thead="no"><para>Tool   </para>
</entry><entry thead="no"><para>Add equity asset to graph    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>graph://data/3d-layout</computeroutput>   </para>
</entry><entry thead="no"><para>Resource   </para>
</entry><entry thead="no"><para>3D visualization data resource   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4189">
<title>6.3.3.3 Frontend-Backend Integration</title><para>The Next.js frontend communicates with the FastAPI backend through a typed API client layer.</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Aspect   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>HTTP Client   </para>
</entry><entry thead="no"><para>Axios    </para>
</entry></row>
<row>
<entry thead="no"><para><ref refid="classBase" kindref="compound">Base</ref> URL   </para>
</entry><entry thead="no"><para><computeroutput>NEXT_PUBLIC_API_URL</computeroutput> (default: <computeroutput><ulink url="http://localhost:8000">http://localhost:8000</ulink></computeroutput>)    </para>
</entry></row>
<row>
<entry thead="no"><para>Content-Type   </para>
</entry><entry thead="no"><para><computeroutput>application/json</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Location   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/lib/api.ts</computeroutput>   </para>
</entry></row>
</table>
</para>
<para><bold>API Client Methods:</bold></para>
<para><table rows="10" cols="3"><row>
<entry thead="yes"><para>Method   </para>
</entry><entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Return Type    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>healthCheck()</computeroutput>   </para>
</entry><entry thead="no"><para>GET /api/health   </para>
</entry><entry thead="no"><para>Health status    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>getAssets(params?)</computeroutput>   </para>
</entry><entry thead="no"><para>GET /api/assets   </para>
</entry><entry thead="no"><para>Asset[] or paginated    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>getAssetDetail(id)</computeroutput>   </para>
</entry><entry thead="no"><para>GET /api/assets/{id}   </para>
</entry><entry thead="no"><para>Asset    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>getAssetRelationships(id)</computeroutput>   </para>
</entry><entry thead="no"><para>GET /api/assets/{id}/relationships   </para>
</entry><entry thead="no"><para>Relationship[]    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>getAllRelationships()</computeroutput>   </para>
</entry><entry thead="no"><para>GET /api/relationships   </para>
</entry><entry thead="no"><para>Relationship[]    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>getMetrics()</computeroutput>   </para>
</entry><entry thead="no"><para>GET /api/metrics   </para>
</entry><entry thead="no"><para>Metrics    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>getVisualizationData()</computeroutput>   </para>
</entry><entry thead="no"><para>GET /api/visualization   </para>
</entry><entry thead="no"><para>VisualizationData    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>getAssetClasses()</computeroutput>   </para>
</entry><entry thead="no"><para>GET /api/asset-classes   </para>
</entry><entry thead="no"><para>{ asset_classes: string[] }    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>getSectors()</computeroutput>   </para>
</entry><entry thead="no"><para>GET /api/sectors   </para>
</entry><entry thead="no"><para>{ sectors: string[] }   </para>
</entry></row>
</table>
</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>User<sp/>as<sp/>User<sp/>Browser</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>NextJS<sp/>as<sp/>Next.js<sp/>Frontend</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Axios<sp/>as<sp/>Axios<sp/>Client</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>CORS<sp/>as<sp/>CORS<sp/>Middleware</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>FastAPI<sp/>as<sp/>FastAPI<sp/>Backend</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Graph<sp/>as<sp/>Graph<sp/>Engine</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>User-&gt;&gt;NextJS:<sp/>Navigate<sp/>to<sp/>Page</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NextJS-&gt;&gt;Axios:<sp/>api.getMetrics()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Axios-&gt;&gt;CORS:<sp/>GET<sp/>/api/metrics</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CORS-&gt;&gt;CORS:<sp/>Validate<sp/>Origin</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>alt<sp/>Origin<sp/>Valid</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS-&gt;&gt;FastAPI:<sp/>Forward<sp/>Request</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI-&gt;&gt;Graph:<sp/>get_graph()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph--&gt;&gt;FastAPI:<sp/>Graph<sp/>Instance</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI-&gt;&gt;Graph:<sp/>calculate_metrics()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph--&gt;&gt;FastAPI:<sp/>Metrics<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI--&gt;&gt;CORS:<sp/>MetricsResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS--&gt;&gt;Axios:<sp/>200<sp/>OK<sp/>+<sp/>CORS<sp/>Headers</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Axios--&gt;&gt;NextJS:<sp/>Response<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextJS--&gt;&gt;User:<sp/>Render<sp/>Metrics</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else<sp/>Origin<sp/>Invalid</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS--&gt;&gt;Axios:<sp/>403<sp/>Forbidden</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Axios--&gt;&gt;NextJS:<sp/>Error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextJS--&gt;&gt;User:<sp/>Show<sp/>Error<sp/>Message</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4190">
<title>6.3.3.4 Database Connectivity</title><para>The system supports multiple database backends for authentication credential storage.</para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Backend   </para>
</entry><entry thead="yes"><para>Connection Handling   </para>
</entry><entry thead="yes"><para>Use Case    </para>
</entry></row>
<row>
<entry thead="no"><para>SQLite   </para>
</entry><entry thead="no"><para>Single connection for in-memory; file-based for persistence   </para>
</entry><entry thead="no"><para>Development, testing    </para>
</entry></row>
<row>
<entry thead="no"><para>PostgreSQL   </para>
</entry><entry thead="no"><para>psycopg2-binary with connection pooling   </para>
</entry><entry thead="no"><para>Production    </para>
</entry></row>
<row>
<entry thead="no"><para>In-Memory Testing   </para>
</entry><entry thead="no"><para>SQLAlchemy <computeroutput>StaticPool</computeroutput> for connection reuse   </para>
</entry><entry thead="no"><para>Unit tests   </para>
</entry></row>
</table>
</para>
<para><bold>Authentication Database Schema:</bold></para>
<para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Table   </para>
</entry><entry thead="yes"><para>Field   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Constraint    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>user_credentials</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>username</computeroutput>   </para>
</entry><entry thead="no"><para>VARCHAR   </para>
</entry><entry thead="no"><para>UNIQUE, NOT NULL    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>user_credentials</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>email</computeroutput>   </para>
</entry><entry thead="no"><para>VARCHAR   </para>
</entry><entry thead="no"><para>NULL    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>user_credentials</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>full_name</computeroutput>   </para>
</entry><entry thead="no"><para>VARCHAR   </para>
</entry><entry thead="no"><para>NULL    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>user_credentials</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>hashed_password</computeroutput>   </para>
</entry><entry thead="no"><para>VARCHAR   </para>
</entry><entry thead="no"><para>NOT NULL    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>user_credentials</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>disabled</computeroutput>   </para>
</entry><entry thead="no"><para>BOOLEAN   </para>
</entry><entry thead="no"><para>DEFAULT FALSE   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4191">
<title>6.3.3.5 Deployment Platform Integration</title></sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4192">
<title>Vercel Serverless Deployment</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Builder   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Backend   </para>
</entry><entry thead="no"><para><computeroutput>@vercel/python</computeroutput>   </para>
</entry><entry thead="no"><para>maxLambdaSize: 50mb    </para>
</entry></row>
<row>
<entry thead="no"><para>Frontend   </para>
</entry><entry thead="no"><para><computeroutput>@vercel/next</computeroutput>   </para>
</entry><entry thead="no"><para>Default Next.js settings   </para>
</entry></row>
</table>
</para>
<para><bold>Route Configuration:</bold></para>
<para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Pattern   </para>
</entry><entry thead="yes"><para>Destination   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/(.*)</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Backend API routes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/(.*)</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/$1</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend static/SSR   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4193">
<title>Docker Container Deployment</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><ref refid="classBase" kindref="compound">Base</ref> Image   </para>
</entry><entry thead="no"><para><computeroutput>python:3.11-slim</computeroutput>   </para>
</entry><entry thead="no"><para>Minimal Python runtime    </para>
</entry></row>
<row>
<entry thead="no"><para>Container User   </para>
</entry><entry thead="no"><para><computeroutput>appuser</computeroutput> (UID 1000)   </para>
</entry><entry thead="no"><para>Non-root security    </para>
</entry></row>
<row>
<entry thead="no"><para>Exposed Port   </para>
</entry><entry thead="no"><para>7860   </para>
</entry><entry thead="no"><para>Gradio default    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Check   </para>
</entry><entry thead="no"><para>HTTP probe every 30s   </para>
</entry><entry thead="no"><para>Container health    </para>
</entry></row>
<row>
<entry thead="no"><para>Restart Policy   </para>
</entry><entry thead="no"><para>unless-stopped   </para>
</entry><entry thead="no"><para>Automatic recovery   </para>
</entry></row>
</table>
</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DeploymentArchitecture[Deployment<sp/>Platform<sp/>Integration]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>LocalDev[Local<sp/>Development]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFE[Next.js&lt;br/&gt;:3000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalAPI[FastAPI&lt;br/&gt;:8000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalGradio[Gradio&lt;br/&gt;:7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>DockerDeploy[Docker<sp/>Deployment]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerApp[Single<sp/>Container&lt;br/&gt;:7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerVol[(Mounted<sp/>Volumes)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerApp<sp/>--&gt;<sp/>DockerVol</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>VercelDeploy[Vercel<sp/>Serverless]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelEdge[Edge<sp/>Network]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelLambda[Python<sp/>Lambda]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelNext[Next.js<sp/>SSR]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelEdge<sp/>--&gt;<sp/>VercelLambda</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelEdge<sp/>--&gt;<sp/>VercelNext</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users([End<sp/>Users])<sp/>--&gt;<sp/>LocalDev</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users<sp/>--&gt;<sp/>DockerDeploy</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users<sp/>--&gt;<sp/>VercelDeploy</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4195">
<title>6.3.4 TYPE CONTRACTS</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4196">
<title>6.3.4.1 Backend Response Models</title><para>The API uses Pydantic models for type-safe request/response serialization.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4197">
<title>AssetResponse Model</title><para><table rows="10" cols="4"><row>
<entry thead="yes"><para>Field   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Required   </para>
</entry><entry thead="yes"><para>Default    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>id</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>str</computeroutput>   </para>
</entry><entry thead="no"><para>Yes   </para>
</entry><entry thead="no"><para>-    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>symbol</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>str</computeroutput>   </para>
</entry><entry thead="no"><para>Yes   </para>
</entry><entry thead="no"><para>-    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>name</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>str</computeroutput>   </para>
</entry><entry thead="no"><para>Yes   </para>
</entry><entry thead="no"><para>-    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_class</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>str</computeroutput>   </para>
</entry><entry thead="no"><para>Yes   </para>
</entry><entry thead="no"><para>-    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>sector</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>str</computeroutput>   </para>
</entry><entry thead="no"><para>Yes   </para>
</entry><entry thead="no"><para>-    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>price</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>float</computeroutput>   </para>
</entry><entry thead="no"><para>Yes   </para>
</entry><entry thead="no"><para>-    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>market_cap</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Optional[float]</computeroutput>   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para><computeroutput>None</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>currency</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>str</computeroutput>   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para><computeroutput>&quot;USD&quot;</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>additional_fields</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Dict[str, Any]</computeroutput>   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para><computeroutput>{}</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4198">
<title>RelationshipResponse Model</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Field   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>source_id</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>str</computeroutput>   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>target_id</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>str</computeroutput>   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>relationship_type</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>str</computeroutput>   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>strength</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>float</computeroutput>   </para>
</entry><entry thead="no"><para>Yes   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4199">
<title>MetricsResponse Model</title><para><table rows="8" cols="3"><row>
<entry thead="yes"><para>Field   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>total_assets</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>int</computeroutput>   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>total_relationships</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>int</computeroutput>   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_classes</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Dict[str, int]</computeroutput>   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>avg_degree</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>float</computeroutput>   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>max_degree</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>int</computeroutput>   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>network_density</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>float</computeroutput>   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>relationship_density</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>float</computeroutput>   </para>
</entry><entry thead="no"><para>No (default: 0.0)   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4200">
<title>6.3.4.2 Frontend Type Definitions</title><para>TypeScript interfaces defined in <computeroutput>frontend/app/types/api.ts</computeroutput> provide compile-time type safety.</para>
<para><table rows="7" cols="2"><row>
<entry thead="yes"><para>Interface   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Asset</computeroutput>   </para>
</entry><entry thead="no"><para>Asset data structure    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Relationship</computeroutput>   </para>
</entry><entry thead="no"><para>Relationship data structure    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Metrics</computeroutput>   </para>
</entry><entry thead="no"><para>Network metrics    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>VisualizationNode</computeroutput>   </para>
</entry><entry thead="no"><para>3D visualization node    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>VisualizationEdge</computeroutput>   </para>
</entry><entry thead="no"><para>3D visualization edge    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>VisualizationData</computeroutput>   </para>
</entry><entry thead="no"><para>Complete visualization payload   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4202">
<title>6.3.5 INTEGRATION FLOW DIAGRAMS</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4203">
<title>6.3.5.1 Complete API Request Lifecycle</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>IntegrationFlow[Complete<sp/>API<sp/>Request<sp/>Lifecycle]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Client([Client<sp/>Request])<sp/>--&gt;<sp/>TLS[TLS<sp/>Termination]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TLS<sp/>--&gt;<sp/>Load[Load<sp/>Balancer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Load<sp/>--&gt;<sp/>ASGI[Uvicorn<sp/>ASGI]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ASGI<sp/>--&gt;<sp/>CORS[CORS<sp/>Validation]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS<sp/>--&gt;<sp/>CORSCheck{Origin&lt;br/&gt;Valid?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORSCheck<sp/>--&gt;|No|<sp/>Reject403[403<sp/>Forbidden]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORSCheck<sp/>--&gt;|Yes|<sp/>RateLimit[Rate<sp/>Limit<sp/>Check]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimit<sp/>--&gt;<sp/>RateLimitCheck{Within&lt;br/&gt;Limit?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimitCheck<sp/>--&gt;|No|<sp/>Reject429[429<sp/>Too<sp/>Many]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimitCheck<sp/>--&gt;|Yes|<sp/>AuthCheck{Auth&lt;br/&gt;Required?}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AuthCheck<sp/>--&gt;|Yes|<sp/>ValidateJWT[Validate<sp/>JWT]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ValidateJWT<sp/>--&gt;<sp/>JWTValid{Token&lt;br/&gt;Valid?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JWTValid<sp/>--&gt;|No|<sp/>Reject401[401<sp/>Unauthorized]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JWTValid<sp/>--&gt;|Yes|<sp/>Process[Process<sp/>Request]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AuthCheck<sp/>--&gt;|No|<sp/>Process</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Process<sp/>--&gt;<sp/>Validate[Pydantic<sp/>Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Validate<sp/>--&gt;<sp/>ValidationOK{Valid&lt;br/&gt;Input?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ValidationOK<sp/>--&gt;|No|<sp/>Reject422[422<sp/>Validation<sp/>Error]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ValidationOK<sp/>--&gt;|Yes|<sp/>Handler[Endpoint<sp/>Handler]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Handler<sp/>--&gt;<sp/>Graph[Graph<sp/>Engine]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>Serialize[Serialize<sp/>Response]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Serialize<sp/>--&gt;<sp/>AddHeaders[Add<sp/>Response<sp/>Headers]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AddHeaders<sp/>--&gt;<sp/>Response([JSON<sp/>Response])</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Reject403<sp/>--&gt;<sp/>ErrorResponse([Error<sp/>Response])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Reject429<sp/>--&gt;<sp/>ErrorResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Reject401<sp/>--&gt;<sp/>ErrorResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Reject422<sp/>--&gt;<sp/>ErrorResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4204">
<title>6.3.5.2 Visualization Data Pipeline</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>User<sp/>as<sp/>User</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>UI<sp/>as<sp/>UI<sp/>Component</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>API<sp/>as<sp/>API<sp/>Layer</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Graph<sp/>as<sp/>Graph<sp/>Engine</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Viz<sp/>as<sp/>Visualization<sp/>Module</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Plotly<sp/>as<sp/>Plotly<sp/>Renderer</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>User-&gt;&gt;UI:<sp/>Request<sp/>3D<sp/>Visualization</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>UI-&gt;&gt;API:<sp/>GET<sp/>/api/visualization</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API-&gt;&gt;Graph:<sp/>get_graph()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph--&gt;&gt;API:<sp/>Graph<sp/>Instance</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API-&gt;&gt;Viz:<sp/>get_3d_visualization_data_enhanced()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Viz-&gt;&gt;Viz:<sp/>Set<sp/>seed(42)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Viz-&gt;&gt;Viz:<sp/>Calculate<sp/>3D<sp/>positions</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Viz-&gt;&gt;Viz:<sp/>Assign<sp/>colors<sp/>by<sp/>asset<sp/>class</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Viz-&gt;&gt;Viz:<sp/>Generate<sp/>hover<sp/>text</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Viz--&gt;&gt;API:<sp/>(positions,<sp/>ids,<sp/>colors,<sp/>hovers)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API-&gt;&gt;API:<sp/>Build<sp/>nodes<sp/>array</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API-&gt;&gt;API:<sp/>Build<sp/>edges<sp/>array</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API--&gt;&gt;UI:<sp/>VisualizationDataResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>UI-&gt;&gt;Plotly:<sp/>Render<sp/>3D<sp/>scatter</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Plotly--&gt;&gt;User:<sp/>Interactive<sp/>3D<sp/>Graph</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4205">
<title>6.3.5.3 Thread-Safe Singleton Pattern</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>SingletonAccess[Thread-Safe<sp/>Graph<sp/>Singleton<sp/>Access]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>APIRequest([API<sp/>Request])<sp/>--&gt;<sp/>CheckGlobal{Global<sp/>graph&lt;br/&gt;exists?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckGlobal<sp/>--&gt;|Yes|<sp/>ReturnGraph([Return<sp/>Graph])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckGlobal<sp/>--&gt;|No|<sp/>AcquireLock[Acquire<sp/>Thread<sp/>Lock]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AcquireLock<sp/>--&gt;<sp/>DoubleCheck{Double-check&lt;br/&gt;inside<sp/>lock}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DoubleCheck<sp/>--&gt;|Created|<sp/>Release1[Release<sp/>Lock]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Release1<sp/>--&gt;<sp/>ReturnGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DoubleCheck<sp/>--&gt;|Still<sp/>None|<sp/>InitGraph[Initialize<sp/>New<sp/>Graph]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InitGraph<sp/>--&gt;<sp/>SetGlobal[Set<sp/>Global<sp/>Reference]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetGlobal<sp/>--&gt;<sp/>Release2[Release<sp/>Lock]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Release2<sp/>--&gt;<sp/>ReturnNew[Return<sp/>New<sp/>Graph]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReturnNew<sp/>--&gt;<sp/>ReturnGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4207">
<title>6.3.6 ENVIRONMENT CONFIGURATION</title><para>Integration behavior is controlled through environment variables that configure connectivity, security, and feature flags.</para>
<para><table rows="11" cols="3"><row>
<entry thead="yes"><para>Variable   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Default    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>NEXT_PUBLIC_API_URL</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend API base URL   </para>
</entry><entry thead="no"><para><computeroutput><ulink url="http://localhost:8000">http://localhost:8000</ulink></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ALLOWED_ORIGINS</computeroutput>   </para>
</entry><entry thead="no"><para>CORS allowed origins   </para>
</entry><entry thead="no"><para>(none - uses defaults)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SECRET_KEY</computeroutput>   </para>
</entry><entry thead="no"><para>JWT signing key   </para>
</entry><entry thead="no"><para><bold>Required</bold>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>DATABASE_URL</computeroutput>   </para>
</entry><entry thead="no"><para>SQLite connection string   </para>
</entry><entry thead="no"><para><bold>Required</bold>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>USE_REAL_DATA_FETCHER</computeroutput>   </para>
</entry><entry thead="no"><para>Enable Yahoo Finance   </para>
</entry><entry thead="no"><para><computeroutput>false</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>REAL_DATA_CACHE_PATH</computeroutput>   </para>
</entry><entry thead="no"><para>Cache file path   </para>
</entry><entry thead="no"><para>(none)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GRAPH_CACHE_PATH</computeroutput>   </para>
</entry><entry thead="no"><para>Graph cache path   </para>
</entry><entry thead="no"><para>(none)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_USERNAME</computeroutput>   </para>
</entry><entry thead="no"><para>Admin user credential   </para>
</entry><entry thead="no"><para>(none)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_PASSWORD</computeroutput>   </para>
</entry><entry thead="no"><para>Admin user credential   </para>
</entry><entry thead="no"><para>(none)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ENV</computeroutput>   </para>
</entry><entry thead="no"><para>Environment mode   </para>
</entry><entry thead="no"><para><computeroutput>development</computeroutput>   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4209">
<title>6.3.7 PERFORMANCE TARGETS</title><para>The integration architecture is designed to meet specific service level objectives.</para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Target SLA   </para>
</entry><entry thead="yes"><para>Measurement    </para>
</entry></row>
<row>
<entry thead="no"><para>API Response (p95)   </para>
</entry><entry thead="no"><para>&lt; 500ms   </para>
</entry><entry thead="no"><para>Request to response    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Rendering   </para>
</entry><entry thead="no"><para>&lt; 2 seconds   </para>
</entry><entry thead="no"><para>Data load to interactive    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Generation   </para>
</entry><entry thead="no"><para>&lt; 100ms   </para>
</entry><entry thead="no"><para>Credential to token    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Initialization   </para>
</entry><entry thead="no"><para>&lt; 3 seconds   </para>
</entry><entry thead="no"><para>Application startup    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Discovery   </para>
</entry><entry thead="no"><para>&lt; 500ms   </para>
</entry><entry thead="no"><para>For 100 assets    </para>
</entry></row>
<row>
<entry thead="no"><para>Initial Page Load   </para>
</entry><entry thead="no"><para>&lt; 3 seconds   </para>
</entry><entry thead="no"><para>Navigation to interactive   </para>
</entry></row>
</table>
</para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4210">
<title>Timeout Configuration</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Timeout   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>JWT Token   </para>
</entry><entry thead="no"><para>30 minutes   </para>
</entry><entry thead="no"><para>Session expiration    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limit Window   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Request counting period    </para>
</entry></row>
<row>
<entry thead="no"><para>HTTP Client   </para>
</entry><entry thead="no"><para>30 seconds   </para>
</entry><entry thead="no"><para>API request timeout    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Check   </para>
</entry><entry thead="no"><para>30 seconds   </para>
</entry><entry thead="no"><para>Container probe interval   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4212">
<title>6.3.8 EXTERNAL DEPENDENCIES</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4213">
<title>6.3.8.1 Runtime Dependencies</title><para><table rows="9" cols="3"><row>
<entry thead="yes"><para>Dependency   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>FastAPI   </para>
</entry><entry thead="no"><para>0.127.0   </para>
</entry><entry thead="no"><para>REST framework    </para>
</entry></row>
<row>
<entry thead="no"><para>Uvicorn   </para>
</entry><entry thead="no"><para>≥0.24.0   </para>
</entry><entry thead="no"><para>ASGI server    </para>
</entry></row>
<row>
<entry thead="no"><para>Pydantic   </para>
</entry><entry thead="no"><para>2.12.5   </para>
</entry><entry thead="no"><para>Validation    </para>
</entry></row>
<row>
<entry thead="no"><para>PyJWT   </para>
</entry><entry thead="no"><para>≥2.8.0   </para>
</entry><entry thead="no"><para>Token handling    </para>
</entry></row>
<row>
<entry thead="no"><para>passlib   </para>
</entry><entry thead="no"><para>Latest   </para>
</entry><entry thead="no"><para>Password hashing    </para>
</entry></row>
<row>
<entry thead="no"><para>slowapi   </para>
</entry><entry thead="no"><para>Latest   </para>
</entry><entry thead="no"><para>Rate limiting    </para>
</entry></row>
<row>
<entry thead="no"><para>yfinance   </para>
</entry><entry thead="no"><para>≥0.2.51   </para>
</entry><entry thead="no"><para>Market data    </para>
</entry></row>
<row>
<entry thead="no"><para>SQLAlchemy   </para>
</entry><entry thead="no"><para>≥2.0.0   </para>
</entry><entry thead="no"><para>Database ORM   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4214">
<title>6.3.8.2 Frontend Dependencies</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Dependency   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Next.js   </para>
</entry><entry thead="no"><para>14.2.35   </para>
</entry><entry thead="no"><para>React framework    </para>
</entry></row>
<row>
<entry thead="no"><para>React   </para>
</entry><entry thead="no"><para>18.2.0   </para>
</entry><entry thead="no"><para>UI library    </para>
</entry></row>
<row>
<entry thead="no"><para>TypeScript   </para>
</entry><entry thead="no"><para>^5.3.0   </para>
</entry><entry thead="no"><para>Type safety    </para>
</entry></row>
<row>
<entry thead="no"><para>Axios   </para>
</entry><entry thead="no"><para>Latest   </para>
</entry><entry thead="no"><para>HTTP client    </para>
</entry></row>
<row>
<entry thead="no"><para>Plotly.js   </para>
</entry><entry thead="no"><para>^2.27.0   </para>
</entry><entry thead="no"><para>Visualization    </para>
</entry></row>
<row>
<entry thead="no"><para>Tailwind CSS   </para>
</entry><entry thead="no"><para>Latest   </para>
</entry><entry thead="no"><para>Styling   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4216">
<title>6.3.9 References</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4217">
<title>Files Examined</title><para><table rows="13" cols="2"><row>
<entry thead="yes"><para>Path   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI application, endpoints, CORS, rate limiting, graph lifecycle    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>JWT authentication, password hashing, user repository    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2database_8py" kindref="compound">api/database.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>SQLite integration, connection management    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Yahoo Finance integration, caching strategy    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/lib/api.ts</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend HTTP client implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/types/api.ts</computeroutput>   </para>
</entry><entry thead="no"><para>TypeScript type definitions    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>vercel.json</computeroutput>   </para>
</entry><entry thead="no"><para>Serverless deployment configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>docker-compose.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Docker container orchestration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Dockerfile</computeroutput>   </para>
</entry><entry thead="no"><para>Container build specification    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="mcp__server_8py" kindref="compound">mcp_server.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Model Context Protocol server    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>requirements.txt</computeroutput>   </para>
</entry><entry thead="no"><para>Python dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.env.example</computeroutput>   </para>
</entry><entry thead="no"><para>Environment variable templates   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4218">
<title>Folders Explored</title><para><table rows="7" cols="2"><row>
<entry thead="yes"><para>Folder Path   </para>
</entry><entry thead="yes"><para>Contents    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>api/</computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI backend modules    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/</computeroutput>   </para>
</entry><entry thead="no"><para>Next.js application    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/lib/</computeroutput>   </para>
</entry><entry thead="no"><para>API client layer    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/types/</computeroutput>   </para>
</entry><entry thead="no"><para>TypeScript contracts    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/</computeroutput>   </para>
</entry><entry thead="no"><para>Python core packages    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>src/data/</computeroutput>   </para>
</entry><entry thead="no"><para>Data layer modules   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4219">
<title>Technical Specification Sections Referenced</title><para><table rows="12" cols="2"><row>
<entry thead="yes"><para>Section   </para>
</entry><entry thead="yes"><para>Topic    </para>
</entry></row>
<row>
<entry thead="no"><para>3.1 Technology Stack Overview   </para>
</entry><entry thead="no"><para>Stack architecture and technology choices    </para>
</entry></row>
<row>
<entry thead="no"><para>3.5 Third-Party Services   </para>
</entry><entry thead="no"><para>External service integrations    </para>
</entry></row>
<row>
<entry thead="no"><para>3.8 Security Considerations   </para>
</entry><entry thead="no"><para>Authentication and API security    </para>
</entry></row>
<row>
<entry thead="no"><para>3.9 Integration Requirements   </para>
</entry><entry thead="no"><para>Frontend-backend communication    </para>
</entry></row>
<row>
<entry thead="no"><para>4.3 API Request Workflows   </para>
</entry><entry thead="no"><para>API workflow diagrams    </para>
</entry></row>
<row>
<entry thead="no"><para>4.5 Error Handling Workflows   </para>
</entry><entry thead="no"><para>Error recovery flows    </para>
</entry></row>
<row>
<entry thead="no"><para>4.6 Integration Sequence Diagrams   </para>
</entry><entry thead="no"><para>Integration flow diagrams    </para>
</entry></row>
<row>
<entry thead="no"><para>5.2 COMPONENT DETAILS   </para>
</entry><entry thead="no"><para>Component specifications    </para>
</entry></row>
<row>
<entry thead="no"><para>5.4 CROSS-CUTTING CONCERNS   </para>
</entry><entry thead="no"><para>Cross-cutting concerns    </para>
</entry></row>
<row>
<entry thead="no"><para>5.5 DEPLOYMENT ARCHITECTURE   </para>
</entry><entry thead="no"><para>Deployment options    </para>
</entry></row>
<row>
<entry thead="no"><para>6.1 Core Services Architecture   </para>
</entry><entry thead="no"><para>Monolithic architecture overview   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4220">
<title>6.4 Security Architecture</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4221">
<title>6.4.1 Security Architecture Overview</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4222">
<title>6.4.1.1 Executive Security Summary</title><para>The Financial Asset Relationship Database implements a comprehensive, defense-in-depth security architecture designed to protect both user identities and financial asset data. The security model centers on JWT-based stateless authentication, environment-driven secrets management, multi-layered input validation, and proactive threat mitigation through rate limiting and CORS controls.</para>
<para>The architecture addresses security concerns across multiple domains:</para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Security Domain   </para>
</entry><entry thead="yes"><para>Implementation Approach   </para>
</entry><entry thead="yes"><para>Primary Controls    </para>
</entry></row>
<row>
<entry thead="no"><para>Identity &amp; Access   </para>
</entry><entry thead="no"><para>JWT with HS256 signing   </para>
</entry><entry thead="no"><para>Token-based authentication    </para>
</entry></row>
<row>
<entry thead="no"><para>Input Validation   </para>
</entry><entry thead="no"><para>Multi-layer validation   </para>
</entry><entry thead="no"><para>Pydantic models, domain validation    </para>
</entry></row>
<row>
<entry thead="no"><para>Transport Security   </para>
</entry><entry thead="no"><para>HTTPS enforcement   </para>
</entry><entry thead="no"><para>TLS termination at edge    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Protection   </para>
</entry><entry thead="no"><para>IP-based throttling   </para>
</entry><entry thead="no"><para>slowapi middleware    </para>
</entry></row>
<row>
<entry thead="no"><para>Origin Control   </para>
</entry><entry thead="no"><para>Allowlist validation   </para>
</entry><entry thead="no"><para>Environment-specific CORS    </para>
</entry></row>
<row>
<entry thead="no"><para>Container Security   </para>
</entry><entry thead="no"><para>Hardened runtime   </para>
</entry><entry thead="no"><para>Non-root execution   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4223">
<title>6.4.1.2 Security Zone Architecture</title><para>The system implements security zones with increasing trust levels from the external network to protected internal services:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ExternalZone[External<sp/>Zone<sp/>-<sp/>Untrusted]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Internet([Internet&lt;br/&gt;Clients])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Vercel[Vercel<sp/>Edge&lt;br/&gt;TLS<sp/>Termination]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DMZ[DMZ<sp/>-<sp/>Semi-Trusted]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LB[Load<sp/>Balancer&lt;br/&gt;Rate<sp/>Limiting]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS[CORS&lt;br/&gt;Middleware]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ApplicationZone[Application<sp/>Zone<sp/>-<sp/>Protected]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth[Authentication&lt;br/&gt;Module]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>API[FastAPI&lt;br/&gt;Endpoints]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimit[Rate&lt;br/&gt;Limiter]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DataZone[Data<sp/>Zone<sp/>-<sp/>Restricted]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph[Graph&lt;br/&gt;Engine]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLite[(SQLite&lt;br/&gt;Auth<sp/>DB)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cache[(JSON&lt;br/&gt;Cache)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Internet<sp/>--&gt;<sp/>Vercel</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Vercel<sp/>--&gt;<sp/>LB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LB<sp/>--&gt;<sp/>CORS</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CORS<sp/>--&gt;<sp/>RateLimit</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RateLimit<sp/>--&gt;<sp/>Auth</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Auth<sp/>--&gt;<sp/>API</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Auth<sp/>--&gt;<sp/>SQLite</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>API<sp/>--&gt;<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>Cache</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4224">
<title>6.4.1.3 Security Principles</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Principle   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>Defense in Depth   </para>
</entry><entry thead="no"><para>Multiple validation layers (CORS → Rate Limit → Auth → Input Validation)    </para>
</entry></row>
<row>
<entry thead="no"><para>Least Privilege   </para>
</entry><entry thead="no"><para>Non-root container user, minimal API permissions    </para>
</entry></row>
<row>
<entry thead="no"><para>Fail Secure   </para>
</entry><entry thead="no"><para>Default-deny CORS policy, explicit token validation    </para>
</entry></row>
<row>
<entry thead="no"><para>Separation of Duties   </para>
</entry><entry thead="no"><para>Authentication separated from business logic    </para>
</entry></row>
<row>
<entry thead="no"><para>Audit Trail   </para>
</entry><entry thead="no"><para>Security event logging at multiple levels   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4226">
<title>6.4.2 Authentication Framework</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4227">
<title>6.4.2.1 Identity Management Architecture</title><para>The identity management system uses a SQLite-backed user repository with secure credential storage and JWT-based session management.</para>
<para><bold>Location</bold>: <computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>, <computeroutput><ref refid="api_2database_8py" kindref="compound">api/database.py</ref></computeroutput></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4228">
<title>User Identity Model</title><para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Field   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Security Note    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>username</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>Unique login identifier   </para>
</entry><entry thead="no"><para>Unique constraint enforced    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>email</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>Contact information   </para>
</entry><entry thead="no"><para>Optional, nullable    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>full_name</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>Display name   </para>
</entry><entry thead="no"><para>Optional, nullable    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>hashed_password</computeroutput>   </para>
</entry><entry thead="no"><para>TEXT   </para>
</entry><entry thead="no"><para>pbkdf2_sha256 hash   </para>
</entry><entry thead="no"><para>Never stored in plaintext    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>disabled</computeroutput>   </para>
</entry><entry thead="no"><para>INTEGER   </para>
</entry><entry thead="no"><para>Account status flag   </para>
</entry><entry thead="no"><para>Blocks authentication when true   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4229">
<title>User Repository Pattern</title><para>The <computeroutput>UserRepository</computeroutput> class in <computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput> provides secure user management:</para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Method   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Security Control    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>get_user(username)</computeroutput>   </para>
</entry><entry thead="no"><para>Retrieve user by username   </para>
</entry><entry thead="no"><para>Parameterized query protection    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>has_users()</computeroutput>   </para>
</entry><entry thead="no"><para>Check for existing users   </para>
</entry><entry thead="no"><para>Used during admin seeding    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>create_or_update_user()</computeroutput>   </para>
</entry><entry thead="no"><para>User CRUD operations   </para>
</entry><entry thead="no"><para>Password hashing enforced   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4230">
<title>6.4.2.2 Password Security</title><para>Password security is implemented using industry-standard cryptographic hashing with the <computeroutput>passlib</computeroutput> library.</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Aspect   </para>
</entry><entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Source    </para>
</entry></row>
<row>
<entry thead="no"><para>Algorithm   </para>
</entry><entry thead="no"><para><computeroutput>pbkdf2_sha256</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>passlib.context.CryptContext</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Hash Function   </para>
</entry><entry thead="no"><para>SHA-256   </para>
</entry><entry thead="no"><para>NIST-approved    </para>
</entry></row>
<row>
<entry thead="no"><para>Salt   </para>
</entry><entry thead="no"><para>Automatic (per-hash)   </para>
</entry><entry thead="no"><para>Built-in to pbkdf2    </para>
</entry></row>
<row>
<entry thead="no"><para>Iterations   </para>
</entry><entry thead="no"><para>passlib defaults   </para>
</entry><entry thead="no"><para>Configurable   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4231">
<title>Password Handling Functions</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Function   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Security Behavior    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>get_password_hash(password)</computeroutput>   </para>
</entry><entry thead="no"><para>Hash plaintext password   </para>
</entry><entry thead="no"><para>Returns irreversible hash    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>verify_password(plain, hashed)</computeroutput>   </para>
</entry><entry thead="no"><para>Validate credentials   </para>
</entry><entry thead="no"><para>Constant-time comparison   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4232">
<title>6.4.2.3 Token Handling (JWT)</title><para>The authentication system uses JSON Web Tokens (JWT) for stateless session management.</para>
<para><bold>JWT Configuration</bold>:</para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Location    </para>
</entry></row>
<row>
<entry thead="no"><para>Algorithm   </para>
</entry><entry thead="no"><para>HS256 (HMAC-SHA256)   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput> line 23    </para>
</entry></row>
<row>
<entry thead="no"><para>Expiration   </para>
</entry><entry thead="no"><para>30 minutes   </para>
</entry><entry thead="no"><para><computeroutput>ACCESS_TOKEN_EXPIRE_MINUTES</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Secret Key   </para>
</entry><entry thead="no"><para>Environment variable   </para>
</entry><entry thead="no"><para><computeroutput>SECRET_KEY</computeroutput> (required)   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4233">
<title>Token Lifecycle</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Client<sp/>as<sp/>API<sp/>Client</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Rate<sp/>as<sp/>Rate<sp/>Limiter</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Auth<sp/>as<sp/>Auth<sp/>Module</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Repo<sp/>as<sp/>User<sp/>Repository</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>JWT<sp/>as<sp/>JWT<sp/>Library</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Client-&gt;&gt;Rate:<sp/>POST<sp/>/token<sp/>(credentials)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Rate-&gt;&gt;Rate:<sp/>Check<sp/>5/min<sp/>limit</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>alt<sp/>Within<sp/>Rate<sp/>Limit</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Rate-&gt;&gt;Auth:<sp/>Process<sp/>Login<sp/>Request</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;Repo:<sp/>get_user(username)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Repo--&gt;&gt;Auth:<sp/>User<sp/>Object<sp/>or<sp/>None</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alt<sp/>User<sp/>Found</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;Auth:<sp/>verify_password()</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alt<sp/>Password<sp/>Valid</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;Auth:<sp/>Check<sp/>user.disabled</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alt<sp/>User<sp/>Active</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth-&gt;&gt;JWT:<sp/>encode(payload,<sp/>SECRET_KEY,<sp/>HS256)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JWT--&gt;&gt;Auth:<sp/>Access<sp/>Token</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth--&gt;&gt;Client:<sp/>{&quot;access_token&quot;:<sp/>&quot;...&quot;,<sp/>&quot;token_type&quot;:<sp/>&quot;bearer&quot;}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>User<sp/>Disabled</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth--&gt;&gt;Client:<sp/>400<sp/>Inactive<sp/>user</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>Password<sp/>Invalid</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth--&gt;&gt;Client:<sp/>401<sp/>Incorrect<sp/>username<sp/>or<sp/>password</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>User<sp/>Not<sp/>Found</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Auth--&gt;&gt;Client:<sp/>401<sp/>Incorrect<sp/>username<sp/>or<sp/>password</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else<sp/>Rate<sp/>Limit<sp/>Exceeded</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Rate--&gt;&gt;Client:<sp/>429<sp/>Too<sp/>Many<sp/>Requests</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4234">
<title>Token Security Controls</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Control   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Mitigation    </para>
</entry></row>
<row>
<entry thead="no"><para>Algorithm Pinning   </para>
</entry><entry thead="no"><para>Explicit <computeroutput>algorithms=[&quot;HS256&quot;]</computeroutput> in decode   </para>
</entry><entry thead="no"><para>Algorithm confusion attacks    </para>
</entry></row>
<row>
<entry thead="no"><para>Expiration Enforcement   </para>
</entry><entry thead="no"><para><computeroutput>exp</computeroutput> claim validation   </para>
</entry><entry thead="no"><para>Session hijacking    </para>
</entry></row>
<row>
<entry thead="no"><para>Secret Key Requirement   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput> if <computeroutput>SECRET_KEY</computeroutput> not set   </para>
</entry><entry thead="no"><para>Weak signing prevention    </para>
</entry></row>
<row>
<entry thead="no"><para>Bearer Token Standard   </para>
</entry><entry thead="no"><para>OAuth2PasswordBearer scheme   </para>
</entry><entry thead="no"><para>Standard compliance   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4235">
<title>6.4.2.4 Session Management</title><para>The system implements stateless session management through JWT tokens:</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Aspect   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Benefit    </para>
</entry></row>
<row>
<entry thead="no"><para>Session Storage   </para>
</entry><entry thead="no"><para>None (stateless)   </para>
</entry><entry thead="no"><para>No server-side session attacks    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Transport   </para>
</entry><entry thead="no"><para>Bearer header   </para>
</entry><entry thead="no"><para>Standard OAuth2 pattern    </para>
</entry></row>
<row>
<entry thead="no"><para>Session Termination   </para>
</entry><entry thead="no"><para>Token expiration   </para>
</entry><entry thead="no"><para>Automatic timeout    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Endpoint   </para>
</entry><entry thead="no"><para><computeroutput>POST /token</computeroutput>   </para>
</entry><entry thead="no"><para>Form-based credentials   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4236">
<title>6.4.2.5 Admin Credential Seeding</title><para>Initial admin credentials are configured through environment variables for secure bootstrapping:</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Variable   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_USERNAME</computeroutput>   </para>
</entry><entry thead="no"><para>Initial admin login   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_PASSWORD</computeroutput>   </para>
</entry><entry thead="no"><para>Initial admin password   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_EMAIL</computeroutput>   </para>
</entry><entry thead="no"><para>Admin contact   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_FULL_NAME</computeroutput>   </para>
</entry><entry thead="no"><para>Admin display name   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_DISABLED</computeroutput>   </para>
</entry><entry thead="no"><para>Disable flag (default: false)   </para>
</entry><entry thead="no"><para>No   </para>
</entry></row>
</table>
</para>
<para><bold>Security Enforcement</bold>: The system raises a <computeroutput>ValueError</computeroutput> if no users exist after seeding, preventing operation without proper authentication configuration.</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4238">
<title>6.4.3 Authorization System</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4239">
<title>6.4.3.1 Role-Based Access Control</title><para>The current implementation provides a simplified access control model with two user states:</para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>User State   </para>
</entry><entry thead="yes"><para>Permissions   </para>
</entry><entry thead="yes"><para>Enforcement    </para>
</entry></row>
<row>
<entry thead="no"><para>Anonymous   </para>
</entry><entry thead="no"><para>Public API endpoints only   </para>
</entry><entry thead="no"><para>No token required    </para>
</entry></row>
<row>
<entry thead="no"><para>Authenticated Active   </para>
</entry><entry thead="no"><para>All API endpoints   </para>
</entry><entry thead="no"><para>Valid JWT + active flag    </para>
</entry></row>
<row>
<entry thead="no"><para>Authenticated Disabled   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para><computeroutput>400 Inactive user</computeroutput> returned   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4240">
<title>6.4.3.2 Protected Endpoint Validation Flow</title><para>The <computeroutput>get_current_user</computeroutput> dependency implements a multi-step validation pipeline:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ValidationPipeline[Protected<sp/>Endpoint<sp/>Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Request([Incoming&lt;br/&gt;Request])<sp/>--&gt;<sp/>ExtractToken{Extract<sp/>Bearer&lt;br/&gt;Token<sp/>from<sp/>Header}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ExtractToken<sp/>--&gt;|Missing|<sp/>NoAuth[401:<sp/>Not<sp/>authenticated&lt;br/&gt;WWW-Authenticate:<sp/>Bearer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ExtractToken<sp/>--&gt;|Present|<sp/>DecodeJWT{Decode<sp/>JWT<sp/>with&lt;br/&gt;SECRET_KEY<sp/>+<sp/>HS256}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DecodeJWT<sp/>--&gt;|Decode<sp/>Error|<sp/>InvalidToken[401:<sp/>Could<sp/>not&lt;br/&gt;validate<sp/>credentials]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DecodeJWT<sp/>--&gt;|Success|<sp/>CheckExpiry{Check<sp/>Token&lt;br/&gt;Expiration}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckExpiry<sp/>--&gt;|Expired|<sp/>ExpiredToken[401:<sp/>Token&lt;br/&gt;has<sp/>expired]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckExpiry<sp/>--&gt;|Valid|<sp/>ExtractSub{Extract<sp/>username&lt;br/&gt;from<sp/>&apos;sub&apos;<sp/>claim}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ExtractSub<sp/>--&gt;|Missing|<sp/>InvalidPayload[401:<sp/>Could<sp/>not&lt;br/&gt;validate<sp/>credentials]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ExtractSub<sp/>--&gt;|Present|<sp/>LookupUser{Lookup<sp/>User&lt;br/&gt;in<sp/>Repository}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LookupUser<sp/>--&gt;|Not<sp/>Found|<sp/>UserNotFound[401:<sp/>Could<sp/>not&lt;br/&gt;validate<sp/>credentials]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LookupUser<sp/>--&gt;|Found|<sp/>CheckActive{User&lt;br/&gt;Active?}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckActive<sp/>--&gt;|Disabled|<sp/>InactiveUser[400:<sp/>Inactive<sp/>user]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckActive<sp/>--&gt;|Active|<sp/>Authorized([Request&lt;br/&gt;Authorized])</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NoAuth<sp/>--&gt;<sp/>ErrorResponse([Error<sp/>Response])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InvalidToken<sp/>--&gt;<sp/>ErrorResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ExpiredToken<sp/>--&gt;<sp/>ErrorResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InvalidPayload<sp/>--&gt;<sp/>ErrorResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserNotFound<sp/>--&gt;<sp/>ErrorResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InactiveUser<sp/>--&gt;<sp/>ErrorResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4241">
<title>6.4.3.3 Authorization Dependencies</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Dependency   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Returns    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>get_current_user</computeroutput>   </para>
</entry><entry thead="no"><para>Validates JWT and retrieves user   </para>
</entry><entry thead="no"><para><computeroutput>UserInDB</computeroutput> object    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>get_current_active_user</computeroutput>   </para>
</entry><entry thead="no"><para>Extends above with active check   </para>
</entry><entry thead="no"><para>Active <computeroutput>UserInDB</computeroutput> only   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4242">
<title>6.4.3.4 Endpoint Protection Matrix</title><para><table rows="8" cols="5"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>HTTP Method   </para>
</entry><entry thead="yes"><para>Auth Required   </para>
</entry><entry thead="yes"><para>Rate Limited   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/token</computeroutput>   </para>
</entry><entry thead="no"><para>POST   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>Yes (5/min)   </para>
</entry><entry thead="no"><para>JWT token issuance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/users/me</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Yes   </para>
</entry><entry thead="no"><para>Yes (10/min)   </para>
</entry><entry thead="no"><para>Current user info    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>List assets    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets/{id}</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>Single asset details    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/metrics</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>Network statistics    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/visualization</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>3D visualization data    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/health</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>Health check   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4243">
<title>6.4.3.5 Policy Enforcement Points</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Enforcement Point   </para>
</entry><entry thead="yes"><para>Location   </para>
</entry><entry thead="yes"><para>Control Type    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limiting   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Pre-authentication throttling    </para>
</entry></row>
<row>
<entry thead="no"><para>CORS Validation   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Origin allowlist    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Validation   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>JWT signature verification    </para>
</entry></row>
<row>
<entry thead="no"><para>User State Check   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Active account enforcement    </para>
</entry></row>
<row>
<entry thead="no"><para>Input Validation   </para>
</entry><entry thead="no"><para>Pydantic models   </para>
</entry><entry thead="no"><para>Type/format enforcement   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4245">
<title>6.4.4 Rate Limiting</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4246">
<title>6.4.4.1 Rate Limiting Architecture</title><para>Rate limiting is implemented using the <computeroutput>slowapi</computeroutput> library with IP-based request tracking:</para>
<para><bold>Configuration Location</bold>: <computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput> lines 156-169</para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>Library   </para>
</entry><entry thead="no"><para><computeroutput>slowapi</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Key Function   </para>
</entry><entry thead="no"><para><computeroutput>get_remote_address</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Exception Handler   </para>
</entry><entry thead="no"><para><computeroutput>RateLimitExceeded</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4247">
<title>6.4.4.2 Rate Limit Configuration</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Limit   </para>
</entry><entry thead="yes"><para>Window   </para>
</entry><entry thead="yes"><para>Rationale    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>POST /token</computeroutput>   </para>
</entry><entry thead="no"><para>5 requests   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Brute-force protection    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GET /api/users/me</computeroutput>   </para>
</entry><entry thead="no"><para>10 requests   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Authenticated endpoint protection    </para>
</entry></row>
<row>
<entry thead="no"><para>Other endpoints   </para>
</entry><entry thead="no"><para>Unlimited   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry><entry thead="no"><para>Public data access   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4248">
<title>6.4.4.3 Rate Limit Response</title><para>When rate limits are exceeded:</para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Response Element   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>HTTP Status   </para>
</entry><entry thead="no"><para>429 Too Many Requests    </para>
</entry></row>
<row>
<entry thead="no"><para>Header   </para>
</entry><entry thead="no"><para><computeroutput>Retry-After: &lt;seconds&gt;</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Body   </para>
</entry><entry thead="no"><para>Error message with limit details   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4250">
<title>6.4.5 CORS Configuration</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4251">
<title>6.4.5.1 CORS Security Model</title><para>Cross-Origin Resource Sharing (CORS) is implemented with environment-aware validation:</para>
<para><bold>Configuration Location</bold>: <computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput> lines 226-302</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4252">
<title>6.4.5.2 Origin Validation Rules</title><para><table rows="3" cols="5"><row>
<entry thead="yes"><para>Environment   </para>
</entry><entry thead="yes"><para>HTTP localhost   </para>
</entry><entry thead="yes"><para>HTTPS localhost   </para>
</entry><entry thead="yes"><para>Vercel URLs   </para>
</entry><entry thead="yes"><para>Custom HTTPS    </para>
</entry></row>
<row>
<entry thead="no"><para>Development   </para>
</entry><entry thead="no"><para>✅ Allowed   </para>
</entry><entry thead="no"><para>✅ Allowed   </para>
</entry><entry thead="no"><para>✅ Allowed   </para>
</entry><entry thead="no"><para>✅ Allowed    </para>
</entry></row>
<row>
<entry thead="no"><para>Production   </para>
</entry><entry thead="no"><para>❌ Rejected   </para>
</entry><entry thead="no"><para>✅ Allowed   </para>
</entry><entry thead="no"><para>✅ Allowed   </para>
</entry><entry thead="no"><para>✅ Allowed   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4253">
<title>6.4.5.3 Vercel Preview Domain Validation</title><para>Preview deployments are validated using regex pattern matching:</para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Pattern Component   </para>
</entry><entry thead="yes"><para>Regex    </para>
</entry></row>
<row>
<entry thead="no"><para>Protocol   </para>
</entry><entry thead="no"><para><computeroutput>^https://</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Subdomain   </para>
</entry><entry thead="no"><para><computeroutput>[a-zA-Z0-9\-\.]+</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Domain   </para>
</entry><entry thead="no"><para><computeroutput>\.vercel\.app$</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4254">
<title>6.4.5.4 CORS Middleware Configuration</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Security Note    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>allow_origins</computeroutput>   </para>
</entry><entry thead="no"><para>Validated allowlist   </para>
</entry><entry thead="no"><para>No wildcard (<computeroutput>*</computeroutput>)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>allow_credentials</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>True</computeroutput>   </para>
</entry><entry thead="no"><para>Cookie support enabled    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>allow_methods</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>[&quot;*&quot;]</computeroutput>   </para>
</entry><entry thead="no"><para>All HTTP methods    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>allow_headers</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>[&quot;*&quot;]</computeroutput>   </para>
</entry><entry thead="no"><para>All headers allowed   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4255">
<title>6.4.5.5 Custom Origin Configuration</title><para>Custom origins can be added via the <computeroutput>ALLOWED_ORIGINS</computeroutput> environment variable:</para>
<para><table rows="2" cols="2"><row>
<entry thead="yes"><para>Format   </para>
</entry><entry thead="yes"><para>Example    </para>
</entry></row>
<row>
<entry thead="no"><para>Comma-separated list   </para>
</entry><entry thead="no"><para><computeroutput><ulink url="https://app.example.com,https://staging.example.com">https://app.example.com,https://staging.example.com</ulink></computeroutput>   </para>
</entry></row>
</table>
</para>
<para>Origins are validated through <computeroutput>validate_origin()</computeroutput> before inclusion, with invalid origins logged as warnings and skipped.</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4257">
<title>6.4.6 Data Protection</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4258">
<title>6.4.6.1 Database Security</title><para><bold>Location</bold>: <computeroutput><ref refid="api_2database_8py" kindref="compound">api/database.py</ref></computeroutput></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Control   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Protection    </para>
</entry></row>
<row>
<entry thead="no"><para>Parameterized Queries   </para>
</entry><entry thead="no"><para><computeroutput>WHERE username = ?</computeroutput> binding   </para>
</entry><entry thead="no"><para>SQL injection prevention    </para>
</entry></row>
<row>
<entry thead="no"><para>Thread-Safe Access   </para>
</entry><entry thead="no"><para><computeroutput>threading.Lock</computeroutput> for shared connection   </para>
</entry><entry thead="no"><para>Race condition prevention    </para>
</entry></row>
<row>
<entry thead="no"><para>Connection Configuration   </para>
</entry><entry thead="no"><para><computeroutput>check_same_thread=False</computeroutput>   </para>
</entry><entry thead="no"><para>Multi-threaded compatibility   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4259">
<title>6.4.6.2 Input Validation Layers</title><para>The system implements three layers of input validation:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ValidationLayers[Multi-Layer<sp/>Input<sp/>Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Input([External<sp/>Input])<sp/>--&gt;<sp/>Layer1{Layer<sp/>1:&lt;br/&gt;API<sp/>Validation}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Layer1<sp/>--&gt;|Pydantic<sp/>Models|<sp/>PydanticCheck[Type<sp/>Enforcement&lt;br/&gt;Format<sp/>Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PydanticCheck<sp/>--&gt;|Invalid|<sp/>Reject422[422<sp/>Validation<sp/>Error]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PydanticCheck<sp/>--&gt;|Valid|<sp/>Layer2{Layer<sp/>2:&lt;br/&gt;Domain<sp/>Validation}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Layer2<sp/>--&gt;|Dataclass<sp/>__post_init__|<sp/>DomainCheck[Business<sp/>Rule&lt;br/&gt;Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DomainCheck<sp/>--&gt;|Invalid|<sp/>RejectValue[ValueError<sp/>Exception]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DomainCheck<sp/>--&gt;|Valid|<sp/>Layer3{Layer<sp/>3:&lt;br/&gt;Database<sp/>Constraints}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Layer3<sp/>--&gt;|SQLite/PostgreSQL|<sp/>DBCheck[NOT<sp/>NULL&lt;br/&gt;UNIQUE&lt;br/&gt;FOREIGN<sp/>KEY]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DBCheck<sp/>--&gt;|Invalid|<sp/>RejectDB[Database<sp/>Error]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DBCheck<sp/>--&gt;|Valid|<sp/>Success([Data<sp/>Accepted])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4260">
<title>6.4.6.3 Domain Model Validation Rules</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Field   </para>
</entry><entry thead="yes"><para>Validation Rule   </para>
</entry><entry thead="yes"><para>Error Type    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>id</computeroutput>, <computeroutput>symbol</computeroutput>, <computeroutput>name</computeroutput>   </para>
</entry><entry thead="no"><para>Non-empty string   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>price</computeroutput>   </para>
</entry><entry thead="no"><para>Non-negative float   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>market_cap</computeroutput>   </para>
</entry><entry thead="no"><para>Non-negative float (if present)   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>currency</computeroutput>   </para>
</entry><entry thead="no"><para>3-character ISO code   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>impact_score</computeroutput>   </para>
</entry><entry thead="no"><para>Range [-1.0, 1.0]   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>date</computeroutput>   </para>
</entry><entry thead="no"><para>ISO 8601 format (YYYY-MM-DD)   </para>
</entry><entry thead="no"><para><computeroutput>ValueError</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4261">
<title>6.4.6.4 Encryption Standards</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Data Type   </para>
</entry><entry thead="yes"><para>At Rest   </para>
</entry><entry thead="yes"><para>In Transit    </para>
</entry></row>
<row>
<entry thead="no"><para>Passwords   </para>
</entry><entry thead="no"><para>pbkdf2_sha256 hash   </para>
</entry><entry thead="no"><para>HTTPS/TLS    </para>
</entry></row>
<row>
<entry thead="no"><para>JWT Tokens   </para>
</entry><entry thead="no"><para>N/A (ephemeral)   </para>
</entry><entry thead="no"><para>HTTPS/TLS    </para>
</entry></row>
<row>
<entry thead="no"><para>API Data   </para>
</entry><entry thead="no"><para>Unencrypted (SQLite)   </para>
</entry><entry thead="no"><para>HTTPS/TLS    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache Files   </para>
</entry><entry thead="no"><para>Unencrypted (JSON)   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4262">
<title>6.4.6.5 Secure Communication</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Environment   </para>
</entry><entry thead="yes"><para>Protocol   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>Development   </para>
</entry><entry thead="no"><para>HTTP allowed   </para>
</entry><entry thead="no"><para>Local testing    </para>
</entry></row>
<row>
<entry thead="no"><para>Production   </para>
</entry><entry thead="no"><para>HTTPS required   </para>
</entry><entry thead="no"><para>Vercel TLS termination    </para>
</entry></row>
<row>
<entry thead="no"><para>Container   </para>
</entry><entry thead="no"><para>HTTP internal   </para>
</entry><entry thead="no"><para>HTTPS at edge   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4264">
<title>6.4.7 Secrets Management</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4265">
<title>6.4.7.1 Required Environment Variables</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Variable   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Criticality    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SECRET_KEY</computeroutput>   </para>
</entry><entry thead="no"><para>JWT signing key   </para>
</entry><entry thead="no"><para><bold>Critical</bold> - Application fails without    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>DATABASE_URL</computeroutput>   </para>
</entry><entry thead="no"><para>SQLite connection string   </para>
</entry><entry thead="no"><para><bold>Critical</bold> - Application fails without    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_USERNAME</computeroutput>   </para>
</entry><entry thead="no"><para>Initial admin account   </para>
</entry><entry thead="no"><para>Required for user seeding    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_PASSWORD</computeroutput>   </para>
</entry><entry thead="no"><para>Initial admin password   </para>
</entry><entry thead="no"><para>Required for user seeding   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4266">
<title>6.4.7.2 Optional Environment Variables</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Variable   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Default    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ENV</computeroutput>   </para>
</entry><entry thead="no"><para>Environment mode   </para>
</entry><entry thead="no"><para><computeroutput>development</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ALLOWED_ORIGINS</computeroutput>   </para>
</entry><entry thead="no"><para>CORS allowlist   </para>
</entry><entry thead="no"><para>Empty (built-in defaults)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_EMAIL</computeroutput>   </para>
</entry><entry thead="no"><para>Admin email   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_FULL_NAME</computeroutput>   </para>
</entry><entry thead="no"><para>Admin display name   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_DISABLED</computeroutput>   </para>
</entry><entry thead="no"><para>Disable admin   </para>
</entry><entry thead="no"><para><computeroutput>false</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4267">
<title>6.4.7.3 Secrets Security Best Practices</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Practice   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>No committed secrets   </para>
</entry><entry thead="no"><para><computeroutput>.env.example</computeroutput> provides template only    </para>
</entry></row>
<row>
<entry thead="no"><para>Runtime injection   </para>
</entry><entry thead="no"><para>Environment variables at deployment    </para>
</entry></row>
<row>
<entry thead="no"><para>Secret rotation   </para>
</entry><entry thead="no"><para>Manual SECRET_KEY rotation supported    </para>
</entry></row>
<row>
<entry thead="no"><para>Least privilege   </para>
</entry><entry thead="no"><para>Only required secrets loaded   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4269">
<title>6.4.8 Container Security</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4270">
<title>6.4.8.1 Docker Security Measures</title><para><bold>Location</bold>: <computeroutput>Dockerfile</computeroutput></para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Security Measure   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Benefit    </para>
</entry></row>
<row>
<entry thead="no"><para>Non-root User   </para>
</entry><entry thead="no"><para><computeroutput>useradd -m -u 1000 appuser</computeroutput>   </para>
</entry><entry thead="no"><para>Privilege escalation prevention    </para>
</entry></row>
<row>
<entry thead="no"><para>Minimal <ref refid="classBase" kindref="compound">Base</ref> Image   </para>
</entry><entry thead="no"><para><computeroutput>python:3.11-slim</computeroutput>   </para>
</entry><entry thead="no"><para>Reduced attack surface    </para>
</entry></row>
<row>
<entry thead="no"><para>No Cache   </para>
</entry><entry thead="no"><para><computeroutput>pip install --no-cache-dir</computeroutput>   </para>
</entry><entry thead="no"><para>No sensitive data in layers    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Checks   </para>
</entry><entry thead="no"><para><computeroutput>HEALTHCHECK</computeroutput> with 30s interval   </para>
</entry><entry thead="no"><para>Container orchestration support    </para>
</entry></row>
<row>
<entry thead="no"><para>No Bytecode   </para>
</entry><entry thead="no"><para><computeroutput>PYTHONDONTWRITEBYTECODE=1</computeroutput>   </para>
</entry><entry thead="no"><para>Cleaner runtime   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4271">
<title>6.4.8.2 Container Security Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ContainerSecurity[Container<sp/>Security<sp/>Architecture]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Build([Docker<sp/>Build])<sp/>--&gt;<sp/>BaseImage[python:3.11-slim&lt;br/&gt;Minimal<sp/>Base]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BaseImage<sp/>--&gt;<sp/>CreateUser[Create<sp/>Non-Root<sp/>User&lt;br/&gt;appuser<sp/>UID<sp/>1000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CreateUser<sp/>--&gt;<sp/>InstallDeps[Install<sp/>Dependencies&lt;br/&gt;No<sp/>Cache]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InstallDeps<sp/>--&gt;<sp/>CopyApp[Copy<sp/>Application&lt;br/&gt;Code]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CopyApp<sp/>--&gt;<sp/>SetUser[Switch<sp/>to&lt;br/&gt;appuser]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetUser<sp/>--&gt;<sp/>HealthCheck[Configure&lt;br/&gt;Health<sp/>Check]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HealthCheck<sp/>--&gt;<sp/>Runtime([Container<sp/>Runtime])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4273">
<title>6.4.9 CI/CD Security Scanning</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4274">
<title>6.4.9.1 Security Scanning Pipeline</title><para>The repository implements comprehensive security scanning through both CircleCI and GitHub Actions workflows:</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4275">
<title>CircleCI Security Pipeline</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Stage    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>safety check</computeroutput>   </para>
</entry><entry thead="no"><para>Python dependency vulnerabilities   </para>
</entry><entry thead="no"><para>Build    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>bandit</computeroutput>   </para>
</entry><entry thead="no"><para>Python SAST analysis   </para>
</entry><entry thead="no"><para>Build    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>pytest --cov</computeroutput>   </para>
</entry><entry thead="no"><para>Test coverage verification   </para>
</entry><entry thead="no"><para>Test   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4276">
<title>GitHub Actions Security Workflows</title><para><table rows="11" cols="3"><row>
<entry thead="yes"><para>Workflow   </para>
</entry><entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>bandit.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Bandit   </para>
</entry><entry thead="no"><para>Python static security analysis    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>codeql.yml</computeroutput>   </para>
</entry><entry thead="no"><para>CodeQL   </para>
</entry><entry thead="no"><para>Multi-language SAST    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>semgrep.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Semgrep   </para>
</entry><entry thead="no"><para>Pattern-based vulnerability detection    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>trivy.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Trivy   </para>
</entry><entry thead="no"><para>Container image scanning    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>hadolint.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Hadolint   </para>
</entry><entry thead="no"><para>Dockerfile best practices    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>snyk-security.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Snyk   </para>
</entry><entry thead="no"><para>Dependency vulnerability scanning    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>snyk-container.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Snyk   </para>
</entry><entry thead="no"><para>Container vulnerability scanning    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>dependency-review.yml</computeroutput>   </para>
</entry><entry thead="no"><para>GitHub   </para>
</entry><entry thead="no"><para>PR dependency review    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>scorecard.yml</computeroutput>   </para>
</entry><entry thead="no"><para>OSSF Scorecard   </para>
</entry><entry thead="no"><para>Supply chain security    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>devskim.yml</computeroutput>   </para>
</entry><entry thead="no"><para>DevSkim   </para>
</entry><entry thead="no"><para>Security linting   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4277">
<title>6.4.9.2 SARIF Integration</title><para>Security scan results are integrated with GitHub Advanced Security:</para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Upload Action   </para>
</entry><entry thead="no"><para><computeroutput>github/codeql-action/upload-sarif@v3</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Permission   </para>
</entry><entry thead="no"><para><computeroutput>security-events: write</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Visibility   </para>
</entry><entry thead="no"><para>GitHub Security tab   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4279">
<title>6.4.10 Error Handling Security</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4280">
<title>6.4.10.1 Information Disclosure Controls</title><para>Error responses are designed to minimize information leakage:</para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Status Code   </para>
</entry><entry thead="yes"><para>Scenario   </para>
</entry><entry thead="yes"><para>Information Disclosed    </para>
</entry></row>
<row>
<entry thead="no"><para>400   </para>
</entry><entry thead="no"><para>Bad Request   </para>
</entry><entry thead="no"><para>Generic &quot;Inactive user&quot; message    </para>
</entry></row>
<row>
<entry thead="no"><para>401   </para>
</entry><entry thead="no"><para>Unauthorized   </para>
</entry><entry thead="no"><para>Generic credential failure message    </para>
</entry></row>
<row>
<entry thead="no"><para>404   </para>
</entry><entry thead="no"><para>Not Found   </para>
</entry><entry thead="no"><para>Resource type and ID only    </para>
</entry></row>
<row>
<entry thead="no"><para>422   </para>
</entry><entry thead="no"><para>Validation Error   </para>
</entry><entry thead="no"><para>Pydantic field details    </para>
</entry></row>
<row>
<entry thead="no"><para>429   </para>
</entry><entry thead="no"><para>Rate Limited   </para>
</entry><entry thead="no"><para>Retry-After header only    </para>
</entry></row>
<row>
<entry thead="no"><para>500   </para>
</entry><entry thead="no"><para>Internal Error   </para>
</entry><entry thead="no"><para>Generic message (details logged internally)   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4281">
<title>6.4.10.2 Exception Handling Pattern</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Exception Type   </para>
</entry><entry thead="yes"><para>Response Behavior   </para>
</entry><entry thead="yes"><para>Internal Action    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>HTTPException</computeroutput>   </para>
</entry><entry thead="no"><para>Re-raised directly   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>RateLimitExceeded</computeroutput>   </para>
</entry><entry thead="no"><para>429 with Retry-After   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ValidationError</computeroutput>   </para>
</entry><entry thead="no"><para>422 with field details   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para>Other exceptions   </para>
</entry><entry thead="no"><para>500 generic message   </para>
</entry><entry thead="no"><para><computeroutput>logger.exception()</computeroutput>   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4283">
<title>6.4.11 Logging and Audit</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4284">
<title>6.4.11.1 Logging Configuration</title><para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Level   </para>
</entry><entry thead="no"><para><computeroutput>INFO</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Module   </para>
</entry><entry thead="no"><para><computeroutput>logging.getLogger(__name__)</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Format   </para>
</entry><entry thead="no"><para>Python standard logging   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4285">
<title>6.4.11.2 Security Event Logging</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Event Category   </para>
</entry><entry thead="yes"><para>Log Level   </para>
</entry><entry thead="yes"><para>Content    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph initialization   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Success/failure status    </para>
</entry></row>
<row>
<entry thead="no"><para>Application startup   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Server binding, port    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication failures   </para>
</entry><entry thead="no"><para>WARNING   </para>
</entry><entry thead="no"><para>Failed login attempts    </para>
</entry></row>
<row>
<entry thead="no"><para>Invalid CORS origins   </para>
</entry><entry thead="no"><para>WARNING   </para>
</entry><entry thead="no"><para>Skipped origin value    </para>
</entry></row>
<row>
<entry thead="no"><para>Request errors   </para>
</entry><entry thead="no"><para>ERROR   </para>
</entry><entry thead="no"><para>Exception details    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache operations   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Load/save success   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4287">
<title>6.4.12 Compliance Controls</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4288">
<title>6.4.12.1 Security Control Matrix</title><para><table rows="12" cols="4"><row>
<entry thead="yes"><para>Control Category   </para>
</entry><entry thead="yes"><para>Control   </para>
</entry><entry thead="yes"><para>Status   </para>
</entry><entry thead="yes"><para>Evidence    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Access Control</bold>   </para>
</entry><entry thead="no"><para>JWT Authentication   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para></para>
</entry><entry thead="no"><para>Token Expiration   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>30-minute default    </para>
</entry></row>
<row>
<entry thead="no"><para></para>
</entry><entry thead="no"><para>Rate Limiting   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>slowapi integration    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Data Protection</bold>   </para>
</entry><entry thead="no"><para>Password Hashing   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>pbkdf2_sha256    </para>
</entry></row>
<row>
<entry thead="no"><para></para>
</entry><entry thead="no"><para>HTTPS Enforcement   </para>
</entry><entry thead="no"><para>✅ Production   </para>
</entry><entry thead="no"><para>Vercel TLS    </para>
</entry></row>
<row>
<entry thead="no"><para></para>
</entry><entry thead="no"><para>Input Validation   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>Multi-layer validation    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Audit</bold>   </para>
</entry><entry thead="no"><para>Authentication Logging   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>WARNING level    </para>
</entry></row>
<row>
<entry thead="no"><para></para>
</entry><entry thead="no"><para>Error Logging   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>ERROR level    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Infrastructure</bold>   </para>
</entry><entry thead="no"><para>Container Hardening   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>Non-root user    </para>
</entry></row>
<row>
<entry thead="no"><para></para>
</entry><entry thead="no"><para>Dependency Scanning   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>CI/CD pipelines    </para>
</entry></row>
<row>
<entry thead="no"><para></para>
</entry><entry thead="no"><para>Secret Management   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>Environment variables   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4289">
<title>6.4.12.2 Security Dependencies</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>PyJWT</computeroutput>   </para>
</entry><entry thead="no"><para>&gt;=2.8.0   </para>
</entry><entry thead="no"><para>JWT authentication    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>passlib[bcrypt]</computeroutput>   </para>
</entry><entry thead="no"><para>&gt;=1.7.4   </para>
</entry><entry thead="no"><para>Password hashing    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>slowapi</computeroutput>   </para>
</entry><entry thead="no"><para>&gt;=0.1.4   </para>
</entry><entry thead="no"><para>Rate limiting    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>urllib3</computeroutput>   </para>
</entry><entry thead="no"><para>&gt;=2.6.0   </para>
</entry><entry thead="no"><para>Snyk security pin    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>zipp</computeroutput>   </para>
</entry><entry thead="no"><para>&gt;=3.19.1   </para>
</entry><entry thead="no"><para>Snyk security pin   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4290">
<title>6.4.12.3 Compliance Recommendations</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Requirement   </para>
</entry><entry thead="yes"><para>Current Status   </para>
</entry><entry thead="yes"><para>Recommendation    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Encryption at Rest   </para>
</entry><entry thead="no"><para>Not implemented   </para>
</entry><entry thead="no"><para>Consider SQLCipher for SQLite    </para>
</entry></row>
<row>
<entry thead="no"><para>Multi-Factor Authentication   </para>
</entry><entry thead="no"><para>Not implemented   </para>
</entry><entry thead="no"><para>Add TOTP support for admin    </para>
</entry></row>
<row>
<entry thead="no"><para>Audit Log Persistence   </para>
</entry><entry thead="no"><para>In-memory only   </para>
</entry><entry thead="no"><para>Add persistent audit logging    </para>
</entry></row>
<row>
<entry thead="no"><para>Session Revocation   </para>
</entry><entry thead="no"><para>Token-based expiry only   </para>
</entry><entry thead="no"><para>Implement token blacklist    </para>
</entry></row>
<row>
<entry thead="no"><para>Key Rotation   </para>
</entry><entry thead="no"><para>Manual only   </para>
</entry><entry thead="no"><para>Implement automated rotation   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4292">
<title>6.4.13 Security Architecture Summary Diagram</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>SecurityArchitecture[Complete<sp/>Security<sp/>Architecture]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>ExternalLayer[External<sp/>Security<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TLS[TLS/HTTPS&lt;br/&gt;Termination]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>EdgeCORS[CORS&lt;br/&gt;Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>ApplicationSecurity[Application<sp/>Security<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLimit[Rate&lt;br/&gt;Limiting]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JWTAuth[JWT&lt;br/&gt;Authentication]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InputVal[Input&lt;br/&gt;Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>DataSecurity[Data<sp/>Security<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PassHash[Password&lt;br/&gt;Hashing]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParamQuery[Parameterized&lt;br/&gt;Queries]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SecretMgmt[Secrets&lt;br/&gt;Management]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>InfrastructureSecurity[Infrastructure<sp/>Security]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Container[Container&lt;br/&gt;Hardening]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CICD[CI/CD&lt;br/&gt;Scanning]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AuditLog[Audit&lt;br/&gt;Logging]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Client([Client])<sp/>--&gt;<sp/>TLS</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>TLS<sp/>--&gt;<sp/>EdgeCORS</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>EdgeCORS<sp/>--&gt;<sp/>RateLimit</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RateLimit<sp/>--&gt;<sp/>JWTAuth</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>JWTAuth<sp/>--&gt;<sp/>InputVal</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>InputVal<sp/>--&gt;<sp/>PassHash</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PassHash<sp/>--&gt;<sp/>ParamQuery</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ParamQuery<sp/>--&gt;<sp/>SecretMgmt</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Container<sp/>-.-&gt;<sp/>ApplicationSecurity</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CICD<sp/>-.-&gt;<sp/>DataSecurity</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AuditLog<sp/>-.-&gt;<sp/>ApplicationSecurity</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4294">
<title>6.4.14 References</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4295">
<title>6.4.14.1 Source Files</title><para><table rows="12" cols="2"><row>
<entry thead="yes"><para>Path   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Complete authentication module with JWT, password hashing, user repository    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2database_8py" kindref="compound">api/database.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>SQLite database helpers with parameterized queries    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI application with CORS, rate limiting, authentication integration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="SECURITY_8md" kindref="compound">SECURITY.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Security best practices documentation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Dockerfile</computeroutput>   </para>
</entry><entry thead="no"><para>Container security configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>docker-compose.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Docker composition with health checks    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.env.example</computeroutput>   </para>
</entry><entry thead="no"><para>Environment variable template    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>requirements.txt</computeroutput>   </para>
</entry><entry thead="no"><para>Security dependency specifications    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="test__api__main_8py" kindref="compound">tests/unit/test_api_main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>CORS and API security tests    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="test__api__integration_8py" kindref="compound">tests/integration/test_api_integration.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Authentication flow integration tests    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Domain model validation rules   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4296">
<title>6.4.14.2 CI/CD Security Configuration</title><para><table rows="8" cols="2"><row>
<entry thead="yes"><para>Path   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.circleci/config.yml</computeroutput>   </para>
</entry><entry thead="no"><para>CircleCI security pipeline    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/bandit.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Bandit SAST workflow    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/codeql.yml</computeroutput>   </para>
</entry><entry thead="no"><para>CodeQL analysis workflow    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/semgrep.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Semgrep pattern analysis    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/trivy.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Container scanning workflow    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/snyk-security.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Snyk dependency scanning    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/scorecard.yml</computeroutput>   </para>
</entry><entry thead="no"><para>OSSF supply chain security   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4297">
<title>6.4.14.3 Technical Specification Cross-References</title><para><table rows="8" cols="2"><row>
<entry thead="yes"><para>Section   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para>3.8 Security Considerations   </para>
</entry><entry thead="no"><para>Technology stack security overview    </para>
</entry></row>
<row>
<entry thead="no"><para>5.2 COMPONENT DETAILS   </para>
</entry><entry thead="no"><para>FastAPI backend security integration    </para>
</entry></row>
<row>
<entry thead="no"><para>5.4 CROSS-CUTTING CONCERNS   </para>
</entry><entry thead="no"><para>Authentication framework, error handling    </para>
</entry></row>
<row>
<entry thead="no"><para>5.5 DEPLOYMENT ARCHITECTURE   </para>
</entry><entry thead="no"><para>Container and serverless security    </para>
</entry></row>
<row>
<entry thead="no"><para>6.2 Database Design   </para>
</entry><entry thead="no"><para>Authentication schema, access control matrix    </para>
</entry></row>
<row>
<entry thead="no"><para>4.3 API Request Workflows   </para>
</entry><entry thead="no"><para>Request validation flows    </para>
</entry></row>
<row>
<entry thead="no"><para>4.5 Error Handling Workflows   </para>
</entry><entry thead="no"><para>Security error scenarios   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4298">
<title>6.5 Monitoring and Observability</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4299">
<title>6.5.1 Monitoring Architecture Overview</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4300">
<title>6.5.1.1 Current State Assessment</title><para>The Financial Asset Relationship Database implements <bold>essential monitoring capabilities</bold> through built-in health checks, application logging, and a metrics endpoint. The system follows a <bold>monolithic layered architecture</bold> that does not require complex distributed tracing infrastructure typically associated with microservices architectures.</para>
<para>The current monitoring implementation provides sufficient observability for the system&apos;s operational requirements while maintaining operational simplicity. The following table summarizes the monitoring architecture:</para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Implementation Status   </para>
</entry><entry thead="yes"><para>Technology    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Checks   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>FastAPI endpoint, Docker HEALTHCHECK    </para>
</entry></row>
<row>
<entry thead="no"><para>Application Logging   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>Python standard logging    </para>
</entry></row>
<row>
<entry thead="no"><para>Application Metrics   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>Custom <computeroutput>/api/metrics</computeroutput> endpoint    </para>
</entry></row>
<row>
<entry thead="no"><para>Distributed Tracing   </para>
</entry><entry thead="no"><para>⚠️ Not Required   </para>
</entry><entry thead="no"><para>Monolithic architecture    </para>
</entry></row>
<row>
<entry thead="no"><para>Log Aggregation   </para>
</entry><entry thead="no"><para>⚠️ Not Implemented   </para>
</entry><entry thead="no"><para>Basic stdout logging    </para>
</entry></row>
<row>
<entry thead="no"><para>Alert Management   </para>
</entry><entry thead="no"><para>⚠️ CI/CD Only   </para>
</entry><entry thead="no"><para>GitHub Actions, CircleCI   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4301">
<title>6.5.1.2 Monitoring Architecture Diagram</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>MonitoringArchitecture[Monitoring<sp/>Architecture]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>ApplicationLayer[Application<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI[FastAPI<sp/>Backend&lt;br/&gt;Port<sp/>8000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gradio[Gradio<sp/>UI&lt;br/&gt;Port<sp/>7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextJS[Next.js<sp/>Frontend&lt;br/&gt;Port<sp/>3000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>MonitoringEndpoints[Monitoring<sp/>Endpoints]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HealthCheck[&quot;/api/health&lt;br/&gt;Health<sp/>Check&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MetricsEndpoint[&quot;/api/metrics&lt;br/&gt;Graph<sp/>Metrics&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>LoggingLayer[Logging<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PythonLogging[Python<sp/>Standard&lt;br/&gt;Logging]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ConsoleOutput[Console/Stdout&lt;br/&gt;Output]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>ContainerMonitoring[Container<sp/>Monitoring]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerHealth[Docker<sp/>HEALTHCHECK&lt;br/&gt;HTTP<sp/>Probe]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ComposeHealth[Docker<sp/>Compose&lt;br/&gt;Health<sp/>Config]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>CICDMonitoring[CI/CD<sp/>Monitoring]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GitHubActions[GitHub<sp/>Actions&lt;br/&gt;Security<sp/>Scans]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CircleCI[CircleCI&lt;br/&gt;Test<sp/>Coverage]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Codecov[Codecov&lt;br/&gt;Coverage<sp/>Reports]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>HealthCheck</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>MetricsEndpoint</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>PythonLogging</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PythonLogging<sp/>--&gt;<sp/>ConsoleOutput</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DockerHealth<sp/>--&gt;<sp/>HealthCheck</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ComposeHealth<sp/>--&gt;<sp/>HealthCheck</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GitHubActions<sp/>--&gt;<sp/>SecurityScan([Security&lt;br/&gt;Results])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CircleCI<sp/>--&gt;<sp/>CoverageRpt([Coverage&lt;br/&gt;Reports])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CoverageRpt<sp/>--&gt;<sp/>Codecov</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4303">
<title>6.5.2 Monitoring Infrastructure</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4304">
<title>6.5.2.1 Health Check Implementation</title><para>The system implements comprehensive health checking at multiple levels to ensure operational reliability.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4305">
<title>API Health Check Endpoint</title><para><bold>Location</bold>: <computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput> (lines 428-431)</para>
<para><table rows="2" cols="4"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Method   </para>
</entry><entry thead="yes"><para>Response   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/health</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para><computeroutput>{&quot;status&quot;: &quot;healthy&quot;, &quot;graph_initialized&quot;: true}</computeroutput>   </para>
</entry><entry thead="no"><para>Load balancer probe   </para>
</entry></row>
</table>
</para>
<para>The health check endpoint provides immediate visibility into application state and is used by container orchestration systems for readiness and liveness probes.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4306">
<title>Docker Container Health Checks</title><para><bold>Location</bold>: <computeroutput>Dockerfile</computeroutput> (lines 38-40), <computeroutput>docker-compose.yml</computeroutput> (lines 20-25)</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Parameter   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>interval</computeroutput>   </para>
</entry><entry thead="no"><para>30 seconds   </para>
</entry><entry thead="no"><para>Probe frequency    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>timeout</computeroutput>   </para>
</entry><entry thead="no"><para>10 seconds   </para>
</entry><entry thead="no"><para>Maximum probe duration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>retries</computeroutput>   </para>
</entry><entry thead="no"><para>3   </para>
</entry><entry thead="no"><para>Failures before unhealthy    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>start_period</computeroutput>   </para>
</entry><entry thead="no"><para>5-40 seconds   </para>
</entry><entry thead="no"><para>Startup grace period   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4307">
<title>Health Check Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>HealthCheckFlow[Health<sp/>Check<sp/>Flow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Orchestrator([Container&lt;br/&gt;Orchestrator])<sp/>--&gt;<sp/>DockerProbe{Docker&lt;br/&gt;HEALTHCHECK}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerProbe<sp/>--&gt;<sp/>CurlRequest[HTTP<sp/>GET&lt;br/&gt;localhost:7860/]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CurlRequest<sp/>--&gt;<sp/>CheckResponse{Response&lt;br/&gt;Status?}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckResponse<sp/>--&gt;|200<sp/>OK|<sp/>Healthy[Container&lt;br/&gt;Healthy]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckResponse<sp/>--&gt;|Error/Timeout|<sp/>RetryCount{Retry&lt;br/&gt;Count<sp/>&lt;<sp/>3?}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RetryCount<sp/>--&gt;|Yes|<sp/>WaitInterval[Wait<sp/>30s]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WaitInterval<sp/>--&gt;<sp/>CurlRequest</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RetryCount<sp/>--&gt;|No|<sp/>Unhealthy[Container&lt;br/&gt;Unhealthy]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Unhealthy<sp/>--&gt;<sp/>RestartPolicy{Restart&lt;br/&gt;Policy?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RestartPolicy<sp/>--&gt;|unless-stopped|<sp/>Restart[Restart&lt;br/&gt;Container]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Restart<sp/>--&gt;<sp/>StartPeriod[Start<sp/>Period&lt;br/&gt;Grace<sp/>40s]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>StartPeriod<sp/>--&gt;<sp/>CurlRequest</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4308">
<title>Frontend Health Check Integration</title><para><bold>Location</bold>: <computeroutput>frontend/app/lib/api.ts</computeroutput> (lines 14-18)</para>
<para>The Next.js frontend includes an API client method for health checking:</para>
<para><table rows="2" cols="3"><row>
<entry thead="yes"><para>Method   </para>
</entry><entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Response Handling    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>healthCheck()</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>GET /api/health</computeroutput>   </para>
</entry><entry thead="no"><para>Returns health status object   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4309">
<title>6.5.2.2 Logging Strategy</title><para>The system implements Python standard logging with structured output for operational visibility.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4310">
<title>Logging Configuration</title><para><bold>Backend Logging</bold> (<computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput> lines 26-28):</para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Level   </para>
</entry><entry thead="no"><para><computeroutput>INFO</computeroutput>   </para>
</entry><entry thead="no"><para>Default verbosity    </para>
</entry></row>
<row>
<entry thead="no"><para>Logger   </para>
</entry><entry thead="no"><para><computeroutput>logging.getLogger(__name__)</computeroutput>   </para>
</entry><entry thead="no"><para>Module-specific logger    </para>
</entry></row>
<row>
<entry thead="no"><para>Format   </para>
</entry><entry thead="no"><para>Python default   </para>
</entry><entry thead="no"><para>Standard log format   </para>
</entry></row>
</table>
</para>
<para><bold>Gradio Logging</bold> (<computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput> line 20):</para>
<para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Level   </para>
</entry><entry thead="no"><para><computeroutput>INFO</computeroutput>   </para>
</entry><entry thead="no"><para>Default verbosity    </para>
</entry></row>
<row>
<entry thead="no"><para>Format   </para>
</entry><entry thead="no"><para><computeroutput>%(asctime)s - %(name)s - %(levelname)s - %(message)s</computeroutput>   </para>
</entry><entry thead="no"><para>Timestamped structured format   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4311">
<title>Log Point Catalog</title><para><table rows="9" cols="4"><row>
<entry thead="yes"><para>Log Point   </para>
</entry><entry thead="yes"><para>Level   </para>
</entry><entry thead="yes"><para>Content   </para>
</entry><entry thead="yes"><para>Location    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph initialization   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Success/failure status   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Application startup   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Server binding, port   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Application shutdown   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Shutdown notification   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache operations   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Load/save success   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Data fetching   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Yahoo Finance fetches   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Request errors   </para>
</entry><entry thead="no"><para>ERROR   </para>
</entry><entry thead="no"><para>Exception details   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication failures   </para>
</entry><entry thead="no"><para>WARNING   </para>
</entry><entry thead="no"><para>Failed login attempts   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Invalid CORS origins   </para>
</entry><entry thead="no"><para>WARNING   </para>
</entry><entry thead="no"><para>Skipped origin value   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4312">
<title>6.5.2.3 Metrics Collection</title></sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4313">
<title>Application Metrics Endpoint</title><para><bold>Location</bold>: <computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput> (lines 563-602)</para>
<para>The <computeroutput>/api/metrics</computeroutput> endpoint provides graph topology and network analysis metrics:</para>
<para><table rows="8" cols="3"><row>
<entry thead="yes"><para>Metric   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>total_assets</computeroutput>   </para>
</entry><entry thead="no"><para>Counter   </para>
</entry><entry thead="no"><para>Count of nodes in graph    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>total_relationships</computeroutput>   </para>
</entry><entry thead="no"><para>Counter   </para>
</entry><entry thead="no"><para>Count of edges in graph    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_classes</computeroutput>   </para>
</entry><entry thead="no"><para>Dictionary   </para>
</entry><entry thead="no"><para>Count per asset class    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>avg_degree</computeroutput>   </para>
</entry><entry thead="no"><para>Gauge   </para>
</entry><entry thead="no"><para>Mean connections per node    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>max_degree</computeroutput>   </para>
</entry><entry thead="no"><para>Gauge   </para>
</entry><entry thead="no"><para>Highest connected node    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>network_density</computeroutput>   </para>
</entry><entry thead="no"><para>Gauge   </para>
</entry><entry thead="no"><para>Ratio of actual to possible edges    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>relationship_density</computeroutput>   </para>
</entry><entry thead="no"><para>Gauge   </para>
</entry><entry thead="no"><para>Calculated relationship density   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4314">
<title>Metrics Response Model</title><para><bold>Location</bold>: <computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput> (lines 389-397)</para>
<para><programlisting><codeline><highlight class="normal">MetricsResponse<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>total_assets:<sp/>int</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>total_relationships:<sp/>int</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>asset_classes:<sp/>Dict[str,<sp/>int]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>avg_degree:<sp/>float</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>max_degree:<sp/>int</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>network_density:<sp/>float</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>relationship_density:<sp/>float</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4316">
<title>6.5.3 Observability Patterns</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4317">
<title>6.5.3.1 Performance Targets and SLAs</title><para>The system defines clear Service Level Agreements (SLAs) for critical operations:</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4318">
<title>Performance SLA Matrix</title><para><table rows="9" cols="3"><row>
<entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Target SLA   </para>
</entry><entry thead="yes"><para>Measurement Point    </para>
</entry></row>
<row>
<entry thead="no"><para>API Response (p95)   </para>
</entry><entry thead="no"><para>&lt; 500ms   </para>
</entry><entry thead="no"><para>Request to response    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Rendering   </para>
</entry><entry thead="no"><para>&lt; 2 seconds   </para>
</entry><entry thead="no"><para>Data load to interactive    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Generation   </para>
</entry><entry thead="no"><para>&lt; 100ms   </para>
</entry><entry thead="no"><para>Credential to token    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Initialization   </para>
</entry><entry thead="no"><para>&lt; 3 seconds   </para>
</entry><entry thead="no"><para>Application startup    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Discovery   </para>
</entry><entry thead="no"><para>&lt; 500ms   </para>
</entry><entry thead="no"><para>For 100 assets    </para>
</entry></row>
<row>
<entry thead="no"><para>Initial Page Load   </para>
</entry><entry thead="no"><para>&lt; 3 seconds   </para>
</entry><entry thead="no"><para>Navigation to interactive    </para>
</entry></row>
<row>
<entry thead="no"><para>Dataclass Instantiation   </para>
</entry><entry thead="no"><para>&lt; 1ms   </para>
</entry><entry thead="no"><para>Per object    </para>
</entry></row>
<row>
<entry thead="no"><para>Validation   </para>
</entry><entry thead="no"><para>&lt; 1ms   </para>
</entry><entry thead="no"><para>Per object   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4319">
<title>Timeout Configuration</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Timeout   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>JWT Token   </para>
</entry><entry thead="no"><para>30 minutes   </para>
</entry><entry thead="no"><para>Session expiration    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limit Window   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Request counting period    </para>
</entry></row>
<row>
<entry thead="no"><para>HTTP Client   </para>
</entry><entry thead="no"><para>30 seconds   </para>
</entry><entry thead="no"><para>API request timeout    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Check   </para>
</entry><entry thead="no"><para>30 seconds   </para>
</entry><entry thead="no"><para>Container probe interval   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4320">
<title>6.5.3.2 Rate Limiting Observability</title><para>Rate limiting provides visibility into API usage patterns and abuse prevention.</para>
<para><bold>Location</bold>: <computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput> (lines 156-169)</para>
<para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Limit   </para>
</entry><entry thead="yes"><para>Window   </para>
</entry><entry thead="yes"><para>Key Function    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>POST /token</computeroutput>   </para>
</entry><entry thead="no"><para>5 requests   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Client IP    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GET /api/users/me</computeroutput>   </para>
</entry><entry thead="no"><para>10 requests   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Client IP    </para>
</entry></row>
<row>
<entry thead="no"><para>Other endpoints   </para>
</entry><entry thead="no"><para>Unlimited   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4321">
<title>Rate Limit Response Indicators</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Indicator   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>HTTP Status   </para>
</entry><entry thead="no"><para>429   </para>
</entry><entry thead="no"><para>Too Many Requests    </para>
</entry></row>
<row>
<entry thead="no"><para>Header   </para>
</entry><entry thead="no"><para><computeroutput>Retry-After: &lt;seconds&gt;</computeroutput>   </para>
</entry><entry thead="no"><para>Client retry guidance    </para>
</entry></row>
<row>
<entry thead="no"><para>Body   </para>
</entry><entry thead="no"><para>Error detail message   </para>
</entry><entry thead="no"><para>Limit information   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4322">
<title>6.5.3.3 Error Tracking Patterns</title></sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4323">
<title>API Error Categories</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Status Code   </para>
</entry><entry thead="yes"><para>Scenario   </para>
</entry><entry thead="yes"><para>Monitoring Impact    </para>
</entry></row>
<row>
<entry thead="no"><para>400   </para>
</entry><entry thead="no"><para>Bad Request   </para>
</entry><entry thead="no"><para>User input validation    </para>
</entry></row>
<row>
<entry thead="no"><para>401   </para>
</entry><entry thead="no"><para>Unauthorized   </para>
</entry><entry thead="no"><para>Authentication failures    </para>
</entry></row>
<row>
<entry thead="no"><para>404   </para>
</entry><entry thead="no"><para>Not Found   </para>
</entry><entry thead="no"><para>Missing resource requests    </para>
</entry></row>
<row>
<entry thead="no"><para>422   </para>
</entry><entry thead="no"><para>Validation Error   </para>
</entry><entry thead="no"><para>Schema validation failures    </para>
</entry></row>
<row>
<entry thead="no"><para>429   </para>
</entry><entry thead="no"><para>Too Many Requests   </para>
</entry><entry thead="no"><para>Rate limiting activation    </para>
</entry></row>
<row>
<entry thead="no"><para>500   </para>
</entry><entry thead="no"><para>Internal Error   </para>
</entry><entry thead="no"><para>Application exceptions   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4324">
<title>Error Handling Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ErrorObservability[Error<sp/>Observability<sp/>Flow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorOccurs([Error&lt;br/&gt;Detected])<sp/>--&gt;<sp/>ErrorType{Error&lt;br/&gt;Category}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorType<sp/>--&gt;|HTTPException|<sp/>HTTPLog[Log<sp/>HTTP&lt;br/&gt;Error<sp/>Details]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorType<sp/>--&gt;|Rate<sp/>Limit|<sp/>RateLog[Log<sp/>Rate&lt;br/&gt;Limit<sp/>Hit]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorType<sp/>--&gt;|Validation|<sp/>ValLog[Log<sp/>Validation&lt;br/&gt;Error]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorType<sp/>--&gt;|Unexpected|<sp/>UnexpLog[Logger.exception&lt;br/&gt;Full<sp/>Stack<sp/>Trace]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HTTPLog<sp/>--&gt;<sp/>ReturnStatus[Return<sp/>HTTP&lt;br/&gt;Status<sp/>Code]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RateLog<sp/>--&gt;<sp/>Return429[Return<sp/>429&lt;br/&gt;+<sp/>Retry-After]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ValLog<sp/>--&gt;<sp/>Return422[Return<sp/>422&lt;br/&gt;+<sp/>Field<sp/>Details]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UnexpLog<sp/>--&gt;<sp/>Return500[Return<sp/>500&lt;br/&gt;Generic<sp/>Error]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReturnStatus<sp/>--&gt;<sp/>ClientResponse([Client&lt;br/&gt;Response])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return429<sp/>--&gt;<sp/>ClientResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return422<sp/>--&gt;<sp/>ClientResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return500<sp/>--&gt;<sp/>ClientResponse</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4325">
<title>6.5.3.4 Frontend Error Recovery Patterns</title><para><bold>Location</bold>: <computeroutput>frontend/app/page.tsx</computeroutput> (lines 109-119)</para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Error Category   </para>
</entry><entry thead="yes"><para>User Feedback   </para>
</entry><entry thead="yes"><para>Recovery Option    </para>
</entry></row>
<row>
<entry thead="no"><para>Network Error   </para>
</entry><entry thead="no"><para>&quot;Unable to connect&quot;   </para>
</entry><entry thead="no"><para>Retry button    </para>
</entry></row>
<row>
<entry thead="no"><para>API Error   </para>
</entry><entry thead="no"><para>Error message display   </para>
</entry><entry thead="no"><para>Retry button    </para>
</entry></row>
<row>
<entry thead="no"><para>Render Error   </para>
</entry><entry thead="no"><para>Display error state   </para>
</entry><entry thead="no"><para>Refresh page   </para>
</entry></row>
</table>
</para>
<para>Client-side errors are logged via <lsquo/>console.error(&apos;Error loading data:<rsquo/>, err)` for browser developer tools visibility.</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4327">
<title>6.5.4 CI/CD Monitoring and Quality Gates</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4328">
<title>6.5.4.1 Test Coverage Monitoring</title><para>The system implements comprehensive test coverage monitoring through multiple platforms.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4329">
<title>Codecov Integration</title><para><bold>Location</bold>: <computeroutput>.github/workflows/codecov.yaml</computeroutput></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Coverage Format   </para>
</entry><entry thead="no"><para>XML/HTML   </para>
</entry><entry thead="no"><para>Report generation    </para>
</entry></row>
<row>
<entry thead="no"><para>Test Results   </para>
</entry><entry thead="no"><para>JUnit XML   </para>
</entry><entry thead="no"><para>Test outcome tracking    </para>
</entry></row>
<row>
<entry thead="no"><para>Upload Action   </para>
</entry><entry thead="no"><para><computeroutput>codecov/codecov-action</computeroutput>   </para>
</entry><entry thead="no"><para>Results publication   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4330">
<title>CircleCI Coverage Pipeline</title><para><bold>Location</bold>: <computeroutput>.circleci/config.yml</computeroutput> (lines 68-75)</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Coverage Setting   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Source Directories   </para>
</entry><entry thead="no"><para><computeroutput>src</computeroutput>, <computeroutput>tests</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Report Formats   </para>
</entry><entry thead="no"><para>XML, HTML    </para>
</entry></row>
<row>
<entry thead="no"><para>Upload Target   </para>
</entry><entry thead="no"><para>Codecov    </para>
</entry></row>
<row>
<entry thead="no"><para>Artifact Storage   </para>
</entry><entry thead="no"><para>Coverage reports   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4331">
<title>Coverage Configuration</title><para><bold>Location</bold>: <computeroutput>pyproject.toml</computeroutput> (lines 65-83)</para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Source   </para>
</entry><entry thead="no"><para><computeroutput>[&quot;src&quot;]</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Omit Patterns   </para>
</entry><entry thead="no"><para><computeroutput>*/tests/*</computeroutput>, <computeroutput>*/__pycache__/*</computeroutput>, <computeroutput>*/site-packages/*</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Exclude Lines   </para>
</entry><entry thead="no"><para><computeroutput>pragma: no cover</computeroutput>, abstract methods, type checking   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4332">
<title>6.5.4.2 Security Scanning Pipeline</title><para>The repository implements comprehensive security scanning through both CircleCI and GitHub Actions.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4333">
<title>GitHub Actions Security Workflows</title><para><table rows="11" cols="4"><row>
<entry thead="yes"><para>Workflow   </para>
</entry><entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Trigger   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>bandit.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Bandit   </para>
</entry><entry thead="no"><para>Push/PR   </para>
</entry><entry thead="no"><para>Python SAST    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>codeql.yml</computeroutput>   </para>
</entry><entry thead="no"><para>CodeQL   </para>
</entry><entry thead="no"><para>Push/PR/Schedule   </para>
</entry><entry thead="no"><para>Multi-language SAST    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>semgrep.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Semgrep   </para>
</entry><entry thead="no"><para>Push/PR   </para>
</entry><entry thead="no"><para>Pattern-based detection    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>trivy.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Trivy   </para>
</entry><entry thead="no"><para>Push/Schedule   </para>
</entry><entry thead="no"><para>Container scanning    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>hadolint.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Hadolint   </para>
</entry><entry thead="no"><para>Push/PR   </para>
</entry><entry thead="no"><para>Dockerfile analysis    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>snyk-security.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Snyk   </para>
</entry><entry thead="no"><para>Push/PR   </para>
</entry><entry thead="no"><para>Dependency scanning    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>snyk-container.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Snyk   </para>
</entry><entry thead="no"><para>Push/PR   </para>
</entry><entry thead="no"><para>Container vulnerabilities    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>dependency-review.yml</computeroutput>   </para>
</entry><entry thead="no"><para>GitHub   </para>
</entry><entry thead="no"><para>PR   </para>
</entry><entry thead="no"><para>Dependency review    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>scorecard.yml</computeroutput>   </para>
</entry><entry thead="no"><para>OSSF Scorecard   </para>
</entry><entry thead="no"><para>Push/Schedule   </para>
</entry><entry thead="no"><para>Supply chain security    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>devskim.yml</computeroutput>   </para>
</entry><entry thead="no"><para>DevSkim   </para>
</entry><entry thead="no"><para>Push/PR   </para>
</entry><entry thead="no"><para>Security linting   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4334">
<title>CircleCI Security Pipeline</title><para><bold>Location</bold>: <computeroutput>.circleci/config.yml</computeroutput> (lines 77-100)</para>
<para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Stage    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>safety check</computeroutput>   </para>
</entry><entry thead="no"><para>Python dependency vulnerabilities   </para>
</entry><entry thead="no"><para>Build    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>bandit</computeroutput>   </para>
</entry><entry thead="no"><para>Python SAST analysis   </para>
</entry><entry thead="no"><para>Build   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4335">
<title>Nightly Security Scan</title><para><bold>Location</bold>: <computeroutput>.circleci/config.yml</computeroutput> (lines 206-216)</para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Schedule   </para>
</entry><entry thead="no"><para><computeroutput>0 2 * * *</computeroutput> (2:00 AM UTC daily)    </para>
</entry></row>
<row>
<entry thead="no"><para>Branch   </para>
</entry><entry thead="no"><para><computeroutput>main</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Jobs   </para>
</entry><entry thead="no"><para><computeroutput>python-security</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4336">
<title>Security Scan Dashboard</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>SecurityScanPipeline[Security<sp/>Scan<sp/>Pipeline]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>GitHubSecurity[GitHub<sp/>Actions<sp/>Security]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CodeQL[CodeQL&lt;br/&gt;SAST]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Bandit[Bandit&lt;br/&gt;Python<sp/>SAST]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Semgrep[Semgrep&lt;br/&gt;Pattern<sp/>Detection]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trivy[Trivy&lt;br/&gt;Container<sp/>Scan]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Snyk[Snyk&lt;br/&gt;Dependency<sp/>Scan]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>CircleCISecurity[CircleCI<sp/>Security]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Safety[Safety&lt;br/&gt;Dependency<sp/>Check]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BanditCI[Bandit&lt;br/&gt;SAST]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Results[Security<sp/>Results]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SARIF[SARIF<sp/>Upload&lt;br/&gt;GitHub<sp/>Security<sp/>Tab]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Artifacts[Scan&lt;br/&gt;Artifacts]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Schedule[Scheduled<sp/>Scans]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Nightly[Nightly<sp/>Security&lt;br/&gt;2:00<sp/>AM<sp/>UTC]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Weekly[Weekly<sp/>Trivy&lt;br/&gt;Saturday<sp/>14:30<sp/>UTC]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CodeQL<sp/>--&gt;<sp/>SARIF</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Bandit<sp/>--&gt;<sp/>SARIF</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Semgrep<sp/>--&gt;<sp/>SARIF</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Trivy<sp/>--&gt;<sp/>SARIF</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Snyk<sp/>--&gt;<sp/>SARIF</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Safety<sp/>--&gt;<sp/>Artifacts</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>BanditCI<sp/>--&gt;<sp/>Artifacts</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Nightly<sp/>--&gt;<sp/>CircleCISecurity</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Weekly<sp/>--&gt;<sp/>Trivy</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4338">
<title>6.5.5 Incident Response</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4339">
<title>6.5.5.1 Error Detection and Classification</title></sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4340">
<title>Graph Initialization Error Handling</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Error Source   </para>
</entry><entry thead="yes"><para>Detection Method   </para>
</entry><entry thead="yes"><para>Recovery Action   </para>
</entry><entry thead="yes"><para>Fallback    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache load failed   </para>
</entry><entry thead="no"><para>JSON parse error   </para>
</entry><entry thead="no"><para>Proceed to fresh fetch   </para>
</entry><entry thead="no"><para>Standard initialization    </para>
</entry></row>
<row>
<entry thead="no"><para>Network disabled   </para>
</entry><entry thead="no"><para>Connection timeout   </para>
</entry><entry thead="no"><para>Use sample data   </para>
</entry><entry thead="no"><para>Offline mode    </para>
</entry></row>
<row>
<entry thead="no"><para>Yahoo Finance error   </para>
</entry><entry thead="no"><para>Request exception   </para>
</entry><entry thead="no"><para>Check partial data   </para>
</entry><entry thead="no"><para>Sample data fallback    </para>
</entry></row>
<row>
<entry thead="no"><para>Critical failure   </para>
</entry><entry thead="no"><para>Unrecoverable exception   </para>
</entry><entry thead="no"><para>Abort startup   </para>
</entry><entry thead="no"><para>Application exit   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4341">
<title>Graph Initialization Recovery Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>InitRecovery[Graph<sp/>Initialization<sp/>Recovery]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>StartInit([Initialize&lt;br/&gt;Graph])<sp/>--&gt;<sp/>TryCache{Load<sp/>from&lt;br/&gt;Cache?}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryCache<sp/>--&gt;|Success|<sp/>CacheLoaded[Use<sp/>Cached&lt;br/&gt;Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryCache<sp/>--&gt;|JSON<sp/>Error|<sp/>LogCacheErr[Log<sp/>Cache&lt;br/&gt;Error]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LogCacheErr<sp/>--&gt;<sp/>TryNetwork{Network&lt;br/&gt;Available?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryNetwork<sp/>--&gt;|Yes|<sp/>TryYahoo{Fetch<sp/>Yahoo&lt;br/&gt;Finance?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryNetwork<sp/>--&gt;|No|<sp/>UseSample1[Use<sp/>Sample&lt;br/&gt;Data]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryYahoo<sp/>--&gt;|Success|<sp/>UseRealData[Use<sp/>Real&lt;br/&gt;Market<sp/>Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryYahoo<sp/>--&gt;|Partial|<sp/>UsePartial[Use<sp/>Partial&lt;br/&gt;Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TryYahoo<sp/>--&gt;|Failure|<sp/>UseSample2[Use<sp/>Sample&lt;br/&gt;Data]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CacheLoaded<sp/>--&gt;<sp/>GraphReady([Graph&lt;br/&gt;Initialized])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UseRealData<sp/>--&gt;<sp/>SaveCache[Save<sp/>to&lt;br/&gt;Cache]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UsePartial<sp/>--&gt;<sp/>SaveCache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SaveCache<sp/>--&gt;<sp/>GraphReady</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UseSample1<sp/>--&gt;<sp/>GraphReady</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UseSample2<sp/>--&gt;<sp/>GraphReady</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4342">
<title>6.5.5.2 Alert Routing Architecture</title><para>The current system relies on CI/CD platform notifications for alerting:</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4343">
<title>CI/CD Alert Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>AlertRouting[Alert<sp/>Routing<sp/>Flow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Triggers[Alert<sp/>Triggers]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TestFail[Test&lt;br/&gt;Failure]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SecurityFail[Security&lt;br/&gt;Scan<sp/>Alert]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BuildFail[Build&lt;br/&gt;Failure]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CoverageDrop[Coverage&lt;br/&gt;Drop]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Platforms[CI/CD<sp/>Platforms]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GitHub[GitHub&lt;br/&gt;Actions]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CircleCI[CircleCI]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Notifications[Notification<sp/>Channels]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GitHubUI[GitHub&lt;br/&gt;UI<sp/>Alerts]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Email[Email&lt;br/&gt;Notifications]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SecurityTab[GitHub<sp/>Security&lt;br/&gt;Tab]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TestFail<sp/>--&gt;<sp/>GitHub</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TestFail<sp/>--&gt;<sp/>CircleCI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SecurityFail<sp/>--&gt;<sp/>GitHub</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BuildFail<sp/>--&gt;<sp/>GitHub</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BuildFail<sp/>--&gt;<sp/>CircleCI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CoverageDrop<sp/>--&gt;<sp/>GitHub</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GitHub<sp/>--&gt;<sp/>GitHubUI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GitHub<sp/>--&gt;<sp/>Email</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GitHub<sp/>--&gt;<sp/>SecurityTab</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CircleCI<sp/>--&gt;<sp/>Email</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4344">
<title>6.5.5.3 Escalation Procedures</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Severity   </para>
</entry><entry thead="yes"><para>Detection   </para>
</entry><entry thead="yes"><para>Initial Response   </para>
</entry><entry thead="yes"><para>Escalation    </para>
</entry></row>
<row>
<entry thead="no"><para>Critical   </para>
</entry><entry thead="no"><para>Application crash   </para>
</entry><entry thead="no"><para>Restart container   </para>
</entry><entry thead="no"><para>Review logs, investigate root cause    </para>
</entry></row>
<row>
<entry thead="no"><para>High   </para>
</entry><entry thead="no"><para>Security scan failure   </para>
</entry><entry thead="no"><para>Review findings   </para>
</entry><entry thead="no"><para>Patch dependencies, update codebase    </para>
</entry></row>
<row>
<entry thead="no"><para>Medium   </para>
</entry><entry thead="no"><para>Test failure   </para>
</entry><entry thead="no"><para>Review failing tests   </para>
</entry><entry thead="no"><para>Fix code, update tests    </para>
</entry></row>
<row>
<entry thead="no"><para>Low   </para>
</entry><entry thead="no"><para>Coverage drop   </para>
</entry><entry thead="no"><para>Review changes   </para>
</entry><entry thead="no"><para>Improve test coverage   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4345">
<title>6.5.5.4 Recovery Scenarios</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Scenario   </para>
</entry><entry thead="yes"><para>Detection   </para>
</entry><entry thead="yes"><para>Recovery Action    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph corruption   </para>
</entry><entry thead="no"><para>Validation failure   </para>
</entry><entry thead="no"><para>Clear cache, reinitialize    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache file corruption   </para>
</entry><entry thead="no"><para>JSON parse error   </para>
</entry><entry thead="no"><para>Delete cache, fresh fetch    </para>
</entry></row>
<row>
<entry thead="no"><para>Database unavailable   </para>
</entry><entry thead="no"><para>Connection timeout   </para>
</entry><entry thead="no"><para>Retry with exponential backoff    </para>
</entry></row>
<row>
<entry thead="no"><para>Yahoo Finance outage   </para>
</entry><entry thead="no"><para>Request timeout   </para>
</entry><entry thead="no"><para>Fall back to sample data    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication failure   </para>
</entry><entry thead="no"><para>JWT decode error   </para>
</entry><entry thead="no"><para>Re-authenticate user   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4347">
<title>6.5.6 Dashboard Design</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4348">
<title>6.5.6.1 Metrics Dashboard Layout</title><para>The system provides operational metrics through the <computeroutput>/api/metrics</computeroutput> endpoint. A recommended dashboard layout for visualization:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>MetricsDashboard[Metrics<sp/>Dashboard<sp/>Layout]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>TopRow[Overview<sp/>Metrics]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TotalAssets[Total<sp/>Assets&lt;br/&gt;Counter]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TotalRelationships[Total<sp/>Relationships&lt;br/&gt;Counter]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NetworkDensity[Network<sp/>Density&lt;br/&gt;Gauge]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>MiddleRow[Network<sp/>Analysis]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AvgDegree[Average<sp/>Degree&lt;br/&gt;Gauge]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MaxDegree[Maximum<sp/>Degree&lt;br/&gt;Gauge]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RelDensity[Relationship&lt;br/&gt;Density]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>BottomRow[Asset<sp/>Distribution]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AssetClasses[Asset<sp/>Classes&lt;br/&gt;Breakdown<sp/>Chart]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4349">
<title>6.5.6.2 Alert Threshold Matrix</title><para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Metric   </para>
</entry><entry thead="yes"><para>Warning Threshold   </para>
</entry><entry thead="yes"><para>Critical Threshold   </para>
</entry><entry thead="yes"><para>Action    </para>
</entry></row>
<row>
<entry thead="no"><para>API Response Time (p95)   </para>
</entry><entry thead="no"><para>&gt; 400ms   </para>
</entry><entry thead="no"><para>&gt; 500ms   </para>
</entry><entry thead="no"><para>Investigate slow endpoints    </para>
</entry></row>
<row>
<entry thead="no"><para>Error Rate   </para>
</entry><entry thead="no"><para>&gt; 1%   </para>
</entry><entry thead="no"><para>&gt; 5%   </para>
</entry><entry thead="no"><para>Review error logs    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Check Failures   </para>
</entry><entry thead="no"><para>1 retry   </para>
</entry><entry thead="no"><para>3 retries   </para>
</entry><entry thead="no"><para>Container restart    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Initialization   </para>
</entry><entry thead="no"><para>&gt; 2.5s   </para>
</entry><entry thead="no"><para>&gt; 3s   </para>
</entry><entry thead="no"><para>Optimize data loading    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Generation   </para>
</entry><entry thead="no"><para>&gt; 80ms   </para>
</entry><entry thead="no"><para>&gt; 100ms   </para>
</entry><entry thead="no"><para>Review auth performance   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4350">
<title>6.5.6.3 SLA Monitoring Dashboard Concept</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Panel   </para>
</entry><entry thead="yes"><para>Metric   </para>
</entry><entry thead="yes"><para>SLA Target   </para>
</entry><entry thead="yes"><para>Visualization    </para>
</entry></row>
<row>
<entry thead="no"><para>API Latency   </para>
</entry><entry thead="no"><para>Response time p95   </para>
</entry><entry thead="no"><para>&lt; 500ms   </para>
</entry><entry thead="no"><para>Time series graph    </para>
</entry></row>
<row>
<entry thead="no"><para>Availability   </para>
</entry><entry thead="no"><para>Health check status   </para>
</entry><entry thead="no"><para>&gt; 99.9%   </para>
</entry><entry thead="no"><para>Status indicator    </para>
</entry></row>
<row>
<entry thead="no"><para>Error Rate   </para>
</entry><entry thead="no"><para>5xx responses   </para>
</entry><entry thead="no"><para>&lt; 0.1%   </para>
</entry><entry thead="no"><para>Percentage gauge    </para>
</entry></row>
<row>
<entry thead="no"><para>Throughput   </para>
</entry><entry thead="no"><para>Requests per second   </para>
</entry><entry thead="no"><para>Variable   </para>
</entry><entry thead="no"><para>Counter display   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4352">
<title>6.5.7 Future Monitoring Recommendations</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4353">
<title>6.5.7.1 Recommended Observability Stack</title><para>Based on industry best practices for FastAPI applications, the following enhancements are recommended for production deployments with increased scale requirements:</para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Recommended Tool   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Metrics Collection   </para>
</entry><entry thead="no"><para>Prometheus + prometheus-fastapi-instrumentator   </para>
</entry><entry thead="no"><para>RED metrics (Rate, Error, Duration)    </para>
</entry></row>
<row>
<entry thead="no"><para>Distributed Tracing   </para>
</entry><entry thead="no"><para>OpenTelemetry   </para>
</entry><entry thead="no"><para>Request flow visualization    </para>
</entry></row>
<row>
<entry thead="no"><para>Log Aggregation   </para>
</entry><entry thead="no"><para>Loki or ELK Stack   </para>
</entry><entry thead="no"><para>Centralized log management    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization   </para>
</entry><entry thead="no"><para>Grafana   </para>
</entry><entry thead="no"><para>Unified dashboard    </para>
</entry></row>
<row>
<entry thead="no"><para>Error Tracking   </para>
</entry><entry thead="no"><para>Sentry   </para>
</entry><entry thead="no"><para>Exception monitoring    </para>
</entry></row>
<row>
<entry thead="no"><para>Alerting   </para>
</entry><entry thead="no"><para>Prometheus Alertmanager   </para>
</entry><entry thead="no"><para>Automated notifications   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4354">
<title>6.5.7.2 OpenTelemetry Integration Path</title><para>For future scalability, OpenTelemetry provides a vendor-neutral approach to observability:</para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Integration Point   </para>
</entry><entry thead="yes"><para>Library   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Auto-instrumentation   </para>
</entry><entry thead="no"><para><computeroutput>opentelemetry-instrumentation-fastapi</computeroutput>   </para>
</entry><entry thead="no"><para>Automatic request tracing    </para>
</entry></row>
<row>
<entry thead="no"><para>Metrics Export   </para>
</entry><entry thead="no"><para><computeroutput>opentelemetry-exporter-prometheus</computeroutput>   </para>
</entry><entry thead="no"><para>Prometheus-compatible metrics    </para>
</entry></row>
<row>
<entry thead="no"><para>Trace Export   </para>
</entry><entry thead="no"><para><computeroutput>opentelemetry-exporter-otlp</computeroutput>   </para>
</entry><entry thead="no"><para>Trace data export   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4355">
<title>6.5.7.3 Structured Logging Enhancement</title><para>Recommended logging format upgrade for improved observability:</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Enhancement   </para>
</entry><entry thead="yes"><para>Current   </para>
</entry><entry thead="yes"><para>Recommended    </para>
</entry></row>
<row>
<entry thead="no"><para>Format   </para>
</entry><entry thead="no"><para>Plain text   </para>
</entry><entry thead="no"><para>JSON structured    </para>
</entry></row>
<row>
<entry thead="no"><para>Request ID   </para>
</entry><entry thead="no"><para>Not implemented   </para>
</entry><entry thead="no"><para>UUID per request    </para>
</entry></row>
<row>
<entry thead="no"><para>Correlation   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>Trace ID integration    </para>
</entry></row>
<row>
<entry thead="no"><para>Context   </para>
</entry><entry thead="no"><para>Basic   </para>
</entry><entry thead="no"><para>User, endpoint, duration   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4356">
<title>6.5.7.4 Monitoring Prerequisites for Microservices Migration</title><para>As documented in the Core Services Architecture (Section 6.1), the following monitoring capabilities would be required before migrating to a microservices architecture:</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Prerequisite   </para>
</entry><entry thead="yes"><para>Current State   </para>
</entry><entry thead="yes"><para>Required for Migration    </para>
</entry></row>
<row>
<entry thead="no"><para>Database Persistence   </para>
</entry><entry thead="no"><para>Optional   </para>
</entry><entry thead="no"><para>Required for shared state    </para>
</entry></row>
<row>
<entry thead="no"><para>Message Queue   </para>
</entry><entry thead="no"><para>Not implemented   </para>
</entry><entry thead="no"><para>Required for async communication    </para>
</entry></row>
<row>
<entry thead="no"><para>Service Mesh   </para>
</entry><entry thead="no"><para>Not applicable   </para>
</entry><entry thead="no"><para>Required for service discovery    </para>
</entry></row>
<row>
<entry thead="no"><para>Distributed Tracing   </para>
</entry><entry thead="no"><para>Not implemented   </para>
</entry><entry thead="no"><para>Required for observability   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4358">
<title>6.5.8 Security Event Monitoring</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4359">
<title>6.5.8.1 Security Event Categories</title><para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Event Category   </para>
</entry><entry thead="yes"><para>Log Level   </para>
</entry><entry thead="yes"><para>Content   </para>
</entry><entry thead="yes"><para>Monitoring Action    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication failures   </para>
</entry><entry thead="no"><para>WARNING   </para>
</entry><entry thead="no"><para>Failed login attempts   </para>
</entry><entry thead="no"><para>Track frequency, detect brute force    </para>
</entry></row>
<row>
<entry thead="no"><para>Invalid CORS origins   </para>
</entry><entry thead="no"><para>WARNING   </para>
</entry><entry thead="no"><para>Skipped origin value   </para>
</entry><entry thead="no"><para>Review CORS configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate limit exceeded   </para>
</entry><entry thead="no"><para>INFO (429 response)   </para>
</entry><entry thead="no"><para>Client IP, endpoint   </para>
</entry><entry thead="no"><para>Identify abuse patterns    </para>
</entry></row>
<row>
<entry thead="no"><para>Request errors   </para>
</entry><entry thead="no"><para>ERROR   </para>
</entry><entry thead="no"><para>Exception details   </para>
</entry><entry thead="no"><para>Investigate root cause    </para>
</entry></row>
<row>
<entry thead="no"><para>Token expiration   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Session timeout   </para>
</entry><entry thead="no"><para>Normal operation tracking   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4360">
<title>6.5.8.2 CI/CD Security Event Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>SecurityEventFlow[Security<sp/>Event<sp/>Monitoring<sp/>Flow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Sources[Event<sp/>Sources]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CodePush[Code&lt;br/&gt;Push]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PRCreated[Pull<sp/>Request&lt;br/&gt;Created]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Schedule[Scheduled&lt;br/&gt;Trigger]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Scans[Security<sp/>Scans]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SAST[SAST&lt;br/&gt;Analysis]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DependencyScan[Dependency&lt;br/&gt;Scan]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ContainerScan[Container&lt;br/&gt;Scan]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Analysis[Results<sp/>Analysis]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FindingsReview[Findings&lt;br/&gt;Review]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeverityClass[Severity&lt;br/&gt;Classification]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Actions[Response<sp/>Actions]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BlockMerge[Block<sp/>PR&lt;br/&gt;Merge]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CreateIssue[Create&lt;br/&gt;Issue]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AlertTeam[Alert&lt;br/&gt;Team]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CodePush<sp/>--&gt;<sp/>SAST</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CodePush<sp/>--&gt;<sp/>DependencyScan</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PRCreated<sp/>--&gt;<sp/>ContainerScan</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Schedule<sp/>--&gt;<sp/>SAST</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Schedule<sp/>--&gt;<sp/>DependencyScan</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Schedule<sp/>--&gt;<sp/>ContainerScan</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SAST<sp/>--&gt;<sp/>FindingsReview</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DependencyScan<sp/>--&gt;<sp/>FindingsReview</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ContainerScan<sp/>--&gt;<sp/>FindingsReview</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FindingsReview<sp/>--&gt;<sp/>SeverityClass</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SeverityClass<sp/>--&gt;|Critical/High|<sp/>BlockMerge</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SeverityClass<sp/>--&gt;|Critical/High|<sp/>AlertTeam</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SeverityClass<sp/>--&gt;|Medium/Low|<sp/>CreateIssue</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4362">
<title>6.5.9 Container and Deployment Monitoring</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4363">
<title>6.5.9.1 Docker Container Monitoring</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Monitoring Aspect   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Probes   </para>
</entry><entry thead="no"><para>HTTP GET <computeroutput>/</computeroutput>   </para>
</entry><entry thead="no"><para>Every 30 seconds    </para>
</entry></row>
<row>
<entry thead="no"><para>Restart Policy   </para>
</entry><entry thead="no"><para><computeroutput>unless-stopped</computeroutput>   </para>
</entry><entry thead="no"><para>Automatic recovery    </para>
</entry></row>
<row>
<entry thead="no"><para>Volume Mounts   </para>
</entry><entry thead="no"><para><computeroutput>./src:/app/src</computeroutput>, <computeroutput>./data:/app/data</computeroutput>   </para>
</entry><entry thead="no"><para>Persistent storage    </para>
</entry></row>
<row>
<entry thead="no"><para>Port Exposure   </para>
</entry><entry thead="no"><para>7860   </para>
</entry><entry thead="no"><para>External access   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4364">
<title>6.5.9.2 Container Security Monitoring</title><para><bold>Trivy Vulnerability Scanner</bold> (<computeroutput>.github/workflows/trivy.yml</computeroutput>)</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Trigger   </para>
</entry><entry thead="no"><para>Dockerfile/docker-compose changes    </para>
</entry></row>
<row>
<entry thead="no"><para>Schedule   </para>
</entry><entry thead="no"><para>Weekly (Saturday 14:30 UTC)    </para>
</entry></row>
<row>
<entry thead="no"><para>Severity Filter   </para>
</entry><entry thead="no"><para>CRITICAL, HIGH    </para>
</entry></row>
<row>
<entry thead="no"><para>Results   </para>
</entry><entry thead="no"><para>SARIF upload to GitHub Security   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4365">
<title>6.5.9.3 Deployment Environment Comparison</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Environment   </para>
</entry><entry thead="yes"><para>Monitoring Approach   </para>
</entry><entry thead="yes"><para>Health Check    </para>
</entry></row>
<row>
<entry thead="no"><para>Local Development   </para>
</entry><entry thead="no"><para>Console logging   </para>
</entry><entry thead="no"><para>Manual testing    </para>
</entry></row>
<row>
<entry thead="no"><para>Docker   </para>
</entry><entry thead="no"><para>Docker HEALTHCHECK   </para>
</entry><entry thead="no"><para>HTTP probe    </para>
</entry></row>
<row>
<entry thead="no"><para>Vercel Serverless   </para>
</entry><entry thead="no"><para>Platform monitoring   </para>
</entry><entry thead="no"><para>Edge health checks   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4367">
<title>6.5.10 References</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4368">
<title>6.5.10.1 Source Files Examined</title><para><table rows="11" cols="2"><row>
<entry thead="yes"><para>Path   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Health check endpoint, metrics endpoint, logging, rate limiting, error handling    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Authentication logging, security event handling    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2database_8py" kindref="compound">api/database.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Database connection logging    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Gradio application logging configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Data fetch logging, cache operations    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/page.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend error handling, retry pattern    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/lib/api.ts</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend health check API client    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Dockerfile</computeroutput>   </para>
</entry><entry thead="no"><para>Docker health check configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>docker-compose.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Container orchestration health checks    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>pyproject.toml</computeroutput>   </para>
</entry><entry thead="no"><para>Test coverage configuration   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4369">
<title>6.5.10.2 CI/CD Configuration Files</title><para><table rows="10" cols="2"><row>
<entry thead="yes"><para>Path   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.circleci/config.yml</computeroutput>   </para>
</entry><entry thead="no"><para>CircleCI monitoring, coverage, security scanning    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/ci.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Main CI workflow with coverage    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/codecov.yaml</computeroutput>   </para>
</entry><entry thead="no"><para>Coverage upload workflow    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/trivy.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Container security scanning    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/bandit.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Python SAST workflow    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/codeql.yml</computeroutput>   </para>
</entry><entry thead="no"><para>CodeQL analysis workflow    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/semgrep.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Semgrep pattern analysis    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/snyk-security.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Snyk dependency scanning    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/scorecard.yml</computeroutput>   </para>
</entry><entry thead="no"><para>OSSF supply chain security   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4370">
<title>6.5.10.3 Technical Specification Cross-References</title><para><table rows="7" cols="2"><row>
<entry thead="yes"><para>Section   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para>5.4 CROSS-CUTTING CONCERNS   </para>
</entry><entry thead="no"><para>Monitoring, observability, error handling patterns    </para>
</entry></row>
<row>
<entry thead="no"><para>6.4 Security Architecture   </para>
</entry><entry thead="no"><para>Security event logging, audit requirements    </para>
</entry></row>
<row>
<entry thead="no"><para>5.5 DEPLOYMENT ARCHITECTURE   </para>
</entry><entry thead="no"><para>Container and serverless deployment monitoring    </para>
</entry></row>
<row>
<entry thead="no"><para>4.5 Error Handling Workflows   </para>
</entry><entry thead="no"><para>Error detection and recovery flows    </para>
</entry></row>
<row>
<entry thead="no"><para>4.8 Timing and SLA Considerations   </para>
</entry><entry thead="no"><para>Performance targets and timeout configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>6.1 Core Services Architecture   </para>
</entry><entry thead="no"><para>Monolithic architecture implications for monitoring   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4371">
<title>6.5.10.4 External References</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Resource   </para>
</entry><entry thead="yes"><para>Context    </para>
</entry></row>
<row>
<entry thead="no"><para>FastAPI Observability Best Practices   </para>
</entry><entry thead="no"><para>Industry recommendations for monitoring    </para>
</entry></row>
<row>
<entry thead="no"><para>OpenTelemetry Documentation   </para>
</entry><entry thead="no"><para>Distributed tracing standards    </para>
</entry></row>
<row>
<entry thead="no"><para>Prometheus FastAPI Instrumentator   </para>
</entry><entry thead="no"><para>Metrics collection library    </para>
</entry></row>
<row>
<entry thead="no"><para>Grafana FastAPI Dashboard   </para>
</entry><entry thead="no"><para>Dashboard design patterns   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4372">
<title>6.6 Testing Strategy</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4373">
<title>6.6.1 Testing Strategy Overview</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4374">
<title>6.6.1.1 Executive Summary</title><para>The Financial Asset Relationship Database implements a comprehensive multi-tier testing strategy designed to ensure reliability, maintainability, and quality across both backend (Python/FastAPI) and frontend (Next.js/TypeScript) components. The testing approach emphasizes automated validation at multiple levels—from unit tests validating individual functions to integration tests verifying cross-component interactions.</para>
<para>The testing architecture aligns with industry best practices for monolithic layered applications, leveraging pytest for Python backend testing, Jest with React Testing Library for frontend validation, and a robust CI/CD pipeline for automated quality gates.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4375">
<title>6.6.1.2 Testing Philosophy</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Principle   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Rationale    </para>
</entry></row>
<row>
<entry thead="no"><para>Test Isolation   </para>
</entry><entry thead="no"><para>Separate test databases, fixture reset   </para>
</entry><entry thead="no"><para>Prevent test interference    </para>
</entry></row>
<row>
<entry thead="no"><para>Behavior-Driven   </para>
</entry><entry thead="no"><para>Test user interactions, not implementation   </para>
</entry><entry thead="no"><para>Resilient to refactoring    </para>
</entry></row>
<row>
<entry thead="no"><para>Coverage-First   </para>
</entry><entry thead="no"><para>80%+ coverage targets   </para>
</entry><entry thead="no"><para>Catch regressions early    </para>
</entry></row>
<row>
<entry thead="no"><para>Fast Feedback   </para>
</entry><entry thead="no"><para>Parallel execution, CI integration   </para>
</entry><entry thead="no"><para>Developer productivity   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4376">
<title>6.6.1.3 Test Suite Statistics</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Test Cases   </para>
</entry><entry thead="yes"><para>Test Lines   </para>
</entry><entry thead="yes"><para>Coverage Target    </para>
</entry></row>
<row>
<entry thead="no"><para>Backend Python   </para>
</entry><entry thead="no"><para>60+   </para>
</entry><entry thead="no"><para>~1,042   </para>
</entry><entry thead="no"><para>&gt;80%    </para>
</entry></row>
<row>
<entry thead="no"><para>Frontend TypeScript   </para>
</entry><entry thead="no"><para>80+   </para>
</entry><entry thead="no"><para>~937   </para>
</entry><entry thead="no"><para>&gt;80%    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Total</bold>   </para>
</entry><entry thead="no"><para><bold>140+</bold>   </para>
</entry><entry thead="no"><para>**~2,000**   </para>
</entry><entry thead="no"><para><bold>&gt;80%</bold>   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4378">
<title>6.6.2 Unit Testing</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4379">
<title>6.6.2.1 Backend Unit Testing Framework</title><para>The Python backend utilizes pytest as the primary testing framework, providing powerful fixtures, parametrization, and extensibility.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4380">
<title>Testing Framework Stack</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>pytest   </para>
</entry><entry thead="no"><para>&gt;= 7.0.0   </para>
</entry><entry thead="no"><para>Test runner and framework    </para>
</entry></row>
<row>
<entry thead="no"><para>pytest-cov   </para>
</entry><entry thead="no"><para>&gt;= 4.0.0   </para>
</entry><entry thead="no"><para>Coverage reporting    </para>
</entry></row>
<row>
<entry thead="no"><para>httpx   </para>
</entry><entry thead="no"><para>&gt;= 0.24.0   </para>
</entry><entry thead="no"><para>Async HTTP client for TestClient    </para>
</entry></row>
<row>
<entry thead="no"><para>unittest.mock   </para>
</entry><entry thead="no"><para>stdlib   </para>
</entry><entry thead="no"><para>Mocking and patching   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4381">
<title>Test Organization Structure</title><para><programlisting><codeline><highlight class="normal">tests/</highlight></codeline>
<codeline><highlight class="normal">├──<sp/>__init__.py<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Test<sp/>environment<sp/>setup</highlight></codeline>
<codeline><highlight class="normal">├──<sp/>conftest.py<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Shared<sp/>fixtures</highlight></codeline>
<codeline><highlight class="normal">├──<sp/>unit/</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>test_api.py<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>FastAPI<sp/>endpoint<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>test_api_main.py<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Comprehensive<sp/>API<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>test_financial_models.py<sp/><sp/>#<sp/>Domain<sp/>model<sp/>validation</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>test_asset_graph.py<sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Graph<sp/>logic<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>test_repository.py<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Data<sp/>layer<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>test_database.py<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>SQLite/SQLAlchemy<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>test_database_memory.py<sp/><sp/><sp/>#<sp/>In-memory<sp/>database<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>test_graph_visuals.py<sp/><sp/><sp/><sp/><sp/>#<sp/>Plotly<sp/>visualization<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>test_metric_visuals.py<sp/><sp/><sp/><sp/>#<sp/>Metrics<sp/>visualization<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>└──<sp/>test_schema_report.py<sp/><sp/><sp/><sp/><sp/>#<sp/>Report<sp/>generation<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">└──<sp/>integration/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>├──<sp/>conftest.py<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Integration<sp/>fixtures</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>├──<sp/>test_api_integration.py<sp/><sp/><sp/>#<sp/>End-to-end<sp/>API<sp/>workflows</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>└──<sp/>test_repository.py<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Database<sp/>integration<sp/>tests</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4382">
<title>Pytest Configuration</title><para><bold>Location</bold>: <computeroutput>pyproject.toml</computeroutput></para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>testpaths</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>[&quot;tests&quot;]</computeroutput>   </para>
</entry><entry thead="no"><para>Test discovery root    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>python_files</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>[&quot;test_*.py&quot;, &quot;*_test.py&quot;]</computeroutput>   </para>
</entry><entry thead="no"><para>Test file patterns    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>python_classes</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>[&quot;Test*&quot;]</computeroutput>   </para>
</entry><entry thead="no"><para>Test class patterns    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>python_functions</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>[&quot;test_*&quot;]</computeroutput>   </para>
</entry><entry thead="no"><para>Test function patterns   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4383">
<title>Test Markers</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Marker   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Usage    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>@pytest.mark.unit</computeroutput>   </para>
</entry><entry thead="no"><para>Unit tests   </para>
</entry><entry thead="no"><para><computeroutput>pytest -m unit</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>@pytest.mark.integration</computeroutput>   </para>
</entry><entry thead="no"><para>Integration tests   </para>
</entry><entry thead="no"><para><computeroutput>pytest -m integration</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>@pytest.mark.slow</computeroutput>   </para>
</entry><entry thead="no"><para>Slow running tests   </para>
</entry><entry thead="no"><para><computeroutput>pytest -m &quot;not slow&quot;</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4384">
<title>6.6.2.2 Backend Mocking Strategy</title><para>The backend employs a multi-layered mocking approach to isolate components under test.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4385">
<title>Graph Instance Mocking</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Pattern   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Use Case    </para>
</entry></row>
<row>
<entry thead="no"><para>Factory Override   </para>
</entry><entry thead="no"><para><computeroutput>set_graph_factory()</computeroutput>   </para>
</entry><entry thead="no"><para>Test isolation for graph singleton    </para>
</entry></row>
<row>
<entry thead="no"><para>Fixture Reset   </para>
</entry><entry thead="no"><para><computeroutput>_reset_graph</computeroutput> fixture   </para>
</entry><entry thead="no"><para>Clean state between tests    </para>
</entry></row>
<row>
<entry thead="no"><para>Mock Patch   </para>
</entry><entry thead="no"><para><computeroutput>unittest.mock.patch</computeroutput>   </para>
</entry><entry thead="no"><para>API endpoint isolation   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4386">
<title>Test Fixture Patterns</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>FixtureHierarchy[Backend<sp/>Test<sp/>Fixture<sp/>Hierarchy]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>SessionScope[Session<sp/>Scope]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DBEngine[Database<sp/>Engine&lt;br/&gt;SQLite<sp/>in-memory]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>ModuleScope[Module<sp/>Scope]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphFactory[Graph<sp/>Factory&lt;br/&gt;Mock/Real<sp/>Toggle]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>FunctionScope[Function<sp/>Scope]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TestClient[FastAPI<sp/>TestClient]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MockGraph[Mock<sp/>Graph<sp/>Instance]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SampleAssets[Sample<sp/>Asset<sp/>Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DBSession[Database<sp/>Session&lt;br/&gt;With<sp/>Rollback]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DBEngine<sp/>--&gt;<sp/>DBSession</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphFactory<sp/>--&gt;<sp/>MockGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>MockGraph<sp/>--&gt;<sp/>TestClient</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SampleAssets<sp/>--&gt;<sp/>TestClient</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DBSession<sp/>--&gt;<sp/>TestClient</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4387">
<title>Shared Fixture Examples</title><para><bold>Location</bold>: <computeroutput><ref refid="tests_2conftest_8py" kindref="compound">tests/conftest.py</ref></computeroutput></para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Fixture   </para>
</entry><entry thead="yes"><para>Scope   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>mock_graph</computeroutput>   </para>
</entry><entry thead="no"><para>function   </para>
</entry><entry thead="no"><para>Isolated graph instance for testing    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>sample_equity</computeroutput>   </para>
</entry><entry thead="no"><para>function   </para>
</entry><entry thead="no"><para>Pre-configured equity asset    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>dividend_stock</computeroutput>   </para>
</entry><entry thead="no"><para>function   </para>
</entry><entry thead="no"><para>Asset with dividend data    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>_reset_graph</computeroutput>   </para>
</entry><entry thead="no"><para>function   </para>
</entry><entry thead="no"><para>Graph state cleanup   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4388">
<title>Conditional Test Execution</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Pattern   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Import Skip   </para>
</entry><entry thead="no"><para><computeroutput>pytest.importorskip(&quot;sqlalchemy&quot;)</computeroutput>   </para>
</entry><entry thead="no"><para>Skip if dependency missing    </para>
</entry></row>
<row>
<entry thead="no"><para>Environment Check   </para>
</entry><entry thead="no"><para><computeroutput>pytest.mark.skipif(...)</computeroutput>   </para>
</entry><entry thead="no"><para>Environment-specific tests    </para>
</entry></row>
<row>
<entry thead="no"><para>Parametrization   </para>
</entry><entry thead="no"><para><computeroutput>@pytest.mark.parametrize</computeroutput>   </para>
</entry><entry thead="no"><para>Multiple test scenarios   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4389">
<title>6.6.2.3 Frontend Unit Testing Framework</title><para>The Next.js frontend implements Jest with React Testing Library for comprehensive component and utility testing.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4390">
<title>Testing Framework Stack</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Jest   </para>
</entry><entry thead="no"><para>^29.7.0   </para>
</entry><entry thead="no"><para>Test runner and framework    </para>
</entry></row>
<row>
<entry thead="no"><para>@testing-library/react   </para>
</entry><entry thead="no"><para>^14.1.2   </para>
</entry><entry thead="no"><para>React component testing    </para>
</entry></row>
<row>
<entry thead="no"><para>@testing-library/jest-dom   </para>
</entry><entry thead="no"><para>^6.4.0   </para>
</entry><entry thead="no"><para>DOM assertions    </para>
</entry></row>
<row>
<entry thead="no"><para>jest-environment-jsdom   </para>
</entry><entry thead="no"><para>^29.7.0   </para>
</entry><entry thead="no"><para>DOM simulation   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4391">
<title>Frontend Test Organization</title><para><programlisting><codeline><highlight class="normal">frontend/</highlight></codeline>
<codeline><highlight class="normal">├──<sp/>__tests__/</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>test-utils.ts<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Centralized<sp/>mock<sp/>data</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>lib/</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>│<sp/><sp/><sp/>├──<sp/>api.test.ts<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>API<sp/>client<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>│<sp/><sp/><sp/>└──<sp/>api-axios-compatibility.test.ts</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>components/</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>│<sp/><sp/><sp/>├──<sp/>AssetList.test.tsx<sp/><sp/><sp/><sp/><sp/>#<sp/>Asset<sp/>list<sp/>component</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>│<sp/><sp/><sp/>├──<sp/>MetricsDashboard.test.tsx</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>│<sp/><sp/><sp/>└──<sp/>NetworkVisualization.test.tsx</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>└──<sp/>app/</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/><sp/><sp/><sp/><sp/>└──<sp/>page.test.tsx<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Page-level<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">├──<sp/>jest.config.js<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Jest<sp/>configuration</highlight></codeline>
<codeline><highlight class="normal">├──<sp/>jest.setup.js<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Environment<sp/>setup</highlight></codeline>
<codeline><highlight class="normal">└──<sp/>package.json<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Test<sp/>scripts</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4392">
<title>Jest Configuration</title><para><bold>Location</bold>: <computeroutput>frontend/jest.config.js</computeroutput></para>
<para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>testEnvironment</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>jest-environment-jsdom</computeroutput>   </para>
</entry><entry thead="no"><para>DOM simulation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>setupFilesAfterEnv</computeroutput>   </para>
</entry><entry thead="no"><para><lsquo/>[<rsquo/>./jest.setup.js&apos;]<computeroutput>\ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Test environment setup \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;markdownTableRowOdd&quot;&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt;</computeroutput>moduleNameMapper<computeroutput>\ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Path aliases \ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Module resolution \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;markdownTableRowEven&quot;&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt;</computeroutput>testMatch<computeroutput>\ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt;</computeroutput>[&apos;**/__tests__/**/*.test.ts(x)?&apos;]`   </para>
</entry><entry thead="no"><para>Test file patterns   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4393">
<title>Environment Setup</title><para><bold>Location</bold>: <computeroutput>frontend/jest.setup.js</computeroutput></para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>@testing-library/jest-dom</computeroutput> import   </para>
</entry><entry thead="no"><para>Extended DOM matchers    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>window.matchMedia</computeroutput> mock   </para>
</entry><entry thead="no"><para>Media query simulation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>IntersectionObserver</computeroutput> mock   </para>
</entry><entry thead="no"><para>Viewport observation   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4394">
<title>6.6.2.4 Frontend Mocking Strategy</title><para>The frontend testing approach prioritizes testing user behavior over implementation details.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4395">
<title>Mock Patterns</title><para><table rows="2" cols="3"><row>
<entry thead="yes"><para>Pattern   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Use Case    </para>
</entry></row>
<row>
<entry thead="no"><para>Module Mock   </para>
</entry><entry thead="no"><para><lsquo/>jest.mock(&apos;axios<rsquo/>)<computeroutput>\ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; API client isolation \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;markdownTableRowEven&quot;&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Component Mock \ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt;</computeroutput>jest.mock(&apos;../../app/lib/api&apos;)<computeroutput>\ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Component isolation \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;markdownTableRowOdd&quot;&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Module Reset \ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt;</computeroutput>jest.resetModules()<computeroutput>\ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Clean state between tests \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;markdownTableRowEven&quot;&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Data-TestId \ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt;</computeroutput>data-testid` attributes   </para>
</entry><entry thead="no"><para>Element targeting   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4396">
<title>Centralized Test Data</title><para><bold>Location</bold>: <computeroutput>frontend/__tests__/test-utils.ts</computeroutput></para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Export   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>mockAssets</computeroutput>   </para>
</entry><entry thead="no"><para>Asset[]   </para>
</entry><entry thead="no"><para>Sample asset collection    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>mockMetrics</computeroutput>   </para>
</entry><entry thead="no"><para>Metrics   </para>
</entry><entry thead="no"><para>Network metrics data    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>mockVisualization</computeroutput>   </para>
</entry><entry thead="no"><para>VisualizationData   </para>
</entry><entry thead="no"><para>3D graph data    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>mockRelationships</computeroutput>   </para>
</entry><entry thead="no"><para>Relationship[]   </para>
</entry><entry thead="no"><para>Sample relationships   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4397">
<title>6.6.2.5 Test Naming Conventions</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Convention   </para>
</entry><entry thead="yes"><para>Example    </para>
</entry></row>
<row>
<entry thead="no"><para>Backend Test Files   </para>
</entry><entry thead="no"><para><computeroutput>test_&lt;module&gt;.py</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="test__api__main_8py" kindref="compound">test_api_main.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Frontend Test Files   </para>
</entry><entry thead="no"><para><computeroutput>&lt;Component&gt;.test.tsx</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>AssetList.test.tsx</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Test Functions   </para>
</entry><entry thead="no"><para><computeroutput>test_&lt;behavior&gt;</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>test_asset_creation_with_valid_data</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Test Classes   </para>
</entry><entry thead="no"><para><computeroutput>Test&lt;Feature&gt;</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>TestCompleteAPIFlow</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4398">
<title>6.6.2.6 Code Coverage Configuration</title></sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4399">
<title>Backend Coverage</title><para><bold>Location</bold>: <computeroutput>pyproject.toml</computeroutput></para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Source Directories   </para>
</entry><entry thead="no"><para><computeroutput>[&quot;src&quot;]</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Omit Patterns   </para>
</entry><entry thead="no"><para><computeroutput>*/tests/*</computeroutput>, <computeroutput>*/__pycache__/*</computeroutput>, <computeroutput>*/site-packages/*</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Exclude Lines   </para>
</entry><entry thead="no"><para><computeroutput>pragma: no cover</computeroutput>, <computeroutput>def __repr__</computeroutput>, <computeroutput>raise NotImplementedError</computeroutput>, <computeroutput>if TYPE_CHECKING:</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4400">
<title>Frontend Coverage</title><para><table rows="3" cols="2"><row>
<entry thead="yes"><para>Command   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm test -- --coverage</computeroutput>   </para>
</entry><entry thead="no"><para>Generate coverage report    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm run test:ci</computeroutput>   </para>
</entry><entry thead="no"><para>CI-optimized coverage   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4402">
<title>6.6.3 Integration Testing</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4403">
<title>6.6.3.1 API Integration Testing</title><para>Integration tests validate end-to-end workflows across multiple system components.</para>
<para><bold>Location</bold>: <computeroutput><ref refid="test__api__integration_8py" kindref="compound">tests/integration/test_api_integration.py</ref></computeroutput></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4404">
<title>Integration Test Categories</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Category   </para>
</entry><entry thead="yes"><para>Test Class   </para>
</entry><entry thead="yes"><para>Validation Focus    </para>
</entry></row>
<row>
<entry thead="no"><para>Complete API Flow   </para>
</entry><entry thead="no"><para><computeroutput>TestCompleteAPIFlow</computeroutput>   </para>
</entry><entry thead="no"><para>health → assets → detail → relationships    </para>
</entry></row>
<row>
<entry thead="no"><para>Metrics Consistency   </para>
</entry><entry thead="no"><para><computeroutput>TestMetricsConsistency</computeroutput>   </para>
</entry><entry thead="no"><para>Metrics match actual data    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Data   </para>
</entry><entry thead="no"><para><computeroutput>TestVisualizationData</computeroutput>   </para>
</entry><entry thead="no"><para>All nodes reference existing assets    </para>
</entry></row>
<row>
<entry thead="no"><para>Performance   </para>
</entry><entry thead="no"><para><computeroutput>TestPerformance</computeroutput>   </para>
</entry><entry thead="no"><para>Response time SLAs    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication   </para>
</entry><entry thead="no"><para><computeroutput>TestAuthentication</computeroutput>   </para>
</entry><entry thead="no"><para>JWT token flows   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4405">
<title>Integration Test Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>IntegrationTestFlow[Integration<sp/>Test<sp/>Execution<sp/>Flow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Setup([Test<sp/>Setup])<sp/>--&gt;<sp/>DBInit[Initialize<sp/>Test&lt;br/&gt;Database]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DBInit<sp/>--&gt;<sp/>GraphInit[Initialize&lt;br/&gt;Graph<sp/>Instance]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphInit<sp/>--&gt;<sp/>ClientCreate[Create<sp/>FastAPI&lt;br/&gt;TestClient]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClientCreate<sp/>--&gt;<sp/>TestExec{Execute<sp/>Test&lt;br/&gt;Scenarios}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TestExec<sp/>--&gt;<sp/>HealthCheck[Health<sp/>Check&lt;br/&gt;Endpoint]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TestExec<sp/>--&gt;<sp/>AssetFlow[Asset<sp/>CRUD&lt;br/&gt;Operations]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TestExec<sp/>--&gt;<sp/>RelFlow[Relationship&lt;br/&gt;Queries]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TestExec<sp/>--&gt;<sp/>MetricsFlow[Metrics&lt;br/&gt;Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TestExec<sp/>--&gt;<sp/>VizFlow[Visualization&lt;br/&gt;Data<sp/>Check]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HealthCheck<sp/>--&gt;<sp/>Assert[Assert&lt;br/&gt;Expectations]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AssetFlow<sp/>--&gt;<sp/>Assert</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RelFlow<sp/>--&gt;<sp/>Assert</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MetricsFlow<sp/>--&gt;<sp/>Assert</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VizFlow<sp/>--&gt;<sp/>Assert</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Assert<sp/>--&gt;<sp/>Teardown([Test<sp/>Teardown&lt;br/&gt;Reset<sp/>State])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4406">
<title>Performance Integration Tests</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Test   </para>
</entry><entry thead="yes"><para>Validation   </para>
</entry><entry thead="yes"><para>Threshold    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>test_response_times</computeroutput>   </para>
</entry><entry thead="no"><para>API endpoint response   </para>
</entry><entry thead="no"><para>&lt; 5 seconds    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>test_concurrent_requests</computeroutput>   </para>
</entry><entry thead="no"><para>ThreadPoolExecutor with 5 workers   </para>
</entry><entry thead="no"><para>10 requests success    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>test_visualization_load</computeroutput>   </para>
</entry><entry thead="no"><para>Graph rendering data   </para>
</entry><entry thead="no"><para>&lt; 2 seconds   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4407">
<title>6.6.3.2 Database Integration Testing</title><para><bold>Location</bold>: <computeroutput><ref refid="integration_2test__repository_8py" kindref="compound">tests/integration/test_repository.py</ref></computeroutput></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4408">
<title>Database Test Strategy</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Approach   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Isolated Database   </para>
</entry><entry thead="no"><para><computeroutput>tmp_path</computeroutput> fixture   </para>
</entry><entry thead="no"><para>Test data isolation    </para>
</entry></row>
<row>
<entry thead="no"><para>Migration Testing   </para>
</entry><entry thead="no"><para>Apply <computeroutput>001_initial.sql</computeroutput>   </para>
</entry><entry thead="no"><para>Schema validation    </para>
</entry></row>
<row>
<entry thead="no"><para>CRUD Operations   </para>
</entry><entry thead="no"><para>SQLAlchemy sessions   </para>
</entry><entry thead="no"><para>Data layer verification    </para>
</entry></row>
<row>
<entry thead="no"><para>Transaction Rollback   </para>
</entry><entry thead="no"><para>Session rollback   </para>
</entry><entry thead="no"><para>Clean state   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4409">
<title>Database Test Configuration</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Parameter   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Database URL   </para>
</entry><entry thead="no"><para><computeroutput>sqlite:///{tmp_path}/test.db</computeroutput>   </para>
</entry><entry thead="no"><para>Isolated test database    </para>
</entry></row>
<row>
<entry thead="no"><para>Connection Args   </para>
</entry><entry thead="no"><para><computeroutput>check_same_thread=False</computeroutput>   </para>
</entry><entry thead="no"><para>Multi-threaded compatibility    </para>
</entry></row>
<row>
<entry thead="no"><para>Pool Class   </para>
</entry><entry thead="no"><para><computeroutput>StaticPool</computeroutput>   </para>
</entry><entry thead="no"><para>Connection reuse   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4410">
<title>6.6.3.3 External Service Mocking</title></sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4411">
<title>Yahoo Finance Mocking</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Strategy   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Environment Flag   </para>
</entry><entry thead="no"><para><computeroutput>USE_REAL_DATA_FETCHER=false</computeroutput>   </para>
</entry><entry thead="no"><para>Disable real API calls    </para>
</entry></row>
<row>
<entry thead="no"><para>Sample Data Fallback   </para>
</entry><entry thead="no"><para><computeroutput>sample_database.py</computeroutput>   </para>
</entry><entry thead="no"><para>Predictable test data    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache Mocking   </para>
</entry><entry thead="no"><para>Mock JSON cache files   </para>
</entry><entry thead="no"><para>Cache behavior testing   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4412">
<title>6.6.3.4 Dependency and Workflow Testing</title><para><bold>Location</bold>: <computeroutput>tests/integration/</computeroutput></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Test File   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="test__requirements_8py" kindref="compound">test_requirements.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Validate production dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="test__requirements__dev_8py" kindref="compound">test_requirements_dev.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Validate development dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="test__github__workflows_8py" kindref="compound">test_github_workflows.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>CI/CD workflow validation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="test__debricked__workflow_8py" kindref="compound">test_debricked_workflow.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Security workflow validation   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4414">
<title>6.6.4 End-to-End Testing</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4415">
<title>6.6.4.1 Current E2E Implementation</title><para>The system implements component-level E2E simulation through Jest and React Testing Library, providing comprehensive user interaction testing without requiring a full browser environment.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4416">
<title>Frontend E2E Patterns</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Pattern   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Coverage    </para>
</entry></row>
<row>
<entry thead="no"><para>Page Rendering   </para>
</entry><entry thead="no"><para><computeroutput>page.test.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Full page lifecycle    </para>
</entry></row>
<row>
<entry thead="no"><para>Component Interaction   </para>
</entry><entry thead="no"><para><computeroutput>fireEvent</computeroutput>, <computeroutput>userEvent</computeroutput>   </para>
</entry><entry thead="no"><para>User actions    </para>
</entry></row>
<row>
<entry thead="no"><para>Loading States   </para>
</entry><entry thead="no"><para><computeroutput>waitFor</computeroutput> assertions   </para>
</entry><entry thead="no"><para>Async behavior    </para>
</entry></row>
<row>
<entry thead="no"><para>Error Handling   </para>
</entry><entry thead="no"><para>Mock error responses   </para>
</entry><entry thead="no"><para>Recovery flows    </para>
</entry></row>
<row>
<entry thead="no"><para>Tab Navigation   </para>
</entry><entry thead="no"><para>State management tests   </para>
</entry><entry thead="no"><para>Navigation behavior   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4417">
<title>Component Test Scenarios</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Test Scenarios    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>AssetList</computeroutput>   </para>
</entry><entry thead="no"><para>Render assets, filter by class, search functionality    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>MetricsDashboard</computeroutput>   </para>
</entry><entry thead="no"><para>Display metrics, handle loading, show errors    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>NetworkVisualization</computeroutput>   </para>
</entry><entry thead="no"><para>3D graph rendering, node interaction    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>page.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Tab switching, data loading, retry mechanisms   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4418">
<title>6.6.4.2 Planned E2E Enhancements</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Enhancement   </para>
</entry><entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Priority    </para>
</entry></row>
<row>
<entry thead="no"><para>Browser E2E Tests   </para>
</entry><entry thead="no"><para>Playwright/Cypress   </para>
</entry><entry thead="no"><para>Medium    </para>
</entry></row>
<row>
<entry thead="no"><para>Visual Regression   </para>
</entry><entry thead="no"><para>Percy/Chromatic   </para>
</entry><entry thead="no"><para>Low    </para>
</entry></row>
<row>
<entry thead="no"><para>Load Testing   </para>
</entry><entry thead="no"><para>k6/Artillery   </para>
</entry><entry thead="no"><para>Medium    </para>
</entry></row>
<row>
<entry thead="no"><para>Accessibility Testing   </para>
</entry><entry thead="no"><para>axe-core   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4419">
<title>6.6.4.3 Test Data Management</title></sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4420">
<title>Backend Test Data Setup</title><para><bold>Location</bold>: <computeroutput><ref refid="tests_2____init_____8py" kindref="compound">tests/__init__.py</ref></computeroutput></para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Environment Variable   </para>
</entry><entry thead="yes"><para>Test Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SECRET_KEY</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>test-secret-key</computeroutput>   </para>
</entry><entry thead="no"><para>JWT signing    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>DATABASE_URL</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>sqlite:///{test_auth.db}</computeroutput>   </para>
</entry><entry thead="no"><para>Auth database    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_USERNAME</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>admin</computeroutput>   </para>
</entry><entry thead="no"><para>Test admin user    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_PASSWORD</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>changeme</computeroutput>   </para>
</entry><entry thead="no"><para>Test credentials   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4421">
<title>Test Data Lifecycle</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>TestDataLifecycle[Test<sp/>Data<sp/>Lifecycle]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Setup[Setup<sp/>Phase]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InitEnv[Initialize&lt;br/&gt;Environment]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CreateDB[Create<sp/>Test&lt;br/&gt;Database]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadFixtures[Load<sp/>Test&lt;br/&gt;Fixtures]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeedData[Seed<sp/>Sample&lt;br/&gt;Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Execution[Execution<sp/>Phase]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RunTest[Execute<sp/>Test&lt;br/&gt;Case]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CaptureState[Capture&lt;br/&gt;State<sp/>Changes]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Validate[Validate&lt;br/&gt;Expectations]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Teardown[Teardown<sp/>Phase]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RollbackTx[Rollback&lt;br/&gt;Transactions]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ResetState[Reset<sp/>Graph&lt;br/&gt;State]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CleanupFiles[Cleanup&lt;br/&gt;Temp<sp/>Files]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>InitEnv<sp/>--&gt;<sp/>CreateDB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CreateDB<sp/>--&gt;<sp/>LoadFixtures</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LoadFixtures<sp/>--&gt;<sp/>SeedData</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SeedData<sp/>--&gt;<sp/>RunTest</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RunTest<sp/>--&gt;<sp/>CaptureState</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CaptureState<sp/>--&gt;<sp/>Validate</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Validate<sp/>--&gt;<sp/>RollbackTx</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RollbackTx<sp/>--&gt;<sp/>ResetState</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ResetState<sp/>--&gt;<sp/>CleanupFiles</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4423">
<title>6.6.5 Test Automation</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4424">
<title>6.6.5.1 CI/CD Integration</title><para>The testing strategy integrates with both GitHub Actions and CircleCI for comprehensive automated validation.</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4425">
<title>GitHub Actions Primary CI</title><para><bold>Location</bold>: <computeroutput>.github/workflows/ci.yml</computeroutput></para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>GitHubActionsCI[GitHub<sp/>Actions<sp/>CI<sp/>Pipeline]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trigger([Push/PR<sp/>to<sp/>main])<sp/>--&gt;<sp/>Checkout[Checkout<sp/>Code]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Checkout<sp/>--&gt;<sp/>Matrix{Python<sp/>Version&lt;br/&gt;Matrix}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Matrix<sp/>--&gt;<sp/>Py310[Python<sp/>3.10]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Matrix<sp/>--&gt;<sp/>Py311[Python<sp/>3.11]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Matrix<sp/>--&gt;<sp/>Py312[Python<sp/>3.12]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Py310<sp/>--&gt;<sp/>LintJobs</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Py311<sp/>--&gt;<sp/>LintJobs</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Py312<sp/>--&gt;<sp/>LintJobs</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>LintJobs[Linting<sp/>Jobs]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Flake8[flake8&lt;br/&gt;Critical<sp/>+<sp/>Full]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Black[black<sp/>--check]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Isort[isort<sp/>--check-only]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pylint[pylint&lt;br/&gt;fail-under=7.0]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LintJobs<sp/>--&gt;<sp/>TestJob[pytest&lt;br/&gt;--cov=src&lt;br/&gt;--cov-report=xml]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TestJob<sp/>--&gt;<sp/>CoverageCheck{Python<sp/>3.11&lt;br/&gt;Only?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CoverageCheck<sp/>--&gt;|Yes|<sp/>Codecov[Upload<sp/>to&lt;br/&gt;Codecov]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CoverageCheck<sp/>--&gt;|No|<sp/>Complete([Job<sp/>Complete])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Codecov<sp/>--&gt;<sp/>Complete</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4426">
<title>CI Job Configuration</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Job   </para>
</entry><entry thead="yes"><para>Tools   </para>
</entry><entry thead="yes"><para>Failure Behavior    </para>
</entry></row>
<row>
<entry thead="no"><para>test   </para>
</entry><entry thead="no"><para>pytest, flake8, black, isort, pylint   </para>
</entry><entry thead="no"><para>fail-fast: false    </para>
</entry></row>
<row>
<entry thead="no"><para>security   </para>
</entry><entry thead="no"><para>safety, bandit   </para>
</entry><entry thead="no"><para>continue-on-error: true   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4427">
<title>CircleCI Secondary CI</title><para><bold>Location</bold>: <computeroutput>.circleci/config.yml</computeroutput></para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Job   </para>
</entry><entry thead="yes"><para>Parallelism   </para>
</entry><entry thead="yes"><para>Output    </para>
</entry></row>
<row>
<entry thead="no"><para>python-lint   </para>
</entry><entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>flake8 results    </para>
</entry></row>
<row>
<entry thead="no"><para>python-test   </para>
</entry><entry thead="no"><para>4   </para>
</entry><entry thead="no"><para>pytest with coverage    </para>
</entry></row>
<row>
<entry thead="no"><para>python-security   </para>
</entry><entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>safety + bandit    </para>
</entry></row>
<row>
<entry thead="no"><para>frontend-lint   </para>
</entry><entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>npm run lint    </para>
</entry></row>
<row>
<entry thead="no"><para>frontend-build   </para>
</entry><entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>npm run build    </para>
</entry></row>
<row>
<entry thead="no"><para>docker-build   </para>
</entry><entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>Smoke test   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4428">
<title>6.6.5.2 Frontend CI Pipeline</title><para><bold>Location</bold>: <computeroutput>.github/workflows/node.js.yml</computeroutput></para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Node Matrix   </para>
</entry><entry thead="no"><para>18.x, 20.x, 22.x    </para>
</entry></row>
<row>
<entry thead="no"><para>Trigger Paths   </para>
</entry><entry thead="no"><para><computeroutput>frontend/**</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Jobs   </para>
</entry><entry thead="no"><para><computeroutput>npm ci</computeroutput>, <computeroutput>npm run build</computeroutput>, <computeroutput>npm test</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4429">
<title>6.6.5.3 Automated Test Triggers</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Trigger   </para>
</entry><entry thead="yes"><para>Event   </para>
</entry><entry thead="yes"><para>Tests Executed    </para>
</entry></row>
<row>
<entry thead="no"><para>Push   </para>
</entry><entry thead="no"><para><computeroutput>main</computeroutput> branch   </para>
</entry><entry thead="no"><para>Full suite    </para>
</entry></row>
<row>
<entry thead="no"><para>Pull Request   </para>
</entry><entry thead="no"><para>To <computeroutput>main</computeroutput>   </para>
</entry><entry thead="no"><para>Full suite    </para>
</entry></row>
<row>
<entry thead="no"><para>Schedule   </para>
</entry><entry thead="no"><para>Daily 02:00 UTC   </para>
</entry><entry thead="no"><para>Security scans    </para>
</entry></row>
<row>
<entry thead="no"><para>Manual   </para>
</entry><entry thead="no"><para><computeroutput>workflow_dispatch</computeroutput>   </para>
</entry><entry thead="no"><para>Selected workflows   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4430">
<title>6.6.5.4 Parallel Test Execution</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Platform   </para>
</entry><entry thead="yes"><para>Parallelism   </para>
</entry><entry thead="yes"><para>Strategy    </para>
</entry></row>
<row>
<entry thead="no"><para>GitHub Actions   </para>
</entry><entry thead="no"><para>Python version matrix   </para>
</entry><entry thead="no"><para>3.10, 3.11, 3.12    </para>
</entry></row>
<row>
<entry thead="no"><para>CircleCI   </para>
</entry><entry thead="no"><para><computeroutput>parallelism: 4</computeroutput>   </para>
</entry><entry thead="no"><para>Test file distribution    </para>
</entry></row>
<row>
<entry thead="no"><para>Jest   </para>
</entry><entry thead="no"><para>Default parallel   </para>
</entry><entry thead="no"><para>Worker pool   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4431">
<title>6.6.5.5 Test Reporting</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Report Type   </para>
</entry><entry thead="yes"><para>Format   </para>
</entry><entry thead="yes"><para>Destination    </para>
</entry></row>
<row>
<entry thead="no"><para>Coverage   </para>
</entry><entry thead="no"><para>XML   </para>
</entry><entry thead="no"><para>Codecov upload    </para>
</entry></row>
<row>
<entry thead="no"><para>Test Results   </para>
</entry><entry thead="no"><para>JUnit XML   </para>
</entry><entry thead="no"><para>CircleCI artifacts    </para>
</entry></row>
<row>
<entry thead="no"><para>Coverage HTML   </para>
</entry><entry thead="no"><para>HTML   </para>
</entry><entry thead="no"><para>GitHub artifacts    </para>
</entry></row>
<row>
<entry thead="no"><para>Security   </para>
</entry><entry thead="no"><para>SARIF   </para>
</entry><entry thead="no"><para>GitHub Security tab   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4432">
<title>6.6.5.6 Failed Test Handling</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Strategy   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Matrix Continue   </para>
</entry><entry thead="no"><para><computeroutput>fail-fast: false</computeroutput>   </para>
</entry><entry thead="no"><para>Complete all versions    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Continue   </para>
</entry><entry thead="no"><para><computeroutput>continue-on-error: true</computeroutput>   </para>
</entry><entry thead="no"><para>Non-blocking scans    </para>
</entry></row>
<row>
<entry thead="no"><para>Artifact Preservation   </para>
</entry><entry thead="no"><para>Always upload   </para>
</entry><entry thead="no"><para>Debug information    </para>
</entry></row>
<row>
<entry thead="no"><para>Retry Mechanism   </para>
</entry><entry thead="no"><para>Manual re-run   </para>
</entry><entry thead="no"><para>Flaky test recovery   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4434">
<title>6.6.6 Security Testing</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4435">
<title>6.6.6.1 Static Application Security Testing (SAST)</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Workflow   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Bandit   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/bandit.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Python security linting    </para>
</entry></row>
<row>
<entry thead="no"><para>CodeQL   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/codeql.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Multi-language SAST    </para>
</entry></row>
<row>
<entry thead="no"><para>Semgrep   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/semgrep.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Pattern-based scanning    </para>
</entry></row>
<row>
<entry thead="no"><para>DevSkim   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/devskim.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Security linting   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4436">
<title>Bandit Configuration</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Skip Codes   </para>
</entry><entry thead="no"><para><computeroutput>B101</computeroutput>   </para>
</entry><entry thead="no"><para>Allow asserts in tests    </para>
</entry></row>
<row>
<entry thead="no"><para>Output   </para>
</entry><entry thead="no"><para>SARIF   </para>
</entry><entry thead="no"><para>GitHub Security integration    </para>
</entry></row>
<row>
<entry thead="no"><para>Targets   </para>
</entry><entry thead="no"><para><computeroutput>src/</computeroutput>, <computeroutput>api/</computeroutput>   </para>
</entry><entry thead="no"><para>Application code only   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4437">
<title>6.6.6.2 Software Composition Analysis (SCA)</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Workflow   </para>
</entry><entry thead="yes"><para>Scope    </para>
</entry></row>
<row>
<entry thead="no"><para>Safety   </para>
</entry><entry thead="no"><para>CircleCI   </para>
</entry><entry thead="no"><para>Python dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para>Snyk Open Source   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/snyk-security.yml</computeroutput>   </para>
</entry><entry thead="no"><para>All dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para>Debricked   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/debricked_workflow.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Dependency analysis    </para>
</entry></row>
<row>
<entry thead="no"><para>OSV Scanner   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/osv-scanner.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Vulnerability database   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4438">
<title>6.6.6.3 Container Security</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Workflow   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Trivy   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/trivy.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Container scanning    </para>
</entry></row>
<row>
<entry thead="no"><para>Hadolint   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/hadolint.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Dockerfile linting    </para>
</entry></row>
<row>
<entry thead="no"><para>Snyk Container   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/snyk-container.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Image vulnerabilities   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4439">
<title>6.6.6.4 Security Scanning Pipeline</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>SecurityPipeline[Security<sp/>Scanning<sp/>Pipeline]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Triggers[Scan<sp/>Triggers]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Push([Code<sp/>Push])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PR([Pull<sp/>Request])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Schedule([Nightly/Weekly])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>SAST[SAST<sp/>Analysis]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Bandit[Bandit&lt;br/&gt;Python<sp/>SAST]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CodeQL[CodeQL&lt;br/&gt;Multi-language]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Semgrep[Semgrep&lt;br/&gt;Pattern<sp/>Detection]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>SCA[Dependency<sp/>Scanning]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Safety[Safety&lt;br/&gt;Python<sp/>Deps]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Snyk[Snyk&lt;br/&gt;All<sp/>Deps]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Debricked[Debricked&lt;br/&gt;Analysis]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Container[Container<sp/>Security]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trivy[Trivy&lt;br/&gt;Image<sp/>Scan]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Hadolint[Hadolint&lt;br/&gt;Dockerfile]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Results[Results<sp/>Processing]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SARIF[SARIF<sp/>Upload]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SecurityTab[GitHub<sp/>Security&lt;br/&gt;Tab]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Artifacts[Scan<sp/>Artifacts]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Push<sp/>--&gt;<sp/>SAST</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Push<sp/>--&gt;<sp/>SCA</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PR<sp/>--&gt;<sp/>SAST</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PR<sp/>--&gt;<sp/>SCA</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PR<sp/>--&gt;<sp/>Container</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Schedule<sp/>--&gt;<sp/>SAST</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Schedule<sp/>--&gt;<sp/>SCA</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Schedule<sp/>--&gt;<sp/>Container</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SAST<sp/>--&gt;<sp/>SARIF</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SCA<sp/>--&gt;<sp/>SARIF</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Container<sp/>--&gt;<sp/>SARIF</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SARIF<sp/>--&gt;<sp/>SecurityTab</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SARIF<sp/>--&gt;<sp/>Artifacts</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4440">
<title>6.6.6.5 Authentication Testing</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Test Category   </para>
</entry><entry thead="yes"><para>Validation   </para>
</entry><entry thead="yes"><para>Location    </para>
</entry></row>
<row>
<entry thead="no"><para>JWT Token Flow   </para>
</entry><entry thead="no"><para>Token generation, expiration   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="test__api__integration_8py" kindref="compound">tests/integration/test_api_integration.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Password Hashing   </para>
</entry><entry thead="no"><para>pbkdf2_sha256 verification   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="test__api__main_8py" kindref="compound">tests/unit/test_api_main.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limiting   </para>
</entry><entry thead="no"><para>5/min on <computeroutput>/token</computeroutput>   </para>
</entry><entry thead="no"><para>Integration tests    </para>
</entry></row>
<row>
<entry thead="no"><para>CORS Validation   </para>
</entry><entry thead="no"><para>Origin allowlist   </para>
</entry><entry thead="no"><para>Unit tests   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4442">
<title>6.6.7 Quality Metrics</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4443">
<title>6.6.7.1 Code Coverage Targets</title><para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Current   </para>
</entry><entry thead="yes"><para>Target   </para>
</entry><entry thead="yes"><para>Critical Paths    </para>
</entry></row>
<row>
<entry thead="no"><para>Backend API   </para>
</entry><entry thead="no"><para>&gt;90%   </para>
</entry><entry thead="no"><para>&gt;80%   </para>
</entry><entry thead="no"><para>100%    </para>
</entry></row>
<row>
<entry thead="no"><para>Frontend API Client   </para>
</entry><entry thead="no"><para>&gt;95%   </para>
</entry><entry thead="no"><para>&gt;80%   </para>
</entry><entry thead="no"><para>100%    </para>
</entry></row>
<row>
<entry thead="no"><para>React Components   </para>
</entry><entry thead="no"><para>&gt;80%   </para>
</entry><entry thead="no"><para>&gt;80%   </para>
</entry><entry thead="no"><para>100%    </para>
</entry></row>
<row>
<entry thead="no"><para>Domain Models   </para>
</entry><entry thead="no"><para>&gt;85%   </para>
</entry><entry thead="no"><para>&gt;80%   </para>
</entry><entry thead="no"><para>100%    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization   </para>
</entry><entry thead="no"><para>&gt;75%   </para>
</entry><entry thead="no"><para>&gt;70%   </para>
</entry><entry thead="no"><para>100%   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4444">
<title>6.6.7.2 Static Analysis Thresholds</title><para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Metric   </para>
</entry><entry thead="yes"><para>Threshold   </para>
</entry><entry thead="yes"><para>Enforcement    </para>
</entry></row>
<row>
<entry thead="no"><para>pylint   </para>
</entry><entry thead="no"><para>Score   </para>
</entry><entry thead="no"><para>&gt;= 7.0   </para>
</entry><entry thead="no"><para>CI blocking    </para>
</entry></row>
<row>
<entry thead="no"><para>black   </para>
</entry><entry thead="no"><para>Formatting   </para>
</entry><entry thead="no"><para>100%   </para>
</entry><entry thead="no"><para>CI blocking    </para>
</entry></row>
<row>
<entry thead="no"><para>flake8   </para>
</entry><entry thead="no"><para>Errors   </para>
</entry><entry thead="no"><para>0 critical   </para>
</entry><entry thead="no"><para>CI blocking    </para>
</entry></row>
<row>
<entry thead="no"><para>isort   </para>
</entry><entry thead="no"><para>Import order   </para>
</entry><entry thead="no"><para>100%   </para>
</entry><entry thead="no"><para>CI blocking    </para>
</entry></row>
<row>
<entry thead="no"><para>ESLint   </para>
</entry><entry thead="no"><para>Errors   </para>
</entry><entry thead="no"><para>0   </para>
</entry><entry thead="no"><para>CI blocking   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4445">
<title>6.6.7.3 Performance Test Thresholds</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Target SLA   </para>
</entry><entry thead="yes"><para>Measurement    </para>
</entry></row>
<row>
<entry thead="no"><para>API Response (p95)   </para>
</entry><entry thead="no"><para>&lt; 500ms   </para>
</entry><entry thead="no"><para>Request to response    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Rendering   </para>
</entry><entry thead="no"><para>&lt; 2 seconds   </para>
</entry><entry thead="no"><para>Data load to interactive    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Generation   </para>
</entry><entry thead="no"><para>&lt; 100ms   </para>
</entry><entry thead="no"><para>Credential to token    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Initialization   </para>
</entry><entry thead="no"><para>&lt; 3 seconds   </para>
</entry><entry thead="no"><para>Application startup    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Discovery   </para>
</entry><entry thead="no"><para>&lt; 500ms   </para>
</entry><entry thead="no"><para>For 100 assets    </para>
</entry></row>
<row>
<entry thead="no"><para>Initial Page Load   </para>
</entry><entry thead="no"><para>&lt; 3 seconds   </para>
</entry><entry thead="no"><para>Navigation to interactive   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4446">
<title>6.6.7.4 Quality Gates</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>QualityGates[Quality<sp/>Gate<sp/>Checkpoints]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PRSubmit([PR<sp/>Submitted])<sp/>--&gt;<sp/>Gate1{Code<sp/>Coverage&lt;br/&gt;&gt;=<sp/>80%?}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gate1<sp/>--&gt;|No|<sp/>Block1[Block<sp/>Merge]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gate1<sp/>--&gt;|Yes|<sp/>Gate2{Linting&lt;br/&gt;Passed?}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gate2<sp/>--&gt;|No|<sp/>Block2[Block<sp/>Merge]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gate2<sp/>--&gt;|Yes|<sp/>Gate3{Tests&lt;br/&gt;Passed?}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gate3<sp/>--&gt;|No|<sp/>Block3[Block<sp/>Merge]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gate3<sp/>--&gt;|Yes|<sp/>Gate4{Security&lt;br/&gt;Scan<sp/>Clean?}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gate4<sp/>--&gt;|Critical|<sp/>Block4[Block<sp/>Merge]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gate4<sp/>--&gt;|Warning/Clean|<sp/>Gate5{Build&lt;br/&gt;Success?}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gate5<sp/>--&gt;|No|<sp/>Block5[Block<sp/>Merge]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gate5<sp/>--&gt;|Yes|<sp/>Approve([Ready<sp/>for<sp/>Review])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4447">
<title>6.6.7.5 Test Success Rate Requirements</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Environment   </para>
</entry><entry thead="yes"><para>Required Pass Rate   </para>
</entry><entry thead="yes"><para>Action on Failure    </para>
</entry></row>
<row>
<entry thead="no"><para>Unit Tests   </para>
</entry><entry thead="no"><para>100%   </para>
</entry><entry thead="no"><para>Block merge    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Tests   </para>
</entry><entry thead="no"><para>100%   </para>
</entry><entry thead="no"><para>Block merge    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Scans   </para>
</entry><entry thead="no"><para>No critical   </para>
</entry><entry thead="no"><para>Block merge    </para>
</entry></row>
<row>
<entry thead="no"><para>Linting   </para>
</entry><entry thead="no"><para>100%   </para>
</entry><entry thead="no"><para>Block merge   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4449">
<title>6.6.8 Test Environment Architecture</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4450">
<title>6.6.8.1 Environment Configuration</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>TestEnvironments[Test<sp/>Environment<sp/>Architecture]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>LocalDev[Local<sp/>Development]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalPytest[pytest&lt;br/&gt;Direct<sp/>execution]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalJest[Jest&lt;br/&gt;Watch<sp/>mode]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalDB[SQLite&lt;br/&gt;In-memory]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>CI[CI<sp/>Environment]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GitHubRunner[GitHub<sp/>Actions&lt;br/&gt;Ubuntu<sp/>Latest]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CircleCIRunner[CircleCI&lt;br/&gt;Python/Node<sp/>Images]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIDatabase[Ephemeral&lt;br/&gt;SQLite]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Docker[Docker<sp/>Testing]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerBuild[Build<sp/>Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SmokeTest[Container&lt;br/&gt;Smoke<sp/>Test]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HealthCheck[Health<sp/>Check&lt;br/&gt;Probe]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LocalDev<sp/>--&gt;|Push|<sp/>CI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CI<sp/>--&gt;|Build|<sp/>Docker</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4451">
<title>6.6.8.2 Backend Test Environment</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Python Version   </para>
</entry><entry thead="no"><para>3.10, 3.11, 3.12    </para>
</entry></row>
<row>
<entry thead="no"><para>Database   </para>
</entry><entry thead="no"><para>SQLite in-memory    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph State   </para>
</entry><entry thead="no"><para>Reset per test    </para>
</entry></row>
<row>
<entry thead="no"><para>External APIs   </para>
</entry><entry thead="no"><para>Mocked/Sample data   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4452">
<title>6.6.8.3 Frontend Test Environment</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Node Version   </para>
</entry><entry thead="no"><para>18.x, 20.x, 22.x    </para>
</entry></row>
<row>
<entry thead="no"><para>Test Environment   </para>
</entry><entry thead="no"><para>jest-environment-jsdom    </para>
</entry></row>
<row>
<entry thead="no"><para>API Mocking   </para>
</entry><entry thead="no"><para>jest.mock(&apos;axios&apos;)    </para>
</entry></row>
<row>
<entry thead="no"><para>Browser APIs   </para>
</entry><entry thead="no"><para>window.matchMedia, IntersectionObserver mocked   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4453">
<title>6.6.8.4 Docker Test Environment</title><para><bold>Location</bold>: <computeroutput>.github/workflows/docker.yml</computeroutput></para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Test   </para>
</entry><entry thead="yes"><para>Command   </para>
</entry><entry thead="yes"><para>Validation    </para>
</entry></row>
<row>
<entry thead="no"><para>Build   </para>
</entry><entry thead="no"><para><computeroutput>docker build</computeroutput>   </para>
</entry><entry thead="no"><para>Image creation    </para>
</entry></row>
<row>
<entry thead="no"><para>Smoke Test   </para>
</entry><entry thead="no"><para>HTTP probe   </para>
</entry><entry thead="no"><para>10s health check    </para>
</entry></row>
<row>
<entry thead="no"><para>Config Validation   </para>
</entry><entry thead="no"><para><computeroutput>docker-compose config</computeroutput>   </para>
</entry><entry thead="no"><para>YAML syntax    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Scan   </para>
</entry><entry thead="no"><para>Trivy   </para>
</entry><entry thead="no"><para>Vulnerability check   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4455">
<title>6.6.9 Test Execution Flow</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4456">
<title>6.6.9.1 Complete Test Execution Pipeline</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>TestExecutionFlow[Test<sp/>Execution<sp/>Pipeline]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trigger([Trigger:&lt;br/&gt;Push/PR/Manual])<sp/>--&gt;<sp/>Checkout[Checkout&lt;br/&gt;Repository]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Checkout<sp/>--&gt;<sp/>ParallelStart{Start<sp/>Parallel&lt;br/&gt;Execution}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParallelStart<sp/>--&gt;<sp/>BackendTrack</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParallelStart<sp/>--&gt;<sp/>FrontendTrack</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParallelStart<sp/>--&gt;<sp/>SecurityTrack</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>BackendTrack[Backend<sp/>Track]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PyMatrix[Python<sp/>Matrix&lt;br/&gt;3.10,<sp/>3.11,<sp/>3.12]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PyMatrix<sp/>--&gt;<sp/>PyLint[Linting&lt;br/&gt;flake8,<sp/>black,<sp/>isort]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PyLint<sp/>--&gt;<sp/>PyTest[pytest&lt;br/&gt;--cov=src]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PyTest<sp/>--&gt;<sp/>PyCoverage[Coverage&lt;br/&gt;Upload]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>FrontendTrack[Frontend<sp/>Track]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NodeMatrix[Node<sp/>Matrix&lt;br/&gt;18.x,<sp/>20.x,<sp/>22.x]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NodeMatrix<sp/>--&gt;<sp/>NodeLint[npm<sp/>run<sp/>lint]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NodeLint<sp/>--&gt;<sp/>NodeBuild[npm<sp/>run<sp/>build]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NodeBuild<sp/>--&gt;<sp/>NodeTest[npm<sp/>test]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>SecurityTrack[Security<sp/>Track]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SASTScans[SAST<sp/>Scans&lt;br/&gt;Bandit,<sp/>CodeQL]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SASTScans<sp/>--&gt;<sp/>SCAScans[SCA<sp/>Scans&lt;br/&gt;Safety,<sp/>Snyk]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SCAScans<sp/>--&gt;<sp/>ContainerScans[Container<sp/>Scans&lt;br/&gt;Trivy]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BackendTrack<sp/>--&gt;<sp/>Aggregate{Aggregate&lt;br/&gt;Results}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FrontendTrack<sp/>--&gt;<sp/>Aggregate</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SecurityTrack<sp/>--&gt;<sp/>Aggregate</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Aggregate<sp/>--&gt;<sp/>QualityGate{Quality&lt;br/&gt;Gates<sp/>Met?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>QualityGate<sp/>--&gt;|Yes|<sp/>Success([Pipeline&lt;br/&gt;Success])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>QualityGate<sp/>--&gt;|No|<sp/>Failure([Pipeline&lt;br/&gt;Failure])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4457">
<title>6.6.9.2 Test Execution Commands</title></sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4458">
<title>Backend Commands</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Command   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>pytest</computeroutput>   </para>
</entry><entry thead="no"><para>Run all tests    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>pytest -m unit</computeroutput>   </para>
</entry><entry thead="no"><para>Run unit tests only    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>pytest -m integration</computeroutput>   </para>
</entry><entry thead="no"><para>Run integration tests only    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>pytest --cov=src --cov-report=html</computeroutput>   </para>
</entry><entry thead="no"><para>Coverage with HTML report    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make test</computeroutput>   </para>
</entry><entry thead="no"><para>Makefile shortcut   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4459">
<title>Frontend Commands</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Command   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm test</computeroutput>   </para>
</entry><entry thead="no"><para>Run all tests    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm test -- --coverage</computeroutput>   </para>
</entry><entry thead="no"><para>Tests with coverage    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm test -- --watch</computeroutput>   </para>
</entry><entry thead="no"><para>Watch mode    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm run test:ci</computeroutput>   </para>
</entry><entry thead="no"><para>CI-optimized execution   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4461">
<title>6.6.10 References</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4462">
<title>6.6.10.1 Source Files Examined</title><para><table rows="25" cols="2"><row>
<entry thead="yes"><para>Path   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>pyproject.toml</computeroutput>   </para>
</entry><entry thead="no"><para>Pytest configuration, coverage settings, tool configs    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>conftest.py</computeroutput> (root)   </para>
</entry><entry thead="no"><para>Coverage plugin handling    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="tests_2conftest_8py" kindref="compound">tests/conftest.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Shared backend fixtures    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="tests_2____init_____8py" kindref="compound">tests/__init__.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Test environment setup    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="tests_2unit_2test__api_8py" kindref="compound">tests/unit/test_api.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>API unit tests    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="test__api__main_8py" kindref="compound">tests/unit/test_api_main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Comprehensive API tests    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="test__financial__models_8py" kindref="compound">tests/unit/test_financial_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Domain model validation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="unit_2test__repository_8py" kindref="compound">tests/unit/test_repository.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Repository tests    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="test__graph__visuals_8py" kindref="compound">tests/unit/test_graph_visuals.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Visualization tests    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="test__api__integration_8py" kindref="compound">tests/integration/test_api_integration.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Integration tests    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="integration_2test__repository_8py" kindref="compound">tests/integration/test_repository.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Database integration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="tests_2integration_2conftest_8py" kindref="compound">tests/integration/conftest.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Integration fixtures    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/jest.config.js</computeroutput>   </para>
</entry><entry thead="no"><para>Jest configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/jest.setup.js</computeroutput>   </para>
</entry><entry thead="no"><para>Jest environment setup    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend test scripts    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/__tests__/test-utils.ts</computeroutput>   </para>
</entry><entry thead="no"><para>Mock data utilities    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/__tests__/lib/api.test.ts</computeroutput>   </para>
</entry><entry thead="no"><para>API client tests    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/ci.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Primary CI workflow    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/codecov.yaml</computeroutput>   </para>
</entry><entry thead="no"><para>Coverage reporting    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/node.js.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend CI    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/docker.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Docker testing    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/bandit.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Security scanning    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/snyk-security.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Snyk scanning    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.circleci/config.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Secondary CI   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4463">
<title>6.6.10.2 Testing Documentation Files</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Path   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="TESTING_8md" kindref="compound">TESTING.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Testing guide overview    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="TESTING__GUIDE_8md" kindref="compound">TESTING_GUIDE.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Comprehensive testing documentation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="TEST__SUMMARY_8md" kindref="compound">TEST_SUMMARY.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Test generation summary    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="tests_2README_8md" kindref="compound">tests/README.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Test suite documentation   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4464">
<title>6.6.10.3 Technical Specification Cross-References</title><para><table rows="8" cols="2"><row>
<entry thead="yes"><para>Section   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para>3.1 Technology Stack Overview   </para>
</entry><entry thead="no"><para>Framework versions, tool choices    </para>
</entry></row>
<row>
<entry thead="no"><para>5.4 CROSS-CUTTING CONCERNS   </para>
</entry><entry thead="no"><para>Performance SLAs, error handling    </para>
</entry></row>
<row>
<entry thead="no"><para>5.5 DEPLOYMENT ARCHITECTURE   </para>
</entry><entry thead="no"><para>Test environment targets    </para>
</entry></row>
<row>
<entry thead="no"><para>6.1 Core Services Architecture   </para>
</entry><entry thead="no"><para>Monolithic testing implications    </para>
</entry></row>
<row>
<entry thead="no"><para>6.3 Integration Architecture   </para>
</entry><entry thead="no"><para>API testing patterns    </para>
</entry></row>
<row>
<entry thead="no"><para>6.4 Security Architecture   </para>
</entry><entry thead="no"><para>Security testing requirements    </para>
</entry></row>
<row>
<entry thead="no"><para>6.5 Monitoring and Observability   </para>
</entry><entry thead="no"><para>CI/CD quality gates   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4465">
<title>6.6.10.4 External Resources</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Resource   </para>
</entry><entry thead="yes"><para>Context    </para>
</entry></row>
<row>
<entry thead="no"><para>FastAPI Testing Documentation   </para>
</entry><entry thead="no"><para>Official TestClient patterns    </para>
</entry></row>
<row>
<entry thead="no"><para>pytest Documentation   </para>
</entry><entry thead="no"><para>Test framework reference    </para>
</entry></row>
<row>
<entry thead="no"><para>Jest Documentation   </para>
</entry><entry thead="no"><para>Frontend testing reference    </para>
</entry></row>
<row>
<entry thead="no"><para>React Testing Library   </para>
</entry><entry thead="no"><para>Component testing best practices    </para>
</entry></row>
<row>
<entry thead="no"><para>Codecov   </para>
</entry><entry thead="no"><para>Coverage reporting integration   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
</sect2>
</sect1>
<sect1 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4466">
<title>7. User Interface Design</title><sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4467">
<title>7.1 Overview</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4468">
<title>7.1.1 Executive Summary</title><para>The Financial Asset Relationship Database implements a <bold>dual-UI architecture</bold> providing two distinct user interface experiences: a legacy <bold>Gradio UI</bold> for Python-native rapid prototyping and a modern <bold>Next.js Frontend</bold> for production-ready web deployment. Both interfaces share a common visualization foundation built on <bold>Plotly</bold> and expose the same underlying graph engine capabilities through different integration patterns.</para>
<para>This architectural decision enables the system to serve multiple user personas—from data scientists who prefer Python-centric workflows to enterprise users requiring polished web applications—while maintaining consistency in data visualization and business logic.</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4469">
<title>7.1.2 UI Architecture Overview</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Aspect   </para>
</entry><entry thead="yes"><para>Gradio UI   </para>
</entry><entry thead="yes"><para>Next.js Frontend    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Primary Use Case</bold>   </para>
</entry><entry thead="no"><para>Rapid prototyping, Python development   </para>
</entry><entry thead="no"><para>Production deployment, enterprise users    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Technology Stack</bold>   </para>
</entry><entry thead="no"><para>Python/Gradio/Plotly (server-side)   </para>
</entry><entry thead="no"><para>React/TypeScript/Tailwind/Plotly.js (client-side)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Integration Pattern</bold>   </para>
</entry><entry thead="no"><para>Direct Python function calls   </para>
</entry><entry thead="no"><para>REST API via FastAPI    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Default Port</bold>   </para>
</entry><entry thead="no"><para>7860   </para>
</entry><entry thead="no"><para>3000 (frontend) + 8000 (API)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Deployment Target</bold>   </para>
</entry><entry thead="no"><para>Local/Docker   </para>
</entry><entry thead="no"><para>Vercel Edge + FastAPI    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Responsive Design</bold>   </para>
</entry><entry thead="no"><para>Limited   </para>
</entry><entry thead="no"><para>Full mobile support   </para>
</entry></row>
</table>
</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>UserInterfaces[User<sp/>Interface<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>GradioUI[Gradio<sp/>UI<sp/>-<sp/>Port<sp/>7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GradioTabs[6<sp/>Tabbed<sp/>Sections]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GradioPlotly[Server-Side<sp/>Plotly]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>NextJSUI[Next.js<sp/>Frontend<sp/>-<sp/>Port<sp/>3000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReactComponents[React<sp/>Components]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClientPlotly[Client-Side<sp/>Plotly.js]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Integration[Integration<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DirectCall[Direct<sp/>Python<sp/>Calls]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RESTApi[REST<sp/>API<sp/>-<sp/>Port<sp/>8000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Backend[Backend<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphEngine[Graph<sp/>Engine]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Visualization[Visualization<sp/>Module]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Metrics[Metrics<sp/>Calculator]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GradioUI<sp/>--&gt;<sp/>DirectCall</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NextJSUI<sp/>--&gt;<sp/>RESTApi</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DirectCall<sp/>--&gt;<sp/>GraphEngine</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RESTApi<sp/>--&gt;<sp/>GraphEngine</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphEngine<sp/>--&gt;<sp/>Visualization</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphEngine<sp/>--&gt;<sp/>Metrics</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4471">
<title>7.2 Core UI Technologies</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4472">
<title>7.2.1 Next.js Frontend Technology Stack</title><para>The modern frontend is built on an enterprise-grade React framework stack optimized for performance, type safety, and developer experience.</para>
<para><table rows="8" cols="4"><row>
<entry thead="yes"><para>Technology   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Configuration Location    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Next.js</bold>   </para>
</entry><entry thead="no"><para>14.2.35   </para>
</entry><entry thead="no"><para>React meta-framework with App Router   </para>
</entry><entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>React</bold>   </para>
</entry><entry thead="no"><para>18.2.0   </para>
</entry><entry thead="no"><para>UI component library   </para>
</entry><entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>TypeScript</bold>   </para>
</entry><entry thead="no"><para>^5.3.0   </para>
</entry><entry thead="no"><para>Static type checking   </para>
</entry><entry thead="no"><para><computeroutput>frontend/tsconfig.json</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Tailwind CSS</bold>   </para>
</entry><entry thead="no"><para>3.3.0   </para>
</entry><entry thead="no"><para>Utility-first CSS framework   </para>
</entry><entry thead="no"><para><computeroutput>frontend/tailwind.config.js</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Plotly.js</bold>   </para>
</entry><entry thead="no"><para>^2.27.0   </para>
</entry><entry thead="no"><para>3D visualization rendering   </para>
</entry><entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>react-plotly.js</bold>   </para>
</entry><entry thead="no"><para>^2.6.0   </para>
</entry><entry thead="no"><para>React Plotly wrapper   </para>
</entry><entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Axios</bold>   </para>
</entry><entry thead="no"><para>Latest   </para>
</entry><entry thead="no"><para>HTTP client for API communication   </para>
</entry><entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>   </para>
</entry></row>
</table>
</para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4473">
<title>Framework Selection Rationale</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Framework   </para>
</entry><entry thead="yes"><para>Selection Criteria   </para>
</entry><entry thead="yes"><para>Benefit    </para>
</entry></row>
<row>
<entry thead="no"><para>Next.js 14   </para>
</entry><entry thead="no"><para>App Router, SSR capabilities, edge deployment   </para>
</entry><entry thead="no"><para>Modern React patterns with optimized bundling    </para>
</entry></row>
<row>
<entry thead="no"><para>TypeScript   </para>
</entry><entry thead="no"><para>Type safety across components and API contracts   </para>
</entry><entry thead="no"><para>Catch errors at compile time, improved IDE support    </para>
</entry></row>
<row>
<entry thead="no"><para>Tailwind CSS   </para>
</entry><entry thead="no"><para>Rapid UI development, consistent design system   </para>
</entry><entry thead="no"><para>Utility classes reduce CSS overhead    </para>
</entry></row>
<row>
<entry thead="no"><para>Plotly.js   </para>
</entry><entry thead="no"><para>Complex 3D visualization support   </para>
</entry><entry thead="no"><para>Interactive, zoom/rotate/hover capabilities   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4474">
<title>7.2.2 Gradio UI Technology Stack</title><para>The legacy UI provides a Python-native interface optimized for data science workflows and rapid prototyping.</para>
<para><table rows="3" cols="4"><row>
<entry thead="yes"><para>Technology   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Configuration Location    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Gradio</bold>   </para>
</entry><entry thead="no"><para>≥4.0.0,&lt;6.0.0   </para>
</entry><entry thead="no"><para>Python-native web interface   </para>
</entry><entry thead="no"><para><computeroutput>requirements.txt</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Plotly</bold>   </para>
</entry><entry thead="no"><para>≥6.0.0   </para>
</entry><entry thead="no"><para>Server-side visualization   </para>
</entry><entry thead="no"><para><computeroutput>requirements.txt</computeroutput>   </para>
</entry></row>
</table>
</para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4475">
<title>Gradio Selection Rationale</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Capability   </para>
</entry><entry thead="yes"><para>Value Proposition    </para>
</entry></row>
<row>
<entry thead="no"><para>Zero Frontend Setup   </para>
</entry><entry thead="no"><para>Python developers can create UIs without JavaScript knowledge    </para>
</entry></row>
<row>
<entry thead="no"><para>Rapid Prototyping   </para>
</entry><entry thead="no"><para>Interactive UIs from Python functions in minutes    </para>
</entry></row>
<row>
<entry thead="no"><para>Direct Python Integration   </para>
</entry><entry thead="no"><para>No API serialization overhead for development    </para>
</entry></row>
<row>
<entry thead="no"><para>Component Library   </para>
</entry><entry thead="no"><para>Pre-built UI widgets for common visualization patterns   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4476">
<title>7.2.3 Shared Visualization Foundation</title><para>Both UI implementations leverage Plotly for visualization rendering, ensuring visual consistency across platforms:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>VisualizationLayer[Shared<sp/>Visualization<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ColorScheme[Asset<sp/>Color<sp/>Mapping]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>EdgeColors[Relationship<sp/>Colors]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LayoutEngine[3D<sp/>Layout<sp/>Calculator]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ServerSide[Server-Side<sp/>-<sp/>Gradio]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PlotlyPython[Plotly<sp/>Python<sp/>≥6.0.0]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ClientSide[Client-Side<sp/>-<sp/>Next.js]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PlotlyJS[Plotly.js<sp/>^2.27.0]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReactPlotly[react-plotly.js]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>VisualizationLayer<sp/>--&gt;<sp/>PlotlyPython</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>VisualizationLayer<sp/>--&gt;<sp/>PlotlyJS</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PlotlyJS<sp/>--&gt;<sp/>ReactPlotly</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4478">
<title>7.3 UI Use Cases and Screens</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4479">
<title>7.3.1 Next.js Frontend Screens</title><para>The Next.js frontend implements three primary views accessible via tab navigation:</para>
<para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Tab   </para>
</entry><entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Location   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>3D Visualization</bold>   </para>
</entry><entry thead="no"><para><computeroutput>NetworkVisualization</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/components/NetworkVisualization.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Interactive 3D graph of asset relationships    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Metrics &amp; Analytics</bold>   </para>
</entry><entry thead="no"><para><computeroutput>MetricsDashboard</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/components/MetricsDashboard.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Grid display of network statistics    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Asset Explorer</bold>   </para>
</entry><entry thead="no"><para><computeroutput>AssetList</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/components/AssetList.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Filterable, paginated asset table   </para>
</entry></row>
</table>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4480">
<title>Next.js Screen Structure</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>NextJSApp[Next.js<sp/>Application<sp/>Structure]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RootLayout[Root<sp/>Layout&lt;br/&gt;layout.tsx]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>HomePage[Home<sp/>Page<sp/>-<sp/>page.tsx]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TabNav[Tab<sp/>Navigation]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>TabContent[Tab<sp/>Content<sp/>Area]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VizTab[3D<sp/>Visualization<sp/>Tab]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MetricsTab[Metrics<sp/>Tab]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AssetsTab[Asset<sp/>Explorer<sp/>Tab]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RootLayout<sp/>--&gt;<sp/>HomePage</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TabNav<sp/>--&gt;<sp/>VizTab</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TabNav<sp/>--&gt;<sp/>MetricsTab</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TabNav<sp/>--&gt;<sp/>AssetsTab</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Components[Component<sp/>Library]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NetworkViz[NetworkVisualization.tsx]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MetricsDash[MetricsDashboard.tsx]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AssetsList[AssetList.tsx]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>VizTab<sp/>--&gt;<sp/>NetworkViz</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>MetricsTab<sp/>--&gt;<sp/>MetricsDash</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AssetsTab<sp/>--&gt;<sp/>AssetsList</highlight></codeline>
</programlisting></para>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4481">
<title>7.3.2 Gradio UI Screens</title><para>The Gradio interface implements six tabbed sections providing comprehensive access to all system capabilities:</para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Tab   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Primary Components    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>🌐 Network Visualization (2D/3D)</bold>   </para>
</entry><entry thead="no"><para>Interactive network graph with filtering   </para>
</entry><entry thead="no"><para>Plot, Radio buttons, Checkboxes    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Metrics &amp; Analytics</bold>   </para>
</entry><entry thead="no"><para>Distribution charts and statistics   </para>
</entry><entry thead="no"><para>Multiple Plot components    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Schema &amp; Rules</bold>   </para>
</entry><entry thead="no"><para>Auto-generated data model documentation   </para>
</entry><entry thead="no"><para>Markdown display    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Asset Explorer</bold>   </para>
</entry><entry thead="no"><para>Asset detail viewer   </para>
</entry><entry thead="no"><para>Dropdown, JSON displays    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Documentation</bold>   </para>
</entry><entry thead="no"><para>Static help documentation   </para>
</entry><entry thead="no"><para>Markdown display    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>📊 Formulaic Analysis</bold>   </para>
</entry><entry thead="no"><para>Mathematical formula dashboard   </para>
</entry><entry thead="no"><para>Plots, Dropdown, Textbox   </para>
</entry></row>
</table>
</para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4482">
<title>Gradio Tab Architecture</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>GradioApp[Gradio<sp/>Application<sp/>-<sp/>app.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Blocks[gr.Blocks<sp/>Container]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Tabs[Tab<sp/>Navigation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Tab1[🌐<sp/>Network<sp/>Visualization]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Tab2[Metrics<sp/>&amp;<sp/>Analytics]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Tab3[Schema<sp/>&amp;<sp/>Rules]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Tab4[Asset<sp/>Explorer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Tab5[Documentation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Tab6[📊<sp/>Formulaic<sp/>Analysis]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Blocks<sp/>--&gt;<sp/>Tabs</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Tab1Content[Network<sp/>Visualization<sp/>Content]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ViewMode[2D/3D<sp/>Toggle]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LayoutType[Layout<sp/>Selector]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RelFilters[8<sp/>Relationship<sp/>Checkboxes]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphPlot[Network<sp/>Graph<sp/>Plot]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Tab6Content[Formulaic<sp/>Analysis<sp/>Content]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Dashboard[Dashboard<sp/>Plot]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CorrelationNet[Correlation<sp/>Network]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FormulaSelect[Formula<sp/>Selector]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FormulaDetails[Formula<sp/>Details]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Tab1<sp/>--&gt;<sp/>Tab1Content</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Tab6<sp/>--&gt;<sp/>Tab6Content</highlight></codeline>
</programlisting></para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4483">
<title>7.3.3 Feature Parity Matrix</title><para><table rows="15" cols="4"><row>
<entry thead="yes"><para>Feature   </para>
</entry><entry thead="yes" align='center'><para>Gradio UI   </para>
</entry><entry thead="yes" align='center'><para>Next.js UI   </para>
</entry><entry thead="yes"><para>Notes    </para>
</entry></row>
<row>
<entry thead="no"><para>3D Network Visualization   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no"><para>Both use Plotly    </para>
</entry></row>
<row>
<entry thead="no"><para>2D Network Visualization   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no" align='center'><para>❌   </para>
</entry><entry thead="no"><para>Gradio-only    </para>
</entry></row>
<row>
<entry thead="no"><para>Metrics Dashboard   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no"><para>Different layouts    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset Explorer   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no"><para>Next.js has better filtering    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset Class Filtering   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no"><para>URL-synced in Next.js    </para>
</entry></row>
<row>
<entry thead="no"><para>Sector Filtering   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no"><para>URL-synced in Next.js    </para>
</entry></row>
<row>
<entry thead="no"><para>Pagination   </para>
</entry><entry thead="no" align='center'><para>❌   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no"><para>Next.js only    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Filtering   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no" align='center'><para>❌   </para>
</entry><entry thead="no"><para>8 checkboxes in Gradio    </para>
</entry></row>
<row>
<entry thead="no"><para>Schema Report   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no" align='center'><para>❌   </para>
</entry><entry thead="no"><para>Gradio-only    </para>
</entry></row>
<row>
<entry thead="no"><para>Documentation Tab   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no" align='center'><para>❌   </para>
</entry><entry thead="no"><para>Gradio-only    </para>
</entry></row>
<row>
<entry thead="no"><para>Formulaic Analysis   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no" align='center'><para>❌   </para>
</entry><entry thead="no"><para>Advanced analytics    </para>
</entry></row>
<row>
<entry thead="no"><para>Mobile Responsive   </para>
</entry><entry thead="no" align='center'><para>⚠️ Limited   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no"><para>Full Tailwind support    </para>
</entry></row>
<row>
<entry thead="no"><para>Custom Branding   </para>
</entry><entry thead="no" align='center'><para>⚠️ Limited   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no"><para>Full CSS control    </para>
</entry></row>
<row>
<entry thead="no"><para>REST API Access   </para>
</entry><entry thead="no" align='center'><para>❌   </para>
</entry><entry thead="no" align='center'><para>✅   </para>
</entry><entry thead="no"><para>Frontend API client   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4485">
<title>7.4 UI/Backend Interaction Boundaries</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4486">
<title>7.4.1 Next.js ↔ FastAPI Interaction</title><para>The Next.js frontend communicates with the FastAPI backend via HTTP/JSON through a typed API client layer.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">sequenceDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>User<sp/>as<sp/>User<sp/>Browser</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Page<sp/>as<sp/>Next.js<sp/>Page</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Client<sp/>as<sp/>API<sp/>Client&lt;br/&gt;(api.ts)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Axios<sp/>as<sp/>Axios<sp/>HTTP</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Backend<sp/>as<sp/>FastAPI&lt;br/&gt;(Port<sp/>8000)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>participant<sp/>Graph<sp/>as<sp/>Graph<sp/>Engine</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>User-&gt;&gt;Page:<sp/>Navigate<sp/>to<sp/>Page</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Page-&gt;&gt;Page:<sp/>useEffect<sp/>Hook</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>par<sp/>Parallel<sp/>Data<sp/>Fetch</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Page-&gt;&gt;Client:<sp/>getMetrics()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Client-&gt;&gt;Axios:<sp/>GET<sp/>/api/metrics</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Axios-&gt;&gt;Backend:<sp/>HTTP<sp/>Request</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Backend-&gt;&gt;Graph:<sp/>calculate_metrics()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph--&gt;&gt;Backend:<sp/>Metrics<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Backend--&gt;&gt;Axios:<sp/>JSON<sp/>Response</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Axios--&gt;&gt;Client:<sp/>Response<sp/>Object</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Client--&gt;&gt;Page:<sp/>Metrics</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>and</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Page-&gt;&gt;Client:<sp/>getVisualizationData()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Client-&gt;&gt;Axios:<sp/>GET<sp/>/api/visualization</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Axios-&gt;&gt;Backend:<sp/>HTTP<sp/>Request</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Backend-&gt;&gt;Graph:<sp/>get_3d_visualization_data()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph--&gt;&gt;Backend:<sp/>Node/Edge<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Backend--&gt;&gt;Axios:<sp/>JSON<sp/>Response</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Axios--&gt;&gt;Client:<sp/>Response<sp/>Object</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Client--&gt;&gt;Page:<sp/>Visualization<sp/>Data</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Page-&gt;&gt;Page:<sp/>setState(data)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Page-&gt;&gt;User:<sp/>Render<sp/>Components</highlight></codeline>
</programlisting></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4487">
<title>API Client Configuration</title><para><bold>Location</bold>: <computeroutput>frontend/app/lib/api.ts</computeroutput></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><ref refid="classBase" kindref="compound">Base</ref> URL   </para>
</entry><entry thead="no"><para><computeroutput><ulink url="http://localhost:8000">http://localhost:8000</ulink></computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI server address    </para>
</entry></row>
<row>
<entry thead="no"><para>Timeout   </para>
</entry><entry thead="no"><para>Default (Axios)   </para>
</entry><entry thead="no"><para>Request timeout handling    </para>
</entry></row>
<row>
<entry thead="no"><para>Error Handling   </para>
</entry><entry thead="no"><para>Try/catch with console.error   </para>
</entry><entry thead="no"><para>Development debugging   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4488">
<title>REST Endpoint Consumption</title><para><table rows="12" cols="4"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Method   </para>
</entry><entry thead="yes"><para>Frontend Usage   </para>
</entry><entry thead="yes"><para>Component    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/health</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Health check   </para>
</entry><entry thead="no"><para>Page load validation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Asset list with filters   </para>
</entry><entry thead="no"><para><computeroutput>AssetList.tsx</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets/{id}</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Single asset details   </para>
</entry><entry thead="no"><para>Asset detail view    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets/{id}/relationships</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Asset relationships   </para>
</entry><entry thead="no"><para>Relationship display    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/relationships</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>All relationships   </para>
</entry><entry thead="no"><para>Visualization edges    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/metrics</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Network statistics   </para>
</entry><entry thead="no"><para><computeroutput>MetricsDashboard.tsx</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/visualization</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>3D graph data   </para>
</entry><entry thead="no"><para><computeroutput>NetworkVisualization.tsx</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/asset-classes</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Filter dropdown options   </para>
</entry><entry thead="no"><para><computeroutput>AssetList.tsx</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/sectors</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Filter dropdown options   </para>
</entry><entry thead="no"><para><computeroutput>AssetList.tsx</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/token</computeroutput>   </para>
</entry><entry thead="no"><para>POST   </para>
</entry><entry thead="no"><para>JWT authentication   </para>
</entry><entry thead="no"><para>Auth flows    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/users/me</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Current user info   </para>
</entry><entry thead="no"><para>User profile   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4489">
<title>Security Boundaries</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Security Control   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Location    </para>
</entry></row>
<row>
<entry thead="no"><para>CORS   </para>
</entry><entry thead="no"><para>Origin allowlist validation   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limiting   </para>
</entry><entry thead="no"><para>IP-based throttling   </para>
</entry><entry thead="no"><para><computeroutput>/token</computeroutput>: 5/min, <computeroutput>/api/users/me</computeroutput>: 10/min    </para>
</entry></row>
<row>
<entry thead="no"><para>JWT Authentication   </para>
</entry><entry thead="no"><para>Bearer token header   </para>
</entry><entry thead="no"><para>Protected endpoints    </para>
</entry></row>
<row>
<entry thead="no"><para>Input Validation   </para>
</entry><entry thead="no"><para>Pydantic models   </para>
</entry><entry thead="no"><para>All API endpoints   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4490">
<title>7.4.2 Gradio ↔ Python Core Interaction</title><para>The Gradio UI bypasses the REST API, directly invoking Python functions from the core library.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>GradioUI[Gradio<sp/>UI<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>EventHandler[Event<sp/>Handlers]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Components[UI<sp/>Components]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>CorePython[Python<sp/>Core<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphVisuals[graph_visuals.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MetricVisuals[metric_visuals.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SchemaReport[schema_report.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FormulaicVisuals[formulaic_visuals.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AssetGraph[asset_graph.py]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>EventHandler<sp/>--&gt;|Direct<sp/>Import|<sp/>GraphVisuals</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>EventHandler<sp/>--&gt;|Direct<sp/>Import|<sp/>MetricVisuals</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>EventHandler<sp/>--&gt;|Direct<sp/>Import|<sp/>SchemaReport</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>EventHandler<sp/>--&gt;|Direct<sp/>Import|<sp/>FormulaicVisuals</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>EventHandler<sp/>--&gt;|Direct<sp/>Import|<sp/>AssetGraph</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GraphVisuals<sp/>--&gt;<sp/>Components</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>MetricVisuals<sp/>--&gt;<sp/>Components</highlight></codeline>
</programlisting></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4491">
<title>Direct Integration Pattern</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>UI Action   </para>
</entry><entry thead="yes"><para>Python Function Call   </para>
</entry><entry thead="yes"><para>Source Module    </para>
</entry></row>
<row>
<entry thead="no"><para>Refresh Visualization   </para>
</entry><entry thead="no"><para><computeroutput>generate_3d_network_graph()</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="graph__visuals_8py" kindref="compound">src/visualizations/graph_visuals.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Update Metrics   </para>
</entry><entry thead="no"><para><computeroutput>create_metric_visuals()</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="metric__visuals_8py" kindref="compound">src/visualizations/metric_visuals.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Generate Schema   </para>
</entry><entry thead="no"><para><computeroutput>SchemaReport.generate_report()</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="schema__report_8py" kindref="compound">src/reports/schema_report.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Load Asset Details   </para>
</entry><entry thead="no"><para><computeroutput>graph.get_asset()</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Formulaic Dashboard   </para>
</entry><entry thead="no"><para><computeroutput>create_formulaic_dashboard()</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="formulaic__visuals_8py" kindref="compound">src/visualizations/formulaic_visuals.py</ref></computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4492">
<title>7.4.3 Visualization Data Guardrails</title><para>Both UIs implement performance guardrails to prevent browser/client overload with large datasets:</para>
<para><table rows="3" cols="4"><row>
<entry thead="yes"><para>Guardrail   </para>
</entry><entry thead="yes"><para>Next.js Value   </para>
</entry><entry thead="yes"><para>Environment Variable   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Maximum Nodes   </para>
</entry><entry thead="no"><para>500 (default)   </para>
</entry><entry thead="no"><para><computeroutput>NEXT_PUBLIC_MAX_NODES</computeroutput>   </para>
</entry><entry thead="no"><para>Client rendering limit    </para>
</entry></row>
<row>
<entry thead="no"><para>Maximum Edges   </para>
</entry><entry thead="no"><para>2000 (default)   </para>
</entry><entry thead="no"><para><computeroutput>NEXT_PUBLIC_MAX_EDGES</computeroutput>   </para>
</entry><entry thead="no"><para>Edge complexity limit   </para>
</entry></row>
</table>
</para>
<para><bold>Implementation Location</bold>: <computeroutput>frontend/app/components/NetworkVisualization.tsx</computeroutput></para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4494">
<title>7.5 UI Schemas and Type Definitions</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4495">
<title>7.5.1 TypeScript API Contracts</title><para>The Next.js frontend defines strict TypeScript interfaces for all API interactions, ensuring type safety across the frontend-backend boundary.</para>
<para><bold>Location</bold>: <computeroutput>frontend/app/types/api.ts</computeroutput></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4496">
<title>Core Entity Types</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">classDiagram</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>class<sp/>Asset<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>id</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>symbol</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>name</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>asset_class</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>sector</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+number<sp/>price</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+number?<sp/>market_cap</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>currency</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Record~string,any~<sp/>additional_fields</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>class<sp/>Relationship<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>source_id</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>target_id</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>relationship_type</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+number<sp/>strength</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>class<sp/>Metrics<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+number<sp/>total_assets</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+number<sp/>total_relationships</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+Record~string,number~<sp/>asset_classes</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+number<sp/>avg_degree</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+number<sp/>max_degree</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+number<sp/>network_density</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>class<sp/>VisualizationNode<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>id</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>name</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>symbol</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>asset_class</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+number<sp/>x</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+number<sp/>y</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+number<sp/>z</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>color</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+number<sp/>size</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>class<sp/>VisualizationEdge<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>source</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>target</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+string<sp/>relationship_type</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+number<sp/>strength</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>class<sp/>VisualizationData<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+VisualizationNode[]<sp/>nodes</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+VisualizationEdge[]<sp/>edges</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>VisualizationData<sp/>*--<sp/>VisualizationNode</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>VisualizationData<sp/>*--<sp/>VisualizationEdge</highlight></codeline>
</programlisting></para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4497">
<title>7.5.2 Pydantic Response Models</title><para>The FastAPI backend defines Pydantic models that serialize Python objects to JSON responses consumed by the frontend.</para>
<para><bold>Location</bold>: <computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput></para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Model   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Key Fields    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>AssetResponse</computeroutput>   </para>
</entry><entry thead="no"><para>Single asset serialization   </para>
</entry><entry thead="no"><para><computeroutput>id</computeroutput>, <computeroutput>symbol</computeroutput>, <computeroutput>name</computeroutput>, <computeroutput>asset_class</computeroutput>, <computeroutput>sector</computeroutput>, <computeroutput>price</computeroutput>, <computeroutput>market_cap</computeroutput>, <computeroutput>currency</computeroutput>, <computeroutput>additional_fields</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>RelationshipResponse</computeroutput>   </para>
</entry><entry thead="no"><para>Relationship edge data   </para>
</entry><entry thead="no"><para><computeroutput>source_id</computeroutput>, <computeroutput>target_id</computeroutput>, <computeroutput>relationship_type</computeroutput>, <computeroutput>strength</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>MetricsResponse</computeroutput>   </para>
</entry><entry thead="no"><para>Network statistics   </para>
</entry><entry thead="no"><para><computeroutput>total_assets</computeroutput>, <computeroutput>total_relationships</computeroutput>, <computeroutput>asset_classes</computeroutput>, <computeroutput>avg_degree</computeroutput>, <computeroutput>max_degree</computeroutput>, <computeroutput>network_density</computeroutput>, <computeroutput>relationship_density</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>VisualizationDataResponse</computeroutput>   </para>
</entry><entry thead="no"><para>3D graph payload   </para>
</entry><entry thead="no"><para><computeroutput>nodes: List[Dict]</computeroutput>, <computeroutput>edges: List[Dict]</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4498">
<title>7.5.3 Type Contract Alignment</title><para>The TypeScript and Pydantic models maintain structural alignment to ensure seamless serialization:</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>TypeScript Type   </para>
</entry><entry thead="yes"><para>Pydantic Model   </para>
</entry><entry thead="yes"><para>Validation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Asset</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>AssetResponse</computeroutput>   </para>
</entry><entry thead="no"><para>✅ Aligned    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Relationship</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>RelationshipResponse</computeroutput>   </para>
</entry><entry thead="no"><para>✅ Aligned    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Metrics</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>MetricsResponse</computeroutput>   </para>
</entry><entry thead="no"><para>✅ Aligned    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>VisualizationData</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>VisualizationDataResponse</computeroutput>   </para>
</entry><entry thead="no"><para>✅ Aligned   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4500">
<title>7.6 Screen Specifications</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4501">
<title>7.6.1 Next.js: 3D Visualization Screen</title><para><bold>Component</bold>: <computeroutput>NetworkVisualization.tsx</computeroutput></para>
<para><bold>Location</bold>: <computeroutput>frontend/app/components/NetworkVisualization.tsx</computeroutput></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4502">
<title>Screen States</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>State   </para>
</entry><entry thead="yes"><para>Condition   </para>
</entry><entry thead="yes"><para>Display    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>loading</computeroutput>   </para>
</entry><entry thead="no"><para>Data fetching in progress   </para>
</entry><entry thead="no"><para>Loading spinner    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ready</computeroutput>   </para>
</entry><entry thead="no"><para>Data loaded, within limits   </para>
</entry><entry thead="no"><para>Interactive 3D graph    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>empty</computeroutput>   </para>
</entry><entry thead="no"><para>No nodes returned   </para>
</entry><entry thead="no"><para>&quot;No data available&quot; message    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>tooLarge</computeroutput>   </para>
</entry><entry thead="no"><para>Nodes &gt; MAX_NODES or Edges &gt; MAX_EDGES   </para>
</entry><entry thead="no"><para>Size warning with counts   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4503">
<title>Visual Elements</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Element   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Interaction    </para>
</entry></row>
<row>
<entry thead="no"><para>3D Node Graph   </para>
</entry><entry thead="no"><para>Plotly Scatter3d traces   </para>
</entry><entry thead="no"><para>Rotate, zoom, pan    </para>
</entry></row>
<row>
<entry thead="no"><para>Node Markers   </para>
</entry><entry thead="no"><para>Color-coded by asset class   </para>
</entry><entry thead="no"><para>Hover for tooltip    </para>
</entry></row>
<row>
<entry thead="no"><para>Edge Lines   </para>
</entry><entry thead="no"><para>Colored by relationship type   </para>
</entry><entry thead="no"><para>Visual connection    </para>
</entry></row>
<row>
<entry thead="no"><para>Hover Tooltip   </para>
</entry><entry thead="no"><para>Asset symbol, name, class   </para>
</entry><entry thead="no"><para>On node hover   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4504">
<title>Dynamic Import Pattern</title><para>The Plotly component uses Next.js dynamic import with SSR disabled to prevent server-side rendering errors:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>SSRSafety[SSR<sp/>Safety<sp/>Pattern]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DynamicImport[dynamic<sp/>import&lt;br/&gt;ssr:<sp/>false]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClientOnly[Client-Only<sp/>Rendering]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PlotlyLoad[Plotly.js<sp/>Load]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphRender[3D<sp/>Graph<sp/>Render]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DynamicImport<sp/>--&gt;<sp/>ClientOnly</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ClientOnly<sp/>--&gt;<sp/>PlotlyLoad</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PlotlyLoad<sp/>--&gt;<sp/>GraphRender</highlight></codeline>
</programlisting></para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4505">
<title>7.6.2 Next.js: Metrics Dashboard Screen</title><para><bold>Component</bold>: <computeroutput>MetricsDashboard.tsx</computeroutput></para>
<para><bold>Location</bold>: <computeroutput>frontend/app/components/MetricsDashboard.tsx</computeroutput></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4506">
<title>Metrics Display Grid</title><para><table rows="7" cols="4"><row>
<entry thead="yes"><para>Metric   </para>
</entry><entry thead="yes"><para>Label   </para>
</entry><entry thead="yes"><para>Format   </para>
</entry><entry thead="yes"><para>Grid Position    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>total_assets</computeroutput>   </para>
</entry><entry thead="no"><para>Total Assets   </para>
</entry><entry thead="no"><para>Integer   </para>
</entry><entry thead="no"><para>Row 1, Col 1    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>total_relationships</computeroutput>   </para>
</entry><entry thead="no"><para>Total Relationships   </para>
</entry><entry thead="no"><para>Integer   </para>
</entry><entry thead="no"><para>Row 1, Col 2    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>avg_degree</computeroutput>   </para>
</entry><entry thead="no"><para>Average Degree   </para>
</entry><entry thead="no"><para>2 decimal places   </para>
</entry><entry thead="no"><para>Row 1, Col 3    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>max_degree</computeroutput>   </para>
</entry><entry thead="no"><para>Maximum Degree   </para>
</entry><entry thead="no"><para>Integer   </para>
</entry><entry thead="no"><para>Row 2, Col 1    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>network_density</computeroutput>   </para>
</entry><entry thead="no"><para>Network Density   </para>
</entry><entry thead="no"><para>Percentage (×100)   </para>
</entry><entry thead="no"><para>Row 2, Col 2    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>relationship_density</computeroutput>   </para>
</entry><entry thead="no"><para>Relationship Density   </para>
</entry><entry thead="no"><para>Percentage (×100)   </para>
</entry><entry thead="no"><para>Row 2, Col 3   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4507">
<title>Asset Class Distribution</title><para>The component renders asset class counts from the <computeroutput>asset_classes</computeroutput> dictionary:</para>
<para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Asset Class   </para>
</entry><entry thead="yes"><para>Display Color   </para>
</entry><entry thead="yes"><para>Source Key    </para>
</entry></row>
<row>
<entry thead="no"><para>Equity   </para>
</entry><entry thead="no"><para>Blue   </para>
</entry><entry thead="no"><para><computeroutput>asset_classes.Equity</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Fixed Income   </para>
</entry><entry thead="no"><para>Green   </para>
</entry><entry thead="no"><para><lsquo/>asset_classes[&apos;Fixed Income<rsquo/>]<computeroutput>\ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;markdownTableRowOdd&quot;&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Commodity \ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Orange \ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt;</computeroutput>asset_classes.Commodity<computeroutput>\ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;markdownTableRowEven&quot;&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Currency \ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Red \ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt;</computeroutput>asset_classes.Currency<computeroutput>\ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;markdownTableRowOdd&quot;&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Derivative \ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt; Purple \ilinebr &lt;/td&gt; &lt;td class=&quot;markdownTableBodyNone&quot;&gt;</computeroutput>asset_classes.Derivative`   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4508">
<title>7.6.3 Next.js: Asset Explorer Screen</title><para><bold>Component</bold>: <computeroutput>AssetList.tsx</computeroutput></para>
<para><bold>Location</bold>: <computeroutput>frontend/app/components/AssetList.tsx</computeroutput></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4509">
<title>Filter Controls</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Control   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Options   </para>
</entry><entry thead="yes"><para>State Management    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset Class Filter   </para>
</entry><entry thead="no"><para>Dropdown Select   </para>
</entry><entry thead="no"><para>All asset classes + &quot;All&quot;   </para>
</entry><entry thead="no"><para>URL query param    </para>
</entry></row>
<row>
<entry thead="no"><para>Sector Filter   </para>
</entry><entry thead="no"><para>Dropdown Select   </para>
</entry><entry thead="no"><para>All sectors + &quot;All&quot;   </para>
</entry><entry thead="no"><para>URL query param    </para>
</entry></row>
<row>
<entry thead="no"><para>Page Size   </para>
</entry><entry thead="no"><para>Dropdown Select   </para>
</entry><entry thead="no"><para>10, 20, 50, 100   </para>
</entry><entry thead="no"><para>Component state   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4510">
<title>URL State Synchronization</title><para>The Asset Explorer implements URL-synced state using Next.js navigation hooks:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>URLState[URL<sp/>State<sp/>Management]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>URLParams[URL<sp/>Search<sp/>Params]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ComponentState[React<sp/>Component<sp/>State]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FilterControls[Filter<sp/>Dropdowns]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>URLParams<sp/>--&gt;|Read<sp/>on<sp/>mount|<sp/>ComponentState</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FilterControls<sp/>--&gt;|onChange|<sp/>URLParams</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>URLParams<sp/>--&gt;|Browser<sp/>history|<sp/>Navigation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ComponentState<sp/>--&gt;|Render|<sp/>FilterControls</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4511">
<title>Table Columns</title><para><table rows="7" cols="4"><row>
<entry thead="yes"><para>Column   </para>
</entry><entry thead="yes"><para>Field   </para>
</entry><entry thead="yes"><para>Width   </para>
</entry><entry thead="yes"><para>Sortable    </para>
</entry></row>
<row>
<entry thead="no"><para>Symbol   </para>
</entry><entry thead="no"><para><computeroutput>symbol</computeroutput>   </para>
</entry><entry thead="no"><para>Auto   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para>Name   </para>
</entry><entry thead="no"><para><computeroutput>name</computeroutput>   </para>
</entry><entry thead="no"><para>Auto   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset Class   </para>
</entry><entry thead="no"><para><computeroutput>asset_class</computeroutput>   </para>
</entry><entry thead="no"><para>Auto   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para>Sector   </para>
</entry><entry thead="no"><para><computeroutput>sector</computeroutput>   </para>
</entry><entry thead="no"><para>Auto   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para>Price   </para>
</entry><entry thead="no"><para><computeroutput>price</computeroutput>   </para>
</entry><entry thead="no"><para>Auto   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para>Market Cap   </para>
</entry><entry thead="no"><para><computeroutput>market_cap</computeroutput>   </para>
</entry><entry thead="no"><para>Auto   </para>
</entry><entry thead="no"><para>No   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4512">
<title>Pagination Controls</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Control   </para>
</entry><entry thead="yes"><para>Behavior   </para>
</entry><entry thead="yes"><para>Disabled Condition    </para>
</entry></row>
<row>
<entry thead="no"><para>Previous Button   </para>
</entry><entry thead="no"><para>Decrement page   </para>
</entry><entry thead="no"><para><computeroutput>page === 1</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Next Button   </para>
</entry><entry thead="no"><para>Increment page   </para>
</entry><entry thead="no"><para><computeroutput>page &gt;= totalPages</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Page Indicator   </para>
</entry><entry thead="no"><para>&quot;Page X of Y&quot;   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4513">
<title>7.6.4 Gradio: Network Visualization Tab</title><para><bold>Location</bold>: <computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput> (lines 386-450)</para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4514">
<title>Control Panel</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Control   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Options   </para>
</entry><entry thead="yes"><para>Default    </para>
</entry></row>
<row>
<entry thead="no"><para>View Mode   </para>
</entry><entry thead="no"><para>Radio   </para>
</entry><entry thead="no"><para>&quot;3D View&quot;, &quot;2D View&quot;   </para>
</entry><entry thead="no"><para>&quot;3D View&quot;    </para>
</entry></row>
<row>
<entry thead="no"><para>Layout Type   </para>
</entry><entry thead="no"><para>Dropdown   </para>
</entry><entry thead="no"><para>&quot;spring&quot;, &quot;circular&quot;, &quot;grid&quot;   </para>
</entry><entry thead="no"><para>&quot;spring&quot;    </para>
</entry></row>
<row>
<entry thead="no"><para>Show Direction Arrows   </para>
</entry><entry thead="no"><para>Checkbox   </para>
</entry><entry thead="no"><para>Boolean   </para>
</entry><entry thead="no"><para><computeroutput>True</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4515">
<title>Relationship Visibility Checkboxes</title><para><table rows="9" cols="3"><row>
<entry thead="yes"><para>Checkbox   </para>
</entry><entry thead="yes"><para>Relationship Type   </para>
</entry><entry thead="yes"><para>Default    </para>
</entry></row>
<row>
<entry thead="no"><para>Same Sector   </para>
</entry><entry thead="no"><para><computeroutput>same_sector</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>True</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Market Cap Similar   </para>
</entry><entry thead="no"><para><computeroutput>market_cap_similar</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>True</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Correlation   </para>
</entry><entry thead="no"><para><computeroutput>correlation</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>True</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Corporate Bond → Equity   </para>
</entry><entry thead="no"><para><computeroutput>corporate_bond_to_equity</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>True</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Commodity ↔ Currency   </para>
</entry><entry thead="no"><para><computeroutput>commodity_currency</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>True</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Income Comparison   </para>
</entry><entry thead="no"><para><computeroutput>income_comparison</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>True</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Regulatory Impact   </para>
</entry><entry thead="no"><para><computeroutput>regulatory_impact</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>True</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Show All Relationships   </para>
</entry><entry thead="no"><para>All types   </para>
</entry><entry thead="no"><para><computeroutput>False</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4516">
<title>Action Buttons</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Button   </para>
</entry><entry thead="yes"><para>Function   </para>
</entry><entry thead="yes"><para>Behavior    </para>
</entry></row>
<row>
<entry thead="no"><para>Refresh   </para>
</entry><entry thead="no"><para><computeroutput>refresh_all_outputs()</computeroutput>   </para>
</entry><entry thead="no"><para>Regenerate all visualizations    </para>
</entry></row>
<row>
<entry thead="no"><para>Reset View   </para>
</entry><entry thead="no"><para><computeroutput>reset_visualization()</computeroutput>   </para>
</entry><entry thead="no"><para>Clear filters, restore defaults   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4517">
<title>7.6.5 Gradio: Formulaic Analysis Tab</title><para><bold>Location</bold>: <computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput> (lines 520-590)</para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4518">
<title>Dashboard Components</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Content    </para>
</entry></row>
<row>
<entry thead="no"><para>Formula Dashboard   </para>
</entry><entry thead="no"><para>Plot   </para>
</entry><entry thead="no"><para>Overview of all formula categories    </para>
</entry></row>
<row>
<entry thead="no"><para>Correlation Network   </para>
</entry><entry thead="no"><para>Plot   </para>
</entry><entry thead="no"><para>Asset correlation visualization    </para>
</entry></row>
<row>
<entry thead="no"><para>Metric Comparison   </para>
</entry><entry thead="no"><para>Plot   </para>
</entry><entry thead="no"><para>Formula metric comparisons    </para>
</entry></row>
<row>
<entry thead="no"><para>Formula Selector   </para>
</entry><entry thead="no"><para>Dropdown   </para>
</entry><entry thead="no"><para>Individual formula selection    </para>
</entry></row>
<row>
<entry thead="no"><para>Formula Details   </para>
</entry><entry thead="no"><para>Textbox   </para>
</entry><entry thead="no"><para>LaTeX formula, variables, example    </para>
</entry></row>
<row>
<entry thead="no"><para>Summary   </para>
</entry><entry thead="no"><para>Textbox   </para>
</entry><entry thead="no"><para>Analysis summary text   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4520">
<title>7.7 User Interactions</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4521">
<title>7.7.1 Next.js Page Load Flow</title><para>The Next.js frontend implements a client-side data loading pattern with comprehensive error handling and retry capabilities.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>NextJSPageLoad[Next.js<sp/>Page<sp/>Load<sp/>Workflow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PageMount([Page<sp/>Mount])<sp/>--&gt;<sp/>SetLoading[Set<sp/>Loading&lt;br/&gt;State<sp/>=<sp/>true]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetLoading<sp/>--&gt;<sp/>FetchData[Promise.all:&lt;br/&gt;getMetrics()&lt;br/&gt;getVisualizationData()]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FetchData<sp/>--&gt;<sp/>FetchResult{Fetch&lt;br/&gt;Successful?}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FetchResult<sp/>--&gt;|Yes|<sp/>StoreData[Store<sp/>Data&lt;br/&gt;in<sp/>State]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>StoreData<sp/>--&gt;<sp/>ClearLoading[Clear<sp/>Loading&lt;br/&gt;State]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClearLoading<sp/>--&gt;<sp/>RenderUI[Render<sp/>UI&lt;br/&gt;Components]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RenderUI<sp/>--&gt;<sp/>PageReady([Page<sp/>Ready])</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FetchResult<sp/>--&gt;|No|<sp/>SetError[Set<sp/>Error&lt;br/&gt;State]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetError<sp/>--&gt;<sp/>ShowRetry[Show<sp/>Retry&lt;br/&gt;Button]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ShowRetry<sp/>--&gt;<sp/>UserRetry{User<sp/>Clicks&lt;br/&gt;Retry?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserRetry<sp/>--&gt;|Yes|<sp/>SetLoading</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserRetry<sp/>--&gt;|No|<sp/>WaitAction([Wait<sp/>for&lt;br/&gt;User<sp/>Action])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4522">
<title>7.7.2 Tab Navigation State Machine</title><para>Both UIs implement tab-based navigation with distinct state transitions:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">stateDiagram-v2</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>[*]<sp/>--&gt;<sp/>Visualization:<sp/>Default<sp/>Tab</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Visualization<sp/>--&gt;<sp/>Metrics:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Visualization<sp/>--&gt;<sp/>Assets:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Metrics<sp/>--&gt;<sp/>Visualization:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Metrics<sp/>--&gt;<sp/>Assets:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Assets<sp/>--&gt;<sp/>Visualization:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Assets<sp/>--&gt;<sp/>Metrics:<sp/>Tab<sp/>Click</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>note<sp/>right<sp/>of<sp/>Visualization:<sp/>3D<sp/>Network<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>note<sp/>right<sp/>of<sp/>Metrics:<sp/>Statistics<sp/>Dashboard</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>note<sp/>right<sp/>of<sp/>Assets:<sp/>Filterable<sp/>Table</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4523">
<title>7.7.3 Gradio Event Flow</title><para>The Gradio interface manages state through an event-driven architecture with real-time visualization updates:</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>GradioEventFlow[Gradio<sp/>UI<sp/>Event<sp/>Flow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AppStart([Gradio<sp/>App&lt;br/&gt;Starts])<sp/>--&gt;<sp/>InitGraph[Initialize&lt;br/&gt;Graph<sp/>State]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InitGraph<sp/>--&gt;<sp/>CreateInterface[Create<sp/>Blocks&lt;br/&gt;Interface]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CreateInterface<sp/>--&gt;<sp/>SetupTabs[Setup<sp/>6&lt;br/&gt;Tabs]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetupTabs<sp/>--&gt;<sp/>WireEvents[Wire<sp/>Event&lt;br/&gt;Handlers]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WireEvents<sp/>--&gt;<sp/>LaunchServer[Launch<sp/>Server&lt;br/&gt;Port<sp/>7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LaunchServer<sp/>--&gt;<sp/>WaitEvent([Wait<sp/>for&lt;br/&gt;User<sp/>Event])</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WaitEvent<sp/>--&gt;<sp/>UserAction{User&lt;br/&gt;Action<sp/>Type}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserAction<sp/>--&gt;|Refresh|<sp/>RefreshAll[refresh_all_outputs()]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserAction<sp/>--&gt;|Filter<sp/>Change|<sp/>UpdateViz[refresh_visualization()]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserAction<sp/>--&gt;|Tab<sp/>Change|<sp/>LoadTab[Load<sp/>Tab&lt;br/&gt;Content]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserAction<sp/>--&gt;|Asset<sp/>Select|<sp/>UpdateAsset[update_asset_info()]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RefreshAll<sp/>--&gt;<sp/>WaitEvent</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UpdateViz<sp/>--&gt;<sp/>WaitEvent</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoadTab<sp/>--&gt;<sp/>WaitEvent</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UpdateAsset<sp/>--&gt;<sp/>WaitEvent</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4524">
<title>7.7.4 3D Visualization Interactions</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Interaction   </para>
</entry><entry thead="yes"><para>Action   </para>
</entry><entry thead="yes"><para>Result    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Drag</bold>   </para>
</entry><entry thead="no"><para>Click and drag on graph area   </para>
</entry><entry thead="no"><para>Rotate 3D view    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Scroll</bold>   </para>
</entry><entry thead="no"><para>Mouse wheel   </para>
</entry><entry thead="no"><para>Zoom in/out    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Hover</bold>   </para>
</entry><entry thead="no"><para>Mouse over node   </para>
</entry><entry thead="no"><para>Show tooltip with asset details    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Click</bold>   </para>
</entry><entry thead="no"><para>Click on node   </para>
</entry><entry thead="no"><para>(Future: Asset detail view)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Double-click</bold>   </para>
</entry><entry thead="no"><para>Double-click on background   </para>
</entry><entry thead="no"><para>Reset view   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4525">
<title>7.7.5 Asset Explorer Interactions</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Interaction   </para>
</entry><entry thead="yes"><para>Action   </para>
</entry><entry thead="yes"><para>Result    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Filter Change</bold>   </para>
</entry><entry thead="no"><para>Select asset class/sector   </para>
</entry><entry thead="no"><para>Update table, modify URL params    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Page Size Change</bold>   </para>
</entry><entry thead="no"><para>Select new page size   </para>
</entry><entry thead="no"><para>Reset to page 1, update display    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Previous Page</bold>   </para>
</entry><entry thead="no"><para>Click Previous button   </para>
</entry><entry thead="no"><para>Load previous page    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Next Page</bold>   </para>
</entry><entry thead="no"><para>Click Next button   </para>
</entry><entry thead="no"><para>Load next page    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Browser Back</bold>   </para>
</entry><entry thead="no"><para>Browser back button   </para>
</entry><entry thead="no"><para>Restore previous filter state   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4526">
<title>7.7.6 Error Recovery Flow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ErrorRecovery[Frontend<sp/>Error<sp/>Recovery]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorDetected([Error&lt;br/&gt;Detected])<sp/>--&gt;<sp/>ErrorCategory{Error&lt;br/&gt;Category}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorCategory<sp/>--&gt;|Network<sp/>Error|<sp/>NetError[Set<sp/>Error:&lt;br/&gt;Network<sp/>Unavailable]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorCategory<sp/>--&gt;|API<sp/>Error|<sp/>APIError[Set<sp/>Error:&lt;br/&gt;API<sp/>Error<sp/>Message]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ErrorCategory<sp/>--&gt;|Render<sp/>Error|<sp/>RenderError[Set<sp/>Error:&lt;br/&gt;Display<sp/>Error]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NetError<sp/>--&gt;<sp/>ShowRetryUI[Show<sp/>Retry&lt;br/&gt;Button]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>APIError<sp/>--&gt;<sp/>ShowRetryUI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RenderError<sp/>--&gt;<sp/>ShowRefresh[Show<sp/>Refresh&lt;br/&gt;Page<sp/>Option]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ShowRetryUI<sp/>--&gt;<sp/>UserRetries{User&lt;br/&gt;Retries?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserRetries<sp/>--&gt;|Yes|<sp/>ClearError[Clear<sp/>Error&lt;br/&gt;State]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ClearError<sp/>--&gt;<sp/>ReloadData[Reload&lt;br/&gt;Data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReloadData<sp/>--&gt;<sp/>Success{Success?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Success<sp/>--&gt;|Yes|<sp/>Normal([Normal&lt;br/&gt;Operation])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Success<sp/>--&gt;|No|<sp/>ErrorDetected</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserRetries<sp/>--&gt;|No|<sp/>WaitUser([Wait<sp/>for&lt;br/&gt;User])</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ShowRefresh<sp/>--&gt;<sp/>UserRefresh{User&lt;br/&gt;Refreshes?}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserRefresh<sp/>--&gt;|Yes|<sp/>PageReload[Full<sp/>Page&lt;br/&gt;Reload]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PageReload<sp/>--&gt;<sp/>Normal</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4528">
<title>7.8 Visual Design Specifications</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4529">
<title>7.8.1 Asset Class Color Scheme</title><para>A consistent color palette maps asset classes to visual representations across both UIs:</para>
<para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Asset Class   </para>
</entry><entry thead="yes"><para>Node Color   </para>
</entry><entry thead="yes"><para>Hex Code   </para>
</entry><entry thead="yes"><para>Usage    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Equity</bold>   </para>
</entry><entry thead="no"><para>Blue   </para>
</entry><entry thead="no"><para><computeroutput>#1f77b4</computeroutput>   </para>
</entry><entry thead="no"><para>Stocks and equity instruments    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Fixed Income</bold>   </para>
</entry><entry thead="no"><para>Green   </para>
</entry><entry thead="no"><para><computeroutput>#2ca02c</computeroutput>   </para>
</entry><entry thead="no"><para>Bonds and debt instruments    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Commodity</bold>   </para>
</entry><entry thead="no"><para>Orange   </para>
</entry><entry thead="no"><para><computeroutput>#ff7f0e</computeroutput>   </para>
</entry><entry thead="no"><para>Physical commodity futures    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Currency</bold>   </para>
</entry><entry thead="no"><para>Red   </para>
</entry><entry thead="no"><para><computeroutput>#d62728</computeroutput>   </para>
</entry><entry thead="no"><para>Foreign exchange pairs    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Derivative</bold>   </para>
</entry><entry thead="no"><para>Purple   </para>
</entry><entry thead="no"><para><computeroutput>#9467bd</computeroutput>   </para>
</entry><entry thead="no"><para>Derivative instruments   </para>
</entry></row>
</table>
</para>
<para><bold>Source</bold>: <computeroutput><ref refid="graph__visuals_8py" kindref="compound">src/visualizations/graph_visuals.py</ref></computeroutput></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4530">
<title>7.8.2 Relationship Edge Colors</title><para>Relationship types are distinguished by edge colors in the network visualization:</para>
<para><table rows="9" cols="3"><row>
<entry thead="yes"><para>Relationship Type   </para>
</entry><entry thead="yes"><para>Edge Color   </para>
</entry><entry thead="yes"><para>Hex Code    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>same_sector</computeroutput>   </para>
</entry><entry thead="no"><para>Red   </para>
</entry><entry thead="no"><para><computeroutput>#FF6B6B</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>market_cap_similar</computeroutput>   </para>
</entry><entry thead="no"><para>Teal   </para>
</entry><entry thead="no"><para><computeroutput>#4ECDC4</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>correlation</computeroutput>   </para>
</entry><entry thead="no"><para>Blue   </para>
</entry><entry thead="no"><para><computeroutput>#45B7D1</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>corporate_bond_to_equity</computeroutput>   </para>
</entry><entry thead="no"><para>Green   </para>
</entry><entry thead="no"><para><computeroutput>#96CEB4</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>commodity_currency</computeroutput>   </para>
</entry><entry thead="no"><para>Yellow   </para>
</entry><entry thead="no"><para><computeroutput>#FFEAA7</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>income_comparison</computeroutput>   </para>
</entry><entry thead="no"><para>Plum   </para>
</entry><entry thead="no"><para><computeroutput>#DDA0DD</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_impact</computeroutput>   </para>
</entry><entry thead="no"><para>Light Salmon   </para>
</entry><entry thead="no"><para><computeroutput>#FFA07A</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Default   </para>
</entry><entry thead="no"><para>Gray   </para>
</entry><entry thead="no"><para><computeroutput>#888888</computeroutput>   </para>
</entry></row>
</table>
</para>
<para><bold>Source</bold>: <computeroutput><ref refid="graph__visuals_8py" kindref="compound">src/visualizations/graph_visuals.py</ref></computeroutput> (lines 18-29)</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4531">
<title>7.8.3 CSS Design System (Next.js)</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4532">
<title>Tailwind CSS Configuration</title><para><bold>Location</bold>: <computeroutput>frontend/tailwind.config.js</computeroutput></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Content Paths   </para>
</entry><entry thead="no"><para><computeroutput>./pages/**</computeroutput>, <computeroutput>./components/**</computeroutput>, <computeroutput>./app/**</computeroutput>   </para>
</entry><entry thead="no"><para>Purge unused CSS    </para>
</entry></row>
<row>
<entry thead="no"><para>Theme   </para>
</entry><entry thead="no"><para>Extended defaults   </para>
</entry><entry thead="no"><para>Custom design tokens    </para>
</entry></row>
<row>
<entry thead="no"><para>Plugins   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>Minimal footprint   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4533">
<title>Global CSS Variables</title><para><bold>Location</bold>: <computeroutput>frontend/app/globals.css</computeroutput></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>CSS Variable   </para>
</entry><entry thead="yes"><para>Light Mode Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>--foreground-rgb</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>0, 0, 0</computeroutput>   </para>
</entry><entry thead="no"><para>Text color    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>--background-start-rgb</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>214, 219, 220</computeroutput>   </para>
</entry><entry thead="no"><para>Gradient start    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>--background-end-rgb</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>255, 255, 255</computeroutput>   </para>
</entry><entry thead="no"><para>Gradient end   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4534">
<title>Background Gradient</title><para>The application uses a subtle vertical gradient:</para>
<para><itemizedlist>
<listitem><para>Start: <computeroutput>rgb(214, 219, 220)</computeroutput> (light gray)</para>
</listitem><listitem><para>End: <computeroutput>rgb(255, 255, 255)</computeroutput> (white)</para>
</listitem><listitem><para>Direction: Top to bottom</para>
</listitem></itemizedlist>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4535">
<title>7.8.4 Responsive Design Patterns</title><para>The Next.js frontend implements mobile-first responsive design using Tailwind breakpoints:</para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Breakpoint   </para>
</entry><entry thead="yes"><para>Screen Size   </para>
</entry><entry thead="yes"><para>Grid Columns (MetricsDashboard)    </para>
</entry></row>
<row>
<entry thead="no"><para>Default   </para>
</entry><entry thead="no"><para>&lt; 768px   </para>
</entry><entry thead="no"><para>1 column    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>md:</computeroutput>   </para>
</entry><entry thead="no"><para>≥ 768px   </para>
</entry><entry thead="no"><para>2 columns    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>lg:</computeroutput>   </para>
</entry><entry thead="no"><para>≥ 1024px   </para>
</entry><entry thead="no"><para>3 columns   </para>
</entry></row>
</table>
</para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4536">
<title>Component Responsive Classes</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Responsive Pattern    </para>
</entry></row>
<row>
<entry thead="no"><para>Container   </para>
</entry><entry thead="no"><para><computeroutput>container mx-auto px-4</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Card   </para>
</entry><entry thead="no"><para><computeroutput>bg-white rounded-lg shadow-md p-6</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Grid   </para>
</entry><entry thead="no"><para><computeroutput>grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Button   </para>
</entry><entry thead="no"><para><computeroutput>px-4 py-2 rounded-md</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4537">
<title>7.8.5 Application Metadata</title></sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4538">
<title>Next.js Metadata</title><para><bold>Location</bold>: <computeroutput>frontend/app/layout.tsx</computeroutput></para>
<para><table rows="3" cols="2"><row>
<entry thead="yes"><para>Property   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Title   </para>
</entry><entry thead="no"><para>&quot;Financial Asset Relationship Network&quot;    </para>
</entry></row>
<row>
<entry thead="no"><para>Description   </para>
</entry><entry thead="no"><para>&quot;Interactive 3D visualization of interconnected financial assets&quot;   </para>
</entry></row>
</table>
</para>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4539_1s3"><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4539">
<title>Gradio Application Title</title><para><bold>Location</bold>: <computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput></para>
<para><table rows="3" cols="2"><row>
<entry thead="yes"><para>Property   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Title   </para>
</entry><entry thead="no"><para>&quot;Financial Asset Relationship Database Visualization&quot;    </para>
</entry></row>
<row>
<entry thead="no"><para>Default Port   </para>
</entry><entry thead="no"><para>7860   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4></sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4541">
<title>7.9 Testing Strategy</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4542">
<title>7.9.1 Frontend Testing Framework</title><para>The Next.js frontend implements comprehensive testing using Jest and React Testing Library:</para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Jest   </para>
</entry><entry thead="no"><para>^29.7.0   </para>
</entry><entry thead="no"><para>Test runner and framework    </para>
</entry></row>
<row>
<entry thead="no"><para>@testing-library/react   </para>
</entry><entry thead="no"><para>^14.1.2   </para>
</entry><entry thead="no"><para>React component testing    </para>
</entry></row>
<row>
<entry thead="no"><para>@testing-library/jest-dom   </para>
</entry><entry thead="no"><para>^6.4.0   </para>
</entry><entry thead="no"><para>DOM assertions    </para>
</entry></row>
<row>
<entry thead="no"><para>jest-environment-jsdom   </para>
</entry><entry thead="no"><para>^29.7.0   </para>
</entry><entry thead="no"><para>DOM simulation   </para>
</entry></row>
</table>
</para>
<para><bold>Configuration Location</bold>: <computeroutput>frontend/jest.config.js</computeroutput>, <computeroutput>frontend/jest.setup.js</computeroutput></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4543">
<title>7.9.2 Frontend Test Organization</title><para><programlisting><codeline><highlight class="normal">frontend/__tests__/</highlight></codeline>
<codeline><highlight class="normal">├──<sp/>test-utils.ts<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Centralized<sp/>mock<sp/>data</highlight></codeline>
<codeline><highlight class="normal">├──<sp/>lib/</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>api.test.ts<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>API<sp/>client<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>└──<sp/>api-axios-compatibility.test.ts</highlight></codeline>
<codeline><highlight class="normal">├──<sp/>components/</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>AssetList.test.tsx<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Asset<sp/>list<sp/>component<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>├──<sp/>MetricsDashboard.test.tsx<sp/><sp/><sp/>#<sp/>Metrics<sp/>dashboard<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">│<sp/><sp/><sp/>└──<sp/>NetworkVisualization.test.tsx<sp/>#<sp/>Visualization<sp/>tests</highlight></codeline>
<codeline><highlight class="normal">└──<sp/>app/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>└──<sp/>page.test.tsx<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Page-level<sp/>tests</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4544">
<title>7.9.3 Component Test Coverage</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Test Scenarios   </para>
</entry><entry thead="yes"><para>Coverage Focus    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>AssetList</computeroutput>   </para>
</entry><entry thead="no"><para>Render assets, filter by class, pagination   </para>
</entry><entry thead="no"><para>User filtering flows    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>MetricsDashboard</computeroutput>   </para>
</entry><entry thead="no"><para>Display metrics, handle loading, show errors   </para>
</entry><entry thead="no"><para>Data presentation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>NetworkVisualization</computeroutput>   </para>
</entry><entry thead="no"><para>3D graph rendering, node interaction   </para>
</entry><entry thead="no"><para>Plotly integration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>page.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Tab switching, data loading, retry mechanisms   </para>
</entry><entry thead="no"><para>Page lifecycle   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4545">
<title>7.9.4 Mock Data Utilities</title><para><bold>Location</bold>: <computeroutput>frontend/__tests__/test-utils.ts</computeroutput></para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Export   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>mockAssets</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Asset[]</computeroutput>   </para>
</entry><entry thead="no"><para>Sample asset collection    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>mockMetrics</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Metrics</computeroutput>   </para>
</entry><entry thead="no"><para>Network metrics data    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>mockVisualization</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>VisualizationData</computeroutput>   </para>
</entry><entry thead="no"><para>3D graph data    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>mockRelationships</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>Relationship[]</computeroutput>   </para>
</entry><entry thead="no"><para>Sample relationships   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4546">
<title>7.9.5 Test Execution Commands</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Command   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm test</computeroutput>   </para>
</entry><entry thead="no"><para>Run all frontend tests    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm test -- --coverage</computeroutput>   </para>
</entry><entry thead="no"><para>Tests with coverage report    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm test -- --watch</computeroutput>   </para>
</entry><entry thead="no"><para>Watch mode for development    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>npm run test:ci</computeroutput>   </para>
</entry><entry thead="no"><para>CI-optimized execution   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4548">
<title>7.10 Accessibility Considerations</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4549">
<title>7.10.1 Current Implementation</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Accessibility Feature   </para>
</entry><entry thead="yes"><para>Status   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>Semantic HTML   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>Proper heading hierarchy    </para>
</entry></row>
<row>
<entry thead="no"><para>Color Contrast   </para>
</entry><entry thead="no"><para>✅ Implemented   </para>
</entry><entry thead="no"><para>Tailwind default palette    </para>
</entry></row>
<row>
<entry thead="no"><para>Keyboard Navigation   </para>
</entry><entry thead="no"><para>⚠️ Partial   </para>
</entry><entry thead="no"><para>Tab navigation works    </para>
</entry></row>
<row>
<entry thead="no"><para>Screen Reader Support   </para>
</entry><entry thead="no"><para>⚠️ Limited   </para>
</entry><entry thead="no"><para>Labels on form controls    </para>
</entry></row>
<row>
<entry thead="no"><para>ARIA Attributes   </para>
</entry><entry thead="no"><para>⚠️ Partial   </para>
</entry><entry thead="no"><para>Button roles   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4550">
<title>7.10.2 Planned Enhancements</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Enhancement   </para>
</entry><entry thead="yes"><para>Priority   </para>
</entry><entry thead="yes"><para>Tool    </para>
</entry></row>
<row>
<entry thead="no"><para>Full ARIA labeling   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry><entry thead="no"><para>Manual implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>Accessibility testing   </para>
</entry><entry thead="no"><para>Medium   </para>
</entry><entry thead="no"><para>axe-core integration    </para>
</entry></row>
<row>
<entry thead="no"><para>Keyboard shortcuts   </para>
</entry><entry thead="no"><para>Low   </para>
</entry><entry thead="no"><para>Custom implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>High contrast mode   </para>
</entry><entry thead="no"><para>Low   </para>
</entry><entry thead="no"><para>Tailwind dark mode   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4552">
<title>7.11 References</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4553">
<title>7.11.1 Source Files Examined</title><para><table rows="19" cols="2"><row>
<entry thead="yes"><para>Path   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/page.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Main Next.js page with tab navigation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/layout.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Root layout with metadata    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/globals.css</computeroutput>   </para>
</entry><entry thead="no"><para>Global CSS styles    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/tailwind.config.js</computeroutput>   </para>
</entry><entry thead="no"><para>Tailwind configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/components/NetworkVisualization.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>3D visualization component    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/components/MetricsDashboard.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Metrics grid component    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/components/AssetList.tsx</computeroutput>   </para>
</entry><entry thead="no"><para>Asset explorer component    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/types/api.ts</computeroutput>   </para>
</entry><entry thead="no"><para>TypeScript API contracts    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/app/lib/api.ts</computeroutput>   </para>
</entry><entry thead="no"><para>Axios API client    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/jest.config.js</computeroutput>   </para>
</entry><entry thead="no"><para>Jest configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/jest.setup.js</computeroutput>   </para>
</entry><entry thead="no"><para>Jest environment setup    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/__tests__/test-utils.ts</computeroutput>   </para>
</entry><entry thead="no"><para>Mock data utilities    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Gradio UI implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI endpoints and response models    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="graph__visuals_8py" kindref="compound">src/visualizations/graph_visuals.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Visualization color schemes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>requirements.txt</computeroutput>   </para>
</entry><entry thead="no"><para>Python dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="UI__COMPARISON_8md" kindref="compound">UI_COMPARISON.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>UI feature comparison   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4554">
<title>7.11.2 Technical Specification Cross-References</title><para><table rows="9" cols="2"><row>
<entry thead="yes"><para>Section   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para>2.1 Feature Catalog   </para>
</entry><entry thead="no"><para>Feature requirements (F-016, F-017)    </para>
</entry></row>
<row>
<entry thead="no"><para>3.3 Frameworks &amp; Libraries   </para>
</entry><entry thead="no"><para>Technology stack details    </para>
</entry></row>
<row>
<entry thead="no"><para>4.4 Frontend Workflows   </para>
</entry><entry thead="no"><para>Page load and event flows    </para>
</entry></row>
<row>
<entry thead="no"><para>4.5 Error Handling Workflows   </para>
</entry><entry thead="no"><para>Error recovery patterns    </para>
</entry></row>
<row>
<entry thead="no"><para>5.1 HIGH-LEVEL ARCHITECTURE   </para>
</entry><entry thead="no"><para>System architecture overview    </para>
</entry></row>
<row>
<entry thead="no"><para>5.2 COMPONENT DETAILS   </para>
</entry><entry thead="no"><para>Component specifications    </para>
</entry></row>
<row>
<entry thead="no"><para>6.4 Security Architecture   </para>
</entry><entry thead="no"><para>Authentication and CORS    </para>
</entry></row>
<row>
<entry thead="no"><para>6.6 Testing Strategy   </para>
</entry><entry thead="no"><para>Frontend testing approach   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4555">
<title>7.11.3 Frontend Component Locations</title><para><table rows="9" cols="2"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>File Path    </para>
</entry></row>
<row>
<entry thead="no"><para>Root Layout   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/layout.tsx</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Home Page   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/page.tsx</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Network Visualization   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/components/NetworkVisualization.tsx</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Metrics Dashboard   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/components/MetricsDashboard.tsx</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset List   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/components/AssetList.tsx</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>API Client   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/lib/api.ts</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Type Definitions   </para>
</entry><entry thead="no"><para><computeroutput>frontend/app/types/api.ts</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Test Utilities   </para>
</entry><entry thead="no"><para><computeroutput>frontend/__tests__/test-utils.ts</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect3>
</sect2>
</sect1>
<sect1 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4556">
<title>8. Infrastructure</title><sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4557">
<title>8.1 Executive Overview</title><para>The Financial Asset Relationship Database implements a <bold>hybrid deployment architecture</bold> supporting multiple deployment targets to accommodate varying operational requirements. The infrastructure design prioritizes deployment flexibility, operational simplicity, and cost-effectiveness while maintaining security and reliability standards appropriate for financial data applications.</para>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4558">
<title>8.1.1 Infrastructure Philosophy</title><para>The system follows these core infrastructure principles:</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Principle   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Rationale    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Multi-Target Deployment</bold>   </para>
</entry><entry thead="no"><para>Vercel, Docker, Local   </para>
</entry><entry thead="no"><para>Supports development through production workflows    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Serverless-First Production</bold>   </para>
</entry><entry thead="no"><para>Vercel Edge Functions   </para>
</entry><entry thead="no"><para>Automatic scaling, global distribution, minimal ops    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Container-Based Portability</bold>   </para>
</entry><entry thead="no"><para>Docker with Docker Compose   </para>
</entry><entry thead="no"><para>Consistent environments across all deployment stages    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Infrastructure as Code</bold>   </para>
</entry><entry thead="no"><para>Configuration files, no imperative scripts   </para>
</entry><entry thead="no"><para>Reproducible, version-controlled infrastructure    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Security by Default</bold>   </para>
</entry><entry thead="no"><para>Non-root containers, TLS enforcement   </para>
</entry><entry thead="no"><para>Defense in depth from build through production   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4559">
<title>8.1.2 Infrastructure Architecture Diagram</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ExternalUsers[External<sp/>Access<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Users([End<sp/>Users])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Developers([Developers])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CI([CI/CD<sp/>Pipelines])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>EdgeLayer[Edge<sp/>&amp;<sp/>CDN<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelEdge[Vercel<sp/>Edge<sp/>Network&lt;br/&gt;Global<sp/>CDN]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TLS[TLS<sp/>Termination&lt;br/&gt;HTTPS<sp/>Enforcement]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ComputeLayer[Compute<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>VercelCompute[Vercel<sp/>Serverless]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextSSR[Next.js<sp/>SSR&lt;br/&gt;@vercel/next]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PythonLambda[Python<sp/>Functions&lt;br/&gt;@vercel/python&lt;br/&gt;50MB<sp/>max]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>DockerCompute[Docker<sp/>Deployment]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AppContainer[app<sp/>container&lt;br/&gt;python:3.11-slim&lt;br/&gt;Port<sp/>7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>LocalDev[Local<sp/>Development]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPILocal[FastAPI&lt;br/&gt;Port<sp/>8000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextJSLocal[Next.js&lt;br/&gt;Port<sp/>3000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GradioLocal[Gradio&lt;br/&gt;Port<sp/>7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DataLayer[Data<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InMemGraph[In-Memory<sp/>Graph&lt;br/&gt;Dict-based<sp/>Storage]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLiteAuth[(SQLite&lt;br/&gt;Auth<sp/>Database)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JSONCache[(JSON<sp/>File<sp/>Cache&lt;br/&gt;Atomic<sp/>Writes)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ExternalServices[External<sp/>Services]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YahooFinance[Yahoo<sp/>Finance<sp/>API&lt;br/&gt;via<sp/>yfinance]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GHCR[GitHub<sp/>Container<sp/>Registry&lt;br/&gt;ghcr.io]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GitHubActions[GitHub<sp/>Actions&lt;br/&gt;CI/CD]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users<sp/>--&gt;<sp/>VercelEdge</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Developers<sp/>--&gt;<sp/>LocalDev</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CI<sp/>--&gt;<sp/>GitHubActions</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>VercelEdge<sp/>--&gt;<sp/>TLS</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>TLS<sp/>--&gt;<sp/>VercelCompute</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>VercelCompute<sp/>--&gt;<sp/>InMemGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DockerCompute<sp/>--&gt;<sp/>InMemGraph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LocalDev<sp/>--&gt;<sp/>InMemGraph</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>InMemGraph<sp/>--&gt;<sp/>SQLiteAuth</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>InMemGraph<sp/>--&gt;<sp/>JSONCache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>InMemGraph<sp/>--&gt;<sp/>YahooFinance</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GitHubActions<sp/>--&gt;<sp/>GHCR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GitHubActions<sp/>--&gt;<sp/>VercelCompute</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4561">
<title>8.2 Deployment Environment</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4562">
<title>8.2.1 Target Environment Assessment</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4563">
<title>8.2.1.1 Environment Type Classification</title><para>The Financial Asset Relationship Database operates in a <bold>hybrid cloud/local</bold> environment model:</para>
<para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Environment Type   </para>
</entry><entry thead="yes"><para>Primary Use   </para>
</entry><entry thead="yes"><para>Technology   </para>
</entry><entry thead="yes"><para>Scale    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Local Development</bold>   </para>
</entry><entry thead="no"><para>Feature development, debugging   </para>
</entry><entry thead="no"><para>Native Python/Node.js   </para>
</entry><entry thead="no"><para>Single developer    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Docker Container</bold>   </para>
</entry><entry thead="no"><para>Integration testing, self-hosted production   </para>
</entry><entry thead="no"><para>Docker, Docker Compose   </para>
</entry><entry thead="no"><para>Single to small cluster    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Vercel Serverless</bold>   </para>
</entry><entry thead="no"><para>Production SaaS deployment   </para>
</entry><entry thead="no"><para>Vercel Edge Network   </para>
</entry><entry thead="no"><para>Auto-scaling global    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Google Cloud Run</bold>   </para>
</entry><entry thead="no"><para>Alternative cloud deployment   </para>
</entry><entry thead="no"><para>GCR, Cloud Run   </para>
</entry><entry thead="no"><para>Auto-scaling regional   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4564">
<title>8.2.1.2 Geographic Distribution</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Deployment Target   </para>
</entry><entry thead="yes"><para>Geographic Strategy   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>Vercel   </para>
</entry><entry thead="no"><para>Global Edge Network   </para>
</entry><entry thead="no"><para>Automatic CDN distribution to nearest edge location    </para>
</entry></row>
<row>
<entry thead="no"><para>Docker   </para>
</entry><entry thead="no"><para>Single region   </para>
</entry><entry thead="no"><para>Deployer-determined; no built-in geo-distribution    </para>
</entry></row>
<row>
<entry thead="no"><para>Cloud Run   </para>
</entry><entry thead="no"><para>Regional with optional multi-region   </para>
</entry><entry thead="no"><para>Configurable via <computeroutput>REGION</computeroutput> environment variable   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4565">
<title>8.2.1.3 Resource Requirements</title><para><bold>Compute Requirements:</bold></para>
<para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Minimum   </para>
</entry><entry thead="yes"><para>Recommended   </para>
</entry><entry thead="yes"><para>Production    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>CPU</bold>   </para>
</entry><entry thead="no"><para>1 vCPU   </para>
</entry><entry thead="no"><para>2 vCPU   </para>
</entry><entry thead="no"><para>Auto-scaling (Vercel)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Memory</bold>   </para>
</entry><entry thead="no"><para>512 MB   </para>
</entry><entry thead="no"><para>2 GB   </para>
</entry><entry thead="no"><para>2-4 GB (Vercel Lambda)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Disk</bold>   </para>
</entry><entry thead="no"><para>100 MB   </para>
</entry><entry thead="no"><para>500 MB   </para>
</entry><entry thead="no"><para>N/A (ephemeral)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Network</bold>   </para>
</entry><entry thead="no"><para>Standard   </para>
</entry><entry thead="no"><para>Low latency   </para>
</entry><entry thead="no"><para>Edge-optimized   </para>
</entry></row>
</table>
</para>
<para><bold>Application Constraints:</bold></para>
<para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Constraint ID   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Impact   </para>
</entry><entry thead="yes"><para>Mitigation    </para>
</entry></row>
<row>
<entry thead="no"><para>C-001   </para>
</entry><entry thead="no"><para>In-memory graph limits scalability   </para>
</entry><entry thead="no"><para>&lt; 500 nodes optimal   </para>
</entry><entry thead="no"><para>Database persistence option    </para>
</entry></row>
<row>
<entry thead="no"><para>C-002   </para>
</entry><entry thead="no"><para>Single-user JWT authentication   </para>
</entry><entry thead="no"><para>Limited concurrent sessions   </para>
</entry><entry thead="no"><para>Session isolation per token    </para>
</entry></row>
<row>
<entry thead="no"><para>C-003   </para>
</entry><entry thead="no"><para>Yahoo Finance API rate limits   </para>
</entry><entry thead="no"><para>Data freshness affected   </para>
</entry><entry thead="no"><para>JSON file caching with atomic writes    </para>
</entry></row>
<row>
<entry thead="no"><para>C-004   </para>
</entry><entry thead="no"><para>Browser memory limits visualization   </para>
</entry><entry thead="no"><para>Large graph rendering issues   </para>
</entry><entry thead="no"><para>MAX_NODES/MAX_EDGES guardrails    </para>
</entry></row>
<row>
<entry thead="no"><para>C-005   </para>
</entry><entry thead="no"><para>Vercel Lambda size limit   </para>
</entry><entry thead="no"><para>50MB maximum   </para>
</entry><entry thead="no"><para>Dependency optimization required   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4566">
<title>8.2.1.4 Port Configuration Matrix</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Service   </para>
</entry><entry thead="yes"><para>Port   </para>
</entry><entry thead="yes"><para>Protocol   </para>
</entry><entry thead="yes"><para>Exposure    </para>
</entry></row>
<row>
<entry thead="no"><para>FastAPI Backend   </para>
</entry><entry thead="no"><para>8000   </para>
</entry><entry thead="no"><para>HTTP/HTTPS   </para>
</entry><entry thead="no"><para>API endpoints    </para>
</entry></row>
<row>
<entry thead="no"><para>Next.js Frontend   </para>
</entry><entry thead="no"><para>3000   </para>
</entry><entry thead="no"><para>HTTP/HTTPS   </para>
</entry><entry thead="no"><para>User interface    </para>
</entry></row>
<row>
<entry thead="no"><para>Gradio Legacy UI   </para>
</entry><entry thead="no"><para>7860   </para>
</entry><entry thead="no"><para>HTTP   </para>
</entry><entry thead="no"><para>Legacy interface    </para>
</entry></row>
<row>
<entry thead="no"><para>PostgreSQL (optional)   </para>
</entry><entry thead="no"><para>5432   </para>
</entry><entry thead="no"><para>TCP   </para>
</entry><entry thead="no"><para>Database (internal only)   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4567">
<title>8.2.2 Environment Management</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4568">
<title>8.2.2.1 Infrastructure as Code Components</title><para><table rows="7" cols="4"><row>
<entry thead="yes"><para>File   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Platform   </para>
</entry><entry thead="yes"><para>Key Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Dockerfile</computeroutput>   </para>
</entry><entry thead="no"><para>Container image definition   </para>
</entry><entry thead="no"><para>Docker   </para>
</entry><entry thead="no"><para><ref refid="classBase" kindref="compound">Base</ref> image, security, health check    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>docker-compose.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Multi-service orchestration   </para>
</entry><entry thead="no"><para>Docker Compose   </para>
</entry><entry thead="no"><para>Service definitions, volumes, networking    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>vercel.json</computeroutput>   </para>
</entry><entry thead="no"><para>Serverless deployment config   </para>
</entry><entry thead="no"><para>Vercel   </para>
</entry><entry thead="no"><para>Builders, routes, lambda size    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Makefile</computeroutput>   </para>
</entry><entry thead="no"><para>Build and deployment automation   </para>
</entry><entry thead="no"><para>Cross-platform   </para>
</entry><entry thead="no"><para>Targets for common operations    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>pyproject.toml</computeroutput>   </para>
</entry><entry thead="no"><para>Python project metadata   </para>
</entry><entry thead="no"><para>Python ecosystem   </para>
</entry><entry thead="no"><para>Build system, tool configs    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.env.example</computeroutput>   </para>
</entry><entry thead="no"><para>Environment variable template   </para>
</entry><entry thead="no"><para>All environments   </para>
</entry><entry thead="no"><para>Required and optional variables   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4569">
<title>8.2.2.2 Environment Variables Configuration</title><para><bold>Required Environment Variables:</bold></para>
<para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Variable   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Default   </para>
</entry><entry thead="yes"><para>Criticality    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SECRET_KEY</computeroutput>   </para>
</entry><entry thead="no"><para>JWT signing key   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para><bold>Critical</bold> - App fails without    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>DATABASE_URL</computeroutput>   </para>
</entry><entry thead="no"><para>SQLite connection string   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para><bold>Critical</bold> - App fails without    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_USERNAME</computeroutput>   </para>
</entry><entry thead="no"><para>Initial admin account   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>Required for user seeding    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_PASSWORD</computeroutput>   </para>
</entry><entry thead="no"><para>Initial admin password   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>Required for user seeding   </para>
</entry></row>
</table>
</para>
<para><bold>Optional Environment Variables:</bold></para>
<para><table rows="9" cols="3"><row>
<entry thead="yes"><para>Variable   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Default    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ENV</computeroutput>   </para>
</entry><entry thead="no"><para>Environment mode   </para>
</entry><entry thead="no"><para><computeroutput>development</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ALLOWED_ORIGINS</computeroutput>   </para>
</entry><entry thead="no"><para>CORS allowlist   </para>
</entry><entry thead="no"><para>Built-in defaults    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>USE_REAL_DATA_FETCHER</computeroutput>   </para>
</entry><entry thead="no"><para>Yahoo Finance toggle   </para>
</entry><entry thead="no"><para><computeroutput>false</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>REAL_DATA_CACHE_PATH</computeroutput>   </para>
</entry><entry thead="no"><para>Cache file location   </para>
</entry><entry thead="no"><para>Default path    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GRAPH_CACHE_PATH</computeroutput>   </para>
</entry><entry thead="no"><para>Graph serialization path   </para>
</entry><entry thead="no"><para>Default path    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>NEXT_PUBLIC_API_URL</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend API endpoint   </para>
</entry><entry thead="no"><para><computeroutput><ulink url="http://localhost:8000">http://localhost:8000</ulink></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GRADIO_SERVER_NAME</computeroutput>   </para>
</entry><entry thead="no"><para>Gradio binding address   </para>
</entry><entry thead="no"><para><computeroutput>0.0.0.0</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GRADIO_SERVER_PORT</computeroutput>   </para>
</entry><entry thead="no"><para>Gradio port   </para>
</entry><entry thead="no"><para><computeroutput>7860</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4570">
<title>8.2.2.3 Environment Promotion Strategy</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Development[Development<sp/>Stage]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalDev[Local<sp/>Development&lt;br/&gt;Feature<sp/>Branches]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DevTest[Developer<sp/>Testing&lt;br/&gt;run-dev.sh]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Integration[Integration<sp/>Stage]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PR[Pull<sp/>Request&lt;br/&gt;Preview<sp/>Deploy]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>QualityGates[Quality<sp/>Gates&lt;br/&gt;CI<sp/>Pipeline]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Staging[Staging<sp/>Stage]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerValidate[Docker<sp/>Build&lt;br/&gt;Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IntegrationTests[Integration&lt;br/&gt;Tests]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Production[Production<sp/>Stage]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelProd[Vercel<sp/>Production&lt;br/&gt;Auto-Deploy]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerProd[Docker<sp/>Registry&lt;br/&gt;GHCR<sp/>Publish]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LocalDev<sp/>--&gt;<sp/>DevTest</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DevTest<sp/>--&gt;<sp/>PR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PR<sp/>--&gt;<sp/>QualityGates</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>QualityGates<sp/>--&gt;<sp/>DockerValidate</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DockerValidate<sp/>--&gt;<sp/>IntegrationTests</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>IntegrationTests<sp/>--&gt;<sp/>VercelProd</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>IntegrationTests<sp/>--&gt;<sp/>DockerProd</highlight></codeline>
</programlisting></para>
<para><bold>Promotion Rules:</bold></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Stage Transition   </para>
</entry><entry thead="yes"><para>Trigger   </para>
</entry><entry thead="yes"><para>Gates    </para>
</entry></row>
<row>
<entry thead="no"><para>Development → Integration   </para>
</entry><entry thead="no"><para>Pull Request opened   </para>
</entry><entry thead="no"><para>Automated CI initiation    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration → Staging   </para>
</entry><entry thead="no"><para>PR review approved   </para>
</entry><entry thead="no"><para>All quality gates passed    </para>
</entry></row>
<row>
<entry thead="no"><para>Staging → Production   </para>
</entry><entry thead="no"><para>Merge to <computeroutput>main</computeroutput>   </para>
</entry><entry thead="no"><para>Security scans, Docker build success   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4571">
<title>8.2.2.4 Backup and Disaster Recovery</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Backup Strategy   </para>
</entry><entry thead="yes"><para>Recovery Time Objective    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Application Code</bold>   </para>
</entry><entry thead="no"><para>Git repository (GitHub)   </para>
</entry><entry thead="no"><para>Immediate (re-deploy)    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Docker Images</bold>   </para>
</entry><entry thead="no"><para>GHCR versioned tags   </para>
</entry><entry thead="no"><para>&lt; 5 minutes    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>User Database (SQLite)</bold>   </para>
</entry><entry thead="no"><para>Volume mount persistence   </para>
</entry><entry thead="no"><para>Container restart    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Graph Cache (JSON)</bold>   </para>
</entry><entry thead="no"><para>Volume mount persistence   </para>
</entry><entry thead="no"><para>Cache rebuild &lt; 30 seconds    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Configuration</bold>   </para>
</entry><entry thead="no"><para>Git-tracked (except secrets)   </para>
</entry><entry thead="no"><para>Immediate (re-deploy)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4573">
<title>8.3 Cloud Services</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4574">
<title>8.3.1 Primary Platform: Vercel</title><para>Vercel serves as the primary production deployment platform, providing serverless hosting optimized for Next.js applications with Python serverless function support.</para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4575">
<title>8.3.1.1 Platform Selection Justification</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Criterion   </para>
</entry><entry thead="yes"><para>Vercel Advantage   </para>
</entry><entry thead="yes"><para>Alternative Consideration    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Next.js Integration</bold>   </para>
</entry><entry thead="no"><para>Native framework support   </para>
</entry><entry thead="no"><para>Manual configuration on other platforms    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Python Functions</bold>   </para>
</entry><entry thead="no"><para>Built-in <computeroutput>@vercel/python</computeroutput> builder   </para>
</entry><entry thead="no"><para>Requires container deployment elsewhere    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Global Edge Network</bold>   </para>
</entry><entry thead="no"><para>Automatic CDN distribution   </para>
</entry><entry thead="no"><para>Manual CDN setup required    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Preview Deployments</bold>   </para>
</entry><entry thead="no"><para>Automatic per-PR previews   </para>
</entry><entry thead="no"><para>Additional CI configuration needed    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Zero-Config Scaling</bold>   </para>
</entry><entry thead="no"><para>Automatic scaling   </para>
</entry><entry thead="no"><para>Manual scaling configuration   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4576">
<title>8.3.1.2 Vercel Build Configuration</title><para><bold>Source:</bold> <computeroutput>vercel.json</computeroutput></para>
<para><programlisting filename=".json"><codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>&quot;builds&quot;:<sp/>[</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&quot;src&quot;:<sp/>&quot;api/main.py&quot;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&quot;use&quot;:<sp/>&quot;@vercel/python&quot;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&quot;config&quot;:<sp/>{<sp/>&quot;maxLambdaSize&quot;:<sp/>&quot;50mb&quot;<sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>},</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&quot;src&quot;:<sp/>&quot;frontend/package.json&quot;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&quot;use&quot;:<sp/>&quot;@vercel/next&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>],</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>&quot;routes&quot;:<sp/>[</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/>&quot;src&quot;:<sp/>&quot;/api/(.*)&quot;,<sp/>&quot;dest&quot;:<sp/>&quot;api/main.py&quot;<sp/>},</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/>&quot;src&quot;:<sp/>&quot;/(.*)&quot;,<sp/>&quot;dest&quot;:<sp/>&quot;frontend/$1&quot;<sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>]</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
<para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Builder   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Backend API   </para>
</entry><entry thead="no"><para><computeroutput>@vercel/python</computeroutput>   </para>
</entry><entry thead="no"><para>maxLambdaSize: 50MB    </para>
</entry></row>
<row>
<entry thead="no"><para>Frontend   </para>
</entry><entry thead="no"><para><computeroutput>@vercel/next</computeroutput>   </para>
</entry><entry thead="no"><para>Default Next.js settings   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4577">
<title>8.3.1.3 Route Configuration</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Pattern   </para>
</entry><entry thead="yes"><para>Destination   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/(.*)</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Backend API routes    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/(.*)</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>frontend/$1</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend static/SSR pages   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4578">
<title>8.3.2 High Availability Design</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4579">
<title>8.3.2.1 Vercel High Availability Architecture</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>GlobalHA[Vercel<sp/>High<sp/>Availability]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>EdgeNetwork[Global<sp/>Edge<sp/>Network]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Edge1[Edge<sp/>Location<sp/>1&lt;br/&gt;US-East]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Edge2[Edge<sp/>Location<sp/>2&lt;br/&gt;EU-West]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Edge3[Edge<sp/>Location<sp/>3&lt;br/&gt;APAC]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>ComputeRegions[Compute<sp/>Regions]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Lambda1[Lambda<sp/>Instance&lt;br/&gt;Primary]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Lambda2[Lambda<sp/>Instance&lt;br/&gt;Replica]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>StaticAssets[Static<sp/>Asset<sp/>CDN]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CDN[Global<sp/>CDN&lt;br/&gt;Static<sp/>Files]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users([Global<sp/>Users])<sp/>--&gt;<sp/>Edge1</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users<sp/>--&gt;<sp/>Edge2</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users<sp/>--&gt;<sp/>Edge3</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Edge1<sp/>--&gt;<sp/>Lambda1</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Edge2<sp/>--&gt;<sp/>Lambda1</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Edge3<sp/>--&gt;<sp/>Lambda2</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Edge1<sp/>--&gt;<sp/>CDN</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Edge2<sp/>--&gt;<sp/>CDN</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Edge3<sp/>--&gt;<sp/>CDN</highlight></codeline>
</programlisting></para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>HA Component   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Benefit    </para>
</entry></row>
<row>
<entry thead="no"><para>Edge Distribution   </para>
</entry><entry thead="no"><para>Multiple global edge locations   </para>
</entry><entry thead="no"><para>Low latency worldwide    </para>
</entry></row>
<row>
<entry thead="no"><para>Function Replicas   </para>
</entry><entry thead="no"><para>Automatic instance scaling   </para>
</entry><entry thead="no"><para>Handle traffic spikes    </para>
</entry></row>
<row>
<entry thead="no"><para>Static CDN   </para>
</entry><entry thead="no"><para>Globally distributed cache   </para>
</entry><entry thead="no"><para>Fast asset delivery    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Monitoring   </para>
</entry><entry thead="no"><para>Platform-level monitoring   </para>
</entry><entry thead="no"><para>Automatic unhealthy instance removal   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4580">
<title>8.3.2.2 Docker High Availability</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Strategy   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Checks   </para>
</entry><entry thead="no"><para>HTTP probe on container   </para>
</entry><entry thead="no"><para>30s interval, 3 retries    </para>
</entry></row>
<row>
<entry thead="no"><para>Restart Policy   </para>
</entry><entry thead="no"><para><computeroutput>unless-stopped</computeroutput>   </para>
</entry><entry thead="no"><para>Automatic recovery    </para>
</entry></row>
<row>
<entry thead="no"><para>Volume Persistence   </para>
</entry><entry thead="no"><para>Mounted data volumes   </para>
</entry><entry thead="no"><para>Data survives restarts   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4581">
<title>8.3.3 Alternative Platform: Google Cloud Run</title><para>A deployment template is available for Google Cloud Run as an alternative cloud deployment option.</para>
<para><bold>Source:</bold> <computeroutput>.github/workflows/google-cloudrun-docker.yml</computeroutput></para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Workload Identity Federation   </para>
</entry><entry thead="no"><para>OIDC authentication for deployment    </para>
</entry></row>
<row>
<entry thead="no"><para>Artifact Registry   </para>
</entry><entry thead="no"><para>Container image storage    </para>
</entry></row>
<row>
<entry thead="no"><para>Cloud Run Service   </para>
</entry><entry thead="no"><para>Serverless container hosting   </para>
</entry></row>
</table>
</para>
<para><bold>Required Google Cloud APIs:</bold></para>
<para><itemizedlist>
<listitem><para>Artifact Registry API</para>
</listitem><listitem><para>Cloud Run Admin API</para>
</listitem><listitem><para>IAM Credentials API</para>
</listitem></itemizedlist>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4582">
<title>8.3.4 Cost Optimization Strategy</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4583">
<title>8.3.4.1 Vercel Cost Considerations</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Resource   </para>
</entry><entry thead="yes"><para>Hobby (Free)   </para>
</entry><entry thead="yes"><para>Pro ($20/user/month)   </para>
</entry><entry thead="yes"><para>Optimization Strategy    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Bandwidth</bold>   </para>
</entry><entry thead="no"><para>100 GB/month   </para>
</entry><entry thead="no"><para>1 TB/month   </para>
</entry><entry thead="no"><para>Enable compression, optimize assets    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Function Invocations</bold>   </para>
</entry><entry thead="no"><para>150K/month   </para>
</entry><entry thead="no"><para>1M/month   </para>
</entry><entry thead="no"><para>Implement caching    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Active CPU Time</bold>   </para>
</entry><entry thead="no"><para>Limited   </para>
</entry><entry thead="no"><para>40 hours/month   </para>
</entry><entry thead="no"><para>Optimize function execution    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Edge Requests</bold>   </para>
</entry><entry thead="no"><para>Included   </para>
</entry><entry thead="no"><para>10M/month   </para>
</entry><entry thead="no"><para>Static asset CDN caching   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4584">
<title>8.3.4.2 Infrastructure Cost Estimates</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Deployment Model   </para>
</entry><entry thead="yes"><para>Monthly Cost Estimate   </para>
</entry><entry thead="yes"><para>Best For    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Local Development</bold>   </para>
</entry><entry thead="no"><para>$0   </para>
</entry><entry thead="no"><para>Development, testing    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Vercel Hobby</bold>   </para>
</entry><entry thead="no"><para>$0   </para>
</entry><entry thead="no"><para>Personal projects, demos    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Vercel Pro</bold>   </para>
</entry><entry thead="no"><para>$20/user   </para>
</entry><entry thead="no"><para>Small teams, production    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Docker Self-Hosted</bold>   </para>
</entry><entry thead="no"><para>Infrastructure cost only   </para>
</entry><entry thead="no"><para>Full control requirements    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Google Cloud Run</bold>   </para>
</entry><entry thead="no"><para>~$5-50 (usage-based)   </para>
</entry><entry thead="no"><para>GCP ecosystem integration   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect4>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4586">
<title>8.4 Containerization</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4587">
<title>8.4.1 Container Platform: Docker</title><para>The system uses Docker for containerization, providing consistent runtime environments across development, testing, and production deployments.</para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4588">
<title>8.4.1.1 Base Image Strategy</title><para><bold>Source:</bold> <computeroutput>Dockerfile</computeroutput></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Rationale    </para>
</entry></row>
<row>
<entry thead="no"><para><bold><ref refid="classBase" kindref="compound">Base</ref> Image</bold>   </para>
</entry><entry thead="no"><para><computeroutput>python:3.11-slim</computeroutput>   </para>
</entry><entry thead="no"><para>Minimal attack surface, small image size    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Python Version</bold>   </para>
</entry><entry thead="no"><para>3.11   </para>
</entry><entry thead="no"><para>Stable, performance improvements    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Image Variant</bold>   </para>
</entry><entry thead="no"><para><computeroutput>slim</computeroutput>   </para>
</entry><entry thead="no"><para>No unnecessary development tools   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4589">
<title>8.4.1.2 Container Security Architecture</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ContainerSecurity[Container<sp/>Security<sp/>Layers]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>BuildPhase[Build<sp/>Phase<sp/>Security]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BaseImage[Minimal<sp/>Base<sp/>Image&lt;br/&gt;python:3.11-slim]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NoCache[No<sp/>Pip<sp/>Cache&lt;br/&gt;--no-cache-dir]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NoBytecode[No<sp/>Bytecode&lt;br/&gt;PYTHONDONTWRITEBYTECODE=1]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>RuntimeSecurity[Runtime<sp/>Security]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NonRoot[Non-Root<sp/>User&lt;br/&gt;appuser<sp/>UID<sp/>1000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReadOnly[Minimal<sp/>Permissions&lt;br/&gt;Application<sp/>Directory<sp/>Only]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HealthCheck[Health<sp/>Monitoring&lt;br/&gt;HTTP<sp/>Probe]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>NetworkSecurity[Network<sp/>Security]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SinglePort[Single<sp/>Port<sp/>Exposure&lt;br/&gt;7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InternalOnly[Internal<sp/>Services&lt;br/&gt;No<sp/>External<sp/>Access]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>BaseImage<sp/>--&gt;<sp/>NoCache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NoCache<sp/>--&gt;<sp/>NoBytecode</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NoBytecode<sp/>--&gt;<sp/>NonRoot</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>NonRoot<sp/>--&gt;<sp/>ReadOnly</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ReadOnly<sp/>--&gt;<sp/>HealthCheck</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>HealthCheck<sp/>--&gt;<sp/>SinglePort</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SinglePort<sp/>--&gt;<sp/>InternalOnly</highlight></codeline>
</programlisting></para>
<para><bold>Security Measures Implementation:</bold></para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Security Measure   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Protection    </para>
</entry></row>
<row>
<entry thead="no"><para>Non-root User   </para>
</entry><entry thead="no"><para><computeroutput>useradd -m -u 1000 appuser</computeroutput>   </para>
</entry><entry thead="no"><para>Privilege escalation prevention    </para>
</entry></row>
<row>
<entry thead="no"><para>Minimal <ref refid="classBase" kindref="compound">Base</ref> Image   </para>
</entry><entry thead="no"><para><computeroutput>python:3.11-slim</computeroutput>   </para>
</entry><entry thead="no"><para>Reduced attack surface    </para>
</entry></row>
<row>
<entry thead="no"><para>No Cache   </para>
</entry><entry thead="no"><para><computeroutput>pip install --no-cache-dir</computeroutput>   </para>
</entry><entry thead="no"><para>No sensitive data in layers    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Checks   </para>
</entry><entry thead="no"><para><computeroutput>HEALTHCHECK</computeroutput> instruction   </para>
</entry><entry thead="no"><para>Container orchestration support    </para>
</entry></row>
<row>
<entry thead="no"><para>No Bytecode   </para>
</entry><entry thead="no"><para><computeroutput>PYTHONDONTWRITEBYTECODE=1</computeroutput>   </para>
</entry><entry thead="no"><para>Cleaner runtime    </para>
</entry></row>
<row>
<entry thead="no"><para>Unbuffered Output   </para>
</entry><entry thead="no"><para><computeroutput>PYTHONUNBUFFERED=1</computeroutput>   </para>
</entry><entry thead="no"><para>Real-time logging   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4590">
<title>8.4.1.3 Dockerfile Configuration</title><para><table rows="8" cols="3"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Working Directory   </para>
</entry><entry thead="no"><para><computeroutput>/app</computeroutput>   </para>
</entry><entry thead="no"><para>Application root    </para>
</entry></row>
<row>
<entry thead="no"><para>User   </para>
</entry><entry thead="no"><para><computeroutput>appuser</computeroutput> (UID 1000)   </para>
</entry><entry thead="no"><para>Non-root execution    </para>
</entry></row>
<row>
<entry thead="no"><para>Exposed Port   </para>
</entry><entry thead="no"><para>7860   </para>
</entry><entry thead="no"><para>Gradio interface    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Check Interval   </para>
</entry><entry thead="no"><para>30 seconds   </para>
</entry><entry thead="no"><para>Container health monitoring    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Check Timeout   </para>
</entry><entry thead="no"><para>10 seconds   </para>
</entry><entry thead="no"><para>Probe timeout    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Check Retries   </para>
</entry><entry thead="no"><para>3   </para>
</entry><entry thead="no"><para>Failures before unhealthy    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Check Start Period   </para>
</entry><entry thead="no"><para>5 seconds   </para>
</entry><entry thead="no"><para>Startup grace period   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4591">
<title>8.4.2 Docker Compose Configuration</title><para><bold>Source:</bold> <computeroutput>docker-compose.yml</computeroutput></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4592">
<title>8.4.2.1 Service Definition</title><para><table rows="3" cols="4"><row>
<entry thead="yes"><para>Service   </para>
</entry><entry thead="yes"><para>Image   </para>
</entry><entry thead="yes"><para>Ports   </para>
</entry><entry thead="yes"><para>Restart Policy    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>app</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>financial-asset-db:latest</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>7860:7860</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>unless-stopped</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>postgres</computeroutput> (optional)   </para>
</entry><entry thead="no"><para><computeroutput>postgres:15-alpine</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>5432:5432</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>unless-stopped</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4593">
<title>8.4.2.2 Volume Configuration</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Volume Mount   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Persistence    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>./src:/app/src</computeroutput>   </para>
</entry><entry thead="no"><para>Application source   </para>
</entry><entry thead="no"><para>Development hot-reload    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>./data:/app/data</computeroutput>   </para>
</entry><entry thead="no"><para>Data persistence   </para>
</entry><entry thead="no"><para>Cache and database files   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4594">
<title>8.4.2.3 Health Check Configuration</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Parameter   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Test Command   </para>
</entry><entry thead="no"><para><computeroutput>curl -f <ulink url="http://localhost:7860/">http://localhost:7860/</ulink></computeroutput>   </para>
</entry><entry thead="no"><para>HTTP health probe    </para>
</entry></row>
<row>
<entry thead="no"><para>Interval   </para>
</entry><entry thead="no"><para>30 seconds   </para>
</entry><entry thead="no"><para>Check frequency    </para>
</entry></row>
<row>
<entry thead="no"><para>Timeout   </para>
</entry><entry thead="no"><para>10 seconds   </para>
</entry><entry thead="no"><para>Maximum probe duration    </para>
</entry></row>
<row>
<entry thead="no"><para>Retries   </para>
</entry><entry thead="no"><para>3   </para>
</entry><entry thead="no"><para>Failures before unhealthy    </para>
</entry></row>
<row>
<entry thead="no"><para>Start Period   </para>
</entry><entry thead="no"><para>40 seconds   </para>
</entry><entry thead="no"><para>Startup grace period   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4595">
<title>8.4.3 Image Versioning Approach</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Version Pattern   </para>
</entry><entry thead="yes"><para>Example   </para>
</entry><entry thead="yes"><para>Use Case    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>latest</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>financial-asset-db:latest</computeroutput>   </para>
</entry><entry thead="no"><para>Development, CI    </para>
</entry></row>
<row>
<entry thead="no"><para>Semantic Version   </para>
</entry><entry thead="no"><para><computeroutput>financial-asset-db:v1.2.3</computeroutput>   </para>
</entry><entry thead="no"><para>Production releases    </para>
</entry></row>
<row>
<entry thead="no"><para>Git SHA   </para>
</entry><entry thead="no"><para><computeroutput>financial-asset-db:abc1234</computeroutput>   </para>
</entry><entry thead="no"><para>Traceability    </para>
</entry></row>
<row>
<entry thead="no"><para>Date-based   </para>
</entry><entry thead="no"><para><computeroutput>financial-asset-db:2025-01-03</computeroutput>   </para>
</entry><entry thead="no"><para>Scheduled builds   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4596">
<title>8.4.4 Build Optimization Techniques</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Technique   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Benefit    </para>
</entry></row>
<row>
<entry thead="no"><para>Multi-stage builds   </para>
</entry><entry thead="no"><para>Separate build and runtime stages   </para>
</entry><entry thead="no"><para>Smaller final image    </para>
</entry></row>
<row>
<entry thead="no"><para>Layer caching   </para>
</entry><entry thead="no"><para>Order Dockerfile commands strategically   </para>
</entry><entry thead="no"><para>Faster rebuilds    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.dockerignore</computeroutput>   </para>
</entry><entry thead="no"><para>Exclude unnecessary files   </para>
</entry><entry thead="no"><para>Smaller build context    </para>
</entry></row>
<row>
<entry thead="no"><para>Dependency pinning   </para>
</entry><entry thead="no"><para>Exact versions in requirements.txt   </para>
</entry><entry thead="no"><para>Reproducible builds   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4597">
<title>8.4.5 Security Scanning Requirements</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Workflow   </para>
</entry><entry thead="yes"><para>Trigger   </para>
</entry><entry thead="yes"><para>Severity    </para>
</entry></row>
<row>
<entry thead="no"><para>Trivy   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/trivy.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Push, PR, Weekly schedule   </para>
</entry><entry thead="no"><para>CRITICAL, HIGH    </para>
</entry></row>
<row>
<entry thead="no"><para>Hadolint   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/hadolint.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Push, PR   </para>
</entry><entry thead="no"><para>All levels    </para>
</entry></row>
<row>
<entry thead="no"><para>Snyk Container   </para>
</entry><entry thead="no"><para><computeroutput>.github/workflows/snyk-container.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Push, PR   </para>
</entry><entry thead="no"><para>CRITICAL, HIGH   </para>
</entry></row>
</table>
</para>
<para><bold>Scanning Schedule:</bold></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Scan Type   </para>
</entry><entry thead="yes"><para>Frequency   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>On-demand   </para>
</entry><entry thead="no"><para>Every push/PR   </para>
</entry><entry thead="no"><para>Immediate feedback    </para>
</entry></row>
<row>
<entry thead="no"><para>Scheduled   </para>
</entry><entry thead="no"><para>Weekly (Saturday 14:30 UTC)   </para>
</entry><entry thead="no"><para>Continuous vulnerability monitoring    </para>
</entry></row>
<row>
<entry thead="no"><para>Nightly   </para>
</entry><entry thead="no"><para>Daily (02:00 UTC)   </para>
</entry><entry thead="no"><para>Security regression detection   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4599">
<title>8.5 Orchestration</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4600">
<title>8.5.1 Orchestration Platform Selection</title><para>The system uses <bold>Docker Compose</bold> for container orchestration rather than Kubernetes, optimized for the monolithic architecture design.</para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4601">
<title>8.5.1.1 Platform Justification</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Factor   </para>
</entry><entry thead="yes"><para>Docker Compose   </para>
</entry><entry thead="yes"><para>Kubernetes    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Complexity</bold>   </para>
</entry><entry thead="no"><para>Low   </para>
</entry><entry thead="no"><para>High    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Scale Target</bold>   </para>
</entry><entry thead="no"><para>&lt; 500 assets   </para>
</entry><entry thead="no"><para>Enterprise-scale    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Operational Overhead</bold>   </para>
</entry><entry thead="no"><para>Minimal   </para>
</entry><entry thead="no"><para>Significant    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Learning Curve</bold>   </para>
</entry><entry thead="no"><para>Gentle   </para>
</entry><entry thead="no"><para>Steep    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Current Fit</bold>   </para>
</entry><entry thead="no"><para>✅ Optimal   </para>
</entry><entry thead="no"><para>❌ Over-engineered   </para>
</entry></row>
</table>
</para>
<para><bold>Rationale from Architecture:</bold></para>
<para><itemizedlist>
<listitem><para>Monolithic core architecture optimized for &lt; 500 assets</para>
</listitem><listitem><para>Single deployable Python process with modular packages</para>
</listitem><listitem><para>Simplifies deployment for current scale</para>
</listitem><listitem><para>Maintains clear module boundaries</para>
</listitem></itemizedlist>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4602">
<title>8.5.2 Service Architecture</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DockerCompose[Docker<sp/>Compose<sp/>Orchestration]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>AppService[Application<sp/>Service]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>App[app<sp/>container&lt;br/&gt;Port<sp/>7860&lt;br/&gt;Python<sp/>3.11-slim]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>OptionalServices[Optional<sp/>Services]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Postgres[(PostgreSQL<sp/>15&lt;br/&gt;Port<sp/>5432&lt;br/&gt;Optional)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Volumes[Persistent<sp/>Volumes]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SrcVol[Source<sp/>Volume&lt;br/&gt;./src:/app/src]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DataVol[Data<sp/>Volume&lt;br/&gt;./data:/app/data]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PgVol[(PostgreSQL<sp/>Data&lt;br/&gt;Optional)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Network[Docker<sp/>Network]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Bridge[Default<sp/>Bridge&lt;br/&gt;Network]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>App<sp/>--&gt;<sp/>SrcVol</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>App<sp/>--&gt;<sp/>DataVol</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>App<sp/>--&gt;<sp/>Bridge</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Postgres<sp/>--&gt;<sp/>PgVol</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Postgres<sp/>--&gt;<sp/>Bridge</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>App<sp/>-.-&gt;<sp/>Postgres</highlight></codeline>
</programlisting></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4603">
<title>8.5.2.1 Current Services</title><para><table rows="3" cols="4"><row>
<entry thead="yes"><para>Service   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Dependencies   </para>
</entry><entry thead="yes"><para>Health Check    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>app</computeroutput>   </para>
</entry><entry thead="no"><para>Primary application   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>HTTP probe    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>postgres</computeroutput> (optional)   </para>
</entry><entry thead="no"><para>Database persistence   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>TCP probe   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4604">
<title>8.5.3 Auto-Scaling Configuration</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4605">
<title>8.5.3.1 Vercel Auto-Scaling</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Scaling Aspect   </para>
</entry><entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Behavior    </para>
</entry></row>
<row>
<entry thead="no"><para>Function Instances   </para>
</entry><entry thead="no"><para>Automatic   </para>
</entry><entry thead="no"><para>Scale to zero, scale up on demand    </para>
</entry></row>
<row>
<entry thead="no"><para>Cold Start   </para>
</entry><entry thead="no"><para>Expected   </para>
</entry><entry thead="no"><para>First request may have latency    </para>
</entry></row>
<row>
<entry thead="no"><para>Concurrent Requests   </para>
</entry><entry thead="no"><para>Platform-managed   </para>
</entry><entry thead="no"><para>Automatic instance distribution    </para>
</entry></row>
<row>
<entry thead="no"><para>Geographic Distribution   </para>
</entry><entry thead="no"><para>Automatic   </para>
</entry><entry thead="no"><para>Route to nearest edge   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4606">
<title>8.5.3.2 Docker Manual Scaling</title><para><programlisting filename=".bash"><codeline><highlight class="normal">#<sp/>Scale<sp/>application<sp/>to<sp/>multiple<sp/>instances<sp/>(load<sp/>balancer<sp/>required)</highlight></codeline>
<codeline><highlight class="normal">docker-compose<sp/>up<sp/>--scale<sp/>app=3<sp/>-d</highlight></codeline>
</programlisting></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Consideration   </para>
</entry><entry thead="yes"><para>Current State   </para>
</entry><entry thead="yes"><para>Production Recommendation    </para>
</entry></row>
<row>
<entry thead="no"><para>Load Balancing   </para>
</entry><entry thead="no"><para>Not configured   </para>
</entry><entry thead="no"><para>Add nginx/traefik for multi-instance    </para>
</entry></row>
<row>
<entry thead="no"><para>Session Affinity   </para>
</entry><entry thead="no"><para>N/A (stateless JWT)   </para>
</entry><entry thead="no"><para>Not required    </para>
</entry></row>
<row>
<entry thead="no"><para>Health-based Routing   </para>
</entry><entry thead="no"><para>Docker health checks   </para>
</entry><entry thead="no"><para>Configure orchestrator probes   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4607">
<title>8.5.4 Future Kubernetes Support</title><para>A Kubernetes deployment template is documented in <computeroutput><ref refid="DOCKER_8md" kindref="compound">DOCKER.md</ref></computeroutput> for future enterprise deployments:</para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Resource   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Deployment   </para>
</entry><entry thead="no"><para>3 replicas, rolling update strategy    </para>
</entry></row>
<row>
<entry thead="no"><para>Service   </para>
</entry><entry thead="no"><para>ClusterIP, port 7860    </para>
</entry></row>
<row>
<entry thead="no"><para>ConfigMap   </para>
</entry><entry thead="no"><para>Environment variables    </para>
</entry></row>
<row>
<entry thead="no"><para>Secret   </para>
</entry><entry thead="no"><para>Sensitive credentials   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4609">
<title>8.6 CI/CD Pipeline</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4610">
<title>8.6.1 Pipeline Architecture Overview</title><para>The system implements a comprehensive CI/CD pipeline using GitHub Actions as the primary platform with CircleCI as a secondary/redundant system.</para>
<para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Triggers[Pipeline<sp/>Triggers]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Push[Push<sp/>to<sp/>main]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PR[Pull<sp/>Request]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Schedule[Scheduled<sp/>Jobs]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Tag[Version<sp/>Tags]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>QualityGates[Quality<sp/>Gates]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Lint[Linting&lt;br/&gt;flake8,<sp/>black,<sp/>isort]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>StaticAnalysis[Static<sp/>Analysis&lt;br/&gt;pylint,<sp/>mypy]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Tests[Test<sp/>Suite&lt;br/&gt;pytest<sp/>+<sp/>coverage]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Security[Security<sp/>Scans&lt;br/&gt;bandit,<sp/>safety]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>BuildPhase[Build<sp/>Phase]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerBuild[Docker<sp/>Build]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FrontendBuild[Frontend<sp/>Build&lt;br/&gt;Next.js]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DeployPhase[Deployment<sp/>Phase]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelDeploy[Vercel&lt;br/&gt;Auto-Deploy]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GHCRPublish[GHCR&lt;br/&gt;Image<sp/>Publish]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ImageSign[Image<sp/>Signing&lt;br/&gt;cosign]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Reporting[Reporting]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Codecov[Codecov&lt;br/&gt;Coverage]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SARIF[GitHub<sp/>Security&lt;br/&gt;SARIF<sp/>Upload]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Push<sp/>--&gt;<sp/>QualityGates</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PR<sp/>--&gt;<sp/>QualityGates</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Schedule<sp/>--&gt;<sp/>Security</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Tag<sp/>--&gt;<sp/>BuildPhase</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>QualityGates<sp/>--&gt;<sp/>BuildPhase</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>BuildPhase<sp/>--&gt;<sp/>DeployPhase</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Tests<sp/>--&gt;<sp/>Codecov</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Security<sp/>--&gt;<sp/>SARIF</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DockerBuild<sp/>--&gt;<sp/>GHCRPublish</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GHCRPublish<sp/>--&gt;<sp/>ImageSign</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4611">
<title>8.6.2 Build Pipeline</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4612">
<title>8.6.2.1 Source Control Triggers</title><para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Trigger   </para>
</entry><entry thead="yes"><para>Event   </para>
</entry><entry thead="yes"><para>Branches   </para>
</entry><entry thead="yes"><para>Actions    </para>
</entry></row>
<row>
<entry thead="no"><para>Push   </para>
</entry><entry thead="no"><para>Code push   </para>
</entry><entry thead="no"><para><computeroutput>main</computeroutput>   </para>
</entry><entry thead="no"><para>Full CI pipeline    </para>
</entry></row>
<row>
<entry thead="no"><para>Pull Request   </para>
</entry><entry thead="no"><para>PR opened/updated   </para>
</entry><entry thead="no"><para><computeroutput>main</computeroutput>   </para>
</entry><entry thead="no"><para>CI + preview deployment    </para>
</entry></row>
<row>
<entry thead="no"><para>Schedule   </para>
</entry><entry thead="no"><para>Cron   </para>
</entry><entry thead="no"><para><computeroutput>main</computeroutput>   </para>
</entry><entry thead="no"><para>Security scans (nightly)    </para>
</entry></row>
<row>
<entry thead="no"><para>Tag   </para>
</entry><entry thead="no"><para>Version tag   </para>
</entry><entry thead="no"><para><computeroutput>v*.*.*</computeroutput>   </para>
</entry><entry thead="no"><para>Release build + publish    </para>
</entry></row>
<row>
<entry thead="no"><para>Manual   </para>
</entry><entry thead="no"><para><computeroutput>workflow_dispatch</computeroutput>   </para>
</entry><entry thead="no"><para>Selected   </para>
</entry><entry thead="no"><para>On-demand execution   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4613">
<title>8.6.2.2 Build Environment Requirements</title><para><bold>Python Environment Matrix:</bold></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Status   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Python 3.10   </para>
</entry><entry thead="no"><para>✅ Tested   </para>
</entry><entry thead="no"><para>Legacy support    </para>
</entry></row>
<row>
<entry thead="no"><para>Python 3.11   </para>
</entry><entry thead="no"><para>✅ Primary   </para>
</entry><entry thead="no"><para>Production runtime    </para>
</entry></row>
<row>
<entry thead="no"><para>Python 3.12   </para>
</entry><entry thead="no"><para>✅ Tested   </para>
</entry><entry thead="no"><para>Forward compatibility   </para>
</entry></row>
</table>
</para>
<para><bold>Node.js Environment Matrix:</bold></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Status   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Node.js 18.x   </para>
</entry><entry thead="no"><para>✅ Tested   </para>
</entry><entry thead="no"><para>LTS support    </para>
</entry></row>
<row>
<entry thead="no"><para>Node.js 20.x   </para>
</entry><entry thead="no"><para>✅ Primary   </para>
</entry><entry thead="no"><para>Current LTS    </para>
</entry></row>
<row>
<entry thead="no"><para>Node.js 22.x   </para>
</entry><entry thead="no"><para>✅ Tested   </para>
</entry><entry thead="no"><para>Forward compatibility   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4614">
<title>8.6.2.3 Dependency Management</title><para><bold>Python Dependencies (requirements.txt):</bold></para>
<para><table rows="12" cols="3"><row>
<entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>fastapi</computeroutput>   </para>
</entry><entry thead="no"><para>==0.127.0   </para>
</entry><entry thead="no"><para>API framework (pinned)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>pydantic</computeroutput>   </para>
</entry><entry thead="no"><para>==2.12.5   </para>
</entry><entry thead="no"><para>Data validation (pinned)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>numpy</computeroutput>   </para>
</entry><entry thead="no"><para>==2.2.6   </para>
</entry><entry thead="no"><para>Numerical computing (pinned)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>gradio</computeroutput>   </para>
</entry><entry thead="no"><para>&gt;=4.0.0,&lt;6.0.0   </para>
</entry><entry thead="no"><para>Legacy UI    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>plotly</computeroutput>   </para>
</entry><entry thead="no"><para>&gt;=6.0.0   </para>
</entry><entry thead="no"><para>Visualization    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>yfinance</computeroutput>   </para>
</entry><entry thead="no"><para>&gt;=0.2.51   </para>
</entry><entry thead="no"><para>Financial data    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>PyJWT</computeroutput>   </para>
</entry><entry thead="no"><para>&gt;=2.8.0   </para>
</entry><entry thead="no"><para>Authentication    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>passlib[bcrypt]</computeroutput>   </para>
</entry><entry thead="no"><para>&gt;=1.7.4   </para>
</entry><entry thead="no"><para>Password hashing    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>slowapi</computeroutput>   </para>
</entry><entry thead="no"><para>&gt;=0.1.4   </para>
</entry><entry thead="no"><para>Rate limiting    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>urllib3</computeroutput>   </para>
</entry><entry thead="no"><para>&gt;=2.6.0   </para>
</entry><entry thead="no"><para>Security pin    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>zipp</computeroutput>   </para>
</entry><entry thead="no"><para>&gt;=3.19.1   </para>
</entry><entry thead="no"><para>Security pin   </para>
</entry></row>
</table>
</para>
<para><bold>Frontend Dependencies (package.json):</bold></para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Package   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>next</computeroutput>   </para>
</entry><entry thead="no"><para>^14.2.35   </para>
</entry><entry thead="no"><para>React framework    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>react</computeroutput>   </para>
</entry><entry thead="no"><para>^18.2.0   </para>
</entry><entry thead="no"><para>UI library    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>axios</computeroutput>   </para>
</entry><entry thead="no"><para>^1.6.0   </para>
</entry><entry thead="no"><para>HTTP client    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>plotly.js</computeroutput>   </para>
</entry><entry thead="no"><para>^2.27.0   </para>
</entry><entry thead="no"><para>Visualization    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>jest</computeroutput>   </para>
</entry><entry thead="no"><para>^29.7.0   </para>
</entry><entry thead="no"><para>Test runner    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>typescript</computeroutput>   </para>
</entry><entry thead="no"><para>^5.3.0   </para>
</entry><entry thead="no"><para>Type checking   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4615">
<title>8.6.2.4 Quality Gates</title><para><table rows="9" cols="4"><row>
<entry thead="yes"><para>Gate   </para>
</entry><entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Threshold   </para>
</entry><entry thead="yes"><para>Blocking    </para>
</entry></row>
<row>
<entry thead="no"><para>Critical Lint Errors   </para>
</entry><entry thead="no"><para>flake8   </para>
</entry><entry thead="no"><para>0 errors   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para>Full Lint   </para>
</entry><entry thead="no"><para>flake8 + statistics   </para>
</entry><entry thead="no"><para>Pass   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para>Formatting   </para>
</entry><entry thead="no"><para>black <ndash/>check   </para>
</entry><entry thead="no"><para>100%   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para>Import Sorting   </para>
</entry><entry thead="no"><para>isort <ndash/>check-only   </para>
</entry><entry thead="no"><para>100%   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para>Static Analysis   </para>
</entry><entry thead="no"><para>pylint   </para>
</entry><entry thead="no"><para>&gt;= 7.0 score   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para>Type Checking   </para>
</entry><entry thead="no"><para>mypy   </para>
</entry><entry thead="no"><para>Pass   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para>Unit Tests   </para>
</entry><entry thead="no"><para>pytest   </para>
</entry><entry thead="no"><para>100% pass   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para>Coverage   </para>
</entry><entry thead="no"><para>Codecov   </para>
</entry><entry thead="no"><para>80%+ target   </para>
</entry><entry thead="no"><para>Warning   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4616">
<title>8.6.2.5 Artifact Generation and Storage</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Artifact   </para>
</entry><entry thead="yes"><para>Destination   </para>
</entry><entry thead="yes"><para>Trigger   </para>
</entry><entry thead="yes"><para>Retention    </para>
</entry></row>
<row>
<entry thead="no"><para>Coverage Reports (XML/HTML)   </para>
</entry><entry thead="no"><para>Codecov, GitHub Artifacts   </para>
</entry><entry thead="no"><para>Test completion   </para>
</entry><entry thead="no"><para>90 days    </para>
</entry></row>
<row>
<entry thead="no"><para>Docker Images   </para>
</entry><entry thead="no"><para>GHCR (ghcr.io)   </para>
</entry><entry thead="no"><para>Push to main, tags   </para>
</entry><entry thead="no"><para>Permanent    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Scan Results   </para>
</entry><entry thead="no"><para>SARIF → GitHub Security   </para>
</entry><entry thead="no"><para>Push/PR   </para>
</entry><entry thead="no"><para>90 days    </para>
</entry></row>
<row>
<entry thead="no"><para>Build Outputs   </para>
</entry><entry thead="no"><para>CircleCI Artifacts   </para>
</entry><entry thead="no"><para>Build completion   </para>
</entry><entry thead="no"><para>30 days   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4617">
<title>8.6.3 GitHub Actions Primary Pipeline</title><para><bold>Source:</bold> <computeroutput>.github/workflows/ci.yml</computeroutput></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4618">
<title>8.6.3.1 Workflow Configuration</title><para><programlisting filename=".yaml"><codeline><highlight class="normal">name:<sp/>Python<sp/>CI</highlight></codeline>
<codeline><highlight class="normal">on:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>push:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>branches:<sp/>[&quot;main&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>pull_request:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>branches:<sp/>[&quot;main&quot;]</highlight></codeline>
<codeline><highlight class="normal">permissions:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>contents:<sp/>read</highlight></codeline>
<codeline><highlight class="normal">concurrency:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>group:<sp/>${{<sp/>github.workflow<sp/>}}-${{<sp/>github.ref<sp/>}}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>cancel-in-progress:<sp/>true</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4619">
<title>8.6.3.2 Job Structure</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Job   </para>
</entry><entry thead="yes"><para>Actions   </para>
</entry><entry thead="yes"><para>Dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>test</computeroutput>   </para>
</entry><entry thead="no"><para>Lint, format check, type check, pytest   </para>
</entry><entry thead="no"><para>None    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>security</computeroutput>   </para>
</entry><entry thead="no"><para>safety, bandit   </para>
</entry><entry thead="no"><para>test    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>coverage</computeroutput>   </para>
</entry><entry thead="no"><para>Codecov upload   </para>
</entry><entry thead="no"><para>test   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4620">
<title>8.6.4 CircleCI Secondary Pipeline</title><para><bold>Source:</bold> <computeroutput>.circleci/config.yml</computeroutput></para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4621">
<title>8.6.4.1 Executor Configuration</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Executor   </para>
</entry><entry thead="yes"><para>Image   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>python-executor</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>cimg/python:3.11</computeroutput>   </para>
</entry><entry thead="no"><para>Python jobs    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>node-executor</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>cimg/node:18.19</computeroutput>   </para>
</entry><entry thead="no"><para>Node.js jobs   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4622">
<title>8.6.4.2 Job Definitions</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Job   </para>
</entry><entry thead="yes"><para>Actions   </para>
</entry><entry thead="yes"><para>Parallelism    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>python-lint</computeroutput>   </para>
</entry><entry thead="no"><para>flake8 (critical errors)   </para>
</entry><entry thead="no"><para>1    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>python-test</computeroutput>   </para>
</entry><entry thead="no"><para>pytest with coverage   </para>
</entry><entry thead="no"><para>4    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>python-security</computeroutput>   </para>
</entry><entry thead="no"><para>safety + bandit   </para>
</entry><entry thead="no"><para>1    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend-lint</computeroutput>   </para>
</entry><entry thead="no"><para>npm run lint   </para>
</entry><entry thead="no"><para>1    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend-build</computeroutput>   </para>
</entry><entry thead="no"><para>npm run build   </para>
</entry><entry thead="no"><para>1    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>docker-build</computeroutput>   </para>
</entry><entry thead="no"><para>Build + smoke test   </para>
</entry><entry thead="no"><para>1   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4623">
<title>8.6.4.3 Workflow Definitions</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>BuildAndTest[build-and-test<sp/>Workflow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PLint[python-lint]<sp/>--&gt;<sp/>PTest[python-test]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PTest<sp/>--&gt;<sp/>PSec[python-security]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FLint[frontend-lint]<sp/>--&gt;<sp/>FBuild[frontend-build]</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PTest<sp/>--&gt;<sp/>Docker[docker-build]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FBuild<sp/>--&gt;<sp/>Docker</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>NightlySecurity[nightly-security<sp/>Workflow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cron[Schedule&lt;br/&gt;02:00<sp/>UTC]<sp/>--&gt;<sp/>NightSec[python-security]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
</programlisting></para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4624">
<title>8.6.5 Deployment Pipeline</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4625">
<title>8.6.5.1 Docker Image Publishing</title><para><bold>Source:</bold> <computeroutput>.github/workflows/docker-publish.yml</computeroutput></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Registry   </para>
</entry><entry thead="no"><para><computeroutput>ghcr.io</computeroutput>   </para>
</entry><entry thead="no"><para>GitHub Container Registry    </para>
</entry></row>
<row>
<entry thead="no"><para>Image Name   </para>
</entry><entry thead="no"><para><computeroutput>${{ github.repository }}</computeroutput>   </para>
</entry><entry thead="no"><para>Repository-based naming    </para>
</entry></row>
<row>
<entry thead="no"><para>Signing   </para>
</entry><entry thead="no"><para><computeroutput>sigstore/cosign</computeroutput>   </para>
</entry><entry thead="no"><para>Supply chain security   </para>
</entry></row>
</table>
</para>
<para><bold>Triggers:</bold></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Trigger   </para>
</entry><entry thead="yes"><para>Condition   </para>
</entry><entry thead="yes"><para>Action    </para>
</entry></row>
<row>
<entry thead="no"><para>Schedule   </para>
</entry><entry thead="no"><para>Daily 15:27 UTC   </para>
</entry><entry thead="no"><para>Regular builds    </para>
</entry></row>
<row>
<entry thead="no"><para>Push   </para>
</entry><entry thead="no"><para><computeroutput>main</computeroutput> branch, Docker paths   </para>
</entry><entry thead="no"><para>Auto-publish    </para>
</entry></row>
<row>
<entry thead="no"><para>Tag   </para>
</entry><entry thead="no"><para><computeroutput>v*.*.*</computeroutput> pattern   </para>
</entry><entry thead="no"><para>Versioned release   </para>
</entry></row>
</table>
</para>
<para><bold>Publishing Steps:</bold></para>
<para><orderedlist>
<listitem><para>Checkout repository</para>
</listitem><listitem><para>Install cosign (image signing)</para>
</listitem><listitem><para>Set up Docker Buildx</para>
</listitem><listitem><para>Login to GHCR</para>
</listitem><listitem><para>Extract metadata (tags, labels)</para>
</listitem><listitem><para>Build and push image</para>
</listitem><listitem><para>Sign image with cosign (except on PRs)</para>
</listitem></orderedlist>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4626">
<title>8.6.5.2 Vercel Deployment</title><para><bold>GitHub Integration (Recommended):</bold></para>
<para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Step   </para>
</entry><entry thead="yes"><para>Action   </para>
</entry><entry thead="yes"><para>Outcome    </para>
</entry></row>
<row>
<entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>Push to GitHub   </para>
</entry><entry thead="no"><para>Triggers deployment    </para>
</entry></row>
<row>
<entry thead="no"><para>2   </para>
</entry><entry thead="no"><para>Vercel build   </para>
</entry><entry thead="no"><para>Frontend + API compiled    </para>
</entry></row>
<row>
<entry thead="no"><para>3   </para>
</entry><entry thead="no"><para>Preview URL   </para>
</entry><entry thead="no"><para>PR gets unique preview    </para>
</entry></row>
<row>
<entry thead="no"><para>4   </para>
</entry><entry thead="no"><para>Production deploy   </para>
</entry><entry thead="no"><para>Main branch auto-deploys   </para>
</entry></row>
</table>
</para>
<para><bold>CLI Deployment:</bold></para>
<para><programlisting filename=".bash"><codeline><highlight class="normal">npm<sp/>install<sp/>-g<sp/>vercel</highlight></codeline>
<codeline><highlight class="normal">vercel<sp/>login</highlight></codeline>
<codeline><highlight class="normal">vercel<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Interactive<sp/>deployment</highlight></codeline>
<codeline><highlight class="normal">vercel<sp/>--prod<sp/><sp/><sp/>#<sp/>Production<sp/>deployment</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4627">
<title>8.6.5.3 Deployment Strategy Comparison</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Environment   </para>
</entry><entry thead="yes"><para>Strategy   </para>
</entry><entry thead="yes"><para>Rollback   </para>
</entry><entry thead="yes"><para>Downtime    </para>
</entry></row>
<row>
<entry thead="no"><para>Vercel   </para>
</entry><entry thead="no"><para>Instant replacement   </para>
</entry><entry thead="no"><para>Promote previous   </para>
</entry><entry thead="no"><para>Zero    </para>
</entry></row>
<row>
<entry thead="no"><para>Docker   </para>
</entry><entry thead="no"><para>Build and restart   </para>
</entry><entry thead="no"><para>Previous image tag   </para>
</entry><entry thead="no"><para>Minimal    </para>
</entry></row>
<row>
<entry thead="no"><para>Cloud Run   </para>
</entry><entry thead="no"><para>Blue-green traffic split   </para>
</entry><entry thead="no"><para>Revert traffic   </para>
</entry><entry thead="no"><para>Zero   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4628">
<title>8.6.6 Environment Promotion Workflow</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>PromotionFlow[Environment<sp/>Promotion<sp/>Flow]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Dev[Development]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FeatureBranch[Feature<sp/>Branch&lt;br/&gt;Development]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalTest[Local<sp/>Testing&lt;br/&gt;run-dev.sh]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Preview[Preview]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PROpen[Pull<sp/>Request&lt;br/&gt;Opened]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PreviewDeploy[Vercel<sp/>Preview&lt;br/&gt;Deployment]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CodeReview[Code<sp/>Review&lt;br/&gt;+<sp/>Quality<sp/>Gates]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Staging[Staging]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerBuild[Docker<sp/>Build&lt;br/&gt;Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SecurityScan[Security&lt;br/&gt;Scanning]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IntegrationTest[Integration&lt;br/&gt;Tests]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Prod[Production]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MergeMain[Merge<sp/>to&lt;br/&gt;main]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ProdDeploy[Production&lt;br/&gt;Deployment]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Monitoring[Post-Deploy&lt;br/&gt;Monitoring]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FeatureBranch<sp/>--&gt;<sp/>LocalTest</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LocalTest<sp/>--&gt;<sp/>PROpen</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PROpen<sp/>--&gt;<sp/>PreviewDeploy</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PreviewDeploy<sp/>--&gt;<sp/>CodeReview</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CodeReview<sp/>--&gt;<sp/>DockerBuild</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DockerBuild<sp/>--&gt;<sp/>SecurityScan</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SecurityScan<sp/>--&gt;<sp/>IntegrationTest</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>IntegrationTest<sp/>--&gt;<sp/>MergeMain</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>MergeMain<sp/>--&gt;<sp/>ProdDeploy</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ProdDeploy<sp/>--&gt;<sp/>Monitoring</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4629">
<title>8.6.7 Rollback Procedures</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4630">
<title>8.6.7.1 Vercel Rollback</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Step   </para>
</entry><entry thead="yes"><para>Action   </para>
</entry><entry thead="yes"><para>Location    </para>
</entry></row>
<row>
<entry thead="no"><para>1   </para>
</entry><entry thead="no"><para>Navigate to Vercel Dashboard   </para>
</entry><entry thead="no"><para>vercel.com    </para>
</entry></row>
<row>
<entry thead="no"><para>2   </para>
</entry><entry thead="no"><para>Select Deployments tab   </para>
</entry><entry thead="no"><para>Project settings    </para>
</entry></row>
<row>
<entry thead="no"><para>3   </para>
</entry><entry thead="no"><para>Find previous working deployment   </para>
</entry><entry thead="no"><para>Deployment history    </para>
</entry></row>
<row>
<entry thead="no"><para>4   </para>
</entry><entry thead="no"><para>Click &quot;Promote to Production&quot;   </para>
</entry><entry thead="no"><para>Deployment actions   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4631">
<title>8.6.7.2 Docker Rollback</title><para><programlisting filename=".bash"><codeline><highlight class="normal">#<sp/>Pull<sp/>previous<sp/>version</highlight></codeline>
<codeline><highlight class="normal">docker<sp/>pull<sp/>ghcr.io/&lt;repo&gt;:&lt;previous-tag&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">####<sp/>Stop<sp/>current<sp/>container</highlight></codeline>
<codeline><highlight class="normal">docker-compose<sp/>down</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">####<sp/>Update<sp/>image<sp/>tag<sp/>in<sp/>docker-compose.yml<sp/>or<sp/>use:</highlight></codeline>
<codeline><highlight class="normal">docker<sp/>run<sp/>-d<sp/>-p<sp/>7860:7860<sp/>ghcr.io/&lt;repo&gt;:&lt;previous-tag&gt;</highlight></codeline>
</programlisting></para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4632">
<title>8.6.8 Post-Deployment Validation</title><para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Check   </para>
</entry><entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Expected Result   </para>
</entry><entry thead="yes"><para>Timeout    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Check   </para>
</entry><entry thead="no"><para><computeroutput>/api/health</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>{&quot;status&quot;: &quot;healthy&quot;}</computeroutput>   </para>
</entry><entry thead="no"><para>5s    </para>
</entry></row>
<row>
<entry thead="no"><para>API Docs   </para>
</entry><entry thead="no"><para><computeroutput>/docs</computeroutput>   </para>
</entry><entry thead="no"><para>OpenAPI documentation loads   </para>
</entry><entry thead="no"><para>10s    </para>
</entry></row>
<row>
<entry thead="no"><para>Frontend Load   </para>
</entry><entry thead="no"><para><computeroutput>/</computeroutput>   </para>
</entry><entry thead="no"><para>Page renders   </para>
</entry><entry thead="no"><para>3s    </para>
</entry></row>
<row>
<entry thead="no"><para>3D Visualization   </para>
</entry><entry thead="no"><para>Tab interaction   </para>
</entry><entry thead="no"><para>Renders smoothly   </para>
</entry><entry thead="no"><para>5s    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication   </para>
</entry><entry thead="no"><para><computeroutput>/token</computeroutput>   </para>
</entry><entry thead="no"><para>Returns JWT   </para>
</entry><entry thead="no"><para>2s   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4633">
<title>8.6.9 Reusable CI Components</title><para><bold>Source:</bold> <computeroutput>.github/actions/ci-common/action.yml</computeroutput></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Feature   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para>Language Support   </para>
</entry><entry thead="no"><para>Python or Node.js    </para>
</entry></row>
<row>
<entry thead="no"><para>Caching   </para>
</entry><entry thead="no"><para>pip/npm cache integration    </para>
</entry></row>
<row>
<entry thead="no"><para>Configurable Commands   </para>
</entry><entry thead="no"><para>Install, build, test    </para>
</entry></row>
<row>
<entry thead="no"><para>Error Handling   </para>
</entry><entry thead="no"><para><computeroutput>set -euo pipefail</computeroutput> strict mode   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4635">
<title>8.7 Infrastructure Monitoring</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4636">
<title>8.7.1 Monitoring Architecture</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>MonitoringStack[Infrastructure<sp/>Monitoring<sp/>Stack]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>ApplicationMonitoring[Application<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HealthEndpoint[/api/health&lt;br/&gt;Health<sp/>Check]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MetricsEndpoint[/api/metrics&lt;br/&gt;Application<sp/>Metrics]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LoggingLayer[Python<sp/>Logging&lt;br/&gt;INFO<sp/>Level]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>ContainerMonitoring[Container<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DockerHealth[Docker<sp/>HEALTHCHECK&lt;br/&gt;HTTP<sp/>Probe]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ComposeHealth[Docker<sp/>Compose&lt;br/&gt;Health<sp/>Config]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>CICDMonitoring[CI/CD<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GitHubSecurity[GitHub<sp/>Actions&lt;br/&gt;Security<sp/>Scans]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CircleCITests[CircleCI&lt;br/&gt;Test<sp/>Coverage]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Codecov[Codecov&lt;br/&gt;Coverage<sp/>Reports]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>SecurityScanning[Security<sp/>Monitoring]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SAST[SAST<sp/>Tools&lt;br/&gt;Bandit,<sp/>CodeQL]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Dependency[Dependency<sp/>Scan&lt;br/&gt;Snyk,<sp/>Safety]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Container[Container<sp/>Scan&lt;br/&gt;Trivy]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>HealthEndpoint<sp/>--&gt;<sp/>DockerHealth</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>DockerHealth<sp/>--&gt;<sp/>ComposeHealth</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GitHubSecurity<sp/>--&gt;<sp/>SAST</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GitHubSecurity<sp/>--&gt;<sp/>Dependency</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>GitHubSecurity<sp/>--&gt;<sp/>Container</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CircleCITests<sp/>--&gt;<sp/>Codecov</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4637">
<title>8.7.2 Resource Monitoring</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4638">
<title>8.7.2.1 Health Check Implementation</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Level   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>API Endpoint   </para>
</entry><entry thead="no"><para><computeroutput>GET /api/health</computeroutput>   </para>
</entry><entry thead="no"><para>Returns status and graph state    </para>
</entry></row>
<row>
<entry thead="no"><para>Docker   </para>
</entry><entry thead="no"><para><computeroutput>HEALTHCHECK</computeroutput> instruction   </para>
</entry><entry thead="no"><para>30s interval, 10s timeout    </para>
</entry></row>
<row>
<entry thead="no"><para>Docker Compose   </para>
</entry><entry thead="no"><para><computeroutput>healthcheck</computeroutput> service config   </para>
</entry><entry thead="no"><para>40s start period   </para>
</entry></row>
</table>
</para>
<para><bold>Health Response Schema:</bold></para>
<para><programlisting filename=".json"><codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>&quot;status&quot;:<sp/>&quot;healthy&quot;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>&quot;graph_initialized&quot;:<sp/>true</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4639">
<title>8.7.2.2 Application Metrics Endpoint</title><para><bold>Endpoint:</bold> <computeroutput>GET /api/metrics</computeroutput></para>
<para><table rows="8" cols="3"><row>
<entry thead="yes"><para>Metric   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>total_assets</computeroutput>   </para>
</entry><entry thead="no"><para>Counter   </para>
</entry><entry thead="no"><para>Count of nodes in graph    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>total_relationships</computeroutput>   </para>
</entry><entry thead="no"><para>Counter   </para>
</entry><entry thead="no"><para>Count of edges in graph    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_classes</computeroutput>   </para>
</entry><entry thead="no"><para>Dictionary   </para>
</entry><entry thead="no"><para>Count per asset class    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>avg_degree</computeroutput>   </para>
</entry><entry thead="no"><para>Gauge   </para>
</entry><entry thead="no"><para>Mean connections per node    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>max_degree</computeroutput>   </para>
</entry><entry thead="no"><para>Gauge   </para>
</entry><entry thead="no"><para>Highest connected node    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>network_density</computeroutput>   </para>
</entry><entry thead="no"><para>Gauge   </para>
</entry><entry thead="no"><para>Edge ratio metric    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>relationship_density</computeroutput>   </para>
</entry><entry thead="no"><para>Gauge   </para>
</entry><entry thead="no"><para>Calculated density   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4640">
<title>8.7.3 Performance Metrics and SLAs</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Target SLA   </para>
</entry><entry thead="yes"><para>Measurement Point    </para>
</entry></row>
<row>
<entry thead="no"><para>API Response (p95)   </para>
</entry><entry thead="no"><para>&lt; 500ms   </para>
</entry><entry thead="no"><para>Request to response    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Rendering   </para>
</entry><entry thead="no"><para>&lt; 2 seconds   </para>
</entry><entry thead="no"><para>Data load to interactive    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Generation   </para>
</entry><entry thead="no"><para>&lt; 100ms   </para>
</entry><entry thead="no"><para>Credential to token    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Initialization   </para>
</entry><entry thead="no"><para>&lt; 3 seconds   </para>
</entry><entry thead="no"><para>Application startup    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Discovery   </para>
</entry><entry thead="no"><para>&lt; 500ms   </para>
</entry><entry thead="no"><para>For 100 assets    </para>
</entry></row>
<row>
<entry thead="no"><para>Initial Page Load   </para>
</entry><entry thead="no"><para>&lt; 3 seconds   </para>
</entry><entry thead="no"><para>Navigation to interactive   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4641">
<title>8.7.4 Logging Configuration</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4642">
<title>8.7.4.1 Backend Logging</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Setting   </para>
</entry><entry thead="yes"><para>Value   </para>
</entry><entry thead="yes"><para>Location    </para>
</entry></row>
<row>
<entry thead="no"><para>Level   </para>
</entry><entry thead="no"><para><computeroutput>INFO</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Logger   </para>
</entry><entry thead="no"><para><computeroutput>logging.getLogger(__name__)</computeroutput>   </para>
</entry><entry thead="no"><para>Module-specific    </para>
</entry></row>
<row>
<entry thead="no"><para>Format   </para>
</entry><entry thead="no"><para>Python default   </para>
</entry><entry thead="no"><para>Standard library   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4643">
<title>8.7.4.2 Log Point Catalog</title><para><table rows="8" cols="4"><row>
<entry thead="yes"><para>Log Point   </para>
</entry><entry thead="yes"><para>Level   </para>
</entry><entry thead="yes"><para>Content   </para>
</entry><entry thead="yes"><para>Location    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph initialization   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Success/failure   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Application startup   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Server binding, port   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Application shutdown   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Shutdown notification   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache operations   </para>
</entry><entry thead="no"><para>INFO   </para>
</entry><entry thead="no"><para>Load/save success   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">real_data_fetcher.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication failures   </para>
</entry><entry thead="no"><para>WARNING   </para>
</entry><entry thead="no"><para>Failed login attempts   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Invalid CORS origins   </para>
</entry><entry thead="no"><para>WARNING   </para>
</entry><entry thead="no"><para>Skipped origin   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Request errors   </para>
</entry><entry thead="no"><para>ERROR   </para>
</entry><entry thead="no"><para>Exception details   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4644">
<title>8.7.5 Security Monitoring</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4645">
<title>8.7.5.1 CI/CD Security Scanning Matrix</title><para><table rows="10" cols="4"><row>
<entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Workflow   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Trigger    </para>
</entry></row>
<row>
<entry thead="no"><para>Bandit   </para>
</entry><entry thead="no"><para><computeroutput>bandit.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Python SAST   </para>
</entry><entry thead="no"><para>Push/PR    </para>
</entry></row>
<row>
<entry thead="no"><para>CodeQL   </para>
</entry><entry thead="no"><para><computeroutput>codeql.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Multi-language SAST   </para>
</entry><entry thead="no"><para>Push/PR/Schedule    </para>
</entry></row>
<row>
<entry thead="no"><para>Semgrep   </para>
</entry><entry thead="no"><para><computeroutput>semgrep.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Pattern detection   </para>
</entry><entry thead="no"><para>Push/PR    </para>
</entry></row>
<row>
<entry thead="no"><para>Trivy   </para>
</entry><entry thead="no"><para><computeroutput>trivy.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Container scanning   </para>
</entry><entry thead="no"><para>Push/PR/Weekly    </para>
</entry></row>
<row>
<entry thead="no"><para>Hadolint   </para>
</entry><entry thead="no"><para><computeroutput>hadolint.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Dockerfile linting   </para>
</entry><entry thead="no"><para>Push/PR    </para>
</entry></row>
<row>
<entry thead="no"><para>Snyk   </para>
</entry><entry thead="no"><para><computeroutput>snyk-security.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Dependency scanning   </para>
</entry><entry thead="no"><para>Push/PR    </para>
</entry></row>
<row>
<entry thead="no"><para>OSSF Scorecard   </para>
</entry><entry thead="no"><para><computeroutput>scorecard.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Supply chain   </para>
</entry><entry thead="no"><para>Push/Schedule    </para>
</entry></row>
<row>
<entry thead="no"><para>DevSkim   </para>
</entry><entry thead="no"><para><computeroutput>devskim.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Security linting   </para>
</entry><entry thead="no"><para>Push/PR    </para>
</entry></row>
<row>
<entry thead="no"><para>Safety   </para>
</entry><entry thead="no"><para>CircleCI   </para>
</entry><entry thead="no"><para>Python vulnerabilities   </para>
</entry><entry thead="no"><para>Nightly   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4646">
<title>8.7.5.2 SARIF Integration</title><para>All security scans upload results to GitHub Advanced Security via SARIF format:</para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Configuration   </para>
</entry><entry thead="yes"><para>Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Upload Action   </para>
</entry><entry thead="no"><para><computeroutput>github/codeql-action/upload-sarif@v3</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Permission   </para>
</entry><entry thead="no"><para><computeroutput>security-events: write</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Visibility   </para>
</entry><entry thead="no"><para>GitHub Security tab   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4647">
<title>8.7.6 Rate Limiting Monitoring</title><para><table rows="3" cols="4"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Limit   </para>
</entry><entry thead="yes"><para>Window   </para>
</entry><entry thead="yes"><para>Response    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>POST /token</computeroutput>   </para>
</entry><entry thead="no"><para>5 requests   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>429 + Retry-After    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GET /api/users/me</computeroutput>   </para>
</entry><entry thead="no"><para>10 requests   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>429 + Retry-After   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4648">
<title>8.7.7 Cost Monitoring</title><sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4649">
<title>8.7.7.1 Vercel Cost Monitoring</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Method   </para>
</entry><entry thead="yes"><para>Implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>Usage Dashboard   </para>
</entry><entry thead="no"><para>Vercel project settings    </para>
</entry></row>
<row>
<entry thead="no"><para>Spend Alerts   </para>
</entry><entry thead="no"><para>Email notifications at thresholds    </para>
</entry></row>
<row>
<entry thead="no"><para>Budget Limits   </para>
</entry><entry thead="no"><para>$200 default on-demand cap    </para>
</entry></row>
<row>
<entry thead="no"><para>Hard Limits   </para>
</entry><entry thead="no"><para>Optional auto-pause at 100%   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4650">
<title>8.7.7.2 Container Registry Cost</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Registry   </para>
</entry><entry thead="yes"><para>Free Tier   </para>
</entry><entry thead="yes"><para>Overage    </para>
</entry></row>
<row>
<entry thead="no"><para>GHCR (public)   </para>
</entry><entry thead="no"><para>Unlimited   </para>
</entry><entry thead="no"><para>N/A    </para>
</entry></row>
<row>
<entry thead="no"><para>GHCR (private)   </para>
</entry><entry thead="no"><para>1 GB storage, 1 GB transfer   </para>
</entry><entry thead="no"><para>$0.25/GB storage   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4651">
<title>8.7.8 Future Monitoring Recommendations</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Recommended Tool   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Metrics Collection   </para>
</entry><entry thead="no"><para>Prometheus + prometheus-fastapi-instrumentator   </para>
</entry><entry thead="no"><para>RED metrics    </para>
</entry></row>
<row>
<entry thead="no"><para>Distributed Tracing   </para>
</entry><entry thead="no"><para>OpenTelemetry   </para>
</entry><entry thead="no"><para>Request flow visualization    </para>
</entry></row>
<row>
<entry thead="no"><para>Log Aggregation   </para>
</entry><entry thead="no"><para>Loki or ELK Stack   </para>
</entry><entry thead="no"><para>Centralized management    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization   </para>
</entry><entry thead="no"><para>Grafana   </para>
</entry><entry thead="no"><para>Unified dashboard    </para>
</entry></row>
<row>
<entry thead="no"><para>Error Tracking   </para>
</entry><entry thead="no"><para>Sentry   </para>
</entry><entry thead="no"><para>Exception monitoring    </para>
</entry></row>
<row>
<entry thead="no"><para>Alerting   </para>
</entry><entry thead="no"><para>Prometheus Alertmanager   </para>
</entry><entry thead="no"><para>Automated notifications   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4653">
<title>8.8 Database and Storage Infrastructure</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4654">
<title>8.8.1 Storage Architecture</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>StorageArchitecture[Data<sp/>Storage<sp/>Architecture]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>PrimaryStorage[Primary<sp/>Storage]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InMemGraph[In-Memory<sp/>Graph&lt;br/&gt;Dict-based<sp/>Structure&lt;br/&gt;&lt;<sp/>500<sp/>nodes<sp/>optimal]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>AuthStorage[Authentication<sp/>Storage]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLiteAuth[(SQLite<sp/>Database&lt;br/&gt;User<sp/>Credentials&lt;br/&gt;DATABASE_URL)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>CacheStorage[Cache<sp/>Storage]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JSONCache[(JSON<sp/>File<sp/>Cache&lt;br/&gt;Atomic<sp/>Writes&lt;br/&gt;REAL_DATA_CACHE_PATH)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GraphCache[(Graph<sp/>Cache&lt;br/&gt;Optional<sp/>Serialization&lt;br/&gt;GRAPH_CACHE_PATH)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>OptionalStorage[Optional<sp/>Production<sp/>Storage]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PostgreSQL[(PostgreSQL<sp/>15&lt;br/&gt;Full<sp/>Persistence&lt;br/&gt;ASSET_GRAPH_DATABASE_URL)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>InMemGraph<sp/>--&gt;<sp/>SQLiteAuth</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>InMemGraph<sp/>--&gt;<sp/>JSONCache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>InMemGraph<sp/>--&gt;<sp/>GraphCache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>InMemGraph<sp/>-.-&gt;<sp/>PostgreSQL</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4655">
<title>8.8.2 Primary Storage: In-Memory Graph</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Structure   </para>
</entry><entry thead="no"><para><computeroutput>Dict[source_id, List[Tuple[target_id, rel_type, strength]]]</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Implementation   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Thread Safety   </para>
</entry><entry thead="no"><para>Double-checked locking singleton pattern    </para>
</entry></row>
<row>
<entry thead="no"><para>Size Constraint   </para>
</entry><entry thead="no"><para>Optimal performance for &lt; 500 nodes   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4656">
<title>8.8.3 SQLite Authentication Database</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Purpose   </para>
</entry><entry thead="no"><para>User credentials storage    </para>
</entry></row>
<row>
<entry thead="no"><para>Implementation   </para>
</entry><entry thead="no"><para><computeroutput><ref refid="api_2database_8py" kindref="compound">api/database.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Environment Variable   </para>
</entry><entry thead="no"><para><computeroutput>DATABASE_URL</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Schema   </para>
</entry><entry thead="no"><para><computeroutput>user_credentials</computeroutput> table   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4657">
<title>8.8.4 PostgreSQL (Optional Production)</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Attribute   </para>
</entry><entry thead="yes"><para>Specification    </para>
</entry></row>
<row>
<entry thead="no"><para>Image   </para>
</entry><entry thead="no"><para><computeroutput>postgres:15-alpine</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Database   </para>
</entry><entry thead="no"><para><computeroutput>financial_assets</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>User   </para>
</entry><entry thead="no"><para><computeroutput>finuser</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Port   </para>
</entry><entry thead="no"><para><computeroutput>5432</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>ORM   </para>
</entry><entry thead="no"><para>SQLAlchemy &gt;= 2.0.0   </para>
</entry></row>
</table>
</para>
<para><bold>Database Schema (migrations/001_initial.sql):</bold></para>
<para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Table   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>assets</computeroutput>   </para>
</entry><entry thead="no"><para>Primary entity table    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>asset_relationships</computeroutput>   </para>
</entry><entry thead="no"><para>Directed edge table    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_events</computeroutput>   </para>
</entry><entry thead="no"><para>Event records    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_event_assets</computeroutput>   </para>
</entry><entry thead="no"><para>Junction table   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4658">
<title>8.8.5 Caching Strategy</title><para><table rows="3" cols="3"><row>
<entry thead="yes"><para>Cache Type   </para>
</entry><entry thead="yes"><para>Implementation   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Real Data Cache   </para>
</entry><entry thead="no"><para>JSON with atomic writes   </para>
</entry><entry thead="no"><para><computeroutput>REAL_DATA_CACHE_PATH</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Cache   </para>
</entry><entry thead="no"><para>JSON serialization   </para>
</entry><entry thead="no"><para><computeroutput>GRAPH_CACHE_PATH</computeroutput>   </para>
</entry></row>
</table>
</para>
<para><bold>Atomic Write Pattern:</bold></para>
<para><orderedlist>
<listitem><para>Write to NamedTemporaryFile</para>
</listitem><listitem><para>Flush and sync to disk</para>
</listitem><listitem><para><computeroutput>os.replace()</computeroutput> atomic rename</para>
</listitem><listitem><para>Guarantees no partial writes</para>
</listitem></orderedlist>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4660">
<title>8.9 Development Workflow Infrastructure</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4661">
<title>8.9.1 Local Development Setup</title><para><bold>Script:</bold> <computeroutput>run-dev.sh</computeroutput></para>
<para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Action   </para>
</entry><entry thead="yes"><para>Command   </para>
</entry><entry thead="yes"><para>Result    </para>
</entry></row>
<row>
<entry thead="no"><para>Create venv   </para>
</entry><entry thead="no"><para><computeroutput>python -m venv venv</computeroutput>   </para>
</entry><entry thead="no"><para>Virtual environment    </para>
</entry></row>
<row>
<entry thead="no"><para>Activate venv   </para>
</entry><entry thead="no"><para><computeroutput>source venv/bin/activate</computeroutput>   </para>
</entry><entry thead="no"><para>Environment active    </para>
</entry></row>
<row>
<entry thead="no"><para>Install Python deps   </para>
</entry><entry thead="no"><para><computeroutput>pip install -r requirements.txt</computeroutput>   </para>
</entry><entry thead="no"><para>Dependencies ready    </para>
</entry></row>
<row>
<entry thead="no"><para>Start FastAPI   </para>
</entry><entry thead="no"><para><computeroutput>uvicorn <ref refid="namespaceapi_1_1main" kindref="compound">api.main</ref>:app --reload</computeroutput>   </para>
</entry><entry thead="no"><para>Backend on 8000    </para>
</entry></row>
<row>
<entry thead="no"><para>Install frontend deps   </para>
</entry><entry thead="no"><para><computeroutput>npm install</computeroutput>   </para>
</entry><entry thead="no"><para>Node modules ready    </para>
</entry></row>
<row>
<entry thead="no"><para>Start Next.js   </para>
</entry><entry thead="no"><para><computeroutput>npm run dev</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend on 3000   </para>
</entry></row>
</table>
</para>
<para><bold>Access Points:</bold></para>
<para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Service   </para>
</entry><entry thead="yes"><para>URL   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Frontend   </para>
</entry><entry thead="no"><para><ulink url="http://localhost:3000">http://localhost:3000</ulink>   </para>
</entry><entry thead="no"><para>User interface    </para>
</entry></row>
<row>
<entry thead="no"><para>Backend API   </para>
</entry><entry thead="no"><para><ulink url="http://localhost:8000">http://localhost:8000</ulink>   </para>
</entry><entry thead="no"><para>API endpoints    </para>
</entry></row>
<row>
<entry thead="no"><para>API Docs   </para>
</entry><entry thead="no"><para><ulink url="http://localhost:8000/docs">http://localhost:8000/docs</ulink>   </para>
</entry><entry thead="no"><para>OpenAPI documentation   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4662">
<title>8.9.2 Makefile Commands</title><para><table rows="12" cols="2"><row>
<entry thead="yes"><para>Command   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make install</computeroutput>   </para>
</entry><entry thead="no"><para>Install production dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make install-dev</computeroutput>   </para>
</entry><entry thead="no"><para>Install development dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make test</computeroutput>   </para>
</entry><entry thead="no"><para>Run tests with coverage    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make lint</computeroutput>   </para>
</entry><entry thead="no"><para>Run flake8 + pylint    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make format</computeroutput>   </para>
</entry><entry thead="no"><para>Format with black + isort    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make type-check</computeroutput>   </para>
</entry><entry thead="no"><para>Run mypy type checking    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make check</computeroutput>   </para>
</entry><entry thead="no"><para>Full quality check pipeline    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make docker-build</computeroutput>   </para>
</entry><entry thead="no"><para>Build Docker image    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make docker-run</computeroutput>   </para>
</entry><entry thead="no"><para>Run Docker container    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make docker-compose-up</computeroutput>   </para>
</entry><entry thead="no"><para>Start with docker-compose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>make docker-shell</computeroutput>   </para>
</entry><entry thead="no"><para>Shell into container   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4663">
<title>8.9.3 Pre-Commit Hooks</title><para><bold>Source:</bold> <computeroutput>.pre-commit-config.yaml</computeroutput></para>
<para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Hook   </para>
</entry><entry thead="yes"><para>Tool   </para>
</entry><entry thead="yes"><para>Version   </para>
</entry><entry thead="yes"><para>Configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>Formatting   </para>
</entry><entry thead="no"><para>black   </para>
</entry><entry thead="no"><para>v25.12.0   </para>
</entry><entry thead="no"><para>Python 3    </para>
</entry></row>
<row>
<entry thead="no"><para>Import Sorting   </para>
</entry><entry thead="no"><para>isort   </para>
</entry><entry thead="no"><para>v7.0.0   </para>
</entry><entry thead="no"><para>profile: black    </para>
</entry></row>
<row>
<entry thead="no"><para>Linting   </para>
</entry><entry thead="no"><para>flake8   </para>
</entry><entry thead="no"><para>v7.3.0   </para>
</entry><entry thead="no"><para>+ flake8-docstrings    </para>
</entry></row>
<row>
<entry thead="no"><para>Type Checking   </para>
</entry><entry thead="no"><para>mypy   </para>
</entry><entry thead="no"><para>v1.19.1   </para>
</entry><entry thead="no"><para><ndash/>ignore-missing-imports    </para>
</entry></row>
<row>
<entry thead="no"><para>Standard Hooks   </para>
</entry><entry thead="no"><para>pre-commit   </para>
</entry><entry thead="no"><para>latest   </para>
</entry><entry thead="no"><para>trailing-whitespace, end-of-file-fixer   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4665">
<title>8.10 Network Architecture</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4666">
<title>8.10.1 Network Topology</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>TB</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>Internet[Public<sp/>Internet]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Users([End<sp/>Users])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Attackers([Potential<sp/>Attackers])</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>EdgeSecurity[Edge<sp/>Security<sp/>Layer]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>VercelEdge[Vercel<sp/>Edge&lt;br/&gt;TLS<sp/>Termination&lt;br/&gt;DDoS<sp/>Protection]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CORS[CORS<sp/>Middleware&lt;br/&gt;Origin<sp/>Validation]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ApplicationNetwork[Application<sp/>Network]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>RateLimiting[Rate<sp/>Limiting]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SlowAPI[SlowAPI&lt;br/&gt;IP-based<sp/>Throttling]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subgraph<sp/>Services[Application<sp/>Services]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FastAPI[FastAPI<sp/>Backend&lt;br/&gt;Port<sp/>8000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextJS[Next.js<sp/>Frontend&lt;br/&gt;Port<sp/>3000]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gradio[Gradio<sp/>UI&lt;br/&gt;Port<sp/>7860]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>DataNetwork[Data<sp/>Network<sp/>-<sp/>Internal<sp/>Only]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Graph[Graph<sp/>Engine]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SQLite[(SQLite<sp/>DB)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cache[(File<sp/>Cache)]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>External[External<sp/>APIs]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>YahooFinance[Yahoo<sp/>Finance&lt;br/&gt;HTTPS]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Users<sp/>--&gt;<sp/>VercelEdge</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Attackers<sp/>--&gt;<sp/>VercelEdge</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>VercelEdge<sp/>--&gt;<sp/>CORS</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CORS<sp/>--&gt;<sp/>SlowAPI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SlowAPI<sp/>--&gt;<sp/>Services</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>FastAPI<sp/>--&gt;<sp/>Graph</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>SQLite</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>Cache</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Graph<sp/>--&gt;<sp/>YahooFinance</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4667">
<title>8.10.2 Port Exposure Matrix</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Port   </para>
</entry><entry thead="yes"><para>Service   </para>
</entry><entry thead="yes"><para>Protocol   </para>
</entry><entry thead="yes"><para>External Access    </para>
</entry></row>
<row>
<entry thead="no"><para>3000   </para>
</entry><entry thead="no"><para>Next.js Frontend   </para>
</entry><entry thead="no"><para>HTTP/HTTPS   </para>
</entry><entry thead="no"><para>Yes (via Vercel)    </para>
</entry></row>
<row>
<entry thead="no"><para>7860   </para>
</entry><entry thead="no"><para>Gradio UI   </para>
</entry><entry thead="no"><para>HTTP   </para>
</entry><entry thead="no"><para>Yes (Docker)    </para>
</entry></row>
<row>
<entry thead="no"><para>8000   </para>
</entry><entry thead="no"><para>FastAPI Backend   </para>
</entry><entry thead="no"><para>HTTP/HTTPS   </para>
</entry><entry thead="no"><para>Yes (via Vercel)    </para>
</entry></row>
<row>
<entry thead="no"><para>5432   </para>
</entry><entry thead="no"><para>PostgreSQL   </para>
</entry><entry thead="no"><para>TCP   </para>
</entry><entry thead="no"><para>No (internal only)   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4668">
<title>8.10.3 CORS Configuration</title><para><table rows="3" cols="5"><row>
<entry thead="yes"><para>Environment   </para>
</entry><entry thead="yes"><para>HTTP localhost   </para>
</entry><entry thead="yes"><para>HTTPS localhost   </para>
</entry><entry thead="yes"><para>Vercel URLs   </para>
</entry><entry thead="yes"><para>Custom HTTPS    </para>
</entry></row>
<row>
<entry thead="no"><para>Development   </para>
</entry><entry thead="no"><para>✅ Allowed   </para>
</entry><entry thead="no"><para>✅ Allowed   </para>
</entry><entry thead="no"><para>✅ Allowed   </para>
</entry><entry thead="no"><para>✅ Allowed    </para>
</entry></row>
<row>
<entry thead="no"><para>Production   </para>
</entry><entry thead="no"><para>❌ Rejected   </para>
</entry><entry thead="no"><para>✅ Allowed   </para>
</entry><entry thead="no"><para>✅ Allowed   </para>
</entry><entry thead="no"><para>✅ Allowed   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4670">
<title>8.11 Infrastructure Cost Summary</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4671">
<title>8.11.1 Cost Comparison Matrix</title><para><table rows="6" cols="4"><row>
<entry thead="yes"><para>Deployment Model   </para>
</entry><entry thead="yes"><para>Fixed Monthly   </para>
</entry><entry thead="yes"><para>Variable Costs   </para>
</entry><entry thead="yes"><para>Best For    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Local Development</bold>   </para>
</entry><entry thead="no"><para>$0   </para>
</entry><entry thead="no"><para>$0   </para>
</entry><entry thead="no"><para>Development    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Vercel Hobby</bold>   </para>
</entry><entry thead="no"><para>$0   </para>
</entry><entry thead="no"><para>Overages possible   </para>
</entry><entry thead="no"><para>Personal projects    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Vercel Pro</bold>   </para>
</entry><entry thead="no"><para>$20/user   </para>
</entry><entry thead="no"><para>Bandwidth, CPU overage   </para>
</entry><entry thead="no"><para>Small teams    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Docker Self-Hosted</bold>   </para>
</entry><entry thead="no"><para>Server cost   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry><entry thead="no"><para>Full control    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Google Cloud Run</bold>   </para>
</entry><entry thead="no"><para>$0   </para>
</entry><entry thead="no"><para>Usage-based (~$5-50/month)   </para>
</entry><entry thead="no"><para>GCP integration   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4672">
<title>8.11.2 Resource Sizing Guidelines</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Scale   </para>
</entry><entry thead="yes"><para>Users   </para>
</entry><entry thead="yes"><para>Assets   </para>
</entry><entry thead="yes"><para>Recommended Deployment    </para>
</entry></row>
<row>
<entry thead="no"><para>Development   </para>
</entry><entry thead="no"><para>1-5   </para>
</entry><entry thead="no"><para>&lt; 100   </para>
</entry><entry thead="no"><para>Local, Vercel Hobby    </para>
</entry></row>
<row>
<entry thead="no"><para>Small   </para>
</entry><entry thead="no"><para>5-50   </para>
</entry><entry thead="no"><para>&lt; 300   </para>
</entry><entry thead="no"><para>Vercel Pro, Docker    </para>
</entry></row>
<row>
<entry thead="no"><para>Medium   </para>
</entry><entry thead="no"><para>50-500   </para>
</entry><entry thead="no"><para>&lt; 500   </para>
</entry><entry thead="no"><para>Vercel Pro + caching    </para>
</entry></row>
<row>
<entry thead="no"><para>Large   </para>
</entry><entry thead="no"><para>500+   </para>
</entry><entry thead="no"><para>500+   </para>
</entry><entry thead="no"><para>Requires architecture changes   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4674">
<title>8.12 Maintenance Procedures</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4675">
<title>8.12.1 Routine Maintenance</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Task   </para>
</entry><entry thead="yes"><para>Frequency   </para>
</entry><entry thead="yes"><para>Procedure    </para>
</entry></row>
<row>
<entry thead="no"><para>Dependency Updates   </para>
</entry><entry thead="no"><para>Weekly   </para>
</entry><entry thead="no"><para>Review Dependabot PRs    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Scans   </para>
</entry><entry thead="no"><para>Daily (automated)   </para>
</entry><entry thead="no"><para>Review SARIF alerts    </para>
</entry></row>
<row>
<entry thead="no"><para>Docker Image Refresh   </para>
</entry><entry thead="no"><para>Weekly   </para>
</entry><entry thead="no"><para>Rebuild with latest base    </para>
</entry></row>
<row>
<entry thead="no"><para>Cache Cleanup   </para>
</entry><entry thead="no"><para>As needed   </para>
</entry><entry thead="no"><para>Clear <computeroutput>GRAPH_CACHE_PATH</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Log Review   </para>
</entry><entry thead="no"><para>Weekly   </para>
</entry><entry thead="no"><para>Check for error patterns   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4676">
<title>8.12.2 Emergency Procedures</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Scenario   </para>
</entry><entry thead="yes"><para>Detection   </para>
</entry><entry thead="yes"><para>Response    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Vulnerability   </para>
</entry><entry thead="no"><para>SARIF alert, CVE notice   </para>
</entry><entry thead="no"><para>Patch dependencies, redeploy    </para>
</entry></row>
<row>
<entry thead="no"><para>Service Outage   </para>
</entry><entry thead="no"><para>Health check failures   </para>
</entry><entry thead="no"><para>Rollback to previous deployment    </para>
</entry></row>
<row>
<entry thead="no"><para>Data Corruption   </para>
</entry><entry thead="no"><para>Validation errors   </para>
</entry><entry thead="no"><para>Clear cache, reinitialize    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limit Abuse   </para>
</entry><entry thead="no"><para>429 response spike   </para>
</entry><entry thead="no"><para>Review IP patterns, adjust limits   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4678">
<title>8.13 References</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4679">
<title>8.13.1 Configuration Files</title><para><table rows="17" cols="2"><row>
<entry thead="yes"><para>Path   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Dockerfile</computeroutput>   </para>
</entry><entry thead="no"><para>Container image definition, security measures, health checks    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>docker-compose.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Service orchestration, volumes, environment    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>vercel.json</computeroutput>   </para>
</entry><entry thead="no"><para>Serverless deployment configuration, routing    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Makefile</computeroutput>   </para>
</entry><entry thead="no"><para>Build automation commands    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/ci.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Primary CI pipeline configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/docker-publish.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Container image publishing    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/trivy.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Container security scanning    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.circleci/config.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Secondary CI platform configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/actions/ci-common/action.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Reusable CI composite action    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.pre-commit-config.yaml</computeroutput>   </para>
</entry><entry thead="no"><para>Pre-commit hook configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.env.example</computeroutput>   </para>
</entry><entry thead="no"><para>Environment variable template    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>pyproject.toml</computeroutput>   </para>
</entry><entry thead="no"><para>Python project metadata and tooling    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>requirements.txt</computeroutput>   </para>
</entry><entry thead="no"><para>Python dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>run-dev.sh</computeroutput>   </para>
</entry><entry thead="no"><para>Development startup script    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend dependencies and scripts    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>migrations/001_initial.sql</computeroutput>   </para>
</entry><entry thead="no"><para>Database schema definition   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4680">
<title>8.13.2 Documentation Files</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Path   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="DEPLOYMENT_8md" kindref="compound">DEPLOYMENT.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Deployment guide    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="DOCKER_8md" kindref="compound">DOCKER.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Docker deployment guide    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="VERCEL__DEPLOYMENT__CHECKLIST_8md" kindref="compound">VERCEL_DEPLOYMENT_CHECKLIST.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Deployment checklist    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="SECURITY_8md" kindref="compound">SECURITY.md</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Security best practices   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4681">
<title>8.13.3 Technical Specification Cross-References</title><para><table rows="8" cols="2"><row>
<entry thead="yes"><para>Section   </para>
</entry><entry thead="yes"><para>Relevance    </para>
</entry></row>
<row>
<entry thead="no"><para>5.5 DEPLOYMENT ARCHITECTURE   </para>
</entry><entry thead="no"><para>Deployment configurations    </para>
</entry></row>
<row>
<entry thead="no"><para>6.5 Monitoring and Observability   </para>
</entry><entry thead="no"><para>Monitoring implementation    </para>
</entry></row>
<row>
<entry thead="no"><para>6.4 Security Architecture   </para>
</entry><entry thead="no"><para>Security controls    </para>
</entry></row>
<row>
<entry thead="no"><para>3.7 Development &amp; Deployment   </para>
</entry><entry thead="no"><para>Development workflow    </para>
</entry></row>
<row>
<entry thead="no"><para>2.6 Assumptions and Constraints   </para>
</entry><entry thead="no"><para>System constraints    </para>
</entry></row>
<row>
<entry thead="no"><para>3.6 Databases &amp; Storage   </para>
</entry><entry thead="no"><para>Storage architecture    </para>
</entry></row>
<row>
<entry thead="no"><para>3.5 Third-Party Services   </para>
</entry><entry thead="no"><para>External dependencies   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4682">
<title>8.13.4 External References</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Resource   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>Vercel Documentation   </para>
</entry><entry thead="no"><para>Serverless deployment    </para>
</entry></row>
<row>
<entry thead="no"><para>Docker Documentation   </para>
</entry><entry thead="no"><para>Container configuration    </para>
</entry></row>
<row>
<entry thead="no"><para>GitHub Actions Documentation   </para>
</entry><entry thead="no"><para>CI/CD pipelines    </para>
</entry></row>
<row>
<entry thead="no"><para>CircleCI Documentation   </para>
</entry><entry thead="no"><para>Secondary CI platform   </para>
</entry></row>
</table>
</para>
</sect3>
</sect2>
</sect1>
<sect1 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4683">
<title>9. Appendices</title><sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4684">
<title>9.1 ADDITIONAL TECHNICAL INFORMATION</title><para>This appendix consolidates supplementary technical reference material that complements the main specification sections, providing quick-reference tables for configuration, operational parameters, and implementation constants.</para>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4685">
<title>9.1.1 Environment Variables Reference</title><para>The system requires specific environment variables for proper operation, categorized by criticality and purpose.</para>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4686">
<title>9.1.1.1 Required Environment Variables</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Variable   </para>
</entry><entry thead="yes"><para>Purpose   </para>
</entry><entry thead="yes"><para>Example Value    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SECRET_KEY</computeroutput>   </para>
</entry><entry thead="no"><para>JWT signing key for authentication   </para>
</entry><entry thead="no"><para><computeroutput>your-secure-secret-key</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>DATABASE_URL</computeroutput>   </para>
</entry><entry thead="no"><para>SQLite authentication database connection   </para>
</entry><entry thead="no"><para><computeroutput>sqlite:///auth.db</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_USERNAME</computeroutput>   </para>
</entry><entry thead="no"><para>Initial admin user login credential   </para>
</entry><entry thead="no"><para><computeroutput>admin</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_PASSWORD</computeroutput>   </para>
</entry><entry thead="no"><para>Initial admin user password   </para>
</entry><entry thead="no"><para><computeroutput>secure-password</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect4>
<sect4 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4687">
<title>9.1.1.2 Optional Environment Variables</title><para><table rows="11" cols="3"><row>
<entry thead="yes"><para>Variable   </para>
</entry><entry thead="yes"><para>Default   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ENV</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>development</computeroutput>   </para>
</entry><entry thead="no"><para>Environment mode (development/production)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ALLOWED_ORIGINS</computeroutput>   </para>
</entry><entry thead="no"><para>(built-in defaults)   </para>
</entry><entry thead="no"><para>Comma-separated CORS allowlist    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>USE_REAL_DATA_FETCHER</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>false</computeroutput>   </para>
</entry><entry thead="no"><para>Enable Yahoo Finance integration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>REAL_DATA_CACHE_PATH</computeroutput>   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>Yahoo Finance cache file location    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GRAPH_CACHE_PATH</computeroutput>   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>Graph serialization cache location    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ASSET_GRAPH_DATABASE_URL</computeroutput>   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>SQLAlchemy ORM connection string    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>NEXT_PUBLIC_API_URL</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput><ulink url="http://localhost:8000">http://localhost:8000</ulink></computeroutput>   </para>
</entry><entry thead="no"><para>Frontend API base URL    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_EMAIL</computeroutput>   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>Admin user email address    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_FULL_NAME</computeroutput>   </para>
</entry><entry thead="no"><para>None   </para>
</entry><entry thead="no"><para>Admin user display name    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ADMIN_DISABLED</computeroutput>   </para>
</entry><entry thead="no"><para><computeroutput>false</computeroutput>   </para>
</entry><entry thead="no"><para>Disable admin account flag   </para>
</entry></row>
</table>
</para>
</sect4>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4688">
<title>9.1.2 Relationship Types Reference</title><para>The graph engine supports eight relationship types with specific detection rules and directionality configurations.</para>
<para><table rows="9" cols="3"><row>
<entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Directionality   </para>
</entry><entry thead="yes"><para>Detection Rule    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>same_sector</computeroutput>   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Assets share identical sector value    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>corporate_bond_to_equity</computeroutput>   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Bond <computeroutput>issuer_id</computeroutput> matches equity <computeroutput>id</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>commodity_exposure</computeroutput>   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Equity sector linked to commodity type    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>currency_risk</computeroutput>   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Asset currency ≠ &quot;USD&quot;    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>income_comparison</computeroutput>   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Dividend yield vs bond yield proximity    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>regulatory_impact</computeroutput>   </para>
</entry><entry thead="no"><para>Directional   </para>
</entry><entry thead="no"><para>Shared regulatory event reference    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>market_cap_similar</computeroutput>   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Market cap within 50% range    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>correlation</computeroutput>   </para>
</entry><entry thead="no"><para>Bidirectional   </para>
</entry><entry thead="no"><para>Price correlation exceeds threshold   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4689">
<title>9.1.3 HTTP Status Codes Reference</title><para>The API returns standardized HTTP status codes with consistent error message formatting.</para>
<para><table rows="9" cols="3"><row>
<entry thead="yes"><para>Code   </para>
</entry><entry thead="yes"><para>Meaning   </para>
</entry><entry thead="yes"><para>Usage Context    </para>
</entry></row>
<row>
<entry thead="no"><para>200   </para>
</entry><entry thead="no"><para>OK   </para>
</entry><entry thead="no"><para>Successful GET/POST request    </para>
</entry></row>
<row>
<entry thead="no"><para>400   </para>
</entry><entry thead="no"><para>Bad Request   </para>
</entry><entry thead="no"><para>Invalid input, inactive user account    </para>
</entry></row>
<row>
<entry thead="no"><para>401   </para>
</entry><entry thead="no"><para>Unauthorized   </para>
</entry><entry thead="no"><para>Invalid/expired token, missing credentials    </para>
</entry></row>
<row>
<entry thead="no"><para>403   </para>
</entry><entry thead="no"><para>Forbidden   </para>
</entry><entry thead="no"><para>Invalid CORS origin    </para>
</entry></row>
<row>
<entry thead="no"><para>404   </para>
</entry><entry thead="no"><para>Not Found   </para>
</entry><entry thead="no"><para>Asset or resource not found    </para>
</entry></row>
<row>
<entry thead="no"><para>422   </para>
</entry><entry thead="no"><para>Validation Error   </para>
</entry><entry thead="no"><para>Pydantic validation failure    </para>
</entry></row>
<row>
<entry thead="no"><para>429   </para>
</entry><entry thead="no"><para>Too Many Requests   </para>
</entry><entry thead="no"><para>Rate limit exceeded    </para>
</entry></row>
<row>
<entry thead="no"><para>500   </para>
</entry><entry thead="no"><para>Internal Server Error   </para>
</entry><entry thead="no"><para>Unexpected exception   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4690">
<title>9.1.4 Default Port Assignments</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Port   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>FastAPI Backend   </para>
</entry><entry thead="no"><para>8000   </para>
</entry><entry thead="no"><para>REST API development server    </para>
</entry></row>
<row>
<entry thead="no"><para>Next.js Frontend   </para>
</entry><entry thead="no"><para>3000   </para>
</entry><entry thead="no"><para>Modern UI development server    </para>
</entry></row>
<row>
<entry thead="no"><para>Gradio UI   </para>
</entry><entry thead="no"><para>7860   </para>
</entry><entry thead="no"><para>Legacy Python UI server   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4691">
<title>9.1.5 Asset Class Color Scheme</title><para>The visualization layer uses a consistent color scheme for asset class identification.</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Asset Class   </para>
</entry><entry thead="yes"><para>Hex Color   </para>
</entry><entry thead="yes"><para>RGB Value    </para>
</entry></row>
<row>
<entry thead="no"><para>Equity   </para>
</entry><entry thead="no"><para>#1f77b4   </para>
</entry><entry thead="no"><para>rgb(31, 119, 180)    </para>
</entry></row>
<row>
<entry thead="no"><para>Fixed Income   </para>
</entry><entry thead="no"><para>#2ca02c   </para>
</entry><entry thead="no"><para>rgb(44, 160, 44)    </para>
</entry></row>
<row>
<entry thead="no"><para>Commodity   </para>
</entry><entry thead="no"><para>#ff7f0e   </para>
</entry><entry thead="no"><para>rgb(255, 127, 14)    </para>
</entry></row>
<row>
<entry thead="no"><para>Currency   </para>
</entry><entry thead="no"><para>#d62728   </para>
</entry><entry thead="no"><para>rgb(214, 39, 40)    </para>
</entry></row>
<row>
<entry thead="no"><para>Derivative   </para>
</entry><entry thead="no"><para>#9467bd   </para>
</entry><entry thead="no"><para>rgb(148, 103, 189)   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4692">
<title>9.1.6 Visualization Guardrails</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Parameter   </para>
</entry><entry thead="yes"><para>Default Value   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>MAX_NODES   </para>
</entry><entry thead="no"><para>500   </para>
</entry><entry thead="no"><para>Prevent browser memory exhaustion    </para>
</entry></row>
<row>
<entry thead="no"><para>MAX_EDGES   </para>
</entry><entry thead="no"><para>2000   </para>
</entry><entry thead="no"><para>Limit rendering complexity    </para>
</entry></row>
<row>
<entry thead="no"><para>Seed   </para>
</entry><entry thead="no"><para>42   </para>
</entry><entry thead="no"><para>Deterministic 3D layout reproduction   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4693">
<title>9.1.7 Rate Limiting Configuration</title><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Limit   </para>
</entry><entry thead="yes"><para>Window    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>POST /token</computeroutput>   </para>
</entry><entry thead="no"><para>5 requests   </para>
</entry><entry thead="no"><para>1 minute    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GET /api/users/me</computeroutput>   </para>
</entry><entry thead="no"><para>10 requests   </para>
</entry><entry thead="no"><para>1 minute    </para>
</entry></row>
<row>
<entry thead="no"><para>Other endpoints   </para>
</entry><entry thead="no"><para>Unlimited   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4694">
<title>9.1.8 Performance SLA Targets</title><para><table rows="7" cols="2"><row>
<entry thead="yes"><para>Operation   </para>
</entry><entry thead="yes"><para>Target SLA    </para>
</entry></row>
<row>
<entry thead="no"><para>API Response (p95)   </para>
</entry><entry thead="no"><para>&lt; 500ms    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Rendering   </para>
</entry><entry thead="no"><para>&lt; 2 seconds    </para>
</entry></row>
<row>
<entry thead="no"><para>Token Generation   </para>
</entry><entry thead="no"><para>&lt; 100ms    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Initialization   </para>
</entry><entry thead="no"><para>&lt; 3 seconds    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Discovery (100 assets)   </para>
</entry><entry thead="no"><para>&lt; 500ms    </para>
</entry></row>
<row>
<entry thead="no"><para>Initial Page Load   </para>
</entry><entry thead="no"><para>&lt; 3 seconds   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4695">
<title>9.1.9 Timeout Configuration</title><para><table rows="5" cols="3"><row>
<entry thead="yes"><para>Component   </para>
</entry><entry thead="yes"><para>Timeout   </para>
</entry><entry thead="yes"><para>Purpose    </para>
</entry></row>
<row>
<entry thead="no"><para>JWT Token   </para>
</entry><entry thead="no"><para>30 minutes   </para>
</entry><entry thead="no"><para>Session expiration    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limit Window   </para>
</entry><entry thead="no"><para>1 minute   </para>
</entry><entry thead="no"><para>Request counting period    </para>
</entry></row>
<row>
<entry thead="no"><para>HTTP Client   </para>
</entry><entry thead="no"><para>30 seconds   </para>
</entry><entry thead="no"><para>API request timeout    </para>
</entry></row>
<row>
<entry thead="no"><para>Health Check   </para>
</entry><entry thead="no"><para>30 seconds   </para>
</entry><entry thead="no"><para>Container probe interval   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4696">
<title>9.1.10 Yahoo Finance Supported Symbols</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Category   </para>
</entry><entry thead="yes"><para>Symbols    </para>
</entry></row>
<row>
<entry thead="no"><para>Equities   </para>
</entry><entry thead="no"><para>AAPL, MSFT, XOM, JPM    </para>
</entry></row>
<row>
<entry thead="no"><para>Bond ETFs   </para>
</entry><entry thead="no"><para>TLT, LQD, HYG    </para>
</entry></row>
<row>
<entry thead="no"><para>Commodities   </para>
</entry><entry thead="no"><para>GC=F (Gold), CL=F (Crude Oil), SI=F (Silver)    </para>
</entry></row>
<row>
<entry thead="no"><para>Currencies   </para>
</entry><entry thead="no"><para>EURUSD=X, GBPUSD=X, JPYUSD=X   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4697">
<title>9.1.11 Sample Data Statistics</title><para>The sample database provides baseline testing and offline development data.</para>
<para><table rows="4" cols="2"><row>
<entry thead="yes"><para>Entity Type   </para>
</entry><entry thead="yes"><para>Count    </para>
</entry></row>
<row>
<entry thead="no"><para>Total Assets   </para>
</entry><entry thead="no"><para>19    </para>
</entry></row>
<row>
<entry thead="no"><para>Regulatory Events   </para>
</entry><entry thead="no"><para>4    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset Classes   </para>
</entry><entry thead="no"><para>5 (all supported)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4699">
<title>9.2 GLOSSARY</title><para>This glossary defines key terms used throughout the Technical Specification, organized by domain.</para>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4700">
<title>9.2.1 Financial Domain Terms</title><para><table rows="32" cols="2"><row>
<entry thead="yes"><para>Term   </para>
</entry><entry thead="yes"><para>Definition    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Asset</bold>   </para>
</entry><entry thead="no"><para>A financial instrument with tradeable value. <ref refid="classBase" kindref="compound">Base</ref> domain entity requiring id, symbol, name, asset_class, sector, and price fields.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Asset Class</bold>   </para>
</entry><entry thead="no"><para>Category classification for financial instruments. Supported values: Equity, Fixed Income, Commodity, Currency, Derivative.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Asset Relationship Graph</bold>   </para>
</entry><entry thead="no"><para>Core in-memory data structure storing assets as nodes and relationships as weighted edges in an adjacency list format.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Average Degree</bold>   </para>
</entry><entry thead="no"><para>Network metric representing the mean number of connections per node, calculated as (2 × total_relationships) / total_assets.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Bidirectional Relationship</bold>   </para>
</entry><entry thead="no"><para>A relationship type where the connection applies equally in both directions (e.g., same_sector, income_comparison).    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Bond</bold>   </para>
</entry><entry thead="no"><para>Fixed income security with specialized attributes: yield_to_maturity, coupon_rate, maturity_date, credit_rating, and issuer_id.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Commodity</bold>   </para>
</entry><entry thead="no"><para>Asset class representing tradeable goods contracts with attributes: contract_size, delivery_date, and volatility.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Commodity Exposure</bold>   </para>
</entry><entry thead="no"><para>Directional relationship linking equity companies to commodity price movements based on sector exposure.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Corporate Bond to Equity</bold>   </para>
</entry><entry thead="no"><para>Directional relationship linking bonds to issuing companies via issuer_id matching equity id.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Coupon Rate</bold>   </para>
</entry><entry thead="no"><para>Annual interest rate paid on a bond&apos;s face value, expressed as a percentage.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Credit Rating</bold>   </para>
</entry><entry thead="no"><para>Assessment of bond issuer creditworthiness, typically represented as letter grades (e.g., AAA, BBB).    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Currency</bold>   </para>
</entry><entry thead="no"><para>Asset class for foreign exchange pairs with attributes: exchange_rate, country, and central_bank_rate.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Currency Risk</bold>   </para>
</entry><entry thead="no"><para>Directional relationship for assets with non-USD currency exposure, indicating foreign exchange risk.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Derivative</bold>   </para>
</entry><entry thead="no"><para>Financial instrument whose value is derived from underlying assets. Reserved for future expansion.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Directional Relationship</bold>   </para>
</entry><entry thead="no"><para>A relationship type where the connection flows from source to target (e.g., corporate_bond_to_equity).    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Dividend Yield</bold>   </para>
</entry><entry thead="no"><para>Annual dividend payment as percentage of stock price, applicable to equity assets.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Earnings Per Share (EPS)</bold>   </para>
</entry><entry thead="no"><para>Company profitability metric calculated as net income divided by outstanding shares.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Equity</bold>   </para>
</entry><entry thead="no"><para>Stock/share ownership in a company with attributes: pe_ratio, dividend_yield, earnings_per_share, and book_value.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Fixed Income</bold>   </para>
</entry><entry thead="no"><para>Asset class for bonds and debt securities generating regular income payments.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Impact Score</bold>   </para>
</entry><entry thead="no"><para>Numerical measure (-1.0 to +1.0) representing regulatory event impact. Negative indicates adverse impact, positive indicates favorable.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Income Comparison</bold>   </para>
</entry><entry thead="no"><para>Bidirectional relationship comparing dividend yields to bond yields for cross-asset income analysis.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Market Cap</bold>   </para>
</entry><entry thead="no"><para>Market Capitalization; total market value of a company&apos;s outstanding shares.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Max Degree</bold>   </para>
</entry><entry thead="no"><para>Network metric representing the highest-connected node in the graph by edge count.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Network Density</bold>   </para>
</entry><entry thead="no"><para>Ratio of actual relationships to maximum possible relationships, calculated as total_edges / (nodes × (nodes-1) / 2).    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>P/E Ratio</bold>   </para>
</entry><entry thead="no"><para>Price-to-Earnings ratio; stock price divided by earnings per share, indicating valuation.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Regulatory Activity</bold>   </para>
</entry><entry thead="no"><para>Enumerated type of corporate or regulatory event: earnings_report, sec_filing, dividend_announcement, bond_issuance, acquisition, bankruptcy.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Regulatory Event</bold>   </para>
</entry><entry thead="no"><para>Corporate or regulatory activity affecting one or more assets with dated occurrence, description, and scored impact.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Relationship Strength</bold>   </para>
</entry><entry thead="no"><para>Normalized weight (0.0-1.0) indicating connection intensity between assets in a relationship.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Same Sector</bold>   </para>
</entry><entry thead="no"><para>Bidirectional relationship linking assets operating in the same industry sector classification.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Sector</bold>   </para>
</entry><entry thead="no"><para>Industry classification for assets (e.g., Technology, Energy, Financial Services, Healthcare).    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Yield to Maturity (YTM)</bold>   </para>
</entry><entry thead="no"><para>Total return anticipated on a bond if held until maturity, accounting for coupon payments and price difference.   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4701">
<title>9.2.2 Technical Architecture Terms</title><para><table rows="24" cols="2"><row>
<entry thead="yes"><para>Term   </para>
</entry><entry thead="yes"><para>Definition    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Adjacency List</bold>   </para>
</entry><entry thead="no"><para>Graph data structure where each node stores a list of connected nodes, implemented as Dict[str, List[Tuple[str, str, float]]].    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>App Router</bold>   </para>
</entry><entry thead="no"><para>Next.js 14 routing paradigm using file-system-based routing in the app/ directory with React Server Components.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Atomic Write</bold>   </para>
</entry><entry thead="no"><para>File operation pattern using NamedTemporaryFile + os.replace() to prevent data corruption during writes.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Bearer Token</bold>   </para>
</entry><entry thead="no"><para>HTTP authorization scheme where the token is passed in the Authorization header as &quot;Bearer {token}&quot;.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Context Manager</bold>   </para>
</entry><entry thead="no"><para>Python pattern using <computeroutput>with</computeroutput> statements for resource management, implemented as session_scope() for database transactions.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Dataclass</bold>   </para>
</entry><entry thead="no"><para>Python @dataclass decorator providing automatic <bold>init</bold>, <bold>repr</bold>, and field handling for domain models.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Dependency Injection</bold>   </para>
</entry><entry thead="no"><para>Design pattern where dependencies are passed to components rather than created internally, used in FastAPI route dependencies.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Double-Checked Locking</bold>   </para>
</entry><entry thead="no"><para>Thread-safe singleton pattern checking instance existence before and after acquiring lock to minimize contention.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold><ref refid="classEnum" kindref="compound">Enum</ref></bold>   </para>
</entry><entry thead="no"><para>Python enumeration type for type-safe constant values (e.g., AssetClass, RegulatoryActivity).    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Graph Engine</bold>   </para>
</entry><entry thead="no"><para>Core component managing asset relationships, 3D layout calculation, and network metrics computation.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Hybrid Storage</bold>   </para>
</entry><entry thead="no"><para>Architecture combining multiple storage mechanisms: in-memory graph, SQLite auth, optional ORM, and JSON cache.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Layered Architecture</bold>   </para>
</entry><entry thead="no"><para>System design separating concerns into Presentation, API, Business Logic, and Data layers for maintainability.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Lifespan Context Manager</bold>   </para>
</entry><entry thead="no"><para>FastAPI pattern for managing application startup/shutdown events using asynccontextmanager decorator.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Middleware</bold>   </para>
</entry><entry thead="no"><para>Software layer intercepting requests/responses for cross-cutting concerns (CORS, rate limiting, authentication).    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Monolithic Architecture</bold>   </para>
</entry><entry thead="no"><para>Single deployable unit containing all application components, as opposed to microservices.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Post-Init Validation</bold>   </para>
</entry><entry thead="no"><para>Dataclass validation in <bold>post_init</bold> method executing after instance creation for business rule enforcement.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Repository Pattern</bold>   </para>
</entry><entry thead="no"><para>Data access abstraction providing collection-like interface over storage, implemented as AssetGraphRepository.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Seed Value</bold>   </para>
</entry><entry thead="no"><para>Random number generator initialization value (42) for deterministic/reproducible 3D layouts.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Session Scope</bold>   </para>
</entry><entry thead="no"><para>Database transaction boundary context manager committing on success, rolling back on error.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Singleton Pattern</bold>   </para>
</entry><entry thead="no"><para>Design pattern ensuring only one instance of a class exists, applied to the graph instance with thread-safety.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Thread-Safe</bold>   </para>
</entry><entry thead="no"><para>Code safe for concurrent execution by multiple threads without race conditions.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Type Contract</bold>   </para>
</entry><entry thead="no"><para>Formal interface defining expected data types through Pydantic models and TypeScript interfaces.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Wide Table Design</bold>   </para>
</entry><entry thead="no"><para>Database schema with nullable columns for type-specific attributes in a single table for simpler queries.   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4702">
<title>9.2.3 UI/UX Terms</title><para><table rows="9" cols="2"><row>
<entry thead="yes"><para>Term   </para>
</entry><entry thead="yes"><para>Definition    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>3D Network Visualization</bold>   </para>
</entry><entry thead="no"><para>Interactive Plotly-based graph rendering with rotation, zoom, pan, and hover capabilities for spatial exploration.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>2D Network Visualization</bold>   </para>
</entry><entry thead="no"><para>Flat network view with selectable layout algorithms (spring, circular, grid) for static analysis.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Asset Explorer</bold>   </para>
</entry><entry thead="no"><para>Filterable, paginated table view for browsing assets by class and sector with direct detail access.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Color Mapping</bold>   </para>
</entry><entry thead="no"><para>Visual encoding scheme mapping asset classes to distinct colors for identification in visualizations.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Hover Text</bold>   </para>
</entry><entry thead="no"><para>Tooltip content displayed when cursor hovers over visualization elements showing asset details.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Metrics Dashboard</bold>   </para>
</entry><entry thead="no"><para>UI component displaying network statistics including node/edge counts and distribution analytics.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Schema Report</bold>   </para>
</entry><entry thead="no"><para>Auto-generated Markdown documentation of data models, relationships, and business rules.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Tabbed Interface</bold>   </para>
</entry><entry thead="no"><para>UI organization with multiple content areas accessible via tab controls (Gradio implements 6 tabs).   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4703">
<title>9.2.4 Infrastructure Terms</title><para><table rows="7" cols="2"><row>
<entry thead="yes"><para>Term   </para>
</entry><entry thead="yes"><para>Definition    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>ASGI Server</bold>   </para>
</entry><entry thead="no"><para>Asynchronous Server Gateway Interface server (Uvicorn) handling async HTTP requests for FastAPI.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Container Hardening</bold>   </para>
</entry><entry thead="no"><para>Security measures applied to Docker containers including non-root user execution and minimal base images.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Edge Network</bold>   </para>
</entry><entry thead="no"><para>Vercel&apos;s globally distributed CDN network for TLS termination and static asset delivery.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Health Check</bold>   </para>
</entry><entry thead="no"><para>HTTP endpoint probe (/api/health) returning system status for load balancer and orchestration verification.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Lambda Function</bold>   </para>
</entry><entry thead="no"><para>Serverless compute unit on Vercel handling individual API requests without persistent server.    </para>
</entry></row>
<row>
<entry thead="no"><para><bold>Static Pool</bold>   </para>
</entry><entry thead="no"><para>SQLAlchemy connection pool configuration for in-memory SQLite maintaining single shared connection.   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4705">
<title>9.3 ACRONYMS</title><para>This section provides expanded forms for all acronyms used throughout the Technical Specification.</para>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4706">
<title>9.3.1 Standard Technical Acronyms</title><para><table rows="46" cols="2"><row>
<entry thead="yes"><para>Acronym   </para>
</entry><entry thead="yes"><para>Expansion    </para>
</entry></row>
<row>
<entry thead="no"><para>API   </para>
</entry><entry thead="no"><para>Application Programming Interface    </para>
</entry></row>
<row>
<entry thead="no"><para>ASGI   </para>
</entry><entry thead="no"><para>Asynchronous Server Gateway Interface    </para>
</entry></row>
<row>
<entry thead="no"><para>CDN   </para>
</entry><entry thead="no"><para>Content Delivery Network    </para>
</entry></row>
<row>
<entry thead="no"><para>CI/CD   </para>
</entry><entry thead="no"><para>Continuous Integration/Continuous Deployment    </para>
</entry></row>
<row>
<entry thead="no"><para>CLI   </para>
</entry><entry thead="no"><para>Command Line Interface    </para>
</entry></row>
<row>
<entry thead="no"><para>CORS   </para>
</entry><entry thead="no"><para>Cross-Origin Resource Sharing    </para>
</entry></row>
<row>
<entry thead="no"><para>CPU   </para>
</entry><entry thead="no"><para>Central Processing Unit    </para>
</entry></row>
<row>
<entry thead="no"><para>CRUD   </para>
</entry><entry thead="no"><para>Create, Read, Update, Delete    </para>
</entry></row>
<row>
<entry thead="no"><para>CSS   </para>
</entry><entry thead="no"><para>Cascading Style Sheets    </para>
</entry></row>
<row>
<entry thead="no"><para>DAG   </para>
</entry><entry thead="no"><para>Directed Acyclic Graph    </para>
</entry></row>
<row>
<entry thead="no"><para>DDL   </para>
</entry><entry thead="no"><para>Data Definition Language    </para>
</entry></row>
<row>
<entry thead="no"><para>DNS   </para>
</entry><entry thead="no"><para>Domain Name System    </para>
</entry></row>
<row>
<entry thead="no"><para>DOM   </para>
</entry><entry thead="no"><para>Document Object Model    </para>
</entry></row>
<row>
<entry thead="no"><para>DRY   </para>
</entry><entry thead="no"><para>Don&apos;t Repeat Yourself    </para>
</entry></row>
<row>
<entry thead="no"><para>ERD   </para>
</entry><entry thead="no"><para>Entity Relationship Diagram    </para>
</entry></row>
<row>
<entry thead="no"><para>FK   </para>
</entry><entry thead="no"><para>Foreign Key    </para>
</entry></row>
<row>
<entry thead="no"><para>GUI   </para>
</entry><entry thead="no"><para>Graphical User Interface    </para>
</entry></row>
<row>
<entry thead="no"><para>HTML   </para>
</entry><entry thead="no"><para>HyperText Markup Language    </para>
</entry></row>
<row>
<entry thead="no"><para>HTTP   </para>
</entry><entry thead="no"><para>HyperText Transfer Protocol    </para>
</entry></row>
<row>
<entry thead="no"><para>HTTPS   </para>
</entry><entry thead="no"><para>HTTP Secure (over TLS)    </para>
</entry></row>
<row>
<entry thead="no"><para>IDE   </para>
</entry><entry thead="no"><para>Integrated Development Environment    </para>
</entry></row>
<row>
<entry thead="no"><para>IP   </para>
</entry><entry thead="no"><para>Internet Protocol    </para>
</entry></row>
<row>
<entry thead="no"><para>JSON   </para>
</entry><entry thead="no"><para>JavaScript Object Notation    </para>
</entry></row>
<row>
<entry thead="no"><para>KPI   </para>
</entry><entry thead="no"><para>Key Performance Indicator    </para>
</entry></row>
<row>
<entry thead="no"><para>LTS   </para>
</entry><entry thead="no"><para>Long-Term Support    </para>
</entry></row>
<row>
<entry thead="no"><para>ORM   </para>
</entry><entry thead="no"><para>Object-Relational Mapping    </para>
</entry></row>
<row>
<entry thead="no"><para>PK   </para>
</entry><entry thead="no"><para>Primary Key    </para>
</entry></row>
<row>
<entry thead="no"><para>PR   </para>
</entry><entry thead="no"><para>Pull Request    </para>
</entry></row>
<row>
<entry thead="no"><para>RAM   </para>
</entry><entry thead="no"><para>Random Access Memory    </para>
</entry></row>
<row>
<entry thead="no"><para>REST   </para>
</entry><entry thead="no"><para>Representational State Transfer    </para>
</entry></row>
<row>
<entry thead="no"><para>SDK   </para>
</entry><entry thead="no"><para>Software Development Kit    </para>
</entry></row>
<row>
<entry thead="no"><para>SLA   </para>
</entry><entry thead="no"><para>Service Level Agreement    </para>
</entry></row>
<row>
<entry thead="no"><para>SQL   </para>
</entry><entry thead="no"><para>Structured Query Language    </para>
</entry></row>
<row>
<entry thead="no"><para>SSR   </para>
</entry><entry thead="no"><para>Server-Side Rendering    </para>
</entry></row>
<row>
<entry thead="no"><para>TLS   </para>
</entry><entry thead="no"><para>Transport Layer Security    </para>
</entry></row>
<row>
<entry thead="no"><para>TTL   </para>
</entry><entry thead="no"><para>Time To Live    </para>
</entry></row>
<row>
<entry thead="no"><para>UID   </para>
</entry><entry thead="no"><para>User Identifier    </para>
</entry></row>
<row>
<entry thead="no"><para>UK   </para>
</entry><entry thead="no"><para>Unique Key    </para>
</entry></row>
<row>
<entry thead="no"><para>URI   </para>
</entry><entry thead="no"><para>Uniform Resource Identifier    </para>
</entry></row>
<row>
<entry thead="no"><para>URL   </para>
</entry><entry thead="no"><para>Uniform Resource Locator    </para>
</entry></row>
<row>
<entry thead="no"><para>UTC   </para>
</entry><entry thead="no"><para>Coordinated Universal Time    </para>
</entry></row>
<row>
<entry thead="no"><para>UUID   </para>
</entry><entry thead="no"><para>Universally Unique Identifier    </para>
</entry></row>
<row>
<entry thead="no"><para>WSGI   </para>
</entry><entry thead="no"><para>Web Server Gateway Interface    </para>
</entry></row>
<row>
<entry thead="no"><para>XML   </para>
</entry><entry thead="no"><para>eXtensible Markup Language    </para>
</entry></row>
<row>
<entry thead="no"><para>YAML   </para>
</entry><entry thead="no"><para>YAML Ain&apos;t Markup Language   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4707">
<title>9.3.2 Security &amp; Authentication Acronyms</title><para><table rows="11" cols="2"><row>
<entry thead="yes"><para>Acronym   </para>
</entry><entry thead="yes"><para>Expansion    </para>
</entry></row>
<row>
<entry thead="no"><para>HMAC   </para>
</entry><entry thead="no"><para>Hash-based Message Authentication Code    </para>
</entry></row>
<row>
<entry thead="no"><para>HS256   </para>
</entry><entry thead="no"><para>HMAC-SHA256 (JWT signing algorithm)    </para>
</entry></row>
<row>
<entry thead="no"><para>JWT   </para>
</entry><entry thead="no"><para>JSON Web Token    </para>
</entry></row>
<row>
<entry thead="no"><para>NIST   </para>
</entry><entry thead="no"><para>National Institute of Standards and Technology    </para>
</entry></row>
<row>
<entry thead="no"><para>RBAC   </para>
</entry><entry thead="no"><para>Role-Based Access Control    </para>
</entry></row>
<row>
<entry thead="no"><para>SARIF   </para>
</entry><entry thead="no"><para>Static Analysis Results Interchange Format    </para>
</entry></row>
<row>
<entry thead="no"><para>SAST   </para>
</entry><entry thead="no"><para>Static Application Security Testing    </para>
</entry></row>
<row>
<entry thead="no"><para>SHA   </para>
</entry><entry thead="no"><para>Secure Hash Algorithm    </para>
</entry></row>
<row>
<entry thead="no"><para>TOTP   </para>
</entry><entry thead="no"><para>Time-based One-Time Password    </para>
</entry></row>
<row>
<entry thead="no"><para>WAL   </para>
</entry><entry thead="no"><para>Write-Ahead Logging   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4708">
<title>9.3.3 Financial Domain Acronyms</title><para><table rows="7" cols="2"><row>
<entry thead="yes"><para>Acronym   </para>
</entry><entry thead="yes"><para>Expansion    </para>
</entry></row>
<row>
<entry thead="no"><para>EPS   </para>
</entry><entry thead="no"><para>Earnings Per Share    </para>
</entry></row>
<row>
<entry thead="no"><para>ETF   </para>
</entry><entry thead="no"><para>Exchange-Traded Fund    </para>
</entry></row>
<row>
<entry thead="no"><para>FX   </para>
</entry><entry thead="no"><para>Foreign Exchange    </para>
</entry></row>
<row>
<entry thead="no"><para>P/E   </para>
</entry><entry thead="no"><para>Price-to-Earnings (ratio)    </para>
</entry></row>
<row>
<entry thead="no"><para>SEC   </para>
</entry><entry thead="no"><para>Securities and Exchange Commission    </para>
</entry></row>
<row>
<entry thead="no"><para>YTM   </para>
</entry><entry thead="no"><para>Yield to Maturity   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4709">
<title>9.3.4 Platform &amp; Tool Acronyms</title><para><table rows="5" cols="2"><row>
<entry thead="yes"><para>Acronym   </para>
</entry><entry thead="yes"><para>Expansion    </para>
</entry></row>
<row>
<entry thead="no"><para>GHCR   </para>
</entry><entry thead="no"><para>GitHub Container Registry    </para>
</entry></row>
<row>
<entry thead="no"><para>MCP   </para>
</entry><entry thead="no"><para>Model Context Protocol    </para>
</entry></row>
<row>
<entry thead="no"><para>OSSF   </para>
</entry><entry thead="no"><para>Open Source Security Foundation    </para>
</entry></row>
<row>
<entry thead="no"><para>ISO   </para>
</entry><entry thead="no"><para>International Organization for Standardization   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4710">
<title>9.3.5 Version-Specific Designations</title><para><table rows="3" cols="2"><row>
<entry thead="yes"><para>Designation   </para>
</entry><entry thead="yes"><para>Meaning    </para>
</entry></row>
<row>
<entry thead="no"><para>ISO 4217   </para>
</entry><entry thead="no"><para>International standard for currency codes (e.g., USD, EUR)    </para>
</entry></row>
<row>
<entry thead="no"><para>ISO 8601   </para>
</entry><entry thead="no"><para>International standard for date/time format (YYYY-MM-DD)   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4712">
<title>9.4 QUICK REFERENCE CARDS</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4713">
<title>9.4.1 API Endpoint Quick Reference</title><para><programlisting filename=".mermaid"><codeline><highlight class="normal">flowchart<sp/>LR</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>PublicEndpoints[Public<sp/>Endpoints]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Health[&quot;/api/health&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Assets[&quot;/api/assets&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AssetDetail[&quot;/api/assets/{id}&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Relationships[&quot;/api/relationships&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Metrics[&quot;/api/metrics&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Visualization[&quot;/api/visualization&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Classes[&quot;/api/asset-classes&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Sectors[&quot;/api/sectors&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>subgraph<sp/>ProtectedEndpoints[Protected<sp/>Endpoints]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Token[&quot;POST<sp/>/token&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserMe[&quot;/api/users/me&quot;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>end</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Client([Client])<sp/>--&gt;<sp/>PublicEndpoints</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Client<sp/>--&gt;<sp/>ProtectedEndpoints</highlight></codeline>
</programlisting></para>
<para><table rows="13" cols="4"><row>
<entry thead="yes"><para>Endpoint   </para>
</entry><entry thead="yes"><para>Method   </para>
</entry><entry thead="yes"><para>Authentication   </para>
</entry><entry thead="yes"><para>Rate Limited    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/health</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/token</computeroutput>   </para>
</entry><entry thead="no"><para>POST   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>Yes (5/min)    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets/{id}</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/assets/{id}/relationships</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/relationships</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/metrics</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/visualization</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/asset-classes</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/sectors</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>No   </para>
</entry><entry thead="no"><para>No    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>/api/users/me</computeroutput>   </para>
</entry><entry thead="no"><para>GET   </para>
</entry><entry thead="no"><para>Yes   </para>
</entry><entry thead="no"><para>Yes (10/min)   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4714">
<title>9.4.2 Development Commands Quick Reference</title><para><table rows="9" cols="2"><row>
<entry thead="yes"><para>Task   </para>
</entry><entry thead="yes"><para>Command    </para>
</entry></row>
<row>
<entry thead="no"><para>Start FastAPI Backend   </para>
</entry><entry thead="no"><para><computeroutput>uvicorn <ref refid="namespaceapi_1_1main" kindref="compound">api.main</ref>:app --reload --port 8000</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Start Next.js Frontend   </para>
</entry><entry thead="no"><para><computeroutput>cd frontend &amp;&amp; npm run dev</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Start Gradio UI   </para>
</entry><entry thead="no"><para><computeroutput>python <ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Run Python Tests   </para>
</entry><entry thead="no"><para><computeroutput>pytest</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Run Tests with Coverage   </para>
</entry><entry thead="no"><para><computeroutput>pytest --cov=api --cov=src --cov-report=html</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Run Frontend Tests   </para>
</entry><entry thead="no"><para><computeroutput>cd frontend &amp;&amp; npm test</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Docker Build   </para>
</entry><entry thead="no"><para><computeroutput>docker-compose up --build</computeroutput>    </para>
</entry></row>
<row>
<entry thead="no"><para>Lint Python Code   </para>
</entry><entry thead="no"><para><computeroutput>flake8 &amp;&amp; black --check . &amp;&amp; isort --check-only .</computeroutput>   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4715">
<title>9.4.3 Domain Model Validation Rules</title><para><table rows="8" cols="3"><row>
<entry thead="yes"><para>Entity   </para>
</entry><entry thead="yes"><para>Field   </para>
</entry><entry thead="yes"><para>Rule    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset   </para>
</entry><entry thead="no"><para>id, symbol, name   </para>
</entry><entry thead="no"><para>Non-empty string required    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset   </para>
</entry><entry thead="no"><para>price   </para>
</entry><entry thead="no"><para>Non-negative float required    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset   </para>
</entry><entry thead="no"><para>market_cap   </para>
</entry><entry thead="no"><para>Non-negative float (optional)    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset   </para>
</entry><entry thead="no"><para>currency   </para>
</entry><entry thead="no"><para>3-character ISO code    </para>
</entry></row>
<row>
<entry thead="no"><para>RegulatoryEvent   </para>
</entry><entry thead="no"><para>impact_score   </para>
</entry><entry thead="no"><para>Range [-1.0, 1.0]    </para>
</entry></row>
<row>
<entry thead="no"><para>RegulatoryEvent   </para>
</entry><entry thead="no"><para>date   </para>
</entry><entry thead="no"><para>ISO 8601 format (YYYY-MM-DD)    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship   </para>
</entry><entry thead="no"><para>strength   </para>
</entry><entry thead="no"><para>Normalized range [0.0, 1.0]   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4717">
<title>9.5 DOCUMENT CROSS-REFERENCE INDEX</title><para>This index maps key topics to their primary documentation locations within this Technical Specification.</para>
<para><table rows="19" cols="2"><row>
<entry thead="yes"><para>Topic   </para>
</entry><entry thead="yes"><para>Primary Section(s)    </para>
</entry></row>
<row>
<entry thead="no"><para>Asset Class Definitions   </para>
</entry><entry thead="no"><para>1.2.2, 2.1.2, 6.2.2    </para>
</entry></row>
<row>
<entry thead="no"><para>Authentication System   </para>
</entry><entry thead="no"><para>5.4.3, 6.4.2, 6.4.3    </para>
</entry></row>
<row>
<entry thead="no"><para>CI/CD Pipeline   </para>
</entry><entry thead="no"><para>8.6    </para>
</entry></row>
<row>
<entry thead="no"><para>CORS Configuration   </para>
</entry><entry thead="no"><para>5.4.5, 6.3.1.5, 6.4.5    </para>
</entry></row>
<row>
<entry thead="no"><para>Database Schema   </para>
</entry><entry thead="no"><para>5.6, 6.2.2, 6.2.3    </para>
</entry></row>
<row>
<entry thead="no"><para>Deployment Options   </para>
</entry><entry thead="no"><para>5.5, 8.2-8.5    </para>
</entry></row>
<row>
<entry thead="no"><para>Environment Variables   </para>
</entry><entry thead="no"><para>6.2.13, 6.3.6, 6.4.7    </para>
</entry></row>
<row>
<entry thead="no"><para>Error Handling   </para>
</entry><entry thead="no"><para>4.5, 5.4.2, 6.3.2.3    </para>
</entry></row>
<row>
<entry thead="no"><para>Feature Catalog   </para>
</entry><entry thead="no"><para>2.1    </para>
</entry></row>
<row>
<entry thead="no"><para>Graph Engine   </para>
</entry><entry thead="no"><para>2.1.3, 5.1.2, 5.2    </para>
</entry></row>
<row>
<entry thead="no"><para>Integration Architecture   </para>
</entry><entry thead="no"><para>6.3    </para>
</entry></row>
<row>
<entry thead="no"><para>Metrics &amp; Analytics   </para>
</entry><entry thead="no"><para>2.1.5 (F-010), 4.3, 5.4.1    </para>
</entry></row>
<row>
<entry thead="no"><para>Rate Limiting   </para>
</entry><entry thead="no"><para>2.1.4 (F-007), 5.4.4, 6.4.4    </para>
</entry></row>
<row>
<entry thead="no"><para>Relationship Types   </para>
</entry><entry thead="no"><para>1.2.2, 2.1.3, 6.2.2.3    </para>
</entry></row>
<row>
<entry thead="no"><para>Security Architecture   </para>
</entry><entry thead="no"><para>3.8, 6.4    </para>
</entry></row>
<row>
<entry thead="no"><para>Technology Stack   </para>
</entry><entry thead="no"><para>1.2.3, 3.1-3.4    </para>
</entry></row>
<row>
<entry thead="no"><para>UI Technologies   </para>
</entry><entry thead="no"><para>7.2    </para>
</entry></row>
<row>
<entry thead="no"><para>Visualization Features   </para>
</entry><entry thead="no"><para>2.1.5, 4.3.2, 7.3   </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect2>
<sect2 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4719">
<title>9.6 REFERENCES</title><sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4720">
<title>9.6.1 Source Files Examined</title><para><table rows="24" cols="2"><row>
<entry thead="yes"><para>Path   </para>
</entry><entry thead="yes"><para>Description    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="app_8py" kindref="compound">app.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Gradio UI implementation with tabbed interface    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2main_8py" kindref="compound">api/main.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>FastAPI application with endpoints, CORS, rate limiting    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="auth_8py" kindref="compound">api/auth.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>JWT authentication and user management    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="api_2database_8py" kindref="compound">api/database.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>SQLite database connection management    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="financial__models_8py" kindref="compound">src/models/financial_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Domain model definitions and validation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="asset__graph_8py" kindref="compound">src/logic/asset_graph.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Graph engine implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="real__data__fetcher_8py" kindref="compound">src/data/real_data_fetcher.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Yahoo Finance integration with caching    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="sample__data_8py" kindref="compound">src/data/sample_data.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Sample database generation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="src_2data_2database_8py" kindref="compound">src/data/database.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>SQLAlchemy ORM configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="db__models_8py" kindref="compound">src/data/db_models.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>ORM model definitions    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="repository_8py" kindref="compound">src/data/repository.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Repository pattern implementation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="schema__report_8py" kindref="compound">src/reports/schema_report.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Schema documentation generator    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="graph__visuals_8py" kindref="compound">src/visualizations/graph_visuals.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>3D visualization generation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="graph__2d__visuals_8py" kindref="compound">src/visualizations/graph_2d_visuals.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>2D visualization generation    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput><ref refid="mcp__server_8py" kindref="compound">mcp_server.py</ref></computeroutput>   </para>
</entry><entry thead="no"><para>Model Context Protocol server    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>migrations/001_initial.sql</computeroutput>   </para>
</entry><entry thead="no"><para>Database DDL schema    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>requirements.txt</computeroutput>   </para>
</entry><entry thead="no"><para>Python dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>frontend/package.json</computeroutput>   </para>
</entry><entry thead="no"><para>Frontend dependencies    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Dockerfile</computeroutput>   </para>
</entry><entry thead="no"><para>Container configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>docker-compose.yml</computeroutput>   </para>
</entry><entry thead="no"><para>Container orchestration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>vercel.json</computeroutput>   </para>
</entry><entry thead="no"><para>Serverless deployment configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.circleci/config.yml</computeroutput>   </para>
</entry><entry thead="no"><para>CircleCI pipeline configuration    </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>.github/workflows/</computeroutput>   </para>
</entry><entry thead="no"><para>GitHub Actions workflow definitions   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4721">
<title>9.6.2 Technical Specification Sections Referenced</title><para><table rows="15" cols="2"><row>
<entry thead="yes"><para>Section   </para>
</entry><entry thead="yes"><para>Topic    </para>
</entry></row>
<row>
<entry thead="no"><para>1.1 Executive Summary   </para>
</entry><entry thead="no"><para>System overview and business context    </para>
</entry></row>
<row>
<entry thead="no"><para>1.2 System Overview   </para>
</entry><entry thead="no"><para>Architecture and technology stack    </para>
</entry></row>
<row>
<entry thead="no"><para>2.1 Feature Catalog   </para>
</entry><entry thead="no"><para>Complete feature descriptions    </para>
</entry></row>
<row>
<entry thead="no"><para>2.6 Assumptions and Constraints   </para>
</entry><entry thead="no"><para>System limitations    </para>
</entry></row>
<row>
<entry thead="no"><para>3.4 Open Source Dependencies   </para>
</entry><entry thead="no"><para>Dependency specifications    </para>
</entry></row>
<row>
<entry thead="no"><para>3.5 Third-Party Services   </para>
</entry><entry thead="no"><para>External integrations    </para>
</entry></row>
<row>
<entry thead="no"><para>5.1 High-Level Architecture   </para>
</entry><entry thead="no"><para>Architectural patterns    </para>
</entry></row>
<row>
<entry thead="no"><para>5.4 Cross-Cutting Concerns   </para>
</entry><entry thead="no"><para>Logging, error handling, authentication    </para>
</entry></row>
<row>
<entry thead="no"><para>5.5 Deployment Architecture   </para>
</entry><entry thead="no"><para>Deployment options    </para>
</entry></row>
<row>
<entry thead="no"><para>6.2 Database Design   </para>
</entry><entry thead="no"><para>Schema and indexing    </para>
</entry></row>
<row>
<entry thead="no"><para>6.3 Integration Architecture   </para>
</entry><entry thead="no"><para>API design and protocols    </para>
</entry></row>
<row>
<entry thead="no"><para>6.4 Security Architecture   </para>
</entry><entry thead="no"><para>Security framework    </para>
</entry></row>
<row>
<entry thead="no"><para>7.2 Core UI Technologies   </para>
</entry><entry thead="no"><para>Frontend specifications    </para>
</entry></row>
<row>
<entry thead="no"><para>8.6 CI/CD Pipeline   </para>
</entry><entry thead="no"><para>Build and deployment automation   </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relationship-db_2tech__spec_1autotoc_md4722">
<title>9.6.3 External Standards Referenced</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Standard   </para>
</entry><entry thead="yes"><para>Usage    </para>
</entry></row>
<row>
<entry thead="no"><para>ISO 4217   </para>
</entry><entry thead="no"><para>Currency code validation (3-character format)    </para>
</entry></row>
<row>
<entry thead="no"><para>ISO 8601   </para>
</entry><entry thead="no"><para>Date format validation (YYYY-MM-DD)    </para>
</entry></row>
<row>
<entry thead="no"><para>OpenAPI 3.x   </para>
</entry><entry thead="no"><para>API documentation specification    </para>
</entry></row>
<row>
<entry thead="no"><para>OAuth2   </para>
</entry><entry thead="no"><para>Bearer token authentication scheme    </para>
</entry></row>
<row>
<entry thead="no"><para>RFC 7519   </para>
</entry><entry thead="no"><para>JSON Web Token standard   </para>
</entry></row>
</table>
</para>
</sect3>
</sect2>
</sect1>
    </detaileddescription>
    <location file="/app/doc_state/github_reposRepoArchDocGenContext/DashFin-FarDb/financial-asset-relationship-db/tech_spec.md"/>
  </compounddef>
</doxygen>
